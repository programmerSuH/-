/*! For license information please see c__LazyBoardReader.7d820576.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{2800:function(t,e,n){"use strict";n.r(e),n.d(e,"Editor",(function(){return ct})),n.d(e,"Reader",(function(){return ft}));var r=n(3655);n.d(e,"Biz",(function(){return r.d}));var a=n(0),i=n.n(a),o=n(8),c=n.n(o),l=n(1),s=n.n(l),u=(n(95),n(49)),d=n(13),h=n.n(d),f=(n(61),n(23)),p=n(26),m=n.n(p),v=n(34),y=n(60),g=n.n(y),b=n(4),x=n.n(b),k=n(5),w=n.n(k),C=n(6),A=n.n(C),O=n(7),E=n.n(O),P=n(2),S=n.n(P),M=n(25),j=n.n(M);function R(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}R("/* stylelint-disable */\n");var L=r.i.Board;function B(t){var e=t.viewModel,n=e.diagram,r=e.onProperties,a=e.showProperties,o=e.onSave,c=e.engine,l=e.mini,s=e.readOnly,u=e.onMaximize,d=e.focusMode,h=e.setFocusMode,f=e.material,p=e.boardWebProxy;if(!n||!c)return i.a.createElement("div",{className:"lake-board-toolbar"});var m={diagram:n,mini:l,onSave:o,onProperties:r,readOnly:s,showProperties:a,onMaximize:u,focusMode:d,setFocusMode:h,boardWebProxy:p};return null!=f&&f.onUse&&(m.onMaterialUse=f.onUse),null!=f&&f.onMore&&(m.onMaterialMore=f.onMore),null!=f&&f.onMaximize&&(m.onMaterialMaximize=f.onMaximize),i.a.createElement("div",{className:"lake-board-toolbar"},i.a.createElement(L.Toolbar,m))}B.propTypes={viewModel:c.a.shape({diagram:c.a.object,onProperties:c.a.func,onImageInputChange:c.a.func,showProperties:c.a.bool,mini:c.a.bool,readOnly:c.a.bool,onSave:c.a.func,onMaximize:c.a.func,engine:c.a.object,focusMode:c.a.bool,setFocusMode:c.a.func,material:c.a.object,boardWebProxy:c.a.object})};var D=r.i.Board;function N(t){var e=t.viewModel,n=e.diagram,r=e.onProperties,a=e.showProperties,o=e.engine,c=e.mini,l=e.boardWebProxy;return n&&o&&!a?i.a.createElement("div",{className:"lake-board-contextual-menu-wrap"},i.a.createElement(D.ContextualMenu,{diagram:n,mini:c,onProperties:r,boardWebProxy:l})):i.a.createElement("div",{className:"lake-board-contextual-menu-wrap"})}function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){var e=t.getBoundingClientRect(),n=e.height;return{width:e.width,height:n}}function T(t){var e=t.diagram,n=t.setDiagram,i=t.model,o=t.container,c=t.mini,l=t.boardWebProxy;Object(a.useEffect)((function(){if(!e){var t=new r.m(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({container:o.current,plugins:[r.u.Board],mode:i.get("mode"),paper:{size:"auto"}},I(o.current)));t.spm=null==l?void 0:l.spm,n(t)}return function(){return e&&e.destroy()}}),[e]),Object(a.useEffect)((function(){var t=o.current,n=new ResizeObserver((function(n){var r=n.find((function(e){return e.target===t})),a=null===t.offsetParent;if(e&&r&&r.contentRect&&!a){var i=I(o.current),l=i.width,s=i.height,u=c?18:0;e.changeSize(l+u,s+u)}}));return n.observe(t),function(){return n.unobserve(t)}}),[e,c])}function F(t){var e=Object(a.useRef)(),n=t.viewModel,r=n.diagram,o=n.setDiagram,c=n.model,l=n.engine,s=n.mini,u=n.focusMode,d=n.setFocusMode;return T({diagram:r,setDiagram:o,model:c,container:e,engine:l,mini:s,boardWebProxy:n.boardWebProxy}),i.a.createElement("div",{ref:e,className:"lake-board-canvas"},i.a.createElement(B,{viewModel:n,focusMode:u,setFocusMode:d}),i.a.createElement(N,{viewModel:n}))}N.propTypes={viewModel:c.a.shape({diagram:c.a.object,onProperties:c.a.func,showProperties:c.a.bool,mini:c.a.bool,engine:c.a.object,boardWebProxy:c.a.object})},R(".lake-board-editor .lake-board-content .lake-board-canvas {\n  width: 100%;\n  height: 100%;\n}\n"),F.defaultProps={viewModel:{}},F.propTypes={viewModel:c.a.shape({model:c.a.object,engine:c.a.object,diagram:c.a.object,setDiagram:c.a.func,mini:c.a.bool,focusMode:c.a.bool,setFocusMode:c.a.func})};var z=r.i.Board;function q(t){var e=t.viewModel,n=e.diagram,r=e.propertiesWidth,a=e.onProperties,o=e.onViewportOptionChange,c=e.viewportOption;return i.a.createElement("div",{className:"lake-board-properties",style:{width:"".concat(r,"px"),flex:"none"}},n&&i.a.createElement(z.Properties,{diagram:n,viewportOptionProps:{onChange:function(t){o(t)},viewportOption:c},onClose:function(){a()}}))}q.defaultProps={viewModel:{}},q.propTypes={viewModel:c.a.shape({diagram:c.a.object,propertiesWidth:c.a.number,viewportOption:c.a.string,onProperties:c.a.func,onViewportOptionChange:c.a.func})},R("/* stylelint-disable */\n.lake-board-material-lib-maxi-modal-container {\n  text-align: center;\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-content {\n  box-shadow: none;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-close {\n  display: none;\n}\n.lake-board-material-lib-maxi-modal-container .ant-modal-footer {\n  display: none;\n}\n");var Y=r.i.Board;function H(t){var e=t.viewModel,n=e.diagram,r=e.material,a=e.boardWebProxy,o=e.showMaterialModal,c=e.materialScrollToName,l={diagram:n,boardWebProxy:a};return null!=r&&r.onUse&&(l.onUse=r.onUse),null!=r&&r.onClose&&(l.onClose=r.onClose),c&&(l.scrollToName=c),i.a.createElement(u.a,{className:"lake-board-material-lib-maxi-modal-container",visible:o,width:"auto",zIndex:1031,centered:!0},i.a.createElement(Y.MaterialLibMaxi,l))}H.defaultProps={viewModel:{}},H.propTypes={viewModel:c.a.shape({diagram:c.a.object,material:c.a.object,boardWebProxy:c.a.object,showMaterialModal:c.a.bool,materialScrollToName:c.a.oneOfType([c.a.string,c.a.number])})};var G=r.i.Board;function X(t){var e=t.viewModel,n=e.diagram,r=e.material,a={diagram:n,boardWebProxy:e.boardWebProxy};return null!=r&&r.onAdd&&(a.onAddMaterial=r.onAdd),i.a.createElement(G.ContextMenu,a)}X.defaultProps={viewModel:{}},X.propTypes={viewModel:c.a.shape({diagram:c.a.object,material:c.a.object,boardWebProxy:c.a.object})},R("/* stylelint-disable */\n.lake-board-editor {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-editor .lake-board-content {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-editor .lake-board-content .lake-board-canvas-wrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n}\n.lake-board-editor .lake-board-content .lake-board-canvas-wrapper.lake-board-has-properties {\n  width: calc(100% - 284px);\n  margin-right: 284px;\n}\n.lake-board-editor .lake-board-content .lake-board-properties-wrapper {\n  width: 284px;\n  height: 100%;\n  position: absolute;\n  right: 0;\n}\n.lake-board-editor .lake-board-content .lake-board-properties-wrapper .lake-board-properties {\n  height: 100%;\n}\n");var W=r.i.LinkEditor,V=r.i.Note,Z=r.i.IconChange,U=r.i.DslEditor;function K(t){var e=t.viewModel,n=e.showProperties,r=e.diagram,a=e.focusMode,o=e.setFocusMode,c=e.showMaterialModal;return i.a.createElement("div",{className:"lake-board-editor"},i.a.createElement("div",{className:"lake-board-content"},i.a.createElement("div",{className:h()("lake-board-canvas-wrapper",{"lake-board-has-properties":n})},i.a.createElement(F,{viewModel:e,focusMode:a,setFocusMode:o}),r&&i.a.createElement(X,{viewModel:e})),r&&n&&i.a.createElement("div",{className:"lake-board-properties-wrapper"},i.a.createElement(q,{viewModel:e}))),r&&i.a.createElement(W,{diagram:r}),r&&i.a.createElement(V.Editor,{diagram:r}),r&&i.a.createElement(Z,{diagram:r}),r&&i.a.createElement(U,{diagram:r}),r&&c&&i.a.createElement(H,{viewModel:e}))}K.defaultProps={viewModel:{}},K.propTypes={viewModel:c.a.shape({diagramData:c.a.object,engine:c.a.object,diagram:c.a.object,showProperties:c.a.bool,focusMode:c.a.bool,setFocusMode:c.a.func,showMaterialModal:c.a.bool})};var Q=r.d.exportData,$=r.d.importData,J=r.d.onBeforeSave,tt=function(t){A()(n,j.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var a=S()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return E()(this,n)}}(n);function n(t){var a,i=t.diagram,o=t.model,c=t.uploader;x()(this,n),a=e.call(this);var l=new r.p.Event;return a.model=o,a.diagram=i,a.uploader=c,a.eventHelper=l,l.bind(i,"aftercommandexecute",(function(t){var e=t.isModelChange,n=t.commandName,r=t.useTime;e&&a.emit("change"),a.emit("commandEnd",n,r)})),a}return w()(n,[{key:"save",value:function(){this.emit("save")}},{key:"setValue",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.diagram,n=this.model,r=this.uploader,a=t.diagramData,i=t.viewportOption,o=t.viewportSetting;a&&(n.set("diagramData",a),e.clear(),$({data:a,diagram:e,uploader:r})),i&&n.set("viewportOption",i),o&&"object"===g()(o)&&(n.set("viewportSetting",o),e.viewport.set(o))}},{key:"getValue",value:function(){var t=this.model;return t.set("diagramData",this.getDiagramData()),t.set("viewportSetting",this.getViewportSetting()),t.set("text",this.getText()),t.set("graphicsBBox",this.getGraphicsBBox()),t.export()}},{key:"getGraphicsBBox",value:function(){return this.diagram.rootGroup.getBBox()}},{key:"getViewportSetting",value:function(){return this.diagram.viewport.toObject()}},{key:"getDiagramData",value:function(){var t=this.diagram;return Q(t)}},{key:"getMeta",value:function(){return{cellCount:this.diagram.getCells().length}}},{key:"getHtml",value:function(){return this.diagram?this.diagram.exporter.html():"<div>LakeBoard</div>"}},{key:"getText",value:function(){return this.diagram?this.diagram.exporter.getText():"LakeBoard"}},{key:"download",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpeg",e=arguments.length>1?arguments[1]:void 0;return this.diagram.exporter.download(t,e)}},{key:"canvas",value:function(){var t;return(t=this.diagram.exporter).canvas.apply(t,arguments)}},{key:"onBeforeSave",value:function(){return J(this,this.uploader)}},{key:"destroy",value:function(){this.diagram=void 0,this.uploader=void 0,this.eventHelper.destroy(),this.destroyed=!0}}]),n}();function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){s()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rt=r.d.uploadImage,at=r.d.generateBoardWebProxy;function it(t){var e=t.file,n=t.uploader,r=t.diagram,a=t.from,i=t.x,o=t.y,c=t.width,l=t.height;return new Promise((function(t){rt({file:e,uploader:n,enable:function(){return r.command.enable("MindmapAttachImage")||r.command.enable("InsertImage")},onTemporaryOnLoad:function(e){var n=r.selector.selections;"clipboard"===a&&(e.firstInsertRatio=1/window.devicePixelRatio),1===n.length&&n[0].isMindmap?r.command.execute("MindmapAttachImage",{image:e}):r.command.execute("InsertImage",{image:e,x:i,y:o,width:c,height:l}),t(e)},onCompleted:function(t){var e=t.hash,n=t.cdn;r.getCells().filter((function(t){var n,r,a,i=null===(n=t.model)||void 0===n||null===(r=n.image)||void 0===r||null===(a=r.uploadInfo)||void 0===a?void 0:a.hash;return i&&i===e})).forEach((function(t){t.updateModel({image:{src:n}})}))}})}))}var ot=r.d.Model;function ct(t){var e=function(t,e){var n,r=t.onLoad,o=t.uploader,c=t.mini,l=void 0!==c&&c,s=t.onMaximize,u=t.boardWebProxyParams,d=void 0===u?{}:u,h=Object(a.useState)(null),p=m()(h,2),y=p[0],g=p[1],b=Object(a.useState)(!1),x=m()(b,2),k=x[0],w=x[1],C=Object(a.useState)(null),A=m()(C,2),O=A[0],E=A[1],P=Object(a.useState)(!1),S=m()(P,2),M=S[0],j=S[1],R=Object(a.useState)(!1),L=m()(R,2),B=L[0],D=L[1],N=Object(a.useState)(null),_=m()(N,2),I=_[0],T=_[1],F=Object(a.useState)(e.get("viewportOption")),z=m()(F,2),q=z[0],Y=z[1],H=d.webProxy,G=d.userId,X=d.spm,W=d.appData,V=t.boardWebProxy||at(H,G,X,W);function Z(){w(!k),setTimeout((function(){window.dispatchEvent(new Event("resize"))}))}return null!=V&&V.material&&(n={onAdd:function(t){f.a.success(i.a.createElement("span",null,i.a.createElement("span",null,"素材添加成功！"),i.a.createElement("a",{onClick:function(){t&&(T("personal"),D(!0))}},"查看"))),D(!1)},onUse:function(){D(!1)},onMore:function(t){T(t),D(!0)},onClose:function(){D(!1)},onMaximize:function(){T(null),D(!0)}}),e.set("mode","edit"),Object(a.useEffect)((function(){if(y){var t=new tt({diagram:y,model:e,uploader:o});return E(t),r(t),function(){return t.destroy()}}}),[y]),Object(a.useEffect)((function(){function t(t){it(nt(nt({},t),{},{file:t.files[0],uploader:o,diagram:y}))}if(y)return y.on("importimage",t),function(){return y.off("importimage",t)}}),[y]),Object(a.useEffect)((function(){function t(t){(function(t){return v.ua.macos?t.metaKey:t.ctrlKey})(t)&&("s"===t.key?(t.preventDefault(),O.save()):"."===t.key&&(t.preventDefault(),j((function(t){return!t}))))}return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[O,Z]),Object(a.useEffect)((function(){function t(t){if(!o.isCompleted())return t.preventDefault(),t.returnValue="仍有图片正在上传中，是否确认关闭？",""}return window.addEventListener("beforeunload",t),function(){window.removeEventListener("beforeunload",t)}}),[O]),{model:e,engine:O,uploader:o,boardWebProxy:V,material:n,onImageInputChange:function(t){it({file:t.nativeEvent.target.files[0],uploader:o,diagram:y}),t.nativeEvent.target.value=null},onMaximize:s,onSave:function(){O.save()},onProperties:Z,onViewportOptionChange:function(t){e&&e.set("viewportOption",t),O&&O.emit("change"),Y(t)},viewportOption:q,setViewportOption:Y,materialScrollToName:I,setMaterialScrollToName:T,diagram:y,setDiagram:g,showMaterialModal:B,setShowMaterialModal:D,showProperties:!l&&k,setShowProperties:w,focusMode:M,setFocusMode:j,mini:l}}(t,Object(a.useMemo)((function(){return new ot}),[]));return i.a.createElement(K,{viewModel:e})}function lt(t){var e=t.viewModel,n=Object(a.useRef)();return T({diagram:e.diagram,setDiagram:e.setDiagram,model:e.model,container:n,engine:e.engine,mini:e.mini}),i.a.createElement("div",{ref:n,className:"lake-board-canvas"},i.a.createElement(B,{viewModel:e}))}ct.defaultProps={data:{},onLoad:function(){},boardWebProxy:null},ct.propTypes={data:c.a.shape({diagramData:c.a.object}),onLoad:c.a.func,uploader:c.a.object.isRequired,boardWebProxy:c.a.object},R(".lake-board-reader .lake-board-content .lake-board-canvas {\n  width: 100%;\n  height: 100%;\n  user-select: none;\n}\n"),lt.defaultProps={viewModel:{},contentContainer:{}},lt.propTypes={viewModel:c.a.shape({diagram:c.a.object,setDiagram:c.a.func,model:c.a.object,engine:c.a.object,mini:c.a.bool}),contentContainer:c.a.object.isRequired},R("/* stylelint-disable */\n.lake-board-reader {\n  width: 100%;\n  height: 100%;\n}\n.lake-board-reader .lake-board-content {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.lake-board-reader .lake-board-content .lake-board-canvas-wrapper {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n}\n");var st=r.i.Note,ut=r.i.Board;function dt(t){var e=t.viewModel,n=e.diagram;return i.a.createElement("div",{className:"lake-board-reader"},i.a.createElement("div",{className:"lake-board-content"},i.a.createElement("div",{className:"lake-board-canvas-wrapper"},i.a.createElement(lt,{viewModel:e}),n&&i.a.createElement(ut.ContextMenu,{diagram:n}))),n&&i.a.createElement(st.Reader,{diagram:n}))}dt.defaultProps={viewModel:{}},dt.propTypes={viewModel:c.a.shape({diagramData:c.a.object,diagram:c.a.object})};var ht=r.d.Model;function ft(t){var e,n,r,o,c,l,s,u,d,h,f,p,v,y=(n=(e=t).onLoad,r=e.mini,o=e.onMaximize,c=Object(a.useMemo)((function(){return new ht})),l=Object(a.useState)(null),s=m()(l,2),u=s[0],d=s[1],h=Object(a.useState)(null),p=(f=m()(h,2))[0],v=f[1],c.set("mode","read"),Object(a.useEffect)((function(){if(u){var t=new tt({diagram:u,model:c});return v(t),n(t),function(){return t.destroy()}}}),[u]),{model:c,onMaximize:o,mini:r,engine:p,setEngine:v,diagram:u,setDiagram:d,readOnly:!0});return i.a.createElement(dt,{viewModel:y})}ft.defaultProps={data:{},onLoad:function(){}},ft.propTypes={data:c.a.shape({diagramData:c.a.object}),onLoad:c.a.func}},3485:function(t,e,n){"use strict";var r=n(25),a=n.n(r);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(){o=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function d(t,e,n,a){var i=e&&e.prototype instanceof p?e:p,o=Object.create(i.prototype),c=new P(a||[]);return r(o,"_invoke",{value:C(t,n,c)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var f={};function p(){}function m(){}function v(){}var y={};u(y,c,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==e&&n.call(b,c)&&(y=b);var x=v.prototype=p.prototype=Object.create(y);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function a(r,o,c,l){var s=h(t[r],t,o);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==i(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){a("next",t,c,l)}),(function(t){a("throw",t,c,l)})):e.resolve(d).then((function(t){u.value=t,c(u)}),(function(t){return a("throw",t,c,l)}))}l(s.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){a(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function C(t,e,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return M()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var c=A(o,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=h(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function A(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=h(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,f;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function S(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:M}}function M(){return{value:void 0,done:!0}}return m.prototype=v,r(x,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},k(w.prototype),u(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new w(d(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},k(x),u(x,s,"Generator"),u(x,c,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function c(t,e,n,r,a,i,o){try{var c=t[i](o),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,a)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d(r.key),r)}}function d(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.doc=e,this.engine=n,this.emitter=new a.a}var e,n,r,i,d;return e=t,n=[{key:"resetDoc",value:function(t){this.doc=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t)}},{key:"init",value:function(t){t.content,t.onFocus}},{key:"initCollabDoc",value:function(t){}},{key:"setContent",value:function(t){}},{key:"appendContent",value:function(t){}},{key:"getValue",value:function(){return null}},{key:"getPureContent",value:function(){return null}},{key:"getSummaryContent",value:function(){return null}},{key:"getEditorContent",value:function(t){return{content:"",html:null,premium:null,premiumHtml:null}}},{key:"getThumbnail",value:function(){return""}},{key:"getDocMeta",value:function(t){return null}},{key:"updateDocEditorMeta",value:function(t){var e=this;["meta_draft","meta"].forEach((function(n){var r="editor_".concat(n);t[n]&&(e.doc[r]=t[n])}))}},{key:"getPremium",value:function(){return null}},{key:"getWordCount",value:function(t){return t&&t(-1),0}},{key:"getSummary",value:function(t){t({summary:null,cover:null})}},{key:"isEmpty",value:function(){return!1}},{key:"isFocus",value:function(){return!1}},{key:"hasUserChanged",value:function(){return!0}},{key:"resetUserChanged",value:function(){}},{key:"disable",value:function(){}},{key:"enable",value:function(){}},{key:"readonly",value:function(t){}},{key:"focus",value:function(t){}},{key:"focusToEnd",value:function(t){}},{key:"focusBlankDoc",value:function(){}},{key:"onBeforeSave",value:(i=o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)})),d=function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function o(t){c(a,n,r,o,l,"next",t)}function l(t){c(a,n,r,o,l,"throw",t)}o(void 0)}))},function(){return d.apply(this,arguments)})},{key:"isContentReady",value:function(){return!0}},{key:"reset",value:function(t){}},{key:"getOriginEngine",value:function(){return this.engine}},{key:"getCollabMembers",value:function(t){return[]}},{key:"setCollabMembers",value:function(){}},{key:"addCollabMember",value:function(){}},{key:"removeCollabMember",value:function(){}},{key:"setCurrentMember",value:function(){}},{key:"onCommandError",value:function(t){}},{key:"onCommandEnd",value:function(t){}},{key:"getReportValue",value:function(){return null}}],n&&u(e.prototype,n),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.a=h},349:function(t,e,n){"use strict";n(3158);var r=n(2505);n(1825);e.a=r.a},3491:function(t,e,n){t.exports=n(2853)},3647:function(t,e,n){"use strict";n(3381);var r=n(2812);n(3377);e.a=r.a},3655:function(t,e,n){"use strict";n.d(e,"a",(function(){return Go})),n.d(e,"b",(function(){return cr})),n.d(e,"c",(function(){return Kl})),n.d(e,"d",(function(){return SC})),n.d(e,"e",(function(){return As})),n.d(e,"f",(function(){return Lc})),n.d(e,"g",(function(){return dc})),n.d(e,"h",(function(){return xn})),n.d(e,"i",(function(){return uC})),n.d(e,"j",(function(){return Vr})),n.d(e,"k",(function(){return To})),n.d(e,"l",(function(){return Ui})),n.d(e,"m",(function(){return Ts})),n.d(e,"n",(function(){return Cs})),n.d(e,"o",(function(){return ui})),n.d(e,"p",(function(){return Qu})),n.d(e,"q",(function(){return Pi})),n.d(e,"r",(function(){return Mi})),n.d(e,"s",(function(){return wl})),n.d(e,"t",(function(){return ar})),n.d(e,"u",(function(){return Rg})),n.d(e,"v",(function(){return Fs}));var r=n(86),a=n(60),i=n.n(a),o=n(1),c=n.n(o),l=n(175),s=n.n(l),u=n(1737),d=n.n(u),h=n(3708),f=n.n(h),p=n(4),m=n.n(p),v=n(5),y=n.n(v),g=n(26),b=n.n(g),x=n(450),k=n.n(x),w=n(3543),C=n(87),A=n.n(C),O=n(3),E=n.n(O),P=n(6),S=n.n(P),M=n(7),j=n.n(M),R=n(2),L=n.n(R),B=n(24),D=n.n(B),N=n(19),_=n.n(N),I=n(25),T=n.n(I),F=n(2405);const z=Math.pow(2,-52),q=new Uint32Array(512);class Y{static from(t,e=K,n=Q){const r=t.length,a=new Float64Array(2*r);for(let i=0;i<r;i++){const r=t[i];a[2*i]=e(r),a[2*i+1]=n(r)}return new Y(a)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:a}=this,i=t.length>>1;let o=1/0,c=1/0,l=-1/0,s=-1/0;for(let e=0;e<i;e++){const n=t[2*e],r=t[2*e+1];n<o&&(o=n),r<c&&(c=r),n>l&&(l=n),r>s&&(s=r),this._ids[e]=e}const u=(o+l)/2,d=(c+s)/2;let h,f,p,m=1/0;for(let e=0;e<i;e++){const n=H(u,d,t[2*e],t[2*e+1]);n<m&&(h=e,m=n)}const v=t[2*h],y=t[2*h+1];m=1/0;for(let e=0;e<i;e++){if(e===h)continue;const n=H(v,y,t[2*e],t[2*e+1]);n<m&&n>0&&(f=e,m=n)}let g=t[2*f],b=t[2*f+1],x=1/0;for(let e=0;e<i;e++){if(e===h||e===f)continue;const n=V(v,y,g,b,t[2*e],t[2*e+1]);n<x&&(p=e,x=n)}let k=t[2*p],w=t[2*p+1];if(x===1/0){for(let e=0;e<i;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];Z(this._ids,this._dists,0,i-1);const e=new Uint32Array(i);let n=0;for(let t=0,r=-1/0;t<i;t++){const a=this._ids[t];this._dists[a]>r&&(e[n++]=a,r=this._dists[a])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(X(v,y,g,b,k,w)){const t=f,e=g,n=b;f=p,g=k,b=w,p=t,k=e,w=n}const C=function(t,e,n,r,a,i){const o=n-t,c=r-e,l=a-t,s=i-e,u=o*o+c*c,d=l*l+s*s,h=.5/(o*s-c*l),f=t+(s*u-c*d)*h,p=e+(o*d-l*u)*h;return{x:f,y:p}}(v,y,g,b,k,w);this._cx=C.x,this._cy=C.y;for(let e=0;e<i;e++)this._dists[e]=H(t[2*e],t[2*e+1],C.x,C.y);Z(this._ids,this._dists,0,i-1),this._hullStart=h;let A=3;n[h]=e[p]=f,n[f]=e[h]=p,n[p]=e[f]=h,r[h]=0,r[f]=1,r[p]=2,a.fill(-1),a[this._hashKey(v,y)]=h,a[this._hashKey(g,b)]=f,a[this._hashKey(k,w)]=p,this.trianglesLen=0,this._addTriangle(h,f,p,-1,-1,-1);for(let i,o,c=0;c<this._ids.length;c++){const l=this._ids[c],s=t[2*l],u=t[2*l+1];if(c>0&&Math.abs(s-i)<=z&&Math.abs(u-o)<=z)continue;if(i=s,o=u,l===h||l===f||l===p)continue;let d=0;for(let t=0,e=this._hashKey(s,u);t<this._hashSize&&(d=a[(e+t)%this._hashSize],-1===d||d===n[d]);t++);d=e[d];let m,v=d;for(;m=n[v],!X(s,u,t[2*v],t[2*v+1],t[2*m],t[2*m+1]);)if(v=m,v===d){v=-1;break}if(-1===v)continue;let y=this._addTriangle(v,l,n[v],-1,-1,r[v]);r[l]=this._legalize(y+2),r[v]=y,A++;let g=n[v];for(;m=n[g],X(s,u,t[2*g],t[2*g+1],t[2*m],t[2*m+1]);)y=this._addTriangle(g,l,m,r[l],-1,r[g]),r[l]=this._legalize(y+2),n[g]=g,A--,g=m;if(v===d)for(;m=e[v],X(s,u,t[2*m],t[2*m+1],t[2*v],t[2*v+1]);)y=this._addTriangle(m,l,v,-1,r[v],r[m]),this._legalize(y+2),r[m]=y,n[v]=v,A--,v=m;this._hullStart=e[l]=v,n[v]=e[g]=l,n[l]=g,a[this._hashKey(s,u)]=l,a[this._hashKey(t[2*v],t[2*v+1])]=v}this.hull=new Uint32Array(A);for(let t=0,e=this._hullStart;t<A;t++)this.hull[t]=e,e=n[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let a=0,i=0;for(;;){const o=n[t],c=t-t%3;if(i=c+(t+2)%3,-1===o){if(0===a)break;t=q[--a];continue}const l=o-o%3,s=c+(t+1)%3,u=l+(o+2)%3,d=e[i],h=e[t],f=e[s],p=e[u];if(W(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*f],r[2*f+1],r[2*p],r[2*p+1])){e[t]=p,e[o]=d;const r=n[u];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===u){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[i]),this._link(i,u);const c=l+(o+1)%3;a<q.length&&(q[a++]=c)}else{if(0===a)break;t=q[--a]}}return i}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,a,i){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}function H(t,e,n,r){const a=t-n,i=e-r;return a*a+i*i}function G(t,e,n,r,a,i){const o=(r-e)*(a-t),c=(n-t)*(i-e);return Math.abs(o-c)>=33306690738754716e-32*Math.abs(o+c)?o-c:0}function X(t,e,n,r,a,i){return(G(a,i,t,e,n,r)||G(t,e,n,r,a,i)||G(n,r,a,i,t,e))<0}function W(t,e,n,r,a,i,o,c){const l=t-o,s=e-c,u=n-o,d=r-c,h=a-o,f=i-c,p=u*u+d*d,m=h*h+f*f;return l*(d*m-p*f)-s*(u*m-p*h)+(l*l+s*s)*(u*f-d*h)<0}function V(t,e,n,r,a,i){const o=n-t,c=r-e,l=a-t,s=i-e,u=o*o+c*c,d=l*l+s*s,h=.5/(o*s-c*l),f=(s*u-c*d)*h,p=(o*d-l*u)*h;return f*f+p*p}function Z(t,e,n,r){if(r-n<=20)for(let a=n+1;a<=r;a++){const r=t[a],i=e[r];let o=a-1;for(;o>=n&&e[t[o]]>i;)t[o+1]=t[o--];t[o+1]=r}else{let a=n+1,i=r;U(t,n+r>>1,a),e[t[n]]>e[t[r]]&&U(t,n,r),e[t[a]]>e[t[r]]&&U(t,a,r),e[t[n]]>e[t[a]]&&U(t,n,a);const o=t[a],c=e[o];for(;;){do{a++}while(e[t[a]]<c);do{i--}while(e[t[i]]>c);if(i<a)break;U(t,a,i)}t[n+1]=t[i],t[i]=o,r-a+1>=i-n?(Z(t,e,a,r),Z(t,e,n,i-1)):(Z(t,e,n,i-1),Z(t,e,a,r))}}function U(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function K(t){return t[0]}function Q(t){return t[1]}const $=1e-6;class J{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),a=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${a}`:(Math.abs(this._x1-r)>$||Math.abs(this._y1-a)>$)&&(this._+="L"+r+","+a),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=a}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class tt{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class et{constructor(t,[e,n,r,a]=[0,0,960,500]){if(!((r=+r)>=(e=+e)&&(a=+a)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=a,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,a=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let e,r,i=0,o=0,c=n.length;i<c;i+=3,o+=2){const c=2*n[i],l=2*n[i+1],s=2*n[i+2],u=t[c],d=t[c+1],h=t[l],f=t[l+1],p=t[s],m=t[s+1],v=h-u,y=f-d,g=p-u,b=m-d,x=v*v+y*y,k=g*g+b*b,w=2*(v*b-y*g);if(w)if(Math.abs(w)<1e-8)e=(u+p)/2,r=(d+m)/2;else{const t=1/w;e=u+(b*x-y*k)*t,r=d+(v*k-g*x)*t}else e=(u+p)/2-1e8*b,r=(d+m)/2+1e8*g;a[o]=e,a[o+1]=r}let i,o,c,l=e[e.length-1],s=4*l,u=t[2*l],d=t[2*l+1];r.fill(0);for(let n=0;n<e.length;++n)l=e[n],i=s,o=u,c=d,s=4*l,u=t[2*l],d=t[2*l+1],r[i+2]=r[s]=c-d,r[i+3]=r[s+1]=u-o}render(t){const e=null==t?t=new J:void 0,{delaunay:{halfedges:n,inedges:r,hull:a},circumcenters:i,vectors:o}=this;if(a.length<=1)return null;for(let e=0,r=n.length;e<r;++e){const r=n[e];if(r<e)continue;const a=2*Math.floor(e/3),o=2*Math.floor(r/3),c=i[a],l=i[a+1],s=i[o],u=i[o+1];this._renderSegment(c,l,s,u,t)}let c,l=a[a.length-1];for(let e=0;e<a.length;++e){c=l,l=a[e];const n=2*Math.floor(r[l]/3),s=i[n],u=i[n+1],d=4*c,h=this._project(s,u,o[d+2],o[d+3]);h&&this._renderSegment(s,u,h[0],h[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new J:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new J:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let a=r.length;for(;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(let t=2;t<a;t+=2)r[t]===r[t-2]&&r[t+1]===r[t-1]||e.lineTo(r[t],r[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new tt;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,a){let i;const o=this._regioncode(t,e),c=this._regioncode(n,r);0===o&&0===c?(a.moveTo(t,e),a.lineTo(n,r)):(i=this._clipSegment(t,e,n,r,o,c))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,a=e.length;r<a;r+=2)for(let i=0,o=t.length;i<o;i+=2)if(e[r]==t[i]&&e[r+1]==t[i+1]&&e[(r+2)%a]==t[(i+o-2)%o]&&e[(r+3)%a]==t[(i+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:a}}=this,i=n[t];if(-1===i)return null;const o=[];let c=i;do{const n=Math.floor(c/3);if(o.push(e[2*n],e[2*n+1]),c=c%3==2?c-2:c+1,a[c]!==t)break;c=r[c]}while(c!==i&&-1!==c);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,a,i,o,c,l=null,s=e[n-2],u=e[n-1],d=this._regioncode(s,u);for(let h=0;h<n;h+=2)if(r=s,a=u,s=e[h],u=e[h+1],i=d,d=this._regioncode(s,u),0===i&&0===d)o=c,c=0,l?l.push(s,u):l=[s,u];else{let e,n,h,f,p;if(0===i){if(null===(e=this._clipSegment(r,a,s,u,i,d)))continue;[n,h,f,p]=e}else{if(null===(e=this._clipSegment(s,u,r,a,d,i)))continue;[f,p,n,h]=e,o=c,c=this._edgecode(n,h),o&&c&&this._edge(t,o,c,l,l.length),l?l.push(n,h):l=[n,h]}o=c,c=this._edgecode(f,p),o&&c&&this._edge(t,o,c,l,l.length),l?l.push(f,p):l=[f,p]}if(l)o=c,c=this._edgecode(l[0],l[1]),o&&c&&this._edge(t,o,c,l,l.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return l}_clipSegment(t,e,n,r,a,i){for(;;){if(0===a&&0===i)return[t,e,n,r];if(a&i)return null;let o,c,l=a||i;8&l?(o=t+(n-t)*(this.ymax-e)/(r-e),c=this.ymax):4&l?(o=t+(n-t)*(this.ymin-e)/(r-e),c=this.ymin):2&l?(c=e+(r-e)*(this.xmax-t)/(n-t),o=this.xmax):(c=e+(r-e)*(this.xmin-t)/(n-t),o=this.xmin),a?(t=o,e=c,a=this._regioncode(t,e)):(n=o,r=c,i=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,a,i){let o,c=Array.from(e);if((o=this._project(c[0],c[1],n,r))&&c.unshift(o[0],o[1]),(o=this._project(c[c.length-2],c[c.length-1],a,i))&&c.push(o[0],o[1]),c=this._clipFinite(t,c))for(let e,n=0,r=c.length,a=this._edgecode(c[r-2],c[r-1]);n<r;n+=2)e=a,a=this._edgecode(c[n],c[n+1]),e&&a&&(n=this._edge(t,e,a,c,n),r=c.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(c=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return c}_edge(t,e,n,r,a){for(;e!==n;){let n,i;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,i=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,i=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,i=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,i=this.ymin}r[a]===n&&r[a+1]===i||!this.contains(t,n,i)||(r.splice(a,0,n,i),a+=2)}if(r.length>4)for(let t=0;t<r.length;t+=2){const e=(t+2)%r.length,n=(t+4)%r.length;(r[t]===r[e]&&r[e]===r[n]||r[t+1]===r[e+1]&&r[e+1]===r[n+1])&&(r.splice(e,2),t-=2)}return a}_project(t,e,n,r){let a,i,o,c=1/0;if(r<0){if(e<=this.ymin)return null;(a=(this.ymin-e)/r)<c&&(o=this.ymin,i=t+(c=a)*n)}else if(r>0){if(e>=this.ymax)return null;(a=(this.ymax-e)/r)<c&&(o=this.ymax,i=t+(c=a)*n)}if(n>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/n)<c&&(i=this.xmax,o=e+(c=a)*r)}else if(n<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/n)<c&&(i=this.xmin,o=e+(c=a)*r)}return[i,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const nt=2*Math.PI,rt=Math.pow;function at(t){return t[0]}function it(t){return t[1]}function ot(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class ct{static from(t,e=at,n=it,r){return new ct("length"in t?function(t,e,n,r){const a=t.length,i=new Float64Array(2*a);for(let o=0;o<a;++o){const a=t[o];i[2*o]=e.call(r,a,o,t),i[2*o+1]=n.call(r,a,o,t)}return i}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let a=0;for(const i of t)yield e.call(r,i,a,t),yield n.call(r,i,a,t),++a}(t,e,n,r)))}constructor(t){this._delaunator=new Y(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let t=0;t<e.length;t+=3){const r=2*e[t],a=2*e[t+1],i=2*e[t+2];if((n[i]-n[r])*(n[a+1]-n[r+1])-(n[a]-n[r])*(n[i+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],a=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let t=0,n=e.length/2;t<n;++t){const n=ot(e[2*t],e[2*t+1],a);e[2*t]=n[0],e[2*t+1]=n[1]}this._delaunator=new Y(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,i=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=a[t%3==2?t-2:t+1];-1!==n[t]&&-1!==i[e]||(i[e]=t)}for(let t=0,e=r.length;t<e;++t)o[r[t]]=t;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],i[r[0]]=1,2===r.length&&(i[r[1]]=0))}voronoi(t){return new et(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:a,triangles:i,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const c=e[t];if(-1===c)return;let l=c,s=-1;do{if(yield s=i[l],l=l%3==2?l-2:l+1,i[l]!==t)return;if(l=a[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==s&&(yield e))}}while(l!==c)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let a;for(;(a=this._step(n,t,e))>=0&&a!==n&&a!==r;)n=a;return a}_step(t,e,n){const{inedges:r,hull:a,_hullIndex:i,halfedges:o,triangles:c,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let s=t,u=rt(e-l[2*t],2)+rt(n-l[2*t+1],2);const d=r[t];let h=d;do{let r=c[h];const d=rt(e-l[2*r],2)+rt(n-l[2*r+1],2);if(d<u&&(u=d,s=r),h=h%3==2?h-2:h+1,c[h]!==t)break;if(h=o[h],-1===h){if(h=a[(i[t]+1)%a.length],h!==r&&rt(e-l[2*h],2)+rt(n-l[2*h+1],2)<u)return h;break}}while(h!==d);return s}render(t){const e=null==t?t=new J:void 0,{points:n,halfedges:r,triangles:a}=this;for(let e=0,i=r.length;e<i;++e){const i=r[e];if(i<e)continue;const o=2*a[e],c=2*a[i];t.moveTo(n[o],n[o+1]),t.lineTo(n[c],n[c+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e=2){const n=null==t?t=new J:void 0,{points:r}=this;for(let n=0,a=r.length;n<a;n+=2){const a=r[n],i=r[n+1];t.moveTo(a+e,i),t.arc(a,i,e,0,nt)}return n&&n.value()}renderHull(t){const e=null==t?t=new J:void 0,{hull:n,points:r}=this,a=2*n[0],i=n.length;t.moveTo(r[a],r[a+1]);for(let e=1;e<i;++e){const a=2*n[e];t.lineTo(r[a],r[a+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new tt;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new J:void 0,{points:r,triangles:a}=this,i=2*a[t*=3],o=2*a[t+1],c=2*a[t+2];return e.moveTo(r[i],r[i+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[c],r[c+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new tt;return this.renderTriangle(t,e),e.value()}}var lt=n(176),st=n.n(lt),ut=n(20),dt=n.n(ut),ht=n(15),ft=n.n(ht),pt=n(34),mt=n(3760),vt=n.n(mt),yt=n(3761),gt=n.n(yt),bt=n(39),xt=n.n(bt),kt=(n(61),n(23)),wt=n(583),Ct=n.n(wt),At=n(329),Ot=n.n(At),Et=n(3762),Pt=n.n(Et),St=n(3765),Mt=n.n(St),jt=n(674),Rt=n.n(jt),Lt=n(168),Bt=n.n(Lt),Dt=n(46),Nt=n.n(Dt),_t=n(3771),It=n.n(_t),Tt=n(143),Ft=n.n(Tt),zt=n(1856),qt=n.n(zt),Yt=n(651),Ht=n.n(Yt),Gt=n(3739),Xt=n.n(Gt),Wt=n(93),Vt=n.n(Wt);function Zt(t,e,n,r=(t=>t)){return t*r(.5-e*(.5-n))}function Ut(t,e){return[t[0]+e[0],t[1]+e[1]]}function Kt(t,e){return[t[0]-e[0],t[1]-e[1]]}function Qt(t,e){return[t[0]*e,t[1]*e]}function $t(t){return[t[1],-t[0]]}function Jt(t,e){return t[0]*e[0]+t[1]*e[1]}function te(t,e){return t[0]===e[0]&&t[1]===e[1]}function ee(t,e){return function(t){return t[0]*t[0]+t[1]*t[1]}(Kt(t,e))}function ne(t){return function(t,e){return[t[0]/e,t[1]/e]}(t,function(t){return Math.hypot(t[0],t[1])}(t))}function re(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}function ae(t,e,n){let r=Math.sin(n),a=Math.cos(n),i=t[0]-e[0],o=t[1]-e[1],c=i*r+o*a;return[i*a-o*r+e[0],c+e[1]]}function ie(t,e,n){return Ut(t,Qt(Kt(e,t),n))}function oe(t,e,n){return Ut(t,Qt(e,n))}var{min:ce,PI:le}=Math,se=.275,ue=le+1e-4;function de(t,e={}){return function(t,e={}){let{size:n=16,smoothing:r=.5,thinning:a=.5,simulatePressure:i=!0,easing:o=(t=>t),start:c={},end:l={},last:s=!1}=e,{cap:u=!0,easing:d=(t=>t*(2-t))}=c,{cap:h=!0,easing:f=(t=>--t*t*t+1)}=l;if(0===t.length||n<=0)return[];let p,m=t[t.length-1].runningLength,v=!1===c.taper?0:!0===c.taper?Math.max(n,m):c.taper,y=!1===l.taper?0:!0===l.taper?Math.max(n,m):l.taper,g=Math.pow(n*r,2),b=[],x=[],k=t.slice(0,10).reduce(((t,e)=>{let r=e.pressure;if(i){let a=ce(1,e.distance/n),i=ce(1,1-a);r=ce(1,t+a*se*(i-t))}return(t+r)/2}),t[0].pressure),w=Zt(n,a,t[t.length-1].pressure,o),C=t[0].vector,A=t[0].point,O=A,E=A,P=O,S=!1;for(let e=0;e<t.length;e++){let{pressure:r}=t[e],{point:c,vector:l,distance:s,runningLength:u}=t[e];if(e<t.length-1&&m-u<3)continue;if(a){if(i){let t=ce(1,s/n),e=ce(1,1-t);r=ce(1,k+t*se*(e-k))}w=Zt(n,a,r,o)}else w=n/2;void 0===p&&(p=w);let h=u<v?d(u/v):1,M=m-u<y?f((m-u)/y):1;w=Math.max(.01,w*Math.min(h,M));let j=(e<t.length-1?t[e+1]:t[e]).vector,R=e<t.length-1?Jt(l,j):1,L=null!==R&&R<0;if(Jt(l,C)<0&&!S||L){let t=Qt($t(C),w);for(let e=1/13,n=0;n<=1;n+=e)E=ae(Kt(c,t),c,ue*n),b.push(E),P=ae(Ut(c,t),c,ue*-n),x.push(P);A=E,O=P,L&&(S=!0);continue}if(S=!1,e===t.length-1){let t=Qt($t(l),w);b.push(Kt(c,t)),x.push(Ut(c,t));continue}let B=Qt($t(ie(j,l,R)),w);E=Kt(c,B),(e<=1||ee(A,E)>g)&&(b.push(E),A=E),P=Ut(c,B),(e<=1||ee(O,P)>g)&&(x.push(P),O=P),k=r,C=l}let M=t[0].point.slice(0,2),j=t.length>1?t[t.length-1].point.slice(0,2):Ut(t[0].point,[1,1]),R=[],L=[];if(1===t.length){if(!v&&!y||s){let t=oe(M,ne($t(Kt(M,j))),-(p||w)),e=[];for(let n=1/13,r=n;r<=1;r+=n)e.push(ae(t,M,2*ue*r));return e}}else{if(!(v||y&&1===t.length))if(u)for(let t=1/13,e=t;e<=1;e+=t){let t=ae(x[0],M,ue*e);R.push(t)}else{let t=Kt(b[0],x[0]),e=Qt(t,.5),n=Qt(t,.51);R.push(Kt(M,e),Kt(M,n),Ut(M,n),Ut(M,e))}let e=$t(function(t){return[-t[0],-t[1]]}(t[t.length-1].vector));if(y||v&&1===t.length)L.push(j);else if(h){let t=oe(j,e,w);for(let e=1/29,n=e;n<1;n+=e)L.push(ae(t,j,3*ue*n))}else L.push(Ut(j,Qt(e,w)),Ut(j,Qt(e,.99*w)),Kt(j,Qt(e,.99*w)),Kt(j,Qt(e,w)))}return b.concat(L,x.reverse(),R)}(function(t,e={}){var n;let{streamline:r=.5,size:a=16,last:i=!1}=e;if(0===t.length)return[];let o=.15+.85*(1-r),c=Array.isArray(t[0])?t:t.map((({x:t,y:e,pressure:n=.5})=>[t,e,n]));if(2===c.length){let t=c[1];c=c.slice(0,-1);for(let e=1;e<5;e++)c.push(ie(c[0],t,e/4))}1===c.length&&(c=[...c,[...Ut(c[0],[1,1]),...c[0].slice(2)]]);let l=[{point:[c[0][0],c[0][1]],pressure:c[0][2]>=0?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],s=!1,u=0,d=l[0],h=c.length-1;for(let t=1;t<c.length;t++){let e=i&&t===h?c[t].slice(0,2):ie(d.point,c[t],o);if(te(d.point,e))continue;let n=re(e,d.point);if(u+=n,t<h&&!s){if(u<a)continue;s=!0}d={point:e,pressure:c[t][2]>=0?c[t][2]:.5,vector:ne(Kt(d.point,e)),distance:n,runningLength:u},l.push(d)}return l[0].vector=(null==(n=l[1])?void 0:n.vector)||[0,0],l}(t,e),e)}function he(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var a,i,o,c,l,s,u,d,h,f=t._root,p={data:r},m=t._x0,v=t._y0,y=t._x1,g=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((s=e>=(i=(m+y)/2))?m=i:y=i,(u=n>=(o=(v+g)/2))?v=o:g=o,a=f,!(f=f[d=u<<1|s]))return a[d]=p,t;if(c=+t._x.call(null,f.data),l=+t._y.call(null,f.data),e===c&&n===l)return p.next=f,a?a[d]=p:t._root=p,t;do{a=a?a[d]=new Array(4):t._root=new Array(4),(s=e>=(i=(m+y)/2))?m=i:y=i,(u=n>=(o=(v+g)/2))?v=o:g=o}while((d=u<<1|s)==(h=(l>=o)<<1|c>=i));return a[h]=f,a[d]=p,t}var fe=function(t,e,n,r,a){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=a};function pe(t){return t[0]}function me(t){return t[1]}function ve(t,e,n){var r=new ye(null==e?pe:e,null==n?me:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function ye(t,e,n,r,a,i){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function ge(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var be=ve.prototype=ye.prototype;be.copy=function(){var t,e,n=new ye(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=ge(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var a=0;a<4;++a)(e=r.source[a])&&(e.length?t.push({source:e,target:r.target[a]=new Array(4)}):r.target[a]=ge(e));return n},be.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return he(this.cover(e,n),e,n,t)},be.addAll=function(t){var e,n,r,a,i=t.length,o=new Array(i),c=new Array(i),l=1/0,s=1/0,u=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=r,c[n]=a,r<l&&(l=r),r>u&&(u=r),a<s&&(s=a),a>d&&(d=a));if(l>u||s>d)return this;for(this.cover(l,s).cover(u,d),n=0;n<i;++n)he(this,o[n],c[n],t[n]);return this},be.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,i=(r=Math.floor(e))+1;else{for(var o,c,l=a-n,s=this._root;n>t||t>=a||r>e||e>=i;)switch(c=(e<r)<<1|t<n,(o=new Array(4))[c]=s,s=o,l*=2,c){case 0:a=n+l,i=r+l;break;case 1:n=a-l,i=r+l;break;case 2:a=n+l,r=i-l;break;case 3:n=a-l,r=i-l}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},be.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},be.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},be.find=function(t,e,n){var r,a,i,o,c,l,s,u=this._x0,d=this._y0,h=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new fe(m,u,d,h,f)),null==n?n=1/0:(u=t-n,d=e-n,h=t+n,f=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(a=l.x0)>h||(i=l.y0)>f||(o=l.x1)<u||(c=l.y1)<d))if(m.length){var v=(a+o)/2,y=(i+c)/2;p.push(new fe(m[3],v,y,o,c),new fe(m[2],a,y,v,c),new fe(m[1],v,i,o,y),new fe(m[0],a,i,v,y)),(s=(e>=y)<<1|t>=v)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-s],p[p.length-1-s]=l)}else{var g=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),x=g*g+b*b;if(x<n){var k=Math.sqrt(n=x);u=t-k,d=e-k,h=t+k,f=e+k,r=m.data}}return r},be.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,a,i,o,c,l,s,u,d,h,f=this._root,p=this._x0,m=this._y0,v=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((s=i>=(c=(p+v)/2))?p=c:v=c,(u=o>=(l=(m+y)/2))?m=l:y=l,e=f,!(f=f[d=u<<1|s]))return this;if(!f.length)break;(e[d+1&3]||e[d+2&3]||e[d+3&3])&&(n=e,h=d)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(a=f.next)&&delete f.next,r?(a?r.next=a:delete r.next,this):e?(a?e[d]=a:delete e[d],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[h]=f:this._root=f),this):(this._root=a,this)},be.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},be.root=function(){return this._root},be.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},be.visit=function(t){var e,n,r,a,i,o,c=[],l=this._root;for(l&&c.push(new fe(l,this._x0,this._y0,this._x1,this._y1));e=c.pop();)if(!t(l=e.node,r=e.x0,a=e.y0,i=e.x1,o=e.y1)&&l.length){var s=(r+i)/2,u=(a+o)/2;(n=l[3])&&c.push(new fe(n,s,u,i,o)),(n=l[2])&&c.push(new fe(n,r,u,s,o)),(n=l[1])&&c.push(new fe(n,s,a,i,u)),(n=l[0])&&c.push(new fe(n,r,a,s,u))}return this},be.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new fe(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var i,o=e.x0,c=e.y0,l=e.x1,s=e.y1,u=(o+l)/2,d=(c+s)/2;(i=a[0])&&n.push(new fe(i,o,c,u,d)),(i=a[1])&&n.push(new fe(i,u,c,l,d)),(i=a[2])&&n.push(new fe(i,o,d,u,s)),(i=a[3])&&n.push(new fe(i,u,d,l,s))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},be.x=function(t){return arguments.length?(this._x=t,this):this._x},be.y=function(t){return arguments.length?(this._y=t,this):this._y};var xe=n(67),ke=n.n(xe),we=n(57),Ce=n.n(we),Ae=n(0),Oe=n.n(Ae),Ee=n(8),Pe=n.n(Ee),Se=n(13),Me=n.n(Se),je=(n(113),n(35)),Re=(n(64),n(21)),Le=n(80),Be=n.n(Le),De=(n(640),n(327)),Ne=(n(197),n(36)),_e=(n(94),n(27)),Ie=(n(645),n(214)),Te=(n(3377),n(3647)),Fe=(n(267),n(127)),ze=(n(228),n(66)),qe=(n(1825),n(349)),Ye=(n(445),n(166)),He=(n(1982),n(669)),Ge=(n(95),n(49)),Xe=(n(529),n(306));function We(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-viewport-container *::selection {\n  background-color: rgba(52, 155, 249, 0.15) !important;\n  color: inherit !important;\n}\n.lake-user-select-none {\n  user-select: none;\n}\n.lake-diagram-mindmap-root::selection {\n  background-color: var(--yq-blue-1) !important;\n}\n.selection-transparent::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n.selection-transparent *::selection {\n  background-color: transparent !important;\n  color: inherit !important;\n}\n");var Ve=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.children};if(!1!==n(e,arguments.length>3?arguments[3]:void 0,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)){var a=r(e);if(a)for(var i=0;i<a.length;i++)t(a[i],n,r,e,i)}},Ze=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.children},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=r(e);if(i)for(var o=0;o<i.length;o++)!1!==n(i[o],e,a)&&t(i[o],n,r,o)};function Ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ke(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Qe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qe(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function Qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $e(t,e){var n,r=-1/0;if(void 0===e){var a,i=Ke(t);try{for(i.s();!(a=i.n()).done;)null!=(n=a.value)&&r<n&&(r=n)}catch(t){i.e(t)}finally{i.f()}}else{var o,c=-1,l=Ke(t);try{for(l.s();!(o=l.n()).done;)null!=(n=e(n=o.value,++c,t))&&r<n&&(r=n)}catch(t){l.e(t)}finally{l.f()}}return r}function Je(t,e,n){return t<e?e:t>n?n:t}function tn(t,e){for(var n,r=-1/0,a=0;a<t.length;a++){var i=t[a],o=e?i[e]:i;o>r&&(r=o,n=i)}return n}function en(t,e){var n=e(t);return t.children&&(n.children=[],t.children.forEach((function(t){n.children&&n.children.push(en(t,e))}))),n}function nn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return t<e?e:t>n?n:t}function rn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return t>=e[0]-n&&t<=e[1]+n}function an(t,e){return Object.values(t.reduce((function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t}),{}))}function on(t){return t.filter((function(t,e,n){return n.indexOf(t,0)===e}))}function cn(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}function ln(t,e,n){if(n>=t.length)for(var r=n-t.length+1;r--;)t.push(void 0);return t.splice(n,0,t.splice(e,1)[0]),t}function sn(t){for(var e,n,r=arguments.length<=1?0:arguments.length-1;r>=1&&t.length;){var a;for(e=(a=1+--r)<1||arguments.length<=a?void 0:arguments[a];-1!==(n=t.indexOf(e));)t.splice(n,1)}return e}function un(t,e){e.sort();for(var n=e.length-1;n>=0;n--)t.splice(e[n],1)}function dn(t,e){t.indexOf(e)<0&&t.push(e)}function hn(t,e){t.children?t.children.push(e):t.children=[e]}function fn(t,e,n,r){for(var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(t){return void 0===t};t&&t!==n&&i(a);)a=e(t),t=r(t);return a}function pn(t,e){Object.keys(e).forEach((function(n){var r,a=e[n];if("font-size"===n&&null!==(r=e["font-family"])&&void 0!==r&&r.includes("shouxie")){var i=parseInt(a);i<92&&(a=i+2+"px")}t.style[n]=a}))}function mn(t){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(e){var n=e.query,r=e.css;"self"!==n?t.querySelectorAll(n).forEach((function(t){pn(t,r)})):pn(t,r)}))}function vn(t,e){var n={};return Object.keys(e).forEach((function(r){var a=e[r];!0===a?n[r]=s()(t[r]):d()(e[r])&&d()(t[r])&&a&&(n[r]=vn(t[r],a))})),n}function yn(t,e,n){var r={};return t&&n?e?(n.forEach((function(n){t[n]!==e[n]&&(r[n]=t[n])})),r):function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ue(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t):r}function gn(t,e){return f()(t,e,(function(t,e){return void 0!==t||d()(e)?t:null}))}function bn(t,e){var n="object"===i()(t)?t:c()({},t,e),r={},a=function(t){t.split(".").reduce((function(e,r,a,i){return e[r]=a+1===i.length?n[t]:{}}),r)};for(var o in n)a(o);return r}var xn=Object.freeze({__proto__:null,max:$e,min:function(t,e){var n,r=1/0;if(void 0===e){var a,i=Ke(t);try{for(i.s();!(a=i.n()).done;)null!=(n=a.value)&&r>n&&(r=n)}catch(t){i.e(t)}finally{i.f()}}else{var o,c=-1,l=Ke(t);try{for(l.s();!(o=l.n()).done;)null!=(n=e(n=o.value,++c,t))&&r>n&&(r=n)}catch(t){l.e(t)}finally{l.f()}}return r},limitValue:Je,findMaxObjBy:tn,buildTree:en,getValue:nn,between:rn,groupBy:an,arrayUnique:on,arrayEqual:cn,arrayMove:ln,removeArray:sn,removeMultiple:un,push:dn,append:hn,closest:fn,setStyleSheets:mn,pick:vn,diff:yn,mergeUndefinedToNull:gn,makeChangeModel:bn});function kn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kn(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Cn=function(t,e){var n=["x","y"].map((function(n){return t[n]+2*(e[n]-t[n])})),r=b()(n,2);return{x:r[0],y:r[1]}},An=function(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}},On=function(t,e){var n=no(e),r=Math.sin(n),a=Math.cos(n),i=t.x,o=t.y;return{x:i*a-o*r,y:i*r+o*a}},En=function(t,e,n){var r={x:t.x-e.x,y:t.y-e.y},a=On(r,n);return{x:a.x+e.x,y:a.y+e.y}},Pn=function(t,e){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)},Sn=function(t){var e=t.x,n=t.y;return{x:e+t.w/2,y:n+t.h/2}},Mn=function(t){var e=t.x,n=t.y;return 180*Math.atan2(n,e)/Math.PI},jn=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},a={x:n.x-t.x,y:n.y-t.y},i=Mn(r);return Mn(a)-i},Rn=function(t,e){var n=e.x,r=e.y,a=b()(t,2),i=a[0],o=a[1];if(ro(i.x,o.x))return{x:i.x,y:r};if(ro(i.y,o.y))return{x:n,y:i.y};var c=co(i.x,i.y,o.x,o.y),l=-1/c,s=(c*i.x+r-i.y-l*n)/(c-l);return{x:s,y:i.y-c*(i.x-s)}},Ln=function(){function t(e){m()(this,t),c()(this,"rect",void 0),c()(this,"_tl",void 0),c()(this,"_tr",void 0),c()(this,"_br",void 0),c()(this,"_bl",void 0),c()(this,"_tc",void 0),c()(this,"_bc",void 0),c()(this,"_rc",void 0),c()(this,"_lc",void 0),c()(this,"_center",void 0),this.rect=e,this._tl=null,this._tr=null,this._br=null,this._bl=null,this._tc=null,this._bc=null,this._rc=null,this._lc=null,this._center=null}return y()(t,[{key:"center",get:function(){return this._center||(this._center=Sn(this.rect)),this._center}},{key:"tl",get:function(){if(!this._tl){var t=this.rect,e=t.x,n=t.y,r=t.r;this._tl=En({x:e,y:n},this.center,r)}return this._tl}},{key:"tr",get:function(){if(!this._tr){var t=this.rect,e=t.x,n=t.y,r=t.w,a=t.r;this._tr=En({x:e+r,y:n},this.center,a)}return this._tr}},{key:"br",get:function(){return this._br||(this._br=Cn(this.tl,this.center)),this._br}},{key:"bl",get:function(){return this._bl||(this._bl=Cn(this.tr,this.center)),this._bl}},{key:"tc",get:function(){return this._tc||(this._tc=An(this.tl,this.tr)),this._tc}},{key:"bc",get:function(){return this._bc||(this._bc=An(this.br,this.bl)),this._bc}},{key:"rc",get:function(){return this._rc||(this._rc=An(this.tr,this.br)),this._rc}},{key:"lc",get:function(){return this._lc||(this._lc=An(this.tl,this.bl)),this._lc}}]),t}();function Bn(t){var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return 0!==e?[1/e*t[0],1/e*t[1]]:e}function Dn(t,e){return(e-t)/3}function Nn(t,e){var n=0,r=0;return function(t,e){return Math.abs(t.x-e.x)>Math.abs(t.y-e.y)}(t,e)?n=Dn(t.x,e.x):r=Dn(t.y,e.y),{x:t.x+n,y:t.y+r}}function _n(t,e){var n=Nn(t,e),r=Nn(e,t);return["C",n.x,n.y,r.x,r.y,e.x,e.y]}function In(t,e){var n={x:-1,y:-1},r=e.connection;return r&&("string"===i()(r)?n=t.anchors.filter((function(t){return t.name===r}))[0]:Array.isArray(r)&&(n={x:r[0],y:r[1]})),{width:t.width,height:t.height,theta:t.rotate,port:n}}function Tn(t,e,n,r){var a,i,o=t.width,c=t.height,l=t.port,s=t.theta,u=l.x,d=l.y;if(0===u&&0===d||1===u&&1===d||0===u&&1===d||1===u&&0===d)return a=[n.x-e.x,n.y-e.y],i=Math.sqrt(Math.pow(o,2)+Math.pow(c,2))/3,{direction:Bn(a),offset:Math.max(i,36)};var h=Bn([n.x-e.x,n.y-e.y]);return 0===u&&d>0&&d<1?(a=0===s?[-1,0]:h,i=Math.abs(Math.abs(n.x)-Math.abs(r.x))):1===u&&d>0&&d<1?(a=0===s?[1,0]:h,i=Math.abs(Math.abs(n.x)-Math.abs(r.x))):0===d&&u>0&&u<1?(a=0===s?[0,-1]:h,i=Math.abs(Math.abs(n.y)-Math.abs(r.y))):1===d&&u>0&&u<1?(a=0===s?[0,1]:h,i=Math.abs(Math.abs(n.y)-Math.abs(r.y))):(a=h,i=Math.abs(n.y-r.y)),i/=2,{direction:a,offset:Math.max(i,32)}}function Fn(t){var e=t.source,n=t.target,r=t.diagram,a=[],i=r.find(e.id),o=r.find(n.id),c=t.getPoints(),l=c[0],s=c[1];if(!i&&!o){var u=_n(c[0],c[1]);return a.push(u),a}if(i&&o){var d=In(i,e),h=In(o,n),f=i.percentage2Canvas({x:.5,y:.5}),p=o.percentage2Canvas({x:.5,y:.5}),m=Tn(d,f,l,s),v=Tn(h,p,s,l),y=[l.x+m.direction[0]*m.offset,l.y+m.direction[1]*m.offset],g=[s.x+v.direction[0]*v.offset,s.y+v.direction[1]*v.offset];return[["C",y[0],y[1],g[0],g[1],s.x,s.y]]}if(!i&&o){var b=Tn(In(o,n),o.percentage2Canvas({x:.5,y:.5}),s,l),x=_n(c[0],c[1]);return x[3]=s.x+b.direction[0]*b.offset,x[4]=s.y+b.direction[1]*b.offset,a.push(x),a}var k=Tn(In(i,e),i.percentage2Canvas({x:.5,y:.5}),l,s),w=_n(c[0],c[1]);return w[1]=l.x+k.direction[0]*k.offset,w[2]=l.y+k.direction[1]*k.offset,a.push(w),a}function zn(t){for(var e=[],n=[0,.25,.5,.75],r=0;r<t.length-1;r++){var a=t[r-1],i=t[r],o=t[r+1],c=t[r+2];void 0===a&&(a={x:2*i.x-o.x,y:2*i.y-o.y}),void 0===c&&(c={x:2*o.x-i.x,y:2*o.y-i.y}),n[1]=Math.pow(lo(a.x,a.y,i.x,i.y),1)+n[0],n[2]=Math.pow(lo(i.x,i.y,o.x,o.y),1)+n[1],n[3]=Math.pow(lo(o.x,o.y,c.x,c.y),1)+n[2];var l=[(n[2]-n[1])/(n[2]-n[0]),(n[1]-n[0])/(n[2]-n[0]),(n[3]-n[2])/(n[3]-n[1]),(n[2]-n[1])/(n[3]-n[1])],s=[(n[2]-n[1])*(l[0]*(i.x-a.x)/(n[1]-n[0])+l[1]*(o.x-i.x)/(n[2]-n[1])),(n[2]-n[1])*(l[0]*(i.y-a.y)/(n[1]-n[0])+l[1]*(o.y-i.y)/(n[2]-n[1]))],u=[(n[2]-n[1])*(l[2]*(o.x-i.x)/(n[2]-n[1])+l[3]*(c.x-o.x)/(n[3]-n[2])),(n[2]-n[1])*(l[2]*(o.y-i.y)/(n[2]-n[1])+l[3]*(c.y-o.y)/(n[3]-n[2]))];e.push(["C",i.x+s[0]/3,i.y+s[1]/3,o.x-u[0]/3,o.y-u[1]/3,o.x,o.y])}return e}function qn(t){if(Array.isArray(t)){var e=k()(t);return[e[0],e.slice(1).join()].join("")}var n=t.name,r=t.x,a=t.y;switch(n.toLowerCase()){case"m":case"l":return n+[r,a].join();case"h":case"v":return n+r;case"z":return n;case"a":var i=t.xAxisRotation,o=t.largeArcFlag,c=t.sweepFlag;return n+[t.rx,t.ry,i,o,c,r,a].join();case"c":return n+[t.x1,t.y1,t.x2,t.y2,t.x,t.y].join();case"q":return n+[t.x1,t.y1,t.x,t.y].join();default:throw new Error("unknown path command: ".concat(n))}}function Yn(t){return t.map(qn).join("")}function Hn(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return Yn([["M",t-n,e],["a",n,r,0,1,0,2*n,0],["a",n,r,0,1,0,-2*n,0],["Z"]])}function Gn(t,e,n){return Hn(t,e,n)}function Xn(t,e,n){var r=[],a=e[0],i=e[e.length-1],o=t[0],c=t[t.length-1];if(!o&&!o)return[];"V"===o[o.length-1]?r.push(["L",a.x,o[1]]):r.push(["L",o[0],a.y]);for(var l=1;l<t.length;l++){var s=t[l-1],u=t[l];"V"===u[u.length-1]?r.push(["L",s[0],u[1]]):r.push(["L",u[0],s[1]])}"V"===c[c.length-1]?r.push(["L",i.x,c[1]]):r.push(["L",c[0],i.y]);var d=r;n&&(d=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n],a=t[n+1];r&&a&&ao(r.slice(1),a.slice(1),2)?n+=1:e.push(r)}return e}(r)),d.unshift(["M",a.x,a.y]);var h=d[d.length-1];if(ro(h[1],e[e.length-1].x,.65)&&ro(h[h.length-1],e[e.length-1].y,.65)?d[d.length-1]=["L",e[e.length-1].x,e[e.length-1].y]:ro(h[1],e[e.length-1].x)&&ro(h[h.length-1],e[e.length-1].y)||d.push(["L",e[e.length-1].x,e[e.length-1].y]),d.length>1){var f=d[0],p=d[1];ro(f[1],p[1],.65)&&ro(f[f.length-1],p[p.length-1],.65)&&d.splice(1,1)}return d}function Wn(t,e,n,r,a,i,o,c){return Yn([["M",t,e],["L",n,e],["L",n,r],["L",t,r],["Z"],["M",a,i],["L",a,c],["L",o,c],["L",o,i],["Z"]])}function Vn(t,e,n,r){return Yn([["M",t,e],["L",n,r]])}var Zn="\t\n\v\f\r   ᠎             　\u2028\u2029",Un=new RegExp("([a-z])["+Zn+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Zn+"]*,?["+Zn+"]*)+)","ig"),Kn=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Zn+"]*,?["+Zn+"]*","ig");function Qn(t){if(!t)return null;if(Array.isArray(t))return t;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return(t=String(t)).replace(Un,(function(t,r,a){var i=[],o=r.toLowerCase();if(a.replace(Kn,(function(t,e){e&&i.push(+e)})),"m"===o&&i.length>2&&(n.push([r].concat(i.splice(0,2))),o="l",r="m"===r?"l":"L"),"o"===o&&1===i.length&&n.push([r,i[0]]),"r"===o)n.push([r].concat(i));else for(;i.length>=e[o]&&(n.push([r].concat(i.splice(0,e[o]))),e[o]););return""})),n}function $n(t){return Yn(t.map((function(t,e){return[0===e?"M":"L",t.x,t.y]})))}function Jn(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:a;return Yn(a?[["M",+t+ +a,e],["l",n-2*a,0],["a",a,i,0,0,1,a,i],["l",0,r-2*i],["a",a,i,0,0,1,-a,i],["l",2*a-n,0],["a",a,i,0,0,1,-a,-i],["l",0,2*i-r],["a",a,i,0,0,1,a,-i],["z"]]:[["M",t,e],["l",n,0],["l",0,r],["l",-n,0],["z"]])}function tr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function er(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tr(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function nr(t){for(var e,n=/([mlhvcsqtaz])/gi,r=t.replace(n," $1 ").trim().split(/[ ,]+/),a=[],i=0;i<r.length;i++){var o=r[i];n.test(o)?(e&&a.push(e),e=[o]):e.push(parseFloat(o))}return a}function rr(t,e,n){return"string"==typeof t&&(t=nr(t)),t.map((function(t){return function(t,e,n){switch(Array.isArray(t)&&(t=function(t){var e=k()(t),n=e[0],r=e.slice(1);switch(n.toLowerCase()){case"m":case"l":var a=b()(r,2);return{name:n,x:a[0],y:a[1]};case"a":var i=b()(r,7);return{name:n,rx:i[0],ry:i[1],xAxisRotation:i[2],largeArcFlag:i[3],sweepFlag:i[4],x:i[5],y:i[6]};case"c":var o=b()(r,6);return{name:n,x1:o[0],y1:o[1],x2:o[2],y2:o[3],x:o[4],y:o[5]};case"q":var c=b()(r,4);return{name:n,x1:c[0],y1:c[1],x:c[2],y:c[3]};default:return{name:n}}}(t)),t.name.toLowerCase()){case"m":case"l":var r=t,a=r.x,i=r.y;return er(er({},t),{},{x:a*e,y:i*n});case"a":var o=t,c=o.x,l=o.y,s=o.rx,u=o.ry;return er(er({},t),{},{x:c*e,y:l*n,rx:s*e,ry:u*n});case"c":var d=t,h=d.x1,f=d.y1,p=d.x2,m=d.y2,v=d.x,y=d.y;return er(er({},t),{},{x1:h*e,y1:f*n,x2:p*e,y2:m*n,x:v*e,y:y*n});case"q":var g=t,x=g.x1,w=g.y1,C=g.x,A=g.y;return er(er({},t),{},{x1:x*e,y1:w*n,x:C*e,y:A*n});default:return t}}(t,e,n)}))}var ar=Object.freeze({__proto__:null,parsePathString:Qn,formatPath:Yn,rectPath:Jn,polylinePath:$n,ellipsePath:Hn,circlePath:Gn,catmullRomPath:zn,elbowPath:Xn,bezierPath:Fn,huiPath:Wn,linePath:Vn,inflatePath:nr,scalePath:rr});function ir(){var t=[],e=arguments.length<=0?void 0:arguments[0];Array.isArray(e)?t.push(e):t.push([e]);for(var n=1;n<arguments.length;n++)if(e=n<0||arguments.length<=n?void 0:arguments[n],Array.isArray(e))t.push(e);else{for(var r=[],a=0;a<t[0].length;a++)r.push(e);t.push(r)}return t}var or,cr=Object.freeze({__proto__:null,convertBatch:ir}),lr=function(t){return null==t?void 0:t.isText},sr=function(t){return null==t?void 0:t.isLine},ur=function(t){return null==t?void 0:t.isVertex},dr=function(t){return null==t?void 0:t.isDsl},hr=function(t){return null==t?void 0:t.isDslCell},fr=function(t){return null==t?void 0:t.isGroup},pr=function(t){return null==t?void 0:t.isBoardCell},mr=function(t){return null==t?void 0:t.isMindmap},vr=function(t){return null==t?void 0:t.isGeometry},yr=function(t){return null==t?void 0:t.isSwimlane},gr=function(t){return null==t?void 0:t.isSwimlaneCell},br=function(t){return null==t?void 0:t.isStack},xr=function(t){return null==t?void 0:t.isStackCell},kr=function(t){return null==t?void 0:t.isFreeHand},wr=function(t){return null==t?void 0:t.isPen},Cr=function(t){return null==t?void 0:t.isPoints},Ar=function(t){return{minX:t.x,minY:t.y,maxX:t.x+t.width,maxY:t.y+t.height}},Or=function(t){var e=new Ln(t),n=e.tl,r=e.tr,a=e.bl,i=e.br;return{minX:Math.min(n.x,r.x,a.x,i.x),minY:Math.min(n.y,r.y,a.y,i.y),maxX:Math.max(n.x,r.x,a.x,i.x),maxY:Math.max(n.y,r.y,a.y,i.y)}};function Er(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.getBBox()},n=t.reduce((function(t,n){var r=e(n),a=[r.x,r.y],i=[[a[0],a[1]],[a[0]+r.width,a[1]+r.height]];return t.push.apply(t,i),t}),[]),r=n.reduce((function(t,e){return e[0]>t?e[0]:t}),n[0][0]),a=n.reduce((function(t,e){return e[0]<t?e[0]:t}),n[0][0]),i=n.reduce((function(t,e){return e[1]>t?e[1]:t}),n[0][1]),o=n.reduce((function(t,e){return e[1]<t?e[1]:t}),n[0][1]);return{minX:a,minY:o,maxX:r,maxY:i}}var Pr=(c()(or={"未命名":"unnamed","与编辑一致":"Same as Edition","阅读页配置":"Setting","默认视口":"Default Viewport"," 粘贴":" paste",ER:"ER",UML:"UML","三角形":"Triangle","上下居中":"Align vertically","上传素材中":"Uploading Material","上传素材图片失败":"Failed to upload material image","上移":"Forward","上移一层":"Bring Forward","下移":"Backward","下移一层":"Bring Backward","不透明度":"Opacity"},"与编辑一致","WYSIWYG"),c()(or,"云","cloud"),c()(or,"五角星","star"),c()(or,"五边形","Polygon"),c()(or,"五边箭头","pentagon-arrow"),c()(or,"位置","Position"),c()(or,"使用","Use"),c()(or,"使用说明","Instructions"),c()(or,"保存","Save"),c()(or,"保持宽高比","Constrain proportions"),c()(or,"全局","Global"),c()(or,"全部概化","Total generalization"),c()(or,"关系","Relationship"),c()(or,"内部存储","Internal Storage"),c()(or,"决策","Decision"),c()(or,"准备","Preparation"),c()(or,"分支","Choice"),c()(or,"分支类型","Branch type"),c()(or,"分支粗细","Branch thickness"),c()(or,"分支线条宽度逐渐变细","Tapered line"),c()(or,"分支颜色","Line Color"),c()(or,"删除","Delete"),c()(or,"删除单个节点","Delete a single node"),c()(or,"删除泳道","Delete Lane"),c()(or,"前进","Forward"),c()(or,"剪切","Cut"),c()(or,"剪切失败","Cut failed"),c()(or,"剪切成功","Cut successfully"),c()(or,"副标题","Subtitle"),c()(or,"加粗","Bold"),c()(or,"包","Package"),c()(or,"十字","Cross"),c()(or,"卡片","Card"),c()(or,"历史","Histroy Pseudostate"),c()(or,"原始大小","Original size"),c()(or,"双击画布快速添加","Double click to directly add"),c()(or,"双向箭头","Arrow 3"),c()(or,"发送信号","Send Signal"),c()(or,"取消成组","Ungroup"),c()(or,"另存为图片","Save as picture"),c()(or,"可设置颜色、布局、文字等样式","Can set color, layout, text and other styles"),c()(or,"右对齐","Right"),c()(or,"右箭头","Arrow 2"),c()(or,"合并","Merge"),c()(or,"同步","Fork"),c()(or,"同级","same level"),c()(or,"后退","Backward"),c()(or,"回到中心","Fit Page"),c()(or,"图形","Shape"),c()(or,"图片","Picture"),c()(or,"图片上传中，请稍候","Picture uploading, please wait"),c()(or,"圆形","Circle"),c()(or,"圆角半径","Corner radius"),c()(or,"圆角矩形","Rounded Rectangle"),c()(or,"垂直均分","Distribute vertically"),c()(or,"垂直居中","Align vertically"),c()(or,"基础图形","Basic"),c()(or,"基础格式","Basic Format"),c()(or,"填充","Fill"),c()(or,"填充颜色","Fill"),c()(or,"备注","Note"),c()(or,"复制","Copy"),c()(or,"复制为其它格式","Copy to other formats"),c()(or,"复制失败","Copy failed"),c()(or,"复制成功","Copy successfully"),c()(or,"多个值","multiValue"),c()(or,"多值属性",""),c()(or,"多文档","Multi Document"),c()(or,"多类例","Multiplicity"),c()(or,"大小","Size"),c()(or,"大标题","Title"),c()(or,"子级","Child"),c()(or,"字号","Font size"),c()(or,"字色","Font Color"),c()(or,"存储数据","Stored Data"),c()(or,"实体","Entity"),c()(or,"实际尺寸","Actual size"),c()(or,"宽","Widht"),c()(or,"宽度","Width"),c()(or,"对象","Object"),c()(or,"对齐","Alignment"),c()(or,"对齐方式","Alignment"),c()(or,"导出素材图片失败","Failed to export stock image"),c()(or,"小标题","Title small"),c()(or,"层级","Level"),c()(or,"展开","Expand"),c()(or,"展开工具栏","Expand Toolbar"),c()(or,"展开节点","Expand topic"),c()(or,"属性","Attributes"),c()(or,"左右居中","Align horizontally"),c()(or,"左对齐","Left"),c()(or,"左箭头","Arrow 1"),c()(or,"已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ","The copied content of the current page has been pasted. If you need to paste the content outside the page, please use"),c()(or,"布局","Layout"),c()(or,"平行四边形","Parallelogram"),c()(or,"并行模式","Parallel"),c()(or,"幻灯片布局","Slide layout"),c()(or,"底对齐","Bottom"),c()(or,"底部对齐","Bottom"),c()(or,"延迟","Delay"),c()(or,"开始","Start"),c()(or,"弱关系","Weak Relationship"),c()(or,"弱实体","Weak Entity"),c()(or,"形状","Shape"),c()(or,"彩虹分支","Multi-colored lines"),c()(or,"循环起止符","Loop Limit"),c()(or,"思维导图","Mindmap"),c()(or,"成组","Group"),c()(or,"或者","Or"),c()(or,"所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。","All icon materials come from the iconfont platform and are only for the communication and learning of the majority of users, and may not be used for any commercial purposes without the written authorization of iconfont or its affiliates."),c()(or,"手动循环","Manual loop"),c()(or,"手动设置节点宽度","Fixed size"),c()(or,"手动设置节点尺寸","Custom size"),c()(or,"手动输入","Manual Input"),c()(or,"打开设置","Setting"),c()(or,"批注","Annotation"),c()(or,"折叠","Collapse"),c()(or,"折叠节点","Collapse topic"),c()(or,"拖拽","Drag"),c()(or,"排列","Arrange"),c()(or,"排序","Sort"),c()(or,"接口","Interface"),c()(or,"接收信号","Receive Signal"),c()(or,"控制","Control"),c()(or,"推荐素材","Recommended material"),c()(or,"描边","Stroke"),c()(or,"插入","Insert"),c()(or,"插入 Iconfont","Insert Iconfont"),c()(or,"插入主节点","Insert root topic"),c()(or,"插入同级","Insert sibling"),c()(or,"插入同级节点","Insert topic"),c()(or,"插入图片","Insert image"),c()(or,"插入子级","Insert child"),c()(or,"插入子节点","Insert subtopic"),c()(or,"插入父级","Insert parent"),c()(or,"插入连线","Inset line"),c()(or,"插入链接","Insert link"),c()(or,"搜索结果为空","Search results are empty"),c()(or,"撤销","Undo"),c()(or,"数据","Data"),c()(or,"数据库","Storage"),c()(or,"整理","Collate"),c()(or,"文字样式","Text Style"),c()(or,"文本","Text"),c()(or,"文本颜色","Font color"),c()(or,"文档","Document"),c()(or,"新建节点","New Node"),c()(or,"旋转","Rotate"),c()(or,"旋转角度","Rotate angle"),c()(or,"无颜色","No color"),c()(or,"时间信号","Frequency"),c()(or,"星形","Star"),c()(or,"显示","Display"),c()(or,"暂时无法从 iconfont 获取资源","Temporarily unable to get resources from iconfont"),c()(or,"更多 >","More >"),c()(or,"最近使用","Recently Used"),c()(or,"条带","Paper Tape"),c()(or,"标注","Comment"),c()(or,"标注 2","Annotation 2"),c()(or,"样式","Styles"),c()(or,"格式","Format"),c()(or,"格式面板","Format panel"),c()(or,"框选后，右键添加到素材库","After frame selection, right click and add to material library"),c()(or,"梯形","Trapezoid"),c()(or,"概化","Generalization"),c()(or,"正文","Text"),c()(or,"步骤一：框选需要添加的内容","Step 1: Box to select the content to be added"),c()(or,"步骤二：右键打开面板，选择“添加到素材库”","Step 2: Right-click to open the panel and select 'Add to Material Library'"),c()(or,"水平均分","Distribute horizontally"),c()(or,"水平对齐","Horizontal Alignment"),c()(or,"汇总连接","Summing Junction"),c()(or,"注释","Annotation"),c()(or,"泳道","Swimlane"),c()(or,"泳道垂直","Vertical Swimlane"),c()(or,"泳道水平","horizontal Swimlane"),c()(or,"泳道数","Lane Number"),c()(or,"活动","Activity"),c()(or,"活动类","Activity Class"),c()(or,"派生属性","Derived Attribute"),c()(or,"流程图","Flowchart"),c()(or,"流程图图形","Flowchart Graphics"),c()(or,"流程箭头","process-arrow"),c()(or,"流终止","Termination Pseudostate"),c()(or,"添加到素材库","Add to material library"),c()(or,"添加图形","Insert Geometry"),c()(or,"添加思维导图","Insert Mindmap"),c()(or,"添加文字","Insert Text"),c()(or,"添加自定义素材","Add custom material"),c()(or,"添加连线","Insert Line"),c()(or,"添加链接","Insert Link"),c()(or,"激活","Activation"),c()(or,"点击选中元素","Click on the selected element"),c()(or,"父级","Parent"),c()(or,"版权说明","Copyright statement"),c()(or,"状态","State"),c()(or,"用例","Use Case"),c()(or,"矩形","Rectangle"),c()(or,"硬盘","Hard Disk"),c()(or,"竖直对齐","Vertical Alignment"),c()(or,"端点","End Point"),c()(or,"简单类","Simple Class"),c()(or,"类","Class"),c()(or,"类型","Type"),c()(or,"粗细","Line Width"),c()(or,"粘贴","Paste"),c()(or,"粘贴失败","Paste failed"),c()(or,"素材库","Material Lib"),c()(or,"素材版权说明","Material copyright statement"),c()(or,"约束","Constraint"),c()(or,"线条","Line"),c()(or,"线条/边框","Line/Border"),c()(or,"线条样式","Line style"),c()(or,"线条端点","Line Endpoint"),c()(or,"线条类型","Line Shape"),c()(or,"线条粗细","Line Width"),c()(or,"线条颜色","Line Color"),c()(or,"直线","Straight"),c()(or,"曲线","Curve"),c()(or,"折线","Elbow"),c()(or,"组件","Component"),c()(or,"组合片段","Frame"),c()(or,"终点","End"),c()(or,"绑定","Boundary"),c()(or,"结束","Finish"),c()(or,"结构","Structure"),c()(or,"编辑文本","Edit text"),c()(or,"置底","Back"),c()(or,"置顶","Front"),c()(or,"背景","Background"),c()(or,"背景颜色","Background color"),c()(or,"自动适配","Adaption"),c()(or,"自定义素材","Custom material"),c()(or,"节点","Node"),c()(or,"节点填充","Fill"),c()(or,"节点形状","Topic shape"),c()(or,"节点描边","Stroke"),c()(or,"菱形","Diamond"),c()(or,"角度","Angle"),c()(or,"角色","Actor"),c()(or,"设置","Setting"),c()(or,"设置面板","Properties"),c()(or,"语雀文档","Yuque document"),c()(or,"语雀表格","Yuque table"),c()(or,"请搜索","Please search"),c()(or,"起止符","Terminator"),c()(or,"起点","Start"),c()(or,"转换","Swap"),c()(or,"边框","Border"),c()(or,"边框粗细","Border thickness"),c()(or,"边框颜色","Border color"),c()(or,"过程","Process"),c()(or,"连接器","Connector"),c()(or,"连接线","Line"),c()(or,"连线","Insert Line"),c()(or,"适应画布","Reset View"),c()(or,"重做","Redo"),c()(or,"链接","Link"),c()(or,"隐藏工具栏","Hide Toolbar"),c()(or,"页外连接符","Off-page Connector"),c()(or,"顶对齐","Top"),c()(or,"顶部对齐","Top"),c()(or,"预定义流程","Predefined Process"),c()(or,"颜色","Color"),c()(or,"高","Height"),c()(or,"高度","Height"),c()(or,"概要","Abstract"),c()(or,"添加概要","Insert Abstract"),c()(or,"选择","Select"),c()(or,"画笔","Pencil"),c()(or,"铅笔","Pencil"),c()(or,"马克笔","Mark Pencil"),c()(or,"橡皮","Eraser"),c()(or,"添加标记","Insert Icon"),c()(or,"进度","Progress"),c()(or,"优先级","Priority"),c()(or,"旗帜","Flag"),c()(or,"矢量绘图","Vector Drawing"),c()(or,"确定","confirm"),or),Sr={locale:r.LocaleUtil.getLocale(),translations:{"en-us":Pr}};function Mr(t,e){if(!t)return t;var n=Sr.locale,r=Sr.translations[n]||{};return"zh-cn"!==n&&(t=r[t]||t),t.replace(/\{([^\}]+)\}/g,(function(t,n){return e[n]||n}))}var jr=["#A287E1","#E48484","#69B1E4","#DE81C6","#77C386","#DFB85D","#8169BF"],Rr={html:"".concat(Mr("思维导图")),type:"mindmap"},Lr=["priority","progress","flag"],Br=["优先级","进度","旗帜"],Dr=[7,7,7],Nr=[["https://gw.alipayobjects.com/zos/bmw-prod/bf9b8e4b-b1d4-45b1-bafc-f22c905b7b4e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bbb05404-6149-4cd6-b234-e330d412ceff.svg","https://gw.alipayobjects.com/zos/bmw-prod/1ef71652-d5a3-48b7-9e57-de90c7aa835b.svg","https://gw.alipayobjects.com/zos/bmw-prod/4119993f-c9b6-4c2d-8a65-907840a47202.svg","https://gw.alipayobjects.com/zos/bmw-prod/61ae2c45-7c6d-40fe-a772-873e34aecc6f.svg","https://gw.alipayobjects.com/zos/bmw-prod/f9e31950-3daa-457b-a429-6da0c6f8fee0.svg","https://gw.alipayobjects.com/zos/bmw-prod/cf26510b-6d9a-43dc-9bba-67839b11c05b.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/8b4c2bef-649d-40ac-b43b-f33fd456284d.svg","https://gw.alipayobjects.com/zos/bmw-prod/3a513a92-a334-4469-98ae-3c5825d8864e.svg","https://gw.alipayobjects.com/zos/bmw-prod/bd0e81dc-34e8-4b6f-9221-9d33371f53b9.svg","https://gw.alipayobjects.com/zos/bmw-prod/aad5a7c4-8f72-47c0-805b-6b0d239a51d5.svg","https://gw.alipayobjects.com/zos/bmw-prod/5489b9dd-20bc-464a-a064-2593db39d1df.svg","https://gw.alipayobjects.com/zos/bmw-prod/8d2d4df2-f1f0-48c6-875d-c694d01fcfad.svg","https://gw.alipayobjects.com/zos/bmw-prod/d07956ae-58ad-479a-b59d-310646dd5f37.svg"],["https://gw.alipayobjects.com/zos/bmw-prod/01e45248-e9d6-4ac1-9018-f64b82050155.svg","https://gw.alipayobjects.com/zos/bmw-prod/ddb1da7b-5481-4d40-a9f0-d6aea06c0011.svg","https://gw.alipayobjects.com/zos/bmw-prod/566d145a-bffa-4b19-b9fd-14315c9d2fd3.svg","https://gw.alipayobjects.com/zos/bmw-prod/ba0e8dee-7014-4213-84d0-6aee48c37248.svg","https://gw.alipayobjects.com/zos/bmw-prod/d3e16f31-34bd-4269-9ef7-d04005303024.svg","https://gw.alipayobjects.com/zos/bmw-prod/ca82f31a-a2d9-4751-a8d0-d4f87771b913.svg","https://gw.alipayobjects.com/zos/bmw-prod/1a24ad93-ccd5-4fe5-a42e-f8777b933e47.svg"]],_r=function(t,e){var n=Lr.findIndex((function(e){return e===t}));if(-1===n||e>Dr[n])throw new Error("mindmap icon type ".concat(t," or index ").concat(e," is not valid."));return Nr[n][e]},Ir="https://gw.alipayobjects.com/zos/bmw-prod/3f937c7f-4274-4765-8b4c-c0321ab89d83.svg",Tr="https://gw.alipayobjects.com/zos/bmw-prod/4c2a5221-e479-4805-b4e9-f170c9edfad2.svg",Fr="Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif",zr={"line-height":!0,"font-size":!0,"text-decoration-line":!0,"font-weight":!0,"font-style":!0,"text-align":!0,"text-decoration":!0,color:!0},qr=[{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2"},fontWeight:"normal"},{name:"shouxie",fontURL:{woff2:"https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2"},fontWeight:"bold"}],Yr=[{key:"top",icon:"top",title:"顶部对齐"},{key:"middle",icon:"middle",title:"垂直居中"},{key:"bottom",icon:"bottom",title:"底部对齐"}],Hr=Yr.map((function(t){return t.key})),Gr="rgba(88, 90, 90, 0.7)",Xr={background:"#ffffff",hover:"#e7e9e8",text:"#595959",roughIconHachurefill:"#585A5A",roughIconCrossHatchfill:"#585A5A",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#BEC0BF",roughIconSolidDisablefill:"#EFF0F0"},Wr={background:"#292929",hover:"rgba(255, 255, 255, 0.12)",text:"#d0d0d0",roughIconHachurefill:"#EFF0F0",roughIconCrossHatchfill:"#EFF0F0",roughIconSolidfill:"#BEC0BF",roughIconHachureDisablefill:"#BEC0BF",roughIconCrossHatchDisablefill:"#8A8F8D",roughIconSolidDisablefill:"#585A5A"},Vr=Object.freeze({__proto__:null,BTM_HREF:Ir,BTN_HOVER_HREF:Tr,DEFAULT_FONT_FAMILY:Fr,INLINE_STYLE:zr,EMPTY_TEXT:"&#8203;",LOCKED_STROKE_COLOR:"#979797",DEFAULT_FONT_COLOR:"rgb(38, 38, 38)",MULTI_SELECTED_FRAME_FILL:"rgba(9, 109, 217, .05)",LOCAL_STORAGE_CLIPBOARD_DATA_KEY:"lake_diagram_clipboard_data",LOCAL_STORAGE_CUSTOM_COLORS_KEY:"lake_diagram_custom_colors",LOCAL_STORAGE_GRAPHIC_LATEST_USED:"lake_diagram_graphic_latest_used",GLOBAL_VARIABLE_EXTERNAL_FONT_KEY:"lake_diagram_external_font",EXTERNAL_FONTS:qr,MINIMUM_STACK_CELL_HEIGHT:30,STACK_CELL_VERTICAL_PADDING:12,MAXIMUM_LINE_TEXT_DISTANCE:60,VERTICAL_TEXT_ALIGN_DEFAULT_VALUE:"middle",VERTICAL_TEXT_ALIGN_ALIGN_DATA:Yr,VERTICAL_TEXT_ALIGN_VAILD_VALUES:Hr,REF_LINE_STROKE:"#1672F3",RESIZE_STROKE:Gr,RESIZE_FILL:"#FFFFFF",RESIZE_LINE_STROKE:"#3384F5",RESIZE_BUTTON_RADIUS:4,ANCHOR_STORE:"rgba(255,255,255,0.15)",ANCHOR_FILL:"rgba(51, 132, 245, 0.3)",ANCHOR_HOVER_FILL:"rgba(95, 159, 246, 0.6)",CONTROL_STROKE:"rgba(255,255,255,0.8)",CONTROL_FILL:"#3384F5",ANTIANCHOR_STROKE:"#3384F5",ANTIANCHOR_FILL:"rgba(192,217,252,0.2)",CONNECT_FILL:"rgba(192,217,252,0.2)",SELECTED_STROKE_COLOR:"#3384F5",LINE_DOCK_TIME:1500,DRAG_DISTANCE_THRESHOLD:8,SWIMLANE_SINGLE_LANE_WIDTH:150,PEN_ACTIVE_BUTTON_FILL:"#C0D9FC",MAX_LANE_NUMBER:50,MIN_LANE_NUMBER:1,DEFAULT_FREE_HAND_COLOR:"#595959",EDIT_MODE:"edit",READ_MODE:"read",PEN_MODE:"pen",DRAG_MODE:"dragCanvas",FREE_HAND_MODE:"free-hand",ERASER_MODE:"eraser",BEGIN_INSERT_VERTEX_MODE:"beginInsertVertex",FREE_HAND_PENCIL:"pencil",FREE_HAND_MARK_PENCIL:"mark-pencil",PEN_SPMID:"a385.b4693.c124035",PENCIL_SPMID:"a385.b4693.c121188.d251467",MARK_PENCIL_SPMID:"a385.b4693.c121188.d251468",UI_THEME_COLORS_LIGHT:Xr,UI_THEME_COLORS_DARK:Wr,MINDMAP_ROOT_TEMPLATE:Rr}),Zr="http://www.w3.org/2000/svg",Ur="http://www.w3.org/1999/xlink";function Kr(t){t=t||document.body;var e=document.createElementNS(Zr,"svg");return e.setAttribute("version","1.1"),e.setAttribute("xmlns",Zr),e.setAttribute("xmlns:xlink",Ur),e.style.opacity=0,e.style.width="0px",e.style.height="0px",e.style.position="absolute",e.style["z-index"]=-1,t.appendChild(e),e}function Qr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qr(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Jr=Kr(),ta=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),r=e.call(this),c()(E()(r),"options",void 0),c()(E()(r),"matrix",void 0),c()(E()(r),"rendererElement",void 0),c()(E()(r),"destroyed",void 0),c()(E()(r),"styles",void 0),c()(E()(r),"attrs",void 0),c()(E()(r),"parent",void 0);var a=$r({matrix:[1,0,0,0,1,0,0,0,1]},t);if(!a.name)throw new Error("Should set name for Graphics Element!");return r.options=a,r.matrix=a.matrix,r.attrs={},r.styles={},r.rendererElement=r.create(a.name),r.update(a),r}return y()(n,[{key:"hide",value:function(){this.update({visibility:"hidden"})}},{key:"show",value:function(){this.update({visibility:"visible"})}},{key:"on",value:function(t,e){return"string"==typeof t&&-1!==this.passthroughEventKeys().indexOf(t)&&this.rendererElement.addEventListener(t,e),_()(L()(n.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){return"string"==typeof t&&-1!==this.passthroughEventKeys().indexOf(t)&&this.rendererElement.removeEventListener(t,e),_()(L()(n.prototype),"off",this).call(this,t,e)}},{key:"passthroughEventKeys",value:function(){return["mousedown","mouseenter","mouseleave","mousemove","mouseover","click"]}},{key:"passthroughAttributeKeys",value:function(){return["id","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin","stroke-miterlimit","clip-path","visibility","pointer-events","opacity","stroke-dasharray","class"]}},{key:"_getPassthroughData",value:function(t,e){var n={},r=Object.keys(e),a=this["passthrough".concat(t,"Keys")]();return r.filter((function(t){return a.includes(t)})).forEach((function(t){var r=e[t];void 0!==r&&(n[t]=r)})),n}},{key:"dataset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.rendererElement;e.dataset?Object.assign(e.dataset,t):Object.keys(t).forEach((function(n){e.setAttribute("data-".concat(n),t[n])}))}},{key:"update",value:function(t){var e=this._getPassthroughData("Attribute",t),n=t.matrix;n&&(e.transform="matrix(".concat(n[0],", ").concat(n[1],", ").concat(n[3],", ").concat(n[4],", ").concat(n[6],", ").concat(n[7],")"),this.matrix=n),this.attr(e)}},{key:"setAttrs",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rendererElement;Object.keys(t).forEach((function(n){var r=t[n];if(null==r)e.removeAttribute(n);else try{e.setAttribute(n,r)}catch(t){}}))}},{key:"_setStyles",value:function(t){var e=this;Object.keys(t).forEach((function(n){e.rendererElement.style[n]=t[n]}))}},{key:"create",value:function(t){return document.createElementNS(Zr,t)}},{key:"css",value:function(t){if("object"===i()(t))this.styles=$r($r({},this.styles),t),this._setStyles(t);else if("string"==typeof t)return this.styles[t]}},{key:"attr",value:function(t){if("object"===i()(t))this.attrs=$r($r({},this.attrs),t),this.setAttrs(t);else if("string"==typeof t)return this.attrs[t]}},{key:"getBBox",value:function(){var t,e=this.rendererElement,n=this.canvas,r=n&&n.calculateCanvas||Jr;if(document.contains(e))t=e.getBBox();else{var a=e.cloneNode(!0);r.appendChild(a),t=a.getBBox(),r.removeChild(a)}return{x:t.x,y:t.y,width:t.width,height:t.height}}},{key:"capture",value:function(t){!0===t?this.css({"pointer-events":"auto"}):!1===t&&this.css({"pointer-events":"none"})}},{key:"getBoundingClientRect",value:function(){return this.rendererElement.getBoundingClientRect()}},{key:"getZIndex",value:function(){return this.parent?this.parent.children.indexOf(this):null}},{key:"getSiblingRendererElement",value:function(){return this.rendererElement.nextSibling?["before",this.rendererElement.nextSibling]:this.rendererElement.previousSibling?["after",this.rendererElement.previousSibling]:null}},{key:"remove",value:function(){this.parent&&this.parent.removeChild(this)}},{key:"previousSibling",get:function(){if(!this.parent)return null;var t=this.parent.children,e=t.indexOf(this);return e>=1?t[e-1]:null}},{key:"nextSibling",get:function(){var t=this.parent.children,e=t.indexOf(this);return e>=0?t[e+1]:null}},{key:"before",value:function(t){if(!this.parent)return null;this.parent.insertBefore(t,this)}},{key:"after",value:function(t){var e;if(!this.parent)return null;null===(e=this.parent)||void 0===e||e.insertAfter(t,this)}},{key:"toBack",value:function(){if(!this.destroyed){var t=this.parent;t&&t.insertBefore(this,t.children[0])}}},{key:"toFront",value:function(){if(!this.destroyed){var t=this.parent;t&&t.insertBefore(this,null)}}},{key:"forward",value:function(){if(!this.destroyed){var t=this.parent,e=this.nextSibling;t&&e&&t.insertBefore(e,this)}}},{key:"backward",value:function(){if(!this.destroyed){var t=this.parent,e=this.previousSibling;t&&e&&t.insertBefore(this,e)}}},{key:"destroy",value:function(){this.destroyed=!0,this.options=null,this.remove()}}]),n}();function ea(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var na=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n);var a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ea(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ea(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"g"},t);return r=e.call(this,a),c()(E()(r),"children",void 0),r.children=[],r}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this)}},{key:"deepEach",value:function(t){Ve(this,t)}},{key:"add",value:function(t){this.children.includes(t)||(t.parent=this,this.children.push(t),this.rendererElement.appendChild(t.rendererElement))}},{key:"append",value:function(t){this.insertAfter(t,null)}},{key:"prepend",value:function(t){this.insertBefore(t,this.children[0])}},{key:"insertBefore",value:function(t,e){var n=this.children,r=this.rendererElement,a=n.indexOf(t);a>=0&&n.splice(a,1),t.parent=this;var i=n.indexOf(e);i>=0?(n.splice(i,0,t),r.insertBefore(t.rendererElement,e.rendererElement)):(n.push(t),r.insertBefore(t.rendererElement,null))}},{key:"insertAfter",value:function(t,e){e?this.insertBefore(t,e.nextSibling):this.insertBefore(t,null)}},{key:"removeChild",value:function(t){if(t.parent===this){var e=this.children,n=e.indexOf(t);n>-1&&e.splice(n,1),t.parent=void 0,this.rendererElement.removeChild(t.rendererElement)}}},{key:"clear",value:function(){D()(this.children).forEach((function(t){t.remove()}))}}]),n}();function ra(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var aa=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(m()(this,n),!(r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ra(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ra(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({container:null,calculatedContainer:null,name:"svg"},r)).container)throw new Error("Please set container for canvas!");t=e.call(this,r),c()(E()(t),"calculateCanvas",void 0),t.options=r;var a=r.container,i=E()(t).rendererElement;return i.setAttribute("version","1.1"),i.setAttribute("xmlns",Zr),i.setAttribute("xmlns:xlink",Ur),a.appendChild(i),t.createCalculateCanvas(),t.container=a,t.canvas=E()(t),t}return y()(n,[{key:"createCalculateCanvas",value:function(){var t=this.options;this.calculateCanvas=Kr(t.calculatedContainer)}},{key:"remove",value:function(){this.container&&this.container.removeChild(this.rendererElement),this.calculateCanvas&&this.calculateCanvas.parentElement.removeChild(this.calculateCanvas)}}]),n}();function ia(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var oa=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ia(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ia(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({x:0,y:0,scale:1,rotate:0},t))}return y()(n,[{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.options,t);var e=this.options,r=e.x,a=e.y,i=e.scale,o=e.rotate,c=i,l=Math.cos(o),s=Math.sin(o);t.matrix=[l*c,s*c,0,-s*c,l*c,0,r,a,1],_()(L()(n.prototype),"update",this).call(this,t)}}]),n}();var ca=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t=e.call(this,r),c()(E()(t),"isShape",!0),t}return y()(n)}();var la=function(t){S()(n,ca);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t={name:"avatar",matrix:t.element.matrix,element:t.element},e.call(this,t)}return y()(n,[{key:"create",value:function(){return this.options.element.rendererElement.cloneNode(!0)}}]),n}();function sa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ua(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function da(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ua(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ua(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ha=function(t){S()(n,ca);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=da(da({},r),{},{name:"path"}),t=e.call(this,r),c()(E()(t),"isPath",!0),t}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","marker-start","marker-end","fill-rule","clip-rule"])}},{key:"update",value:function(t){var e=t.d;Array.isArray(e)?_()(L()(n.prototype),"update",this).call(this,da(da({},t),{},{d:Yn(e)})):_()(L()(n.prototype),"update",this).call(this,t)}},{key:"getPath",value:function(t,e){var n;return rr(null===(n=this.options)||void 0===n?void 0:n.d,t,e)}},{key:"getClosestPoint",value:function(t,e){if("number"==typeof t&&"number"==typeof e){var n=t,r=e,a=Ho(this.rendererElement,(function(t,e){var a=t-n,i=e-r;return a*a+i*i})),i=a.point,o=a.percentage;return{point:[i.x,i.y],percentage:o}}if("number"!=typeof t&&e&&"number"!=typeof e){var c,l=t,s=e,u=Ar(this.rendererElement.getBBox()),d=ct.from(s).voronoi([u.minX-10,u.minY-10,u.maxX+10,u.maxY+10]),h=0,f=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sa(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(d.cellPolygons());try{for(f.s();!(c=f.n()).done;){if(c.value,d.contains(h,l.x,l.y))return h;h++}}catch(t){f.e(t)}finally{f.f()}return 0}}},{key:"getIntersectionPoint",value:function(t,e,n,r){return Ho(this.rendererElement,(function(a,i){var o=a-t,c=i-e,l=a-n,s=i-r;return Math.sqrt(o*o+c*c)+Math.sqrt(l*l+s*s)})).point}}]),n}();function fa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fa(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(t){Object.defineProperty(ha.prototype,t,{value:function(){var e=this.rendererElement;return e[t].apply(e,arguments)}})}));var ma=function(t){S()(n,ha);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){m()(this,n);var r=t.cx,a=t.cy,i=t.rx,o=t.ry;return e.call(this,pa(pa({},t),{},{d:Hn(r,a,i,o)}))}return y()(n,[{key:"getPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options;return Hn(n.cx*t,n.cy*e,n.rx*t,n.ry*e)}}]),n}();function va(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var ya=function(t){S()(n,ca);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?va(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"html",html:"",x:0,y:0,width:0,height:0,styleSheets:[]},t),e.call(this,t)}return y()(n,[{key:"addClass",value:function(t){this.htmlContainer.classList.add(t)}},{key:"removeClass",value:function(t){this.htmlContainer.classList.remove(t)}},{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height"])}},{key:"create",value:function(){var t=document.createElement("div"),e=_()(L()(n.prototype),"create",this).call(this,"foreignObject");return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),e.appendChild(t),this.htmlContainer=t,mn(this.htmlContainer,this.options.styleSheets),e}},{key:"update",value:function(t){t.html&&this.htmlContainer.innerHTML!==t.html&&(this.html=t.html,this.htmlContainer.innerHTML=t.html,mn(this.htmlContainer,this.options.styleSheets)),_()(L()(n.prototype),"update",this).call(this,t)}}]),n}();function ga(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var ba=function(t){S()(n,ca);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ga(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ga(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"image",crossorigin:"anonymous",preserveAspectRatio:"none"},t))}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["href","x","y","width","height","crossorigin","preserveAspectRatio"])}}]),n}();function xa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ka(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xa(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var wa=function(t){S()(n,ha);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){m()(this,n);var r=t.points;return e.call(this,ka(ka({},t),{},{d:$n(r).concat("z")}))}return y()(n,[{key:"getPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return $n(this.options.points.map((function(n){return{x:n.x*t,y:n.y*e}}))).concat("z")}}]),n}();function Ca(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Aa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ca(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ca(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Oa=function(t){S()(n,ha);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){m()(this,n);var r=t.x,a=t.y,i=t.width,o=t.height,c=t.rx,l=t.ry;return e.call(this,Aa(Aa({},t),{},{d:Jn(r,a,i,o,c,l)}))}return y()(n,[{key:"getPath",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.options,r=n.x,a=n.y,i=n.width,o=n.height,c=n.rx,l=n.ry;return Jn(r*t,a*e,i*t,o*e,Math.min(c*t,c),Math.min(l*t,l))}}]),n}();function Ea(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ea(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ea(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Sa=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,Pa(Pa({},t),{},{name:"text"}))}return y()(n,[{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_()(L()(n.prototype),"update",this).call(this,t);var e=(t||{}).text;null!=e&&(this.rendererElement.innerHTML=e)}},{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dominant-baseline","x","y","textLength"])}}]),n}();function Ma(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ja(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ma(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ma(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ra=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,ja(ja({},t),{},{name:"title"}))}return y()(n,[{key:"update",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title;null!=t&&(this.rendererElement.innerHTML=t)}}]),n}();function La(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Ba=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?La(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):La(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"use"},t),e.call(this,t)}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["x","y","width","height","href"])}}]),n}();function Da(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Na=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Da(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Da(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({name:"defs",matrix:null},r),(t=e.call(this,r)).isDefs=!0,t}return y()(n)}();function _a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ia(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_a(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ta=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,Ia(Ia({},t),{},{matrix:null,name:"clipPath"}))}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","clipPathUnits"])}}]),n}();function Fa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function za(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fa(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var qa=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,za(za({},t),{},{name:"feDropShadow"}))}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["dx","dy","stdDeviation","flood-color"])}}]),n}();function Ya(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ha(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ya(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ya(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ga=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),(t=e.call(this,Ha(Ha({},r),{},{name:"filter"}))).children=[],t}return y()(n,[{key:"add",value:function(t){t.parent=this,this.children.push(t),this.rendererElement.appendChild(t.rendererElement)}},{key:"destroy",value:function(){this.children.forEach((function(t){return t.destroy()})),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Xa=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Wa=function(t){S()(n,ta);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),(t=e.call(this,{name:"linearGradient",matrix:null})).id=Object(F.a)(),t.rendererElement.setAttribute("id",t.id),t}return y()(n,[{key:"update",value:function(t){if("string"==typeof t){var e,n,r,a,i=this.rendererElement,o=Xa.exec(t),c=(n=parseFloat(o[1]),(Math.PI/180*n%(e=2*Math.PI)+e)%e),l=o[2];c>=0&&c<.5*Math.PI?(r={x:0,y:0},a={x:1,y:1}):.5*Math.PI<=c&&c<Math.PI?(r={x:1,y:0},a={x:0,y:1}):Math.PI<=c&&c<1.5*Math.PI?(r={x:1,y:1},a={x:0,y:0}):(r={x:0,y:1},a={x:1,y:0});var s=Math.tan(c),u=s*s,d=(a.x-r.x+s*(a.y-r.y))/(u+1)+r.x,h=s*(a.x-r.x+s*(a.y-r.y))/(u+1)+r.y;i.setAttribute("x1",r.x),i.setAttribute("y1",r.y),i.setAttribute("x2",d),i.setAttribute("y2",h),i.innerHTML=function(t){var e=t.match(/[\d.]+:(#[^\s]+|[^\)]+\))/gi);if(!e)return"";var n="";return e.sort((function(t,e){return t=t.split(":"),e=e.split(":"),Number(t[0])-Number(e[0])})),e.forEach((function(t){t=t.split(":"),n+='<stop offset="'.concat(t[0],'" stop-color="').concat(t[1],'"></stop>')})),n}(l)}}}]),n}();function Va(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Za(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Va(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Va(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ua=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,Za(Za({},t),{},{name:"marker"}))}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["id","markerWidth","markerHeight","viewBox","orient","refX","refY"])}}]),n}();function Ka(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qa(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qa(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ja=Kr(),ti=function(t){S()(n,ca);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t=$a($a({},t),{},{name:"roughPath"}),e.call(this,t)}return y()(n,[{key:"passthroughAttributeKeys",value:function(){return _()(L()(n.prototype),"passthroughAttributeKeys",this).call(this).concat(["d","roughFillStyle","disableMultiStroke"])}},{key:"create",value:function(t){var e=_()(L()(n.prototype),"create",this).call(this,"g"),r=_()(L()(n.prototype),"create",this).call(this,"path"),a=_()(L()(n.prototype),"create",this).call(this,"g"),i=_()(L()(n.prototype),"create",this).call(this,"svg");i.setAttribute("version","1.1"),i.setAttribute("xmlns",Zr),i.setAttribute("xmlns:xlink",Ur);var o=gt.a.svg(i);return e.appendChild(a),e.appendChild(r),r.setAttribute("fill","rgba(0,0,0,0)"),r.setAttribute("stroke","rgba(0,0,0,0)"),this.roughSVGContainer=i,this.roughSVG=o,this.roughGroup=a,this.calculatePath=r,e}},{key:"setAttrs",value:function(t){var e=this.roughSVG,n=this.calculatePath,r=this.roughGroup,a=this.rendererElement,i=["d","stroke-width"],o=["d","stroke","stroke-width","fill","stroke-dasharray","roughFillWeight","disableMultiStroke"],c={},l={},s={};if(Object.keys(t).forEach((function(e){var n=o.includes(e),r=i.includes(e);n&&(c[e]=t[e]),r&&(l[e]=t[e]),n||r||(s[e]=t[e])})),Object.keys(c).length>0){var u=this.attrs.d,d=e.path(u,function(t){var e=["stroke","fill"],n={seed:75,roughness:.4},r=t.roughFillStyle;return Object.keys(t).forEach((function(a){var i=t[a];e.includes(a)?n[a]=i:"stroke-dasharray"===a&&"string"==typeof i&&"none"!==i?n.strokeLineDash=i.split(" ").map((function(t){return Number(t)})):"stroke-width"===a&&"number"==typeof i?(n.strokeWidth=i,["hachure","default"].includes(r)&&(n.hachureGap=2.5*i,n.fillWeight=.8*i,n.bowing=1.2*(i-1)+4)):"roughFillStyle"===a&&"string"==typeof i?("solid"===i&&(n.roughness=1),n.fillStyle=i):"disableMultiStroke"===a&&"boolean"==typeof i&&(n.disableMultiStroke=i)})),n}(this.attrs));!function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(r),r.appendChild(d)}Object.keys(s).forEach((function(t){var e=s[t];null==e?a.removeAttribute(t):a.setAttribute(t,e)})),Object.keys(l).forEach((function(t){var e=l[t];null==e?n.removeAttribute(t):n.setAttribute(t,e)}))}},{key:"update",value:function(t){var e=t.d;Array.isArray(e)?_()(L()(n.prototype),"update",this).call(this,$a($a({},t),{},{d:Yn(e)})):_()(L()(n.prototype),"update",this).call(this,t)}},{key:"getPath",value:function(t,e){var n;return rr(null===(n=this.options)||void 0===n?void 0:n.d,t,e)}},{key:"getClosestPoint",value:function(t,e){if("number"==typeof t&&"number"==typeof e){var n=t,r=e,a=Ho(this.calculatePath,(function(t,e){var a=t-n,i=e-r;return a*a+i*i})),i=a.point,o=a.percentage;return{point:[i.x,i.y],percentage:o}}if("number"!=typeof t&&e&&"number"!=typeof e){var c,l=t,s=e,u=Ar(this.calculatePath.getBBox()),d=ct.from(s).voronoi([u.minX-10,u.minY-10,u.maxX+10,u.maxY+10]),h=0,f=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ka(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ka(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(d.cellPolygons());try{for(f.s();!(c=f.n()).done;){if(c.value,d.contains(h,l.x,l.y))return h;h++}}catch(t){f.e(t)}finally{f.f()}return 0}}},{key:"getIntersectionPoint",value:function(t,e,n,r){return Ho(this.calculatePath,(function(a,i){var o=a-t,c=i-e,l=a-n,s=i-r;return Math.sqrt(o*o+c*c)+Math.sqrt(l*l+s*s)})).point}},{key:"getBBox",value:function(){var t,e=this.calculatePath,n=this.canvas,r=n&&n.calculateCanvas||Ja;if(document.contains(e))t=e.getBBox();else{var a=e.cloneNode(!0);r.appendChild(a),t=a.getBBox(),r.removeChild(a)}return{x:t.x,y:t.y,width:t.width,height:t.height}}}]),n}();function ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ni(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ei(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}["getPointAtLength","getTotalLength","isPointInFill","isPointInStroke"].forEach((function(t){Object.defineProperty(ti.prototype,t,{value:function(){var e=this.calculatePath;return e[t].apply(e,arguments)}})}));var ri=function(t){S()(n,ti);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){m()(this,n);var r=t.cx,a=t.cy,i=t.rx,o=t.ry;return e.call(this,ni(ni({},t),{},{d:Hn(r,a,i,o)}))}return y()(n,[{key:"getPath",value:function(t,e){var n=this.options;return Hn(n.cx*t,n.cy*e,n.rx*t,n.ry*e)}}]),n}();function ai(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ii(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ai(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ai(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var oi=function(t){S()(n,ti);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){m()(this,n);var r=t.points;return e.call(this,ii(ii({},t),{},{d:$n(r).concat("z")}))}return y()(n,[{key:"getPath",value:function(t,e){return $n(this.options.points.map((function(n){return{x:n.x*t,y:n.y*e}}))).concat("z")}}]),n}();function ci(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function li(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ci(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ci(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var si=function(t){S()(n,ti);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n);var r=t.x,a=t.y,i=t.width,o=t.height,c=t.rx,l=t.ry;return e.call(this,li(li({},t),{},{d:Jn(r,a,i,o,c,l)}))}return y()(n,[{key:"getPath",value:function(t,e){var n=this.options,r=n.x,a=n.y,i=n.width,o=n.height,c=n.rx,l=n.ry;return Jn(r*t,a*e,i*t,o*e,Math.min(c*t,c),Math.min(l*t,l))}}]),n}(),ui=Object.freeze({__proto__:null,Canvas:aa,Group:na,FixedGroup:oa,Shape:ca,Path:ha,Html:ya,Avatar:la,Image:ba,Defs:Na,LinearGradient:Wa,Rect:Oa,Ellipse:ma,Marker:Ua,Use:Ba,Filter:Ga,FeDropShadow:qa,ClipPath:Ta,Title:Ra,Text:Sa,Polygon:wa,RoughPath:ti,RoughRect:si,RoughPolygon:oi,RoughEllipse:ri});function di(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function hi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?di(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function fi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new oa,r=new ha({d:Gn(0,0,4),stroke:Gr,fill:"#FFFFFF","stroke-width":1});return n.add(r),r.dataset(hi(hi({},e),{},{type:"point",cursor:t})),{group:n,shape:r,name:t}}function pi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new na,r=new ha({stroke:"rgba(255,255,255,0)"}),a=new ha({stroke:"#3384F5"});return r.dataset(hi(hi({},e),{},{type:"line",cursor:t})),n.add(a),n.add(r),{visShape:a,shape:r,name:t,group:n}}function mi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new oa,r=new ba({href:"https://gw.alipayobjects.com/zos/bmw-prod/d07101fb-046a-474e-a8f7-5bfa2d2d920d.svg",x:-8,y:-8,width:16,height:16});return n.add(r),r.dataset(hi({lake_prevent_click_unselect:"true",rotate_button:"true"},e)),n.css({cursor:"pointer"}),{group:n,shape:r,name:t}}var vi=function(t){for(var e=t;null!==(n=e)&&void 0!==n&&n.parent&&fr(null===(r=e)||void 0===r?void 0:r.parent);){var n,r,a;e=null===(a=e)||void 0===a?void 0:a.parent}return e};function yi(t){var e=st()(t).toRgb(),n=e.r,r=e.g,a=e.b;return e.a<.5||.299*n+.587*r+.114*a>=210?"#8C8C8C":"#fff"}try{JSON.parse(r.LocalStorageUtil.getItem("lake_diagram_custom_colors"))}catch(t){}function gi(t,e){var n=[],r={};return t.forEach((function(t){Ve(t,(function(t){var a=Object(F.a)();r[t.id]=a,e&&(e[a]=e[t.id]),t.id=a,"line"!==t.type&&"edge"!==t.type||n.push(t)}))})),n.forEach((function(t){t.source&&t.source.id&&r[t.source.id]&&(t.source.id=r[t.source.id]),t.target&&t.target.id&&r[t.target.id]&&(t.target.id=r[t.target.id])})),r}function bi(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[e.x+e.width/2,e.y+e.height/2],a=Math.cos(n),i=Math.sin(n),o=Oo(8,r,[r[0]+a,r[1]+i]);return o(t,0)||o(t,4)?"ew-resize":o(t,1)||o(t,5)?"nesw-resize":o(t,2)||o(t,6)?"ns-resize":"nwse-resize"}function xi(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[e.x+e.width/2,e.y+e.height/2],a=Math.cos(n),i=Math.sin(n),o=Oo(4,r,[r[0]+a,r[1]+i]);return o(t,0)||o(t,2)?"nesw-resize":"nwse-resize"}function ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ki(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ci(t){var e=new Image;return new Promise((function(n,r){e.onload=function(){n(e)},e.onerror=function(){r(new Error("unable to load url ".concat(t)))},e.crossOrigin="anonymous",e.src=t}))}function Ai(t,e,n,r,a,i,o,c,l,s,u){var d=document.createElement("canvas"),h=d.getContext("2d");d.width=s,d.height=u,h&&h.drawImage(e,r,a,i,o,c,l,s,u),t.push({canvas:d,fy:a*n,fHeight:u})}function Oi(t){return Ei.apply(this,arguments)}function Ei(){return(Ei=dt()(ft.a.mark((function t(e){var n,r,a,i,o,c,l,s,u,d,h,f,p,m,v,y,g,b,x,k=arguments;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=k.length>1&&void 0!==k[1]?k[1]:{},t.next=3,Ci(e);case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return");case 6:if(a=document.createElement("canvas"),i=wi({width:r.naturalWidth,height:r.naturalHeight,fLimit:1e4,ratio:1},n),o=i.width,c=i.height,l=i.fLimit,s=i.backgroundColor,u=i.ratio,d=o*u,h=c*u,a.width=d,a.height=h,f=a.getContext("2d")){t.next=15;break}return t.abrupt("return");case 15:if(s&&(f.fillStyle=s,f.fillRect(0,0,d,h)),h>l){for(p=parseInt(h/l),m=h%l,0,0,v=o,y=d,g=[],b=0,0,x=0;x<p;x++)Ai(g,r,u,0,b,v,l/u,0,0,y,l),b+=l/u;Ai(g,r,u,0,b,v,m/u,0,0,y,m),g.forEach((function(t){var e=t.canvas,n=t.fy,r=t.fHeight;f.drawImage(e,0,n,d,r)}))}else f.drawImage(r,0,0,d,h);return t.abrupt("return",a);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Pi=Object.freeze({__proto__:null,loadImage:Ci,loadCanvas:Oi});function Si(t){return pt.ua.macos?t.metaKey:t.ctrlKey}var Mi=Object.freeze({__proto__:null,isMod:Si}),ji=[{key:"standard-h",directions:[[1,0],[-1,0]]},{key:"standard-r",directions:[[1,0]]},{key:"standard-l",directions:[[-1,0]]},{key:"standard-t",directions:[[0,-1]]},{key:"standard-b",directions:[[0,1]]},{key:"indent-br",directions:[[1,1]]},{key:"indent-bl",directions:[[-1,1]]},{key:"indent-tr",directions:[[1,-1]]},{key:"indent-tl",directions:[[-1,-1]]},{key:"timeline-r",directions:[[1,0]]},{key:"timeline-l",directions:[[-1,0]]}];function Ri(t,e){if(0!==t.length){var n=[];return t.forEach((function(t){var r=e.get([t],"downDirection");if(r){var a=e.get([t],"downLayoutType"),i=e.get([t],"layoutQuadrantConstraint"),o=r.map((function(t){return Math.sign(t)})).join(","),c=(1===i.length?{"0,-1":"t","0,1":"b","-1,0":"l","1,0":"r","1,1":"br","-1,1":"bl","1,-1":"tr","-1,-1":"tl"}:{"-1,0":"h","1,0":"h","0,1":"v","0,-1":"v"})[o];n.push("".concat(a,"-").concat(c))}})),n.every((function(t){return t===n[0]}))?n[0]:"multiValue"}}function Li(t){var e,n,r=t.split("-"),a=b()(r,2),i=a[0],o=a[1];return"indent"===i?(e=[1,1],n={br:[1],bl:[2],tl:[3],tr:[4]}[o]):"standard"===i?"h"===o?(e=[1,0],n=null):"v"===o?(e=[0,1],n=null):"r"===o?(e=[1,0],n=[1]):"l"===o?(e=[1,0],n=[2]):"t"===o?(e=[0,1],n=[2]):"b"===o&&(e=[0,1],n=[1]):"timeline"===i&&("r"===o?(e=[1,0],n=[1]):"l"===o&&(e=[1,0],n=[2])),{type:i,direction:e,quadrantConstraint:n}}function Bi(t,e){var n=e.some((function(e,n){return Math.sign(e)===Math.sign(t[n])})),r=e.every((function(e,n){return Math.sign(e)!==-Math.sign(t[n])||0===Math.sign(e)}));return n&&r}function Di(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"standard"!==e:"timeline"===t&&"indent"!==e}var Ni=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a=function(t,e){var n=new oa,r=new ma({cx:0,cy:0,rx:4,ry:4,width:8,height:8,stroke:e?"rgba(255,255,255,0.40)":Gr,strokeWidth:"2px",fill:e?"rgba(9,109,217,0.40)":"#FFFFFF"});return r.dataset({isControlPoint:"".concat(!e),isUIPoints:"".concat(e),index:"".concat(t),test_id:"line-control-point_".concat(t)}),n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line-control-point_".concat(t),isControlPoint:"".concat(!e),isUIPoints:"".concat(e),index:"".concat(t)}),{group:n,shape:r,index:t,isUIPoints:e,isControlPoints:!e}}(t,e);return n&&r&&(a.shape.css({cursor:"V"===r[r.length-1]?"row-resize":"col-resize"}),a.group.dataset({test_id:"elbow_".concat(e?"ui_point":"control_point","_").concat(t)})),a},_i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=new oa,r=new ma({cx:0,cy:0,rx:e,ry:e,stroke:Gr,fill:"#FFFFFF"});return n.add(r),n.dataset({lake_prevent_click_unselect:"true",test_id:"line_endpoint_".concat(t)}),{group:n,shape:r,name:t}};function Ii(t,e){for(var n=t.getPoints(),r=Xn(t.controlPoints,n,e),a=[],i=0;i<r.length-1;i++){var o=r[i],c=r[i+1],l=[.5*(o[1]+c[1]),.5*(o[2]+c[2]),ro(o[1],c[1],2)?"H":"V"];a.push(l)}return a.length>2?a.slice(1,a.length-1):a}function Ti(t){var e=t.cell,n=t.uiPoints,r=t.uiPointIndex;return"elbow"===e.shape?function(t,e,n){return e.length<=1?e:0===n?e.splice(0,e.length-1):n===e.length-1?e.splice(1):e.slice(1,e.length-1)}(0,n,r):function(t,e,n){var r=e[n],a=s()(t.controlPoints);return a.splice(n,0,r),a}(e,n,r)}function Fi(t,e){var n=[];return"straight"===t.shape?n=function(t){var e,n=[],r=t.getPoints(),a=r.length;for(e=0;e<a-1;e++){var i=[.5*(r[e].x+r[e+1].x),.5*(r[e].y+r[e+1].y)];n.push(i)}return n}(t):"curve"===t.shape?n=function(t){var e=[],n=t.getPoints().length,r=t.wireElement;if(2===n){var a=r.getPointAtLength(.5*r.getTotalLength());e.push([a.x,a.y])}else if(3===n){var i=jo(r.attrs.d);e.push(i[0]),e.push(i[1])}else{var o,c=Qn(t.d);for(o=0;o<c.length-1;o++){var l=[];if("M"===c[o][0])l.push(c[o]),l.push(c[o+1]);else{var s=c[o];l.push(["M",s[s.length-2],s[s.length-1]]),l.push(c[o+1])}var u=Yn(l),d=new ha({d:u}),h=d.getPointAtLength(.5*d.getTotalLength());d.destroy(),e.push([h.x,h.y])}}return e}(t):"elbow"===t.shape&&(n=function(t,e){if(t.controlPoints.length>0||t.isLoop)return function(t,e){var n=t.getPoints(),r=t.controlPoints,a=n[0],i=r[0],o=n[n.length-1],c=r[r.length-1],l=s()(Ii(t,e)),u=Xn(r,n,e);return l.length<=2&&u.length<=3||(ro(i[0],a.x)||ro(i[1],a.y)||("V"===i[i.length-1]?l.unshift([a.x,.5*(i[1]+a.y),"H"]):l.unshift([.5*(i[0]+a.x),a.y,"V"])),ro(c[0],o.x)||ro(c[1],o.y)||("V"===c[c.length-1]?l.push([o.x,.5*(c[1]+o.y),"H"]):l.push([.5*(c[0]+o.x),o.y,"V"]))),l}(t,e);var n=t.source,r=t.target,a=t.diagram,i=a.find(n.id),o=a.find(r.id),c=t.getPoints(),l=[];if(!i&&!o&&2===c.length){var u=c[0],d=c[1],h=.5*(u.x+d.x),f=.5*(u.y+d.y);return ro(u.x,d.x)||ro(u.y,d.y)?l.push([h,f,0]):(l.push([.5*(u.x+h),u.y,"V"]),l.push([h,f,"H"]),l.push([.5*(h+d.x),d.y,"V"])),l}for(var p=Qn(t.d),m=1;m<p.length;m++){var v=p[m-1],y=p[m];ro(v[1],y[1])?l.push([v[1],.5*(v[2]+y[2]),"H"]):ro(v[2],y[2])&&l.push([.5*(v[1]+y[1]),v[2],"V"])}return l}(t,e)),n}var zi=function(t){return Array.isArray(t)?{x:t[0],y:t[1]}:t},qi=document.createElementNS(Zr,"svg"),Yi=function(t){var e,n;if(Array.isArray(t)){var r=b()(t,2);e=r[0],n=r[1]}else e=t.x,n=t.y;var a=qi.createSVGPoint();return a.x=e,a.y=n,a},Hi=function(t){return!!(A()(t)&&t.hasOwnProperty("x")&&t.hasOwnProperty("y"))},Gi=function(t){if(!t.length)return"";var e=t.reduce((function(t,e,n,r){var a=b()(e,2),i=a[0],o=a[1],c=b()(r[(n+1)%r.length],2),l=c[0],s=c[1];return t.push(i,o,(i+l)/2,(o+s)/2),t}),["M"].concat(D()(t[0]),["Q"]));return e.push("Z"),e.join(" ")};function Xi(t,e){var n=t;if("number"!=typeof t&&(n=ho(t.x,t.y,e.x,e.y)),n>=5*Math.PI/4&&n<7*Math.PI/4)return"N";if(n>=7*Math.PI/4||n<Math.PI/4)return"E";if(n>=Math.PI/4&&n<3*Math.PI/4)return"S";if(n>=3*Math.PI/4&&n<5*Math.PI/4)return"W";throw new Error("unexpected radian ".concat(n))}var Wi=["penetratedKeys","Subcells"],Vi=function(t,e){return f()(t,e,(function(t,e,n){if(Wi.indexOf(n)>-1)return[].concat(D()(t||[]),D()(e||[]))}))},Zi=function(t){return vt()(t,(function(t){if("object"===i()(t)&&!d()(t))return t}))},Ui=Object.freeze({__proto__:null,mergeDefalutProps:Vi,cloneDeepDefaultProps:Zi});function Ki(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(!t.rendererElement.closest("svg"))return null;var r=Yi(e),a=t.attr("stroke-width");t.attr({"stroke-width":2*n});var i=t.isPointInStroke(r);return t.attr({"stroke-width":a}),i?t.getClosestPoint(e[0],e[1]).point:null}var Qi=function(t,e,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=a?a/180*Math.PI:0,c=Math.sin(o),l=Math.cos(o),s=n/2,u=r/2;return[l*i,c*i,0,-c*i,l*i,0,t+(-s*l+u*c+s),e+(-s*c-u*l+u),1]};function $i(t,e){return{minX:-1.5*t,minY:e+10,maxX:2.5*t,maxY:e+30}}function Ji(t,e,n){var r=t/2,a=e/2,i=r<n?r:n,o=a<n?a:n;return[["M",+(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)+ +i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0],["l",t-2*i,0],["a",i,o,0,0,1,i,o],["l",0,e-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-t,0],["a",i,o,0,0,1,-i,-o],["l",0,2*o-e],["a",i,o,0,0,1,i,-o],["z"]]}function to(t){return t>=180&&(t-=360),t<=-180&&(t+=360),t}function eo(t){return 180*t/Math.PI}function no(t){return Math.PI/180*t}function ro(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return Math.abs(t-e)<=n}function ao(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return t.length===e.length&&t.every((function(t,r){return ro(t,e[r],n)}))}function io(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&t.maxX>=e.maxX&&t.maxY>=e.maxY}function oo(t,e){return!(e.maxX<t.minX||e.minX>t.maxX||e.maxY<t.minY||e.minY>t.maxY)}function co(t,e,n,r){var a;return a=(r-e)/(n-t),isNaN(a)?1/0:a=Number(a.toFixed(2))}function lo(t,e,n,r){if("number"==typeof t&&"number"==typeof e&&"number"==typeof n&&"number"==typeof r){var a=t,i=e;return Math.sqrt(Math.pow(n-a,2)+Math.pow(r-i,2))}if("number"!=typeof t&&"number"!=typeof e){var o=zi(t),c=zi(e);return Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2))}return 0}function so(t,e,n,r,a){var i=co(t,e,n,r),o=Math.atan(i),c=n<t,l=a*Math.cos(o),s=a*Math.sin(o);return c&&(l*=-1,s*=-1),{offsetX:l,offsetY:s}}function uo(t,e,n,r,a){if(lo(t,e,n,r)<a)return{x:t,y:e};var i=so(t,e,n,r,a);return{x:n-i.offsetX,y:r-i.offsetY}}function ho(t,e,n,r){var a=co(t,e,n,r),i=Math.atan(a);return n<t?i+Math.PI:r<e?i+2*Math.PI:i}function fo(t,e,n,r){var a;return a=ro(t,n)?1/0:ro(e,r)?0:(a=(r-e)/(n-t)).toFixed(2),Number(a)}function po(t,e,n,r,a,i,o,c){if(fo(t,e,n,r)===fo(a,i,o,c))return!1;var l=((t*r-n*e)*(a-o)-(t-n)*(a*c-i*o))/((t-n)*(i-c)-(e-r)*(a-o)),s=((t*r-n*e)*(i-c)-(e-r)*(a*c-i*o))/((t-n)*(i-c)-(e-r)*(a-o));return{x:-0===l?0:l,y:-0===s?0:s}}function mo(t,e,n,r){return Math.abs(t-n)+Math.abs(e-r)}function vo(t,e,n){return t>=e&&t<=n}function yo(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-4;return ro(t,n,a)&&ro(e,r,a)}function go(t,e,n,r,a,i,o,c){var l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],s=a-t,u=i-e,d=n-t,h=r-e,f=o-a,p=c-i,m=d*p-h*f,v=null;if(m*m>1e-4*(d*d+h*h)*(f*f+p*p)){var y=(s*p-u*f)/m,g=(s*h-u*d)/m;vo(y,0,1)&&vo(g,0,1)&&(v={x:t+y*d,y:e+y*h})}return v&&!l&&(yo(t,e,v.x,v.y,.1)||yo(n,r,v.x,v.y,.1)||yo(a,i,v.x,v.y,.1)||yo(o,c,v.x,v.y,.1))?null:v}function bo(t,e,n,r){if(t===n)return{f:function(){return null},fy:function(){return t},string:"x=".concat(t.toFixed(3))};if(e===r)return{f:function(){return e},fy:function(){return null},string:"y=".concat(e.toFixed(3))};var a=(r-e)/(n-t),i=-t/(n-t)*(r-e)+e;return{f:function(t){return a*t+i},fy:function(t){return(t-i)/a},string:"y=".concat(a.toFixed(3),"x+").concat(i.toFixed(3))}}function xo(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!(go(t.x1,t.y1,t.x2,t.y2,e.minX,e.minY,e.minX,e.maxY,n)||go(t.x1,t.y1,t.x2,t.y2,e.minX,e.minY,e.maxX,e.minY,n)||go(t.x1,t.y1,t.x2,t.y2,e.maxX,e.minY,e.maxX,e.maxY,n)||go(t.x1,t.y1,t.x2,t.y2,e.minX,e.maxY,e.maxX,e.maxY,n))}function ko(t,e){return fo(t.x,t.y,e.x1,e.y1)===fo(t.x,t.y,e.x2,e.y2)}function wo(t,e,n,r){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2))}function Co(t,e){if(t.k===1/0){if(t.y1<t.y2&&e.y<t.y1)return!1;if(t.y1>t.y2&&e.y>t.y1)return!1}else{if(t.x1<t.x2&&e.x<t.x1)return!1;if(t.x1>t.x2&&e.x>t.x1)return!1}return!0}function Ao(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t[0]*e[0]+t[1]*e[1],a=t[0]*e[1]-t[1]*e[0],i=Math.atan2(a,r);return i<0&&(i=2*Math.PI-Math.abs(i)),n?2*Math.PI-i:i}function Oo(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0],r=[],a=2*Math.PI/t,i=0;i<t;i++)r.push([a*i,a*(i+1)]);var o=[n[0]-e[0],n[1]-e[1]];return function(t,n){var a=[t[0]-e[0],t[1]-e[1]],i=r[n];return rn(Ao(a,o,!1),i)}}var Eo=function(t,e,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)>0};function Po(t,e){var n=new Ln(e),r=n.tl,a=n.tr,i=n.bl,o=n.br;return Eo(t,r,a)&&Eo(t,a,o)&&Eo(t,o,i)&&Eo(t,i,r)}var So=function(t,e){var n="x"in t?Ar(t):t,r="x"in e?Ar(e):e;return Math.max(0,Math.min(n.maxX,r.maxX)-Math.max(n.minX,r.minX))*Math.max(0,Math.min(n.maxY,r.maxY)-Math.max(n.minY,r.minY))},Mo=function(t,e,n){var r=zi(t);return n.map((function(t){var n=to(t.r+e),a=Sn(t),i=[0,0],o=[0,0];w.vec2.rotate(i,[t.x-r.x,t.y-r.y],[0,0],no(e)),i[0]+=r.x,i[1]+=r.y,w.vec2.rotate(o,[a.x-r.x,a.y-r.y],[0,0],no(e)),o[0]+=r.x,o[1]+=r.y;var c=[0,0];return w.vec2.rotate(c,[i[0]-o[0],i[1]-o[1]],[0,0],no(360-e)),c[0]+=o[0],c[1]+=o[1],{x:c[0],y:c[1],r:n}}))},jo=function(t){var e=t.split(/Q|M/).slice(1).map((function(t){return t.split(",").map((function(t){return parseFloat(t)}))})),n=e[0],r=n[0],a=n[1],i=e[1][0],o=e[1][1],c=e[1][2],l=e[1][3];return[Ro(.25,r,a,i,o,c,l),Ro(.75,r,a,i,o,c,l)]};function Ro(t,e,n,r,a,i,o){return[Math.pow(1-t,2)*e+2*(1-t)*t*r+Math.pow(t,2)*i,Math.pow(1-t,2)*n+2*(1-t)*t*a+Math.pow(t,2)*o]}var Lo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m()(this,t),this.vertices={},this.edges={},this.isDirected=e}return y()(t,[{key:"snap",value:function(t){for(var e={vertex:void 0,distance:1/0},n=this.getAllVertices(),r=0;r<n.length;r++){var a=n[r];if(a.x===t.x&&a.y===t.y)return a;var i=Math.abs(a.x-t.x)+Math.abs(a.y-t.y);i<e.distance&&(e.vertex=a,e.distance=i)}return e.vertex}},{key:"addVertex",value:function(t){return this.vertices[t.getKey()]=t,this}},{key:"getVertexByKey",value:function(t){return this.vertices[t]}},{key:"getNeighbors",value:function(t){return t.getNeighbors()}},{key:"getAllVertices",value:function(){return Object.values(this.vertices)}},{key:"getAllEdges",value:function(){return Object.values(this.edges)}},{key:"addEdge",value:function(t){var e=this.getVertexByKey(t.startVertex.getKey()),n=this.getVertexByKey(t.endVertex.getKey());if(e||(this.addVertex(t.startVertex),e=this.getVertexByKey(t.startVertex.getKey())),n||(this.addVertex(t.endVertex),n=this.getVertexByKey(t.endVertex.getKey())),this.edges[t.getKey()])throw new Error("Edge has already been added before");return this.edges[t.getKey()]=t,this.isDirected?e.addEdge(t):(e.addEdge(t),n.addEdge(t)),this}},{key:"deleteEdge",value:function(t){if(!this.edges[t.getKey()])throw new Error("Edge not found in graph");delete this.edges[t.getKey()];var e=this.getVertexByKey(t.startVertex.getKey()),n=this.getVertexByKey(t.endVertex.getKey());e.deleteEdge(t),n.deleteEdge(t)}},{key:"findEdge",value:function(t,e){return this.getVertexByKey(t.getKey()).findEdge(e)}},{key:"findVertexByKey",value:function(t){return this.vertices[t]?this.vertices[t]:null}},{key:"getWeight",value:function(){return this.getAllEdges().reduce((function(t,e){return t+e.weight}),0)}},{key:"reverse",value:function(){var t=this;return this.getAllEdges().forEach((function(e){t.deleteEdge(e),e.reverse(),t.addEdge(e)})),this}},{key:"getVerticesIndices",value:function(){var t={};return this.getAllVertices().forEach((function(e,n){t[e.getKey()]=n})),t}},{key:"getAdjacencyMatrix",value:function(){var t=this,e=this.getAllVertices(),n=this.getVerticesIndices(),r=Array(e.length).fill(null).map((function(){return Array(e.length).fill(1/0)}));return e.forEach((function(e,a){e.getNeighbors().forEach((function(i){var o=n[i.getKey()];r[a][o]=t.findEdge(e,i).weight}))})),r}},{key:"toString",value:function(){return Object.keys(this.vertices).toString()}}]),t}(),Bo=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;m()(this,t),this.value=e,this.next=n}return y()(t,[{key:"toString",value:function(t){return t?t(this.value):"".concat(this.value)}}]),t}(),Do=function(){function t(e){m()(this,t),this.compare=e||t.defaultCompareFunction}return y()(t,[{key:"equal",value:function(t,e){return 0===this.compare(t,e)}},{key:"lessThan",value:function(t,e){return this.compare(t,e)<0}},{key:"greaterThan",value:function(t,e){return this.compare(t,e)>0}},{key:"lessThanOrEqual",value:function(t,e){return this.lessThan(t,e)||this.equal(t,e)}},{key:"greaterThanOrEqual",value:function(t,e){return this.greaterThan(t,e)||this.equal(t,e)}},{key:"reverse",value:function(){var t=this.compare;this.compare=function(e,n){return t(n,e)}}}],[{key:"defaultCompareFunction",value:function(t,e){return t===e?0:t<e?-1:1}}]),t}(),No=function(){function t(e){m()(this,t),this.head=null,this.tail=null,this.compare=new Do(e)}return y()(t,[{key:"prepend",value:function(t){return this.head=new Bo(t,this.head),this}},{key:"append",value:function(t){var e=new Bo(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)}},{key:"delete",value:function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare.equal(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare.equal(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare.equal(this.tail.value,t)&&(this.tail=n),e}},{key:"find",value:function(t){var e=t.value,n=void 0===e?void 0:e,r=t.callback,a=void 0===r?void 0:r;if(!this.head)return null;for(var i=this.head;i;){if(a&&a(i.value))return i;if(void 0!==n&&this.compare.equal(i.value,n))return i;i=i.next}return null}},{key:"deleteTail",value:function(){if(this.head===this.tail){var t=this.tail;return this.head=null,this.tail=null,t}for(var e=this.tail,n=this.head;n.next;)n.next.next?n=n.next:n.next=null;return this.tail=n,e}},{key:"deleteHead",value:function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t}},{key:"toArray",value:function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t}},{key:"toString",value:function(t){return this.toArray().map((function(e){return e.toString(t)})).toString()}}]),t}(),_o=function(){function t(e){if(m()(this,t),void 0===e)throw new Error("Graph vertex must have a value");this.value=e,this.edges=new No((function(t,e){return t.getKey()===e.getKey()?0:t.getKey()<e.getKey()?-1:1}))}return y()(t,[{key:"addEdge",value:function(t){return this.edges.append(t),this}},{key:"deleteEdge",value:function(t){this.edges.delete(t)}},{key:"getNeighbors",value:function(){var t=this;return this.edges.toArray().map((function(e){return e.value.startVertex===t?e.value.endVertex:e.value.startVertex}))}},{key:"getEdges",value:function(){return this.edges.toArray().map((function(t){return t.value}))}},{key:"getDegree",value:function(){return this.edges.toArray().length}},{key:"hasEdge",value:function(t){return!!this.edges.find({callback:function(e){return e===t}})}},{key:"hasNeighbor",value:function(t){return!!this.edges.find({callback:function(e){return e.startVertex===t||e.endVertex===t}})}},{key:"findEdge",value:function(t){var e=this.edges.find({callback:function(e){return e.startVertex===t||e.endVertex===t}});return e?e.value:null}},{key:"getKey",value:function(){return this.value}},{key:"deleteAllEdges",value:function(){var t=this;return this.getEdges().forEach((function(e){return t.deleteEdge(e)})),this}},{key:"toString",value:function(t){return t?t(this.value):"".concat(this.value)}}]),t}(),Io=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;m()(this,t),this.startVertex=e,this.endVertex=n,this.weight=r}return y()(t,[{key:"getKey",value:function(){var t=this.startVertex.getKey(),e=this.endVertex.getKey();return"".concat(t,"_").concat(e)}},{key:"reverse",value:function(){var t=this.startVertex;return this.startVertex=this.endVertex,this.endVertex=t,this}},{key:"toString",value:function(){return this.getKey()}}]),t}(),To=Object.freeze({__proto__:null,Graph:Lo,Vertex:_o,Edge:Io,LinkedList:No});function Fo(t){return t.getNeighbors().filter((function(t){return!0!==t.visited}))}function zo(t){var e,n={};for(e=0;e<t.length;e++){var r=t[e],a=bo(r.x1,r.y1,r.x2,r.y2).string;if(n[a])"ray"===r.type&&(n[a].type="straight"),t[e]=null;else{n[a]=r;var i,o=fo(r.x1,r.y1,r.x2,r.y2);i=r.x1===r.x2?r.x1:r.y1===r.y2?r.y1:r.y1-(r.y2-r.y1)/(r.x2-r.x1)*r.x1,r.k=o,r.b=i,r.intersections=[]}}return(t=t.filter((function(t){return t}))).sort((function(t,e){return t.b-e.b})),t}function qo(t){var e,n,r=an(t=zo(t),"k"),a=[];for(e=0;e<r.length;e++){var i=r[e],o=function(){var t=r[n];i.forEach((function(e){t.forEach((function(t){var n=po(e.x1,e.y1,e.x2,e.y2,t.x1,t.y1,t.x2,t.y2);("ray"!==e.type||Co(e,n))&&("ray"!==t.type||Co(t,n))&&(e.intersections.push(n),t.intersections.push(n),n.index=a.length,a.push(n))}))}))};for(n=e+1;n<r.length;n++)o()}var c=new Lo,l=a.map((function(t,e){var n=new _o(e);return Object.assign(n,t),n})),s=[];for(e=0;e<t.length;e++){var u=t[e];for(n=0;n<u.intersections.length;n++){var d=u.intersections[n],h=u.intersections[n+1];h&&s.push(new Io(l[d.index],l[h.index]))}}return l.forEach((function(t){c.addVertex(t)})),s.forEach((function(t){c.addEdge(t)})),c}function Yo(t,e,n,r){e=t.snap(e),n=t.snap(n);var a,i,o=e,c=Fo(o),l=[o];for(o.visited=!0,o.distance=0;c.length>0;){a=-1/0,i=void 0;for(var s=0;s<c.length;s++){var u=c[s];if(u.from=o,!u.visited){u.distance=wo(o.x,o.y,u.x,u.y)+o.distance;var d=r(u,e,n);d>a&&(i=u,a=d)}}if(i&&(c=Fo(o=i),l.push(o),o.visited=!0,o===n))break}return l}function Ho(t,e){var n,r,a=t.getTotalLength();if(0===a)return{point:{x:0,y:0},percentage:0};var i,o,c,l,s=8,u=0,d=1/0;for(c=0;c<=a;c+=s)(l=e((o=t.getPointAtLength(c)).x,o.y))<d&&(d=l,u=c,i=o);for(s/=2;s>.5;){var h=u-s,f=t.getPointAtLength(h),p=e(f.x,f.y);if(h>=0&&p<d)i=f,u=h,d=p;else{var m=u+s,v=t.getPointAtLength(m),y=e(v.x,v.y);y>=0&&y<d?(i=v,u=m,d=y):s/=2}}return{point:{x:(null===(n=i)||void 0===n?void 0:n.x)||0,y:(null===(r=i)||void 0===r?void 0:r.y)||0},percentage:u/a}}var Go=Object.freeze({__proto__:null,deepTreeTraversal:Ve,deepTreeTraversalWithoutSelf:Ze,breadthTreeTraversal:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.children},r=[];for(r.unshift(t);0!==r.length;){var a=r.shift();if(a){e(a);var i=n(a);if(i)for(var o=0;o<i.length;o++)r.push(i[o])}}},normolizeR:to,toDegree:eo,centerPoint:function(t,e){return t=zi(t),e=zi(e),{x:(t.x+e.x)/2,y:(t.y+e.y)/2}},toRadian:no,pointRotateByPoint:function(t,e,n){t=zi(t),e=zi(e);var r=[t.x-e.x,t.y-e.y],a=[0,0];return w.vec2.rotate(a,r,[0,0],no(n)),{x:a[0]+e.x,y:a[1]+e.y}},computeWidthByHW:function(t,e){var n=no(to(t.r));return(e-t.h*Math.abs(Math.cos(Math.PI/2-n)))/Math.abs(Math.cos(n))},roughlyEqual:ro,roughlyArrayEqual:ao,roughlyDeepEqual:function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;if(Array.isArray(e)&&Array.isArray(n))return e.length===n.length&&e.every((function(e,a){return t(e,n[a],r)}));if(A()(e)&&A()(n)){for(var a=0,i=Object.keys(e);a<i.length;a++){var o=i[a];if(!t(e[o],n[o],r))return!1}return!0}return ro(e,n,r)},rectContainRect:io,rectIntersectRect:oo,lineSlope:co,lineDistance:lo,computeXYOffset:so,findThridPoint:uo,lineRadian:ho,lineIntercept:fo,lineIntersection:po,manhattanDistance:mo,isBetween:vo,isEqlPoint:yo,lineSegmentIntersect:go,getLineEquation:bo,lineSegmentIntersectRect:xo,pointInLine:ko,pointToPointDistance:wo,isInRay:Co,clockwiseAngle:Ao,radialQuadrantSegmentationGenerator:Oo,normalize2D:function(t){var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[1/e*t[0],1/e*t[1]]},getOffset:function(t,e){return Math.max(Math.max(Math.abs(Math.abs(t[0])-Math.abs(e[0])),Math.abs(Math.abs(t[1])-Math.abs(e[1])))/3,4)},isPointLiesLineRight:Eo,isPointInRect:Po,intersectingAreaOfTwoRects:So,rotateByPoint:Mo,getMidPointsFromQuadraticBezierPath:jo,calculateLine:zo,linesToGraph:qo,snapPoint:function(t,e){for(var n={vertex:void 0,distance:1/0},r=t.getAllVertices(),a=0;a<r.length;a++){var i=r[a];if(i.x===e.x&&i.y===e.y)return i;var o=mo(i.x,i.y,e.x,e.y);o<n.distance&&(n.vertex=i,n.distance=o)}return n.vertex},pathFinding:Yo,binaryFindPoint:Ho});function Xo(t,e,n,r){var a=e.split(".");if(!a.reduce((function(t,e){return t&&t[e]}),t)||r)for(var i=a.length,o=0;o<i;o++){var c=a[o];o===i-1?t[c]=n:(d()(t[c])||(t[c]={}),t=t[c])}}var Wo=function(t){return!!t.type&&"line"===t.type},Vo=function(t){return!!t.type&&("freehand"===t.type||"pen"===t.type)},Zo=function(t){return!!t.type&&"dsl"===t.type},Uo=function(t){return!!t.type&&"geometry"===t.type},Ko=function(t){return!!t.type&&"stack"===t.type},Qo=function(t){return!!t.type&&"swimlane"===t.type},$o=function(t){return!!t.type&&"text"===t.type};var Jo=[{name:"rect",category:"basic",width:100,height:100,outline:{name:"polygon",points:[{x:0,y:0},{x:100,y:0},{x:100,y:100},{x:0,y:100}]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,23.6],["C",24,23.8209139,23.8209139,24,23.6,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"rounded-rect",category:"basic",width:100,height:100,round:10,outline:{path:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t/2,i=e/2,o=Math.min(t,e);r>=o/2&&(r=o/2);var c=a<r?a:r,l=i<r?i:r;return[["M",+c+0,0],["l",t-2*c,0],["a",c,l,0,0,1,c,l],["l",0,e-2*l],["a",c,l,0,0,1,-c,l],["l",2*c-t,0],["a",c,l,0,0,1,-c,-l],["l",0,2*l-e],["a",c,l,0,0,1,c,-l],["z"]]}},scene:[],thumb:[{d:[["M",11,8],["L",21,8],["C",22.6568542,8,24,9.3431458,24,11],["L",24,21],["C",24,22.6568542,22.6568542,24,21,24],["L",11,24],["C",9.3431458,24,8,22.6568542,8,21],["L",8,11],["C",8,9.3431458,9.3431458,8,11,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"triangle",category:"basic",width:100,height:87,outline:{name:"polygon",points:[{x:50,y:0},{x:100,y:87},{x:-141931921e-23,y:87}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:8},{x:25,y:24},{x:7,y:24}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:1},{x:1,y:1}]},{name:"cross",category:"basic",width:80,height:80,outline:{d:[["M",56,0],["C",57.1045695,-0,58,.8954305,58,2],["L",58,22],["L",78,22],["C",79.1045695,22,80,22.8954305,80,24],["L",80,56],["C",80,57.1045695,79.1045695,58,78,58],["L",58,58],["L",58,78],["C",58,79.1045695,57.1045695,80,56,80],["L",24,80],["C",22.8954305,80,22,79.1045695,22,78],["L",22,57.999],["L",2,58],["C",.8954305,58,0,57.1045695,0,56],["L",0,24],["C",0,22.8954305,.8954305,22,2,22],["L",22,21.999],["L",22,2],["C",22,.8954305,22.8954305,0,24,0],["L",56,0],["Z"]]},scene:[],thumb:[{d:[["M",18.8909091,7],["C",19.5536508,7,20.0909091,7.5372583,20.0909091,8.2],["L",20.09,11.909],["L",23.8,11.9090909],["C",24.4627417,11.9090909,25,12.4463492,25,13.1090909],["L",25,18.8909091],["C",25,19.5536508,24.4627417,20.0909091,23.8,20.0909091],["L",20.09,20.09],["L",20.0909091,23.8],["C",20.0909091,24.4627417,19.5536508,25,18.8909091,25],["L",13.1090909,25],["C",12.4463492,25,11.9090909,24.4627417,11.9090909,23.8],["L",11.909,20.09],["L",8.2,20.0909091],["C",7.5372583,20.0909091,7,19.5536508,7,18.8909091],["L",7,13.1090909],["C",7,12.4463492,7.5372583,11.9090909,8.2,11.9090909],["L",11.909,11.909],["L",11.9090909,8.2],["C",11.9090909,7.5372583,12.4463492,7,13.1090909,7],["L",18.8909091,7],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"cloud",category:"basic",width:112,height:80,outline:{d:[["M",20.6665465,28.3657378],["C",9.0184823,12.0418488,29.8104362,1.5251218,41.8853768,16.5362653],["C",41.1592489,-4.3380418,87.3193529,-8.1490155,88.6486324,20.930009],["C",103.875914,12.7155897,116.726702,29.8609474,101.339386,39.434501],["C",122.97831,47.5058532,108.447103,73.4138921,86.4692273,64.7475232],["C",86.3334719,64.958338,86.1921896,65.1661294,86.0455508,65.3708699],["C",81.9792975,83.9250756,49.2991196,84.5216854,42.2982472,68.9125048],["C",27.3426857,79.041314,7.4780067,68.88778,15.843504,56.1252668],["C",-8.1440256,55.1167183,-3.5710215,23.0030303,20.6665465,28.3657378],["Z"]]},scene:[],thumb:[{d:[["M",9.0595002,13.6731476],["C",6.7714876,10.4083698,10.8556214,8.3050244,13.2274847,11.3072531],["C",13.0848525,7.1323916,22.1520157,6.3701969,22.4131242,12.1860018],["C",25.4041974,10.5431179,27.9284594,13.9721895,24.9059508,15.8869002],["C",29.1564537,17.5011706,26.3021096,22.6827784,21.9850268,20.9495046],["C",21.9583605,20.9916676,21.9306087,21.0332259,21.9018046,21.074174],["C",21.1030763,24.7850151,14.6837556,24.9043371,13.3085843,21.782501],["C",10.3708847,23.8082628,6.4688942,21.777556,8.1121169,19.2250534],["C",3.4002807,19.0233437,4.2985494,12.6006061,9.0595002,13.6731476],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"pentagon-arrow",category:"basic",width:120,height:50,textarea:{region:function(t,e){var n=e/50*25;return n>=t?{minX:4,minY:4,maxX:t-4,maxY:e-4}:{minX:4,minY:4,maxX:t-n/2-4,maxY:e-4}}},outline:{path:function(t,e){var n=e/50*25;return n>=t?[["M",0,0],["L",t,e/2],["L",0,e],["Z"]]:[["M",0,0],["L",t-n,0],["L",t,e/2],["L",t-n,e],["L",0,e],["Z"]]}},scene:[],thumb:[{d:[["M",7.4,10],["L",18.8343146,10],["C",18.9404012,10,19.0421427,10.0421427,19.1171573,10.1171573],["L",25,16],["L",25,16],["L",19.1171573,21.8828427],["C",19.0421427,21.9578573,18.9404012,22,18.8343146,22],["L",7.4,22],["C",7.1790861,22,7,21.8209139,7,21.6],["L",7,10.4],["C",7,10.1790861,7.1790861,10,7.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"process-arrow",category:"basic",width:120,height:50,textarea:{region:function(t,e){var n=e/50*25;return n>=t?{minX:4,minY:4,maxX:t-4,maxY:e-4}:{minX:n+4,minY:4,maxX:t-n/2-4,maxY:e-4}}},outline:{path:function(t,e){var n=e/50;return 25*n>=t?[["M",0,0],["L",t,e/2],["L",0,e]]:[["M",0,0],["L",t-25*n,0],["L",t,e/2],["L",t-25*n,e],["L",0,e],["L",25*n,e/2],["L",0,0],["Z"]]}},scene:[],thumb:[{d:[["M",19.9439083,10],["C",20.0481092,10,20.1480423,10.0421427,20.2217235,10.1171573],["L",26,16],["L",20.2217235,21.8828427],["C",20.1480423,21.9578573,20.0481092,22,19.9439083,22],["L",6.3928901,22],["C",6.1759029,22,6,21.8209139,6,21.6],["C",6,21.4939134,6.0413937,21.3921718,6.1150748,21.3171573],["L",11.3377208,16],["L",6.1150748,10.6828427],["C",5.9616417,10.526633,5.9616417,10.273367,6.1150748,10.1171573],["C",6.188756,10.0421427,6.2886892,10,6.3928901,10],["L",19.9439083,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-1",category:"basic",width:100,height:80,textarea:{region:function(t,e){var n=e/80*50;return n>=t?{minX:4,minY:4,maxX:t-4,maxY:e-4}:{minX:n/2,minY:.25*e+4,maxX:t-4,maxY:.75*e-4}}},outline:{path:function(t,e){var n=e/80*50;return n>=t?[["M",t,0],["L",0,e/2],["L",t,e],["Z"]]:[["M",n,e/4],["L",n,0],["L",0,e/2],["L",n,e],["L",n,3*e/4],["L",t,3*e/4],["L",t,e/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.2620321,y:7.99867328},{x:7,y:15.9997347},{x:16.2620321,y:23.9986733},{x:16.2620321,y:19.9277347},{x:25.7357163,y:19.9277347},{x:25.7357163,y:12.1917347},{x:16.2620321,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-2",category:"basic",width:100,height:80,textarea:{region:function(t,e){var n=e/80*50;return n>=t?{minX:4,minY:4,maxX:t-4,maxY:e-4}:{minX:4,minY:.25*e+4,maxX:t-n/2,maxY:.75*e-4}}},outline:{path:function(t,e){var n=e/80;return 50*n>=t?[["M",0,0],["L",t,e/2],["L",0,e],["Z"]]:[["M",t-50*n,e/4],["L",t-50*n,0],["L",t,e/2],["L",t-50*n,e],["L",t-50*n,3*e/4],["L",0,3*e/4],["L",0,e/4],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:16.4736842,y:7.99867328},{x:25.7357163,y:15.9997347},{x:16.4736842,y:23.9986733},{x:16.4736842,y:19.9277347},{x:7,y:19.9277347},{x:7,y:12.1917347},{x:16.4736842,y:12.1917347}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"arrow-3",category:"basic",width:138,height:80,textarea:{region:function(t,e){var n=e/80*46;return 2*n>=t?{minX:4,minY:4,maxX:t-4,maxY:e-4}:{minX:n/2,minY:.3125*e+4,maxX:t-4-n/2,maxY:.6875*e-4}}},outline:{path:function(t,e){var n=.3125,r=.6875,a=e/80*46;return 2*a>=t?[["M",t/2,0],["L",0,e/2],["L",t/2,e],["L",t,e/2],["Z"],["M",t/2,0],["L",t/2,e*n],["M",t/2,e],["L",t/2,e*r]]:[["M",t-a,n*e],["L",t-a,0],["L",t,e/2],["L",t-a,e],["L",t-a,e*r],["L",a,e*r],["L",a,e],["L",0,e/2],["L",a,0],["L",a,e*n],["Z"]]}},scene:[],thumb:[{name:"polygon",points:[{x:19.8639344,y:8},{x:27.109397,y:16},{x:19.8639344,y:24},{x:19.8639344,y:19.1800649},{x:12.5968509,y:19.1800649},{x:12.5968509,y:24},{x:5.10939702,y:16.0010614},{x:12.5968509,y:8},{x:12.5968509,y:12.9324943},{x:19.8639344,y:12.9324943}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"circle",category:"basic",width:100,height:100,outline:{name:"ellipse",cx:50,cy:50,rx:50,ry:50},scene:[],thumb:[{name:"ellipse",cx:16,cy:16.5333333,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment-2",category:"basic",width:120,height:100,controlPoints:[[.25,.75],[.25,1],[.5,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],textarea:{region:function(t,e,n){return{minX:4,minY:4,maxX:t-4,maxY:Je(n[0][1],0,1)*e-4}}},outline:{path:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.25,.75],[.25,1],[.5,.75]]).map((function(n){return[Je(n[0],0,1)*t,Je(n[1],0,1)*e]})),r=Math.min(t/2,e/2,8,n[0][1]/2,n[0][0]/2,(t-n[2][0])/2);return[["M",r,0],["l",t-2*r,0],["a",r,r,0,0,1,r,r],["l",0,n[0][1]-2*r],["a",r,r,0,0,1,-r,r],["L",n[2][0],n[2][1]],["L",n[1][0],n[1][1]],["L",n[0][0],n[0][1]],["l",r-n[0][0],0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-n[0][1]],["a",r,r,0,0,1,r,-r],["Z"]]}},scene:[],thumb:[{d:[["M",10,9],["L",22,9],["C",23.6568542,9,25,10.3431458,25,12],["L",25,18.700459],["C",25,20.3573132,23.6568542,21.700459,22,21.700459],["L",15.4989962,21.700459],["L",15.4989962,21.700459],["L",10.5156524,25.2421473],["L",10.5156524,21.7],["L",10,21.7],["C",8.3431458,21.7,7,20.3568542,7,18.7],["L",7,12],["C",7,10.3431458,8.3431458,9,10,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"comment",category:"basic",width:120,height:100,controlPoints:[[.4,.75],[.5,1],[.6,.75]],controlPointsConfig:[{x:{proportional:["2"]},y:{proportional:["2"]}},{x:{},y:{limit:!0}},{x:{limit:["0",1]},y:{limit:!0}}],outline:{path:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.4,.75],[.5,1],[.6,.75]]).map((function(n){return[Je(n[0],0,1)*t,Je(n[1],0,1)*e]}));return[["M",0,0],["L",0,n[0][1]],["L",n[0][0],n[0][1]],["L",n[1][0],n[1][1]],["L",n[2][0],n[2][1]],["L",t,n[2][1]],["L",t,0],["Z"]]}},scene:[],thumb:[{d:[["M",7,22],["C",6.4477153,22,6,21.5522847,6,21],["L",6,10],["C",6,9.4477153,6.4477153,9,7,9],["L",25,9],["C",25.5522847,9,26,9.4477153,26,10],["L",26,21],["C",26,21.5522847,25.5522847,22,25,22],["L",18,22],["L",16,25],["L",14,22],["L",7,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],textarea:{region:function(t,e,n){return{minX:4,minY:4,maxX:t-4,maxY:Je(n[0][1],0,1)*e-4}}}},{name:"diamond",category:"basic",width:100,height:100,outline:{d:[["M",50.5029462,.2083271],["L",99.7916729,49.4970538],["C",100.069442,49.7748233,100.069442,50.2251767,99.7916729,50.5029462],["L",50.5029462,99.7916729],["C",50.2251767,100.069442,49.7748233,100.069442,49.4970538,99.7916729],["L",.2083271,50.5029462],["C",-.0694424,50.2251767,-.0694424,49.7748233,.2083271,49.4970538],["L",49.4970538,.2083271],["C",49.7748233,-.0694424,50.2251767,-.0694424,50.5029462,.2083271],["Z"]]},scene:[],thumb:[{d:[["M",16.2852309,7.0928427],["L",24.9119336,15.7195454],["C",25.0681433,15.8757552,25.0681433,16.1290212,24.9119336,16.2852309],["L",16.2852309,24.9119336],["C",16.1290212,25.0681433,15.8757552,25.0681433,15.7195454,24.9119336],["L",7.0928427,16.2852309],["C",6.936633,16.1290212,6.936633,15.8757552,7.0928427,15.7195454],["L",15.7195454,7.0928427],["C",15.8757552,6.936633,16.1290212,6.936633,16.2852309,7.0928427],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"parallelogram",category:"basic",width:160,height:80,controlPoints:[[.1875,.25]],controlPointsConfig:[{x:{limit:[0,.75]},y:{limit:!0}}],outline:{path:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.1875,.25]]).map((function(n){return[Je(n[0],0,1)*t,Je(n[1],0,1)*e]}));return[["M",4*n[0][0]/3,0],["L",0,e],["L",t-4*n[0][0]/3,e],["L",t,0],["Z"]]}},scene:[],thumb:[{d:[["M",11.2637585,9],["L",26.3933844,9],["C",26.6142983,9,26.7933844,9.1790861,26.7933844,9.4],["C",26.7933844,9.4541707,26.7823813,9.507777,26.7610424,9.5575677],["L",21.1038995,22.7575677],["C",21.040868,22.9046413,20.8962528,23,20.7362415,23],["L",5.6066156,23],["C",5.3857017,23,5.2066156,22.8209139,5.2066156,22.6],["C",5.2066156,22.5458293,5.2176187,22.492223,5.2389576,22.4424323],["L",10.8961005,9.2424323],["C",10.959132,9.0953587,11.1037472,9,11.2637585,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"star",category:"basic",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:75},{x:18.6107374,y:91},{x:24.2235871,y:57.7254249},{x:0,y:34.5491503},{x:33.3053687,y:29.7745751},{x:48,y:0},{x:62.6946313,y:29.7745751},{x:96,y:34.5491503},{x:71.7764129,y:57.7254249},{x:77.3892626,y:91}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:21},{x:10.1221475,y:24.0901699},{x:11.2447174,y:17.545085},{x:6.48943484,y:12.9098301},{x:13.0610737,y:11.954915},{x:16,y:6},{x:18.9389263,y:11.954915},{x:25.5105652,y:12.9098301},{x:20.7552826,y:17.545085},{x:21.8778525,y:24.0901699}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:0,y:.38},{x:1,y:.38},{x:18.6107374/96,y:1},{x:77.3892626/96,y:1}]},{name:"trapezoid",category:"basic",width:140,height:80,controlPoints:[[.75,0]],controlPointsConfig:[{x:{limit:[.5,1]},y:{limit:!0}}],outline:{path:function(t,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[.75,0]]).map((function(n){return[Je(n[0],0,1)*t,Je(n[1],0,1)*e]}));return[["M",t-n[0][0],0],["L",n[0][0],0],["L",t,e],["L",0,e],["Z"]]}},scene:[],thumb:[{d:[["M",6.4000995,22],["L",25.3553854,22],["C",25.5762993,22,25.7553854,21.8209139,25.7553854,21.6],["C",25.7553854,21.5646094,25.7506887,21.5293754,25.7414182,21.4952206],["L",22.7014434,10.2952206],["C",22.6541459,10.120965,22.4959711,10,22.3154107,10],["L",9.4095965,10],["C",9.228659,10,9.0702525,10.1214609,9.0232992,10.2962],["L",6.0138022,21.4962],["C",5.956475,21.709546,6.0829534,21.9289701,6.2962994,21.9862972],["C",6.3301496,21.995393,6.3650485,22,6.4000995,22],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],tc=[{name:"collate",category:"flowchart",width:42,height:36,textarea:{region:$i},outline:{d:[["M",40.3837262,0],["C",40.6808145,0,40.9625216,.132096,41.1525116,.3604931],["C",41.478533,.7524209,41.4542938,1.3198118,41.1146853,1.6825771],["L",41.0232331,1.7687854],["L",20.9996243,18.0064637],["L",41.0232331,34.2312146],["C",41.2190021,34.3940632,41.3440192,34.6242958,41.3757431,34.8738407],["L",41.3837518,35],["C",41.3837518,35.5128358,40.997686,35.9355072,40.5003473,35.9932723],["L",40.3837262,36],["L",1.9253140000000002,36],["C",1.6282257999999992,36,1.3465187000000007,35.867904,1.1565287000000009,35.6395069],["C",.8305071999999996,35.2475791,.8547464999999992,34.6801882,1.1943549999999998,34.317423],["L",1.2858070999999995,34.2312146],["L",20.9996243,18.0064637],["L",1.2858070999999995,1.7687854],["C",1.0900382000000004,1.6059368,.9650210999999995,1.3757042,.9332972000000002,1.1261593],["L",.9252885000000006,1],["C",.9252885000000006,.4871642,1.3113542000000002,.0644928,1.8086929000000005,.0067277],["L",1.9253140000000002,0],["L",40.3837262,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6671476,9],["C",23.787916,9,23.9022194,9.0545637,23.9781629,9.1484658],["C",24.1170814,9.3202349,24.0904508,9.5720969,23.9186817,9.7110154],["L",23.9186817,9.7110154],["L",16.142839,16],["L",23.9186817,22.2889846],["C",23.9938034,22.3497394,24.0437485,22.4350446,24.0607217,22.5285699],["L",24.0671476,22.6],["C",24.0671476,22.8209139,23.8880615,23,23.6671476,23],["L",23.6671476,23],["L",8.3328524,23],["C",8.212084,23,8.0977806,22.9454363,8.0218371,22.8515342],["C",7.8829186,22.6797651,7.9095492,22.4279031,8.0813183,22.2889846],["L",8.0813183,22.2889846],["L",15.856839,16],["L",8.0813183,9.7110154],["C",8.0061966,9.6502606,7.9562515,9.5649554,7.9392783,9.4714301],["L",7.9328524,9.4],["C",7.9328524,9.1790861,8.1119385,9,8.3328524,9],["L",8.3328524,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.02,name:"NW"},{x:0,y:.98,name:"SW"},{x:1,y:.02,name:"NE"},{x:1,y:.98,name:"SE"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"connector",category:"flowchart",width:44,height:44,textarea:{region:$i},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:9,ry:9}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"data",category:"flowchart",width:124,height:60,textarea:{region:function(t,e){return{minX:.15*t,minY:4,maxX:t-.15*t-4,maxY:e-4}}},outline:{d:[["M",17.1403103,0],["L",122.687657,0],["C",123.239942,-0,123.687657,.4477153,123.687657,1],["C",123.687657,1.0896438,123.675604,1.1788806,123.65182,1.2653118],["L",107.823852,58.7853118],["C",107.704434,59.2192873,107.309796,59.52,106.85969,59.52],["L",1.3123427,59.52],["C",.7600579,59.52,.3123427,59.0722847,.3123427,58.52],["C",.3123427,58.4303562,.3243965,58.3411194,.34818,58.2546882],["L",16.1761477,.7346882],["C",16.2955661,.3007127,16.6902043,-0,17.1403103,0],["Z"]]},scene:[],thumb:[{d:[["M",7.6068779,10],["L",27.4750629,10],["C",27.6959768,10,27.8750629,10.1790861,27.8750629,10.4],["C",27.8750629,10.4358575,27.8702414,10.4715522,27.860728,10.5061247],["L",24.7787871,21.7061247],["C",24.7310198,21.8797149,24.5731645,22,24.3931221,22],["L",4.5249371,22],["C",4.3040232,22,4.1249371,21.8209139,4.1249371,21.6],["C",4.1249371,21.5641425,4.1297586,21.5284478,4.139272,21.4938753],["L",7.2212129,10.2938753],["C",7.2689802,10.1202851,7.4268355,10,7.6068779,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.095,y:.5,name:"W"},{x:.905,y:.5,name:"E"},{x:.23,y:.02,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.77,y:.98,name:"SE"}]},{name:"database",category:"flowchart",width:70,height:80,textarea:{region:function(t,e){return{minX:4,minY:4+.2*e,maxX:t-4,maxY:e-4}}},outline:{d:[["M",35,0],["C",53.9753466,0,69.4238162,5.273994,69.9842524,11.8539517],["L",69.995311,11.8537712],["L",69.995311,12.022052],["L",70,12.2242015],["C",70,12.2917139,69.998433,12.3590985,69.995311,12.426351],["L",69.995311,67.977948],["C",69.6862333,74.6359505,54.1366666,80,35,80],["C",16.0547001,80,.6251167,74.7426951,.0185218,68.1772958],["L",.004689,67.977948],["L",0,11.8537712],["L",.0157476,11.8539517],["C",.5761838,5.273994,16.0246534,0,35,0],["Z"]]},scene:[{d:[["M",70,13],["C",70,19.0751322,54.3299662,24,35,24],["C",15.8633334,24,.3137667,19.1731371,.004689,13.1819051],["L",0,13]],attr:{fill:"transparent"}}],thumb:[{d:[["M",16,7],["C",20.337222099999998,7,23.8683009,8.1866487,23.9964006,9.6671391],["L",23.9989282,9.6670985],["L",23.9989282,9.7049617],["L",24,9.750445299999999],["C",24,9.7656356,23.9996418,9.7807972,23.9989282,9.795929000000001],["L",23.9989282,22.2950383],["C",23.9282819,23.7930889,20.3740952,25,16,25],["C",11.6696457,25,8.1428838,23.8171064,8.0042336,22.3398916],["L",8.0010718,22.2950383],["L",8,9.6670985],["L",8.0035994,9.6671391],["C",8.1316991,8.1866487,11.6627779,7,16,7],["Z"]]},{d:[["M",24,10],["C",24,11.1045695,20.418278,12,16,12],["C",11.6259048,12,8.0717181,11.1223886,8.0010718,10.0330737],["L",8,10]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.15,name:"NW"},{x:0,y:.85,name:"SW"},{x:1,y:.15,name:"NE"},{x:1,y:.85,name:"SE"}]},{name:"decision",category:"flowchart",width:140,height:70,textarea:{region:function(t,e){return{minX:24,minY:1/8*e,maxX:t-24,maxY:7/8*e}}},outline:{name:"polygon",points:[{x:70,y:0},{x:140,y:35},{x:70,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",5.5303015,15.6625354],["L",15.7852498,9.1366592],["C",15.9162764,9.0532787,16.0837236,9.0532787,16.2147502,9.1366592],["L",26.4696985,15.6625354],["C",26.656075,15.7811387,26.7110162,16.0283736,26.5924129,16.2147502],["C",26.5609814,16.2641425,26.5190908,16.3060331,26.4696985,16.3374646],["L",16.2147502,22.8633408],["C",16.0837236,22.9467213,15.9162764,22.9467213,15.7852498,22.8633408],["L",5.5303015,16.3374646],["C",5.343925,16.2188613,5.2889839,15.9716264,5.4075871,15.7852498],["C",5.4390186,15.7358575,5.4809092,15.6939669,5.5303015,15.6625354],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"delay",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){return{minX:4,minY:4,maxX:.81*t,maxY:e-4}}},outline:{d:[["M",1,0],["L",90,0],["C",106.568542,-0,120,13.4314575,120,30],["C",120,46.5685425,106.568542,60,90,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,11.0666667],["L",20,11.0666667],["C",23.3137085,11.0666667,26,13.7529582,26,17.0666667],["C",26,20.3803752,23.3137085,23.0666667,20,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,11.4666667],["C",6,11.2457528,6.1790861,11.0666667,6.4,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.81,y:0,name:"NE"},{x:.81,y:1,name:"SE"}]},{name:"display",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){return{minX:.15*t+4,minY:4,maxX:.9*t,maxY:e-4}}},outline:{d:[["M",18.559242,0],["L",108.388294,0],["C",108.593661,-124e-7,108.794047,.0632157,108.962224,.18108],["C",116.320741,5.3381999,120,15.2778399,120,30],["C",120,43.9124351,116.326183,53.8383306,108.978548,59.7776865],["C",108.800609,59.9215337,108.578719,60,108.349908,60],["L",18.559242,60],["C",18.2079174,60,17.8823628,59.8156369,17.70166,59.5143473],["L",.3084873,30.5143473],["C",.1185966,30.1977386,.1185966,29.8022614,.3084873,29.4856527],["L",17.70166,.4856527],["C",17.8823628,.1843631,18.2079174,0,18.559242,0],["Z"]]},scene:[],thumb:[{d:[["M",8.7974767,10],["L",24.1863956,10],["L",24.1863956,10],["C",25.6811795,11.0207233,26.4285714,13.0207233,26.4285714,16],["C",26.4285714,18.8174994,25.6811795,20.8174994,24.1863956,22],["L",8.7974767,22],["C",8.6564465,22,8.525838,21.9257329,8.4537242,21.8045343],["L",5.1216988,16.2045343],["C",5.0467021,16.0784903,5.0467021,15.9215097,5.1216988,15.7954657],["L",8.4537242,10.1954657],["C",8.525838,10.0742671,8.6564465,10,8.7974767,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.2,y:.14,name:"NW"},{x:.2,y:.86,name:"SW"},{x:.92,y:.14,name:"NE"},{x:.92,y:.86,name:"SE"}]},{name:"document",category:"flowchart",width:120,height:72,outline:{d:[["M",1,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,63.2943312],["C",119.999975,63.8466024,119.552271,64.2943066,119,64.2943066],["C",118.874051,64.2943066,118.749236,64.2705132,118.63212,64.2241781],["C",108.562735,60.240377,99.0186463,58.2432881,89.9998549,58.2329113],["C",75.8605271,58.216643,73.9215376,58.9595768,59.9999032,65.0379103],["C",46.0782688,71.1162438,44.1653018,71.9832913,29.9999516,72],["C",20.7325008,72.010162,10.9291929,69.6914094,.590028,65.0437423],["C",.2309588,64.882365,-0,64.5253236,0,64.1316572],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6,10],["L",26,10],["L",26,23.0414063],["C",24.237687,22.2996937,22.5710122,21.9279131,20.9999758,21.9260644],["C",18.6434212,21.9232914,18.3202563,22.0499279,15.9999839,23.0860074],["C",13.6797115,24.122087,13.3608836,24.2698792,11,24.2726331],["C",9.4260668,24.274461,7.7594002,23.864052,6,23.0414063],["L",6,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.9,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:0,y:.9,name:"SW"},{x:.98,y:.015,name:"NE"},{x:1,y:.9,name:"SE"}]},{name:"internal-storage",category:"flowchart",width:80,height:80,textarea:{region:function(t,e){return{minX:.1*t+4,minY:1/8*e+4,maxX:t-4,maxY:e-4}}},outline:{name:"rect",x:0,y:0,width:80,height:80,rx:0,ry:0},scene:[{d:[{name:"M",x:0,y:8},{name:"L",x:80,y:8}]},{d:[{name:"M",x:8,y:0},{name:"L",x:8,y:80}]}],thumb:[{name:"rect",x:8,y:8,width:17,height:17,rx:.4,ry:.4},{d:[{name:"M",x:8.5,y:12.5},{name:"L",x:24.5,y:12.5}]},{d:[{name:"M",x:12.5,y:8.5},{name:"L",x:12.5,y:24.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"loop-limit",category:"flowchart",width:120,height:60,outline:{d:[["M",17.5871195,0],["L",102.429999,0],["C",102.7204,-0,102.996458,.1262398,103.186409,.3459021],["L",119.75641,19.5077312],["C",119.913532,19.6894304,120,19.9216166,120,20.1618291],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1621158],["C",0,19.92173,.0865921,19.6893882,.2439196,19.5076371],["L",16.831039,.3455213],["C",17.0209853,.1260876,17.2968941,0,17.5871195,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,11.0666667],["L",22.4862374,11.0666667],["C",22.6043417,11.0666667,22.7164089,11.1188597,22.7924108,11.2092607],["L",25.9061734,14.9129485],["C",25.9667743,14.9850307,26,15.0761829,26,15.1703545],["L",26,22.6666667],["C",26,22.8875806,25.8209139,23.0666667,25.6,23.0666667],["L",6.4,23.0666667],["C",6.1790861,23.0666667,6,22.8875806,6,22.6666667],["L",6,15.1704681],["C",6,15.0762275,6.0332743,14.9850132,6.0939556,14.9129087],["L",9.210984,11.2091073],["C",9.286986,11.118798,9.3989942,11.0666667,9.5170283,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.15,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.9,y:.15,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-input",category:"flowchart",width:118,height:60,textarea:{region:function(t,e){return{minX:4,minY:e*(2/7)+4,maxX:t-4,maxY:e-4}}},outline:{d:[["M",.8676336,15.6420323],["L",116.867634,.1512179],["C",117.415059,.0781139,117.918097,.4626272,117.991201,1.0100523],["C",117.99706,1.0539311,118,1.0981505,118,1.1424188],["L",118,59],["C",118,59.5522847,117.552285,60,117,60],["L",1,60],["C",.4477152,60,0,59.5522847,0,59],["L",0,16.6332332],["C",0,16.1321084,.3709182,15.7083644,.8676336,15.6420323],["Z"]]},scene:[],thumb:[{d:[["M",6.3471791,12.618128],["L",25.5471791,10.0603243],["C",25.7661584,10.0311521,25.9673249,10.1850212,25.9964971,10.4040005],["C",25.9988298,10.4215108,26,10.4391564,26,10.4568214],["L",26,21.2666667],["C",26,21.4875806,25.8209139,21.6666667,25.6,21.6666667],["L",6.4,21.6666667],["C",6.1790861,21.6666667,6,21.4875806,6,21.2666667],["L",6,13.0146251],["C",6,12.8141269,6.1484367,12.6446042,6.3471791,12.618128],["Z"]]}],anchors:[{x:.5,y:.195,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"manual-loop",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){var n=.14*t;return{minX:n,minY:4,maxX:t-n,maxY:e-4}}},outline:{d:[["M",1.3143594,0],["L",118.682087,0],["C",119.234371,-0,119.682087,.4477153,119.682087,1],["C",119.682087,1.0910107,119.669662,1.1815953,119.645158,1.2692451],["L",103.43015,59.2692451],["C",103.309369,59.7012703,102.915669,60,102.467078,60],["L",17.3668015,60],["C",16.917245,60,16.5229467,59.7000072,16.4030326,59.2667387],["L",.3505905,1.2667387],["C",.2032748,.7344638,.5153458,.1835468,1.0476207,.0362311],["C",1.1344943,.0121874,1.2242199,-0,1.3143594,0],["Z"]]},scene:[],thumb:[{d:[["M",6.5216709,11.0666667],["L",25.4769568,11.0666667],["C",25.6978707,11.0666667,25.8769568,11.2457528,25.8769568,11.4666667],["C",25.8769568,11.5020572,25.8722601,11.5372913,25.8629896,11.5714461],["L",22.8230148,22.7714461],["C",22.7757173,22.9457017,22.6175425,23.0666667,22.4369821,23.0666667],["L",9.5311679,23.0666667],["C",9.3502305,23.0666667,9.1918239,22.9452058,9.1448706,22.7704667],["L",6.1353736,11.5704667],["C",6.0780465,11.3571206,6.2045248,11.1376966,6.4178708,11.0803694],["C",6.451721,11.0712737,6.4866199,11.0666667,6.5216709,11.0666667],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:.1,y:.5,name:"W"},{x:.9,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.22,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.78,y:.985,name:"SE"}]},{name:"merge",category:"flowchart",width:50,height:36,textarea:{region:$i},outline:{d:[["M",48.9094474,1.5703958],["L",25.82137,34.8172272],["C",25.5063491,35.2708574,24.883234299999998,35.3832223,24.4296042,35.0682014],["C",24.3316502,35.0001778,24.246653600000002,34.9151812,24.17863,34.8172272],["L",1.0905526000000005,1.5703958],["C",.7755317000000002,1.1167657,.8878967000000006,.4936509,1.3415268000000005,.17863],["C",1.5090014000000007,.0623282,1.7080259000000009,0,1.9119226000000005,0],["L",48.0880774,0],["C",48.6403621,0,49.0880774,.4477153,49.0880774,1],["C",49.0880774,1.2038967,49.0257492,1.4029212,48.9094474,1.5703958],["Z"]]},scene:[],thumb:[{d:[["M",25.5482177,9.6324953],["L",16.3254934,22.5443093],["C",16.1970898,22.7240743,15.9472698,22.765711,15.7675047,22.6373074],["C",15.7315865,22.6116515,15.7001625,22.5802275,15.6745066,22.5443093],["L",6.4517823,9.6324953],["C",6.3233787,9.4527302,6.3650154,9.2029102,6.5447805,9.0745066],["C",6.6126207,9.0260493,6.6939065,9,6.7772757,9],["L",25.2227243,9],["C",25.4436382,9,25.6227243,9.1790861,25.6227243,9.4],["C",25.6227243,9.4833692,25.596675,9.564655,25.5482177,9.6324953],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:0,y:1,name:"SW"},{x:1,y:0,name:"NE"},{x:1,y:1,name:"SE"}]},{name:"multi-document",category:"flowchart",isClip:!1,width:120,height:80,textarea:{region:function(t,e){return{minX:4,minY:.2*e,maxX:11/12*t-4,maxY:.8*e}}},outline:{d:[["M",119,-0],["C",119.552285,-0,120,.4477153,120,1],["L",120,57.6634711],["C",120.00004,58.2157781,119.552307,58.6635113,119,58.6635113],["C",118.846121,58.6635113,118.694318,58.6280008,118.556406,58.5597438],["C",117.079303,57.8286782,115.893834,57.3066398,115,56.9936286],["L",114.744,56.868],["L",114.744526,63.1694166],["C",114.744553,63.7217167,114.296826,64.1694445,113.744526,64.1694445],["C",113.610972,64.1694445,113.478771,64.1426929,113.355724,64.0907684],["C",111.834645,63.4488877,110.620494,62.9604303,109.71327,62.6253962],["L",109.714286,71.1461039],["C",109.714249,71.6983687,109.26655,72.1460677,108.714286,72.1460677],["C",108.59377,72.1460677,108.474247,72.1242823,108.361482,72.0817624],["C",98.4971172,68.3622546,89.1471649,66.4976545,80.3116246,66.4879622],["C",66.4538962,66.4727606,64.5535237,67.1669765,50.9091531,72.8467226],["C",37.2647825,78.5264687,35.3899142,79.3366596,21.5066816,79.351889],["C",12.4628087,79.3615937,5.4112062,77.2136321,.351874,72.9080041],["C",.1286374,72.7179927,0,72.4396044,0,72.1464509],["L",0,11.7804604],["C",0,11.2281757,.4477153,10.7804604,1,10.7804604],["L",5.255,10.78],["L",5.2554745,6.3902302],["C",5.2554745,5.8379455,5.7031897,5.3902302,6.2554745,5.3902302],["L",10.51,5.39],["L",10.5109489,1],["C",10.5109489,.4477153,10.9586642,-0,11.5109489,-0],["L",119,-0],["Z"]]},scene:[{d:[["M",10,5.3902302],["L",113.744526,5.3902302],["C",114.29681,5.3902302,114.744526,5.8379455,114.744526,6.3902302],["L",114.744526,61.6827625],["L",114.744526,61.6827625]],attr:{fill:"transparent"}},{d:[["M",3,10.7804604],["L",108.714286,10.7804604],["C",109.26657,10.7804604,109.714286,11.2281757,109.714286,11.7804604],["L",109.714286,69.602221],["L",109.714286,69.602221]],attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4444444,10.4296499],["L",8.4444444,8],["L",28.4444444,8],["L",28.4444444,19.5606936],["C",28.0673004,19.4077004,26.2625497,18.3360173,25.8924529,18.2092979]]},{d:[["M",6.2222222,13.090719],["L",6.2222222,10.7555556],["L",25.4444444,10.7555556],["L",25.4444444,21.8666667],["C",25.0819671,21.7196232,23.3557041,21.1217914,23,21]]},{d:[["M",4.3333333,13.5111111],["L",22.3333333,13.5111111],["L",22.3333333,23.8011738],["C",20.6331063,23.1515551,19.0251483,22.8259361,17.5094592,22.824317],["C",15.2359257,22.8218883,14.9241458,22.9328011,12.6856163,23.8402371],["C",10.4470867,24.7476731,10.1394911,24.8771148,7.8617733,24.8795322],["C",6.3432947,24.8811295,5.1671481,24.5216767,4.3333333,23.8011738],["L",4.3333333,13.5111111],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:.88,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.08,y:.1,name:"NW"},{x:0,y:.91,name:"SW"},{x:.98,y:.02,name:"NE"},{x:.885,y:.91,name:"SE"}]},{name:"off-page",category:"flowchart",width:38,height:38,textarea:{region:$i},outline:{d:[["M",.3999999999999986,0],["L",37.6,0],["C",37.8209139,0,38,.1790861,38,.4],["L",38,19.0323398],["C",38,19.1391572,37.9572763,19.2415374,37.8813478,19.3166695],["L",19.2813478,37.7216028],["C",19.125486199999997,37.8758298,18.874513800000003,37.8758298,18.7186522,37.7216028],["L",.11865219999999965,19.3166695],["C",.04272369999999981,19.2415374,0,19.1391572,0,19.0323398],["L",0,.4],["C",0,.1790861,.17908609999999925,0,.3999999999999986,0],["Z"]]},scene:[],thumb:[{d:[["M",8.4,8],["L",23.6,8],["C",23.8209139,8,24,8.1790861,24,8.4],["L",24,15.9169777],["C",24,16.0237952,23.9572763,16.1261753,23.8813478,16.2013075],["L",16.2813478,23.7216028],["C",16.1254862,23.8758298,15.8745138,23.8758298,15.7186522,23.7216028],["L",8.1186522,16.2013075],["C",8.0427237,16.1261753,8,16.0237952,8,15.9169777],["L",8,8.4],["C",8,8.1790861,8.1790861,8,8.4,8],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:0,name:"NW"},{x:1,y:0,name:"NE"}]},{name:"or",category:"flowchart",width:44,height:44,textarea:{region:$i},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[{name:"M",x:0,y:21.5},{name:"L",x:44,y:21.5}]},{d:[{name:"M",x:21.5,y:0},{name:"L",x:21.5,y:44}]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",7,17],["L",25,17],["M",16,8],["L",16,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"parallel",category:"flowchart",width:120,height:40,outline:{name:"rect",x:0,y:0,width:120,height:40,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[{name:"M",x:120,y:40},{name:"L",x:0,y:40}]},{d:[{name:"M",x:0,y:0},{name:"L",x:120,y:0}]}],thumb:[{d:[["M",26,21],["L",6,21],["M",6,11],["L",26,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"polygon",width:96,height:91,outline:{name:"polygon",points:[{x:48,y:0},{x:95.5528258,y:34.5491503},{x:77.3892626,y:90.4508497},{x:18.6107374,y:90.4508497},{x:.44717419000000014,y:34.5491503}]},scene:[],thumb:[{name:"polygon",points:[{x:16,y:7},{x:24.5595086,y:13.2188471},{x:21.2900673,y:23.2811529},{x:10.7099327,y:23.2811529},{x:7.44049135,y:13.2188471}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"preparation",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){return{minX:1/6*t,minY:4,maxX:5/6*t,maxY:e-4}}},outline:{d:[["M",19.9840694,0],["L",99.6873184,0],["C",100.023525,-0,100.33723,.1689467,100.522259,.4496594],["L",119.639798,29.4535248],["C",119.858585,29.7854538,119.859975,30.2154564,119.64334,30.5487937],["L",100.798808,59.5449283],["C",100.614349,59.8287556,100.298826,60,99.960325,60],["L",20.1720063,60],["C",19.83462,60,19.5199796,59.8298739,19.3352402,59.5475604],["L",.3565669,30.5448953],["C",.1398092,30.2136523,.1388534,29.7857253,.3541294,29.4535175],["L",19.1448658,.4561827],["C",19.3292042,.1717169,19.6450984,0,19.9840694,0],["Z"]]},scene:[],thumb:[{d:[["M",9.1753609,10],["L",22.7586938,10],["C",22.8919773,10,23.016505,10.0663866,23.0907953,10.1770457],["L",26.8513724,15.7786117],["C",26.9413749,15.912675,26.9419451,16.0877051,26.8528179,16.2223519],["L",23.1470284,21.8207859],["C",23.072951,21.9326965,22.9476882,22,22.8134814,22],["L",9.2130739,22],["C",9.0793157,22,8.9544098,21.9331428,8.8802274,21.8218405],["L",5.1471359,16.2207607],["C",5.057961,16.0869638,5.0575691,15.9127763,5.1461411,15.7785795],["L",8.8415196,10.1796593],["C",8.9155518,10.067492,9.0409649,10,9.1753609,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.26,y:.02,name:"NW"},{x:.26,y:.98,name:"SW"},{x:.74,y:.02,name:"NE"},{x:.74,y:.98,name:"SE"}]},{name:"process",category:"flowchart",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10.5],["L",25.6,10.5],["C",25.8209139,10.5,26,10.6790861,26,10.9],["L",26,22.1],["C",26,22.3209139,25.8209139,22.5,25.6,22.5],["L",6.4,22.5],["C",6.1790861,22.5,6,22.3209139,6,22.1],["L",6,10.9],["C",6,10.6790861,6.1790861,10.5,6.4,10.5],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"sort",category:"flowchart",width:44,height:44,textarea:{region:$i},outline:{d:[["M",22.707552999999997,.7084468],["L",43.2664758,21.2933397],["C",43.6564052,21.6837616,43.6564052,22.3162384,43.2664758,22.7066603],["L",22.707552999999997,43.2915532],["C",22.3172753,43.682324,21.6841104,43.6827236,21.293339699999997,43.2924459],["C",21.2930419,43.2921485,21.292744399999997,43.291851,21.292447000000003,43.2915532],["L",.7335241999999997,22.7066603],["C",.3435948,22.3162384,.3435948,21.6837616,.7335241999999997,21.2933397],["L",21.292447000000003,.7084468],["C",21.6827247,.317676,22.3158896,.3172764,22.706660300000003,.7075541],["C",22.7069581,.7078515,22.707255600000003,.708149,22.707552999999997,.7084468],["Z"]]},scene:[{d:[{name:"M",x:.1242938,y:22},{name:"L",x:43.8757062,y:22}]}],thumb:[{d:[["M",16.2830212,7.2833787],["L",24.706338,15.7173359],["C",24.8623098,15.8735046,24.8623098,16.1264954,24.706338,16.2826641],["L",16.2830212,24.7166213],["C",16.1269101,24.8729296,15.8736442,24.8730894,15.7173359,24.7169784],["C",15.7172168,24.7168594,15.7170978,24.7167404,15.7169788,24.7166213],["L",7.293662,16.2826641],["C",7.1376902,16.1264954,7.1376902,15.8735046,7.293662,15.7173359],["L",15.7169788,7.2833787],["C",15.8730899,7.1270704,16.1263558,7.1269106,16.2826641,7.2830216],["C",16.2827832,7.2831406,16.2829022,7.2832596,16.2830212,7.2833787],["Z"],["M",7.3175141,15.7333333],["L",25.2158192,15.7333333]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start-end",category:"flowchart",width:120,height:60,outline:{path:function(t,e){return Ji(t,e,Math.min(t,e)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]},{name:"stored-data",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){return{minX:1/12*t,minY:4,maxX:t-1*t/8,maxY:e-4}}},outline:{d:[["M",13.7777709,0],["L",120,0],["C",111.115006,4.7754794,106.672509,14.7754794,106.672509,30],["C",106.672509,44.2961128,111.115006,54.2961128,120,60],["L",13.7777709,60],["C",4.2600422,53.6223342,-.3265282,43.6223342,.0180598,30],["C",.4106176,14.4813071,4.997188,4.4813072,13.7777709,0],["Z"]]},scene:[],thumb:[{d:[["M",7.7592332,10],["L",26.7592332,10],["C",24.3123052,10.9550959,23.0888412,12.9550959,23.0888412,16],["C",23.0888412,18.8592226,24.3123052,20.8592226,26.7592332,22],["L",7.7592332,22],["C",5.853146,20.7244668,4.9346072,18.7244668,5.0036168,16],["C",5.0822332,12.8962614,6.000772,10.8962614,7.7592332,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:.93,y:.5,name:"E"},{x:.1,y:0,name:"NW"},{x:.1,y:1,name:"SW"},{x:.995,y:.01,name:"NE"},{x:.995,y:.99,name:"SE"}]},{name:"subroutine",category:"flowchart",width:120,height:60,textarea:{region:function(t,e){return{minX:.08*t+4,minY:4,maxX:.92*t-4,maxY:e-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[{d:[{name:"M",x:8,y:-0},{name:"L",x:8,y:60}]},{d:[{name:"M",x:112,y:-0},{name:"L",x:112,y:60}]}],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"],["M",10,10],["L",10,22],["M",22,10],["L",22,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.02,y:.015,name:"NW"},{x:.02,y:.985,name:"SW"},{x:.98,y:.015,name:"NE"},{x:.98,y:.985,name:"SE"}]},{name:"summing-junction",category:"flowchart",width:44,height:44,textarea:{region:$i},outline:{name:"ellipse",cx:22,cy:22,rx:22,ry:22},scene:[{d:[["M",6.44365,6.44365],["l",31.1127,31.1127],["m",-31.1127,0],["l",31.1127,-31.1127]]}],thumb:[{name:"ellipse",cx:16,cy:17,rx:9,ry:9},{d:[["M",9.636,10.636],["l",12.727922,12.727922],["m",0,-12.727922],["l",-12.727922,12.727922]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.145,y:.145,name:"NW"},{x:.145,y:.855,name:"SW"},{x:.855,y:.145,name:"NE"},{x:.855,y:.855,name:"SE"}]},{name:"hard-disk",category:"flowchart",width:120,height:60,outline:{d:[["M",15,60],["L",14.7519476,59.9959809],["C",9.2781402,59.818482,4.5170854,53.7768783,1.9708869,44.875377],["L",1.7488298,44.0706625],["L",1.7488298,44.0706625],["L",1.538854,43.2511373],["C",.5535534,39.2550784,0,34.7568286,0,30],["C",0,27.0176624,.2175896,24.1369663,.6227504,21.4179485],["L",.76471,20.5176797],["C",.9879463,19.1765057,1.2572417,17.8774189,1.5688436,16.627924],["L",1.7828048,15.8023567],["C",1.892878,15.3933289,2.0075593,14.9899966,2.1267097,14.5926377],["L",2.3709282,13.805967],["C",4.9969253,5.6312819,9.5529446,.172607,14.7519476,.0040191],["L",15.0621025,0],["L",15.0621025,0],["L",105,0],["L",105.248052,.0040191],["C",110.72186,.181518,115.482915,6.2231217,118.029113,15.124623],["L",118.25117,15.9293375],["L",118.25117,15.9293375],["L",118.461146,16.7488627],["C",119.446447,20.7449216,120,25.2431714,120,30],["C",120,32.9823376,119.78241,35.8630337,119.37725,38.5820515],["L",119.23529,39.4823203],["C",119.012054,40.8234943,118.742758,42.1225811,118.431156,43.372076],["L",118.217195,44.1976433],["C",118.107122,44.6066711,117.992441,45.0100034,117.87329,45.4073623],["L",117.629072,46.194033],["C",115.003075,54.3687181,110.447055,59.827393,105.248052,59.9959809],["L",105,60],["L",15,60],["Z"]]},scene:[{d:[["M",105,0],["C",96.7157288,0,90,13.4314575,90,30],["C",90,46.5685425,96.7157288,60,105,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",26,16],["C",26,19.7950693,24.6815015,22.8847632,23.0365121,22.9968505],["L",23.0365572,22.9990622],["L",9.005513,22.9990622],["C",7.3410124,22.9372467,6,19.8273333,6,16],["C",6,12.21094,7.3143262,9.1250233,8.955676,9.0037044],["L",9.005513,9.0009378],["L",23.0365572,9],["L",23.0365121,9.0031495],["C",24.6815015,9.1152368,26,12.2049307,26,16],["Z"]]},{d:[["M",22.6666667,23],["C",21.4393672,23,20.4444444,19.8659932,20.4444444,16],["C",20.4444444,12.1726667,21.4195683,9.0627533,22.6299182,9.0009378],["L",22.6666667,9]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"annotation",category:"flowchart",width:160,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0,style:{visibility:"hidden"}},open:!0,scene:[{d:[["M",12,0],["L",2,0],["C",.8954305,0,0,.8954305,0,2],["L",0,98],["C",0,99.1045695,1.8954305,100,2,100],["L",12,100],["L",12,100]],attr:{fill:"transparent"}}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]],attr:{fill:"transparent"}},{d:[["M",15,12.4],["L",23,12.4],["M",15,19.6],["L",20,19.6],["M",15,16],["L",25,16]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"paper-tape",category:"flowchart",width:120,height:60,outline:{d:[["M",1.5222953,.9815615],["C",9.1503953,5.6605205,18.6431804,8,30.0006506,8],["C",48.1891811,8,72,0,90,0],["C",101.772949,0,111.620866,2.5667099,119.54375,7.7001296],["C",119.827781,7.8834886,119.999272,8.1983049,120,8.536377],["L",120,58.1813965],["C",119.99868,58.7336797,119.549899,59.1803262,118.997616,59.1790094],["C",118.81486,59.1785736,118.635719,59.1280638,118.479584,59.0330812],["C",110.744659,54.3443604,101.251465,52,90,52],["C",72,52,47.9802124,60,30.0006506,60],["C",18.2410691,60,8.3931965,57.4332901,.4570327,52.2998704],["C",.1725566,52.1168331,7995e-7,51.8018948,0,51.463623],["L",0,1.8312988],["C",.0011011,1.2790152,.4497064,.8321918,1.0019901,.8332909],["C",1.1858393,.8336568,1.3660294,.8846988,1.5222953,.9815615],["Z"]]},scene:[],thumb:[{d:[["M",6.6474214,9.5811114],["C",7.8470102,10.5270371,9.2979179,11,11.0001446,11],["C",14.0315882,11,18.0555691,9,21.0153944,9],["C",22.9279117,9,24.5476734,9.6262819,25.8746796,10.8788457],["C",25.9544319,10.953493,25.9996109,11.0577585,26.0001446,11.1669922],["L",26.0001446,22.1123047],["C",25.9985502,22.3332128,25.8181845,22.5110102,25.5972763,22.5094261],["C",25.5080849,22.5087865,25.421666,22.4783549,25.3523768,22.4221807],["C",24.1466821,21.4740602,22.7041694,21,21.0248386,21],["C",18.037633,21,13.9967599,23,11.0001446,23],["C",9.0638551,23,7.4385415,22.3737181,6.1242038,21.1211543],["C",6.0451563,21.0461214,6.0003506,20.9419953,6,20.8330078],["L",6,9.8935547],["C",6.000786,9.6726422,6.1805061,9.4941923,6.4014186,9.4949758],["C",6.4907774,9.4952927,6.5774568,9.5255221,6.6474214,9.5811114],["Z"]]}],anchors:[{x:.5,y:.09,name:"N"},{x:.5,y:.91,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:0,y:.09,name:"NW"},{x:0,y:.91,name:"SW"},{x:1,y:.09,name:"NE"},{x:1,y:.91,name:"SE"}]},{name:"card",category:"flowchart",width:120,height:60,outline:{d:[["M",17.119717,0],["L",119,0],["C",119.552285,-0,120,.4477153,120,1],["L",120,59],["C",120,59.5522847,119.552285,60,119,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,20.1542151],["C",0,19.9186136,.0831857,19.6905777,.2348891,19.5103165],["L",16.3546062,.3561015],["C",16.5446112,.1303284,16.8246316,-0,17.119717,0],["Z"]]},scene:[],thumb:[{d:[["M",9.5170283,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,14.1038014],["C",6,14.0095609,6.0332743,13.9183465,6.0939556,13.846242],["L",9.210984,10.1424406],["C",9.286986,10.0521313,9.3989942,10,9.5170283,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.1,y:.16,name:"NW"},{x:.015,y:.98,name:"SW"},{x:.985,y:.02,name:"NE"},{x:.985,y:.98,name:"SE"}]}],ec=1/6*Math.PI,nc=20*Math.tan(ec);function rc(t,e){return{d:nc>t?0:nc,titleHeight:20>e?e:20}}var ac=[{name:"frame",width:500,height:400,html:'<div style="text-align:left;">&nbsp;</div>',textarea:{region:function(t,e){return{minX:4,minY:4,maxX:.4*t-(10<t?10:0),maxY:(30<e?30:e)-4}}},outline:{path:function(t,e){return Ji(t,e,4)}},scene:[{path:function(t,e){var n,r,a=.4*t,i=10<t?10:0;return 30<e?(n=30,r=16):(n=e,r=0),[["M",0,n],["l",a-i,0],["l",i,-r],["L",a,0]]},attr:{fill:"none"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",6,12],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["L",16.5337171,9],["C",16.697486400000003,9,16.8447125,9.0998297,16.9053186,9.251971900000001],["L",18,12],["L",18,12],["L",6,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"package",category:"UML",isClip:!1,width:120,height:80,textarea:{region:function(t,e){return{minX:4,minY:rc(t,e).titleHeight+4,maxX:t-4,maxY:e-4}}},outline:{path:function(t,e){var n=.6*t,r=rc(t,e),a=r.d,i=r.titleHeight,o=t/2,c=e>i?e/2:0,l=o<4?o:4,s=c<4?c:4;return[["M",l,0],["l",n,0],["l",a-l,i],["L",t-l,i],["a",l,s,0,0,1,l,s],["L",t,e-s],["a",l,s,0,0,1,-l,s],["L",l,e],["a",l,s,0,0,1,-l,-s],["L",0,s],["a",l,s,0,0,1,l,-s],["Z"]]}},scene:[{path:function(t,e){var n=.6*t,r=rc(t,e),a=r.d;return[["M",0,r.titleHeight],["l",n+a,0]]}}],thumb:[{d:[["M",6,11],["L",25.6,11],["C",25.8209139,11,26,11.1790861,26,11.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,11],["L",6,11],["Z"]]},{d:[["M",6,11],["L",6,8.9],["C",6,8.6790861,6.1790861,8.5,6.4,8.5],["L",14.7328929,8.5],["C",14.8966622,8.5,15.0438883,8.5998297,15.1044944,8.751971900000001],["L",16,11],["L",16,11],["L",6,11],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activation",category:"UML",width:20,height:80,textarea:{region:$i},outline:{name:"rect",x:0,y:0,width:20,height:80,rx:4,ry:4},scene:[],thumb:[{d:[["M",19,6.4],["L",19,25.6],["C",19,25.8209139,18.8209139,26,18.6,26],["L",13.4,26],["C",13.1790861,26,13,25.8209139,13,25.6],["L",13,6.4],["C",13,6.1790861,13.1790861,6,13.4,6],["L",18.6,6],["C",18.8209139,6,19,6.1790861,19,6.4],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"actor",category:"UML",width:40,height:80,isClip:!1,closed:!1,textarea:{region:$i},outline:{d:[["M",20,20],["C",25.5228475,20,30,15.5228475,30,10],["C",30,4.4771525,25.5228475,0,20,0],["C",14.4771525,0,10,4.4771525,10,10],["C",10,15.5228475,14.4771525,20,20,20],["Z"],["M",0,35],["L",40,35],["M",20,20],["L",20,52],["M",20,52],["L",0,80],["M",20,52],["L",40,80]]},scene:[{name:"rect",x:0,y:0,width:40,height:80,attr:{fill:"transparent",stroke:"transparent"}}],thumb:[{d:[["M",16,13],["C",17.9329966,13,19.5,11.4329966,19.5,9.5],["C",19.5,7.5670034,17.9329966,6,16,6],["C",14.0670034,6,12.5,7.5670034,12.5,9.5],["C",12.5,11.4329966,14.0670034,13,16,13],["Z"],["M",11,16],["L",21,16],["M",16,19],["L",11,26],["M",16,19],["L",21,26],["M",16,13],["L",16,19]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.4375,name:"W"},{x:1,y:.4375,name:"E"}]},{name:"annotation",category:"UML",width:159,height:100,outline:{name:"rect",x:0,y:0,width:160,height:100,rx:0,ry:0},scene:[{d:[["M",2,0],["L",10,0],["C",11.1045695,-0,12,.8954305,12,2],["L",12,98],["C",12,99.1045695,11.1045695,100,10,100],["L",0,100],["L",0,100]]}],thumb:[{d:[["M",14,25],["L",8.4,25],["C",8.1790861,25,8,24.8209139,8,24.6],["L",8,7.4],["C",8,7.1790861,8.1790861,7,8.4,7],["L",14,7]]},{d:[["M",20.6,18.8],["C",20.8209139,18.8,21,18.9790861,21,19.2],["L",21,20],["C",21,20.2209139,20.8209139,20.4,20.6,20.4],["L",15.4,20.4],["C",15.1790861,20.4,15,20.2209139,15,20],["L",15,19.2],["C",15,18.9790861,15.1790861,18.8,15.4,18.8],["L",20.6,18.8],["Z"],["M",25.6,15.2],["C",25.8209139,15.2,26,15.3790861,26,15.6],["L",26,16.4],["C",26,16.6209139,25.8209139,16.8,25.6,16.8],["L",15.4,16.8],["C",15.1790861,16.8,15,16.6209139,15,16.4],["L",15,15.6],["C",15,15.3790861,15.1790861,15.2,15.4,15.2],["L",25.6,15.2],["Z"],["M",23.6,11.6],["C",23.8209139,11.6,24,11.7790861,24,12],["L",24,12.8],["C",24,13.0209139,23.8209139,13.2,23.6,13.2],["L",15.4,13.2],["C",15.1790861,13.2,15,13.0209139,15,12.8],["L",15,12],["C",15,11.7790861,15.1790861,11.6,15.4,11.6],["L",23.6,11.6],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"boundary",category:"UML",width:70,height:50,isClip:!1,textarea:{region:$i},outline:{d:[["M",45,50],["C",58.8071187,50,70,38.8071187,70,25],["C",70,11.1928813,58.8071187,0,45,0],["C",31.1928813,0,20,11.1928813,20,25],["C",20,38.8071187,31.1928813,50,45,50],["Z"],["M",-0,0],["L",0,50],["M",0,25],["L",20,25]]},scene:[],thumb:[{d:[["M",19,22],["C",22.3137085,22,25,19.3137085,25,16],["C",25,12.6862915,22.3137085,10,19,10],["C",15.6862915,10,13,12.6862915,13,16],["C",13,19.3137085,15.6862915,22,19,22],["Z"],["M",8,16],["L",13,16],["M",7.5,10],["L",7.5,22]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"choice",width:40,height:40,textarea:{region:$i},outline:{d:[["M",22.1213203,.9081169],["L",39.0918831,17.8786797],["C",40.263456,19.0502525,40.263456,20.9497475,39.0918831,22.1213203],["L",22.1213203,39.0918831],["C",20.9497475,40.263456,19.0502525,40.263456,17.8786797,39.0918831],["L",.9081169,22.1213203],["C",-.263456,20.9497475,-.263456,19.0502525,.9081169,17.8786797],["L",17.8786797,.9081169],["C",19.0502525,-.263456,20.9497475,-.263456,22.1213203,.9081169],["Z"]]},scene:[],thumb:[{d:[["M",16.219338,9.0908528],["L",22.9091472,15.780662],["C",23.0302843,15.901799,23.0302843,16.098201,22.9091472,16.219338],["L",16.219338,22.9091472],["C",16.098201,23.0302843,15.901799,23.0302843,15.780662,22.9091472],["L",9.0908528,16.219338],["C",8.9697157,16.098201,8.9697157,15.901799,9.0908528,15.780662],["L",15.780662,9.0908528],["C",15.901799,8.9697157,16.098201,8.9697157,16.219338,9.0908528],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"control",category:"UML",width:50,height:55,isClip:!1,textarea:{region:$i},outline:{d:[["M",25,55],["C",38.8071187,55,50,43.8071187,50,30],["C",50,16.1928813,38.8071187,5,25,5],["C",11.1928813,5,0,16.1928813,0,30],["C",0,43.8071187,11.1928813,55,25,55],["Z"],["M",24,4.9497475],["L",28.9497475,0]]},scene:[{d:[{name:"M",x:28.9497475,y:9.8994949},{name:"L",x:24,y:4.9497475}]}],thumb:[{d:[["M",16,22],["C",19.3137085,22,22,19.3137085,22,16],["C",22,12.6862915,19.3137085,10,16,10],["C",12.6862915,10,10,12.6862915,10,16],["C",10,19.3137085,12.6862915,22,16,22],["Z"],["M",15,10.1213203],["L",17.1213203,8],["M",17.1213203,12.2426407],["L",15,10.1213203]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"deletion",category:"UML",width:40,height:40,isClip:!1,closed:!1,textarea:{region:$i},outline:{d:[["M",0,0],["L",40,40],["M",40,0],["L",0,40]],attr:{stroke:{width:4}}},scene:[],thumb:[{d:[["M",9.3534503,9.3534503],["L",22.6465497,22.6465497],["M",22.6465497,9.3534503],["L",9.3534503,22.6465497]],attr:{"stroke-width":2}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"finish",category:"UML",width:42,height:42,textarea:{region:$i},outline:{name:"ellipse",cx:21,cy:21,rx:21,ry:21,attr:{stroke:{color:"#595959",width:4.2}}},scene:[{name:"ellipse",cx:21,cy:21,rx:12,ry:12,attr:{fill:"#595959"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{stroke:"#595959","stroke-width":1.2}},{name:"ellipse",cx:16,cy:16,rx:5,ry:5,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"fork",category:"UML",width:120,height:20,outline:{name:"rect",x:0,y:0,width:120,height:20,rx:4,ry:4,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"rect",x:6,y:14,width:20,height:4,rx:1,ry:1,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"frequency",category:"UML",textarea:{region:$i},width:44,height:36,outline:{d:[["M",42.7122245,0],["C",42.8304828,0,42.9426798,.0523287,43.0186811,.1429312],["C",43.1606563,.3121825,43.1385446,.5644814,42.9692933,.7064566],["L",42.9692933,.7064566],["L",22.353,18],["L",42.9692933,35.2935434],["C",43.0417753,35.3543444,43.0897621,35.4383107,43.1060575,35.5300135],["L",43.1122245,35.6],["C",43.1122245,35.8209139,42.9331384,36,42.7122245,36],["L",42.7122245,36],["L",1.2877755,36],["C",1.1695172,36,1.0573202,35.9476713,.9813189,35.8570688],["C",.8393436999999999,35.6878175,.8614554000000001,35.4355186,1.0307067,35.2935434],["L",1.0307067,35.2935434],["L",21.646,17.999],["L",1.0307067,.7064566],["C",.9582246999999999,.6456556,.9102379,.5616893,.8939425000000001,.4699865],["L",.8877755,.4],["C",.8877755,.1790861,1.0668616,0,1.2877755,0],["L",1.2877755,0],["Z"]]},scene:[],thumb:[{d:[["M",23.6012174,9],["C",23.7214126,9,23.8352365,9.0540492,23.9112011,9.1471955],["C",24.0508212,9.3183948,24.0252212,9.5703637,23.8540219,9.7099837],["L",23.8540219,9.7099837],["L",16.142,16],["L",23.8540219,22.2900163],["C",23.928539,22.350788,23.9780339,22.4357897,23.9948511,22.5288994],["L",24.0012174,22.6],["C",24.0012174,22.8209139,23.8221313,23,23.6012174,23],["L",23.6012174,23],["L",8.3987826,23],["C",8.2785874,23,8.1647635,22.9459508,8.0887989,22.8528045],["C",7.9491788,22.6816052,7.9747788,22.4296364,8.1459781,22.2900163],["L",8.1459781,22.2900163],["L",15.858,16],["L",8.1459781,9.7099837],["C",8.071461,9.649212,8.0219661,9.5642103,8.0051489,9.4711006],["L",7.9987826,9.4],["C",7.9987826,9.1790861,8.1778687,9,8.3987826,9],["L",8.3987826,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],antiAnchors:[{x:.5,y:0},{x:.5,y:1}]},{name:"node",category:"UML",width:240,height:240,textarea:{region:function(t,e){return{minX:4,minY:1/11*e+4,maxX:10/11*t-4,maxY:e-4}}},outline:{d:[["M",0,239],["L",0,20.4142136],["C",0,20.1489971,.1053568,19.8946432,.2928932,19.7071068],["L",19.7071068,.2928932],["C",19.8946432,.1053568,20.1489971,0,20.4142136,0],["L",239,0],["C",239.552285,-0,240,.4477153,240,1],["L",240,219.585786],["C",240,219.851003,239.894643,220.105357,239.707107,220.292893],["L",220.292893,239.707107],["C",220.105357,239.894643,219.851003,240,219.585786,240],["L",1,240],["C",.4477153,240,0,239.552285,0,239],["Z"]]},scene:[{name:"polygon",points:[{x:20,y:0},{x:240,y:0},{x:220,y:20},{x:0,y:20}],attr:{fill:"rgba(0,0,0,0.1)"}},{name:"polygon",points:[{x:220,y:20},{x:220,y:240},{x:240,y:220},{x:240,y:6123234e-22}],attr:{fill:"rgba(0,0,0,0.1)"}}],thumb:[{d:[["M",8,10],["L",22,10],["L",22,24],["L",8.4,24],["C",8.1790861,24,8,23.8209139,8,23.6],["L",8,10],["L",8,10],["Z"]]},{d:[["M",8,10],["L",9.9481766,8.1127039],["C",10.0227934,8.0404189,10.122606300000001,8,10.2264947,8],["L",24,8],["L",24,8],["L",22.4516129,10]]},{d:[["M",22,24],["L",23.8872961,22.0518234],["C",23.9595811,21.977206600000002,24,21.8773937,24,21.7735053],["L",24,8],["L",24,8]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"object",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,10],["L",25.6,10],["C",25.8209139,10,26,10.1790861,26,10.4],["L",26,21.6],["C",26,21.8209139,25.8209139,22,25.6,22],["L",6.4,22],["C",6.1790861,22,6,21.8209139,6,21.6],["L",6,10.4],["C",6,10.1790861,6.1790861,10,6.4,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"receive-signal",category:"UML",width:139,height:60,textarea:{region:function(t,e){return{minX:.18*t+4,minY:4,maxX:t-4,maxY:e-4}}},outline:{d:[["M",138,0],["L",1.1350416,0],["C",.5827568999999999,0,.1350416000000001,.4477153,.1350416000000001,1],["C",.1350416000000001,1.2339365,.21705780000000008,1.4604694,.3668203000000001,1.6401844],["L",23.466513,29.3598156],["C",23.7755513,29.7306616,23.7755513,30.2693384,23.466513,30.6401844],["L",.3668203000000001,58.3598156],["C",.01325630000000011,58.7840925,.07058030000000004,59.4146572,.4948572,59.7682213],["C",.6745722000000001,59.9179838,.9011051000000001,60,1.1350416,60],["L",138,60],["C",138.552285,60,139,59.5522847,139,59],["L",139,1],["C",139,.4477153,138.552285,0,138,0],["Z"]]},scene:[],thumb:[{d:[["M",25.6,20],["L",6.9656854,20],["C",6.7447715,20,6.5656854,19.8209139,6.5656854,19.6],["C",6.5656854,19.4939134,6.6078282,19.3921718,6.6828427,19.3171573],["L",9.7171573,16.2828427],["C",9.873367,16.126633,9.873367,15.873367,9.7171573,15.7171573],["L",6.6828427,12.6828427],["C",6.526633,12.526633,6.526633,12.273367,6.6828427,12.1171573],["C",6.7578573,12.0421427,6.8595988,12,6.9656854,12],["L",25.6,12],["C",25.8209139,12,26,12.1790861,26,12.4],["L",26,19.6],["C",26,19.8209139,25.8209139,20,25.6,20],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"send-signal",category:"UML",width:140,height:60,textarea:{region:function(t,e){return{minX:4,minY:4,maxX:t-.18*t-4,maxY:e-4}}},outline:{d:[["M",1,0],["L",114.531625,0],["C",114.828405,0,115.109853,.131823,115.299846,.3598156],["L",139.466513,29.3598156],["C",139.775551,29.7306616,139.775551,30.2693384,139.466513,30.6401844],["L",115.299846,59.6401844],["C",115.109853,59.868177,114.828405,60,114.531625,60],["L",1,60],["C",.4477153,60,0,59.5522847,0,59],["L",0,1],["C",-0,.4477153,.4477153,0,1,0],["Z"]]},scene:[],thumb:[{d:[["M",6.4,12],["L",21.8343146,12],["C",21.9404012,12,22.0421427,12.0421427,22.1171573,12.1171573],["L",26,16],["L",26,16],["L",22.1171573,19.8828427],["C",22.0421427,19.9578573,21.9404012,20,21.8343146,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"simple-class",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"start",width:40,height:40,textarea:{region:$i},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20,attr:{fill:{color:"#595959"}}},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7,attr:{fill:"#595959"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"state",category:"UML",width:120,height:60,outline:{name:"rect",x:0,y:0,width:120,height:60,rx:12,ry:12},scene:[],thumb:[{d:[["M",8,10],["L",24,10],["C",25.1045695,10,26,10.8954305,26,12],["L",26,20],["C",26,21.1045695,25.1045695,22,24,22],["L",8,22],["C",6.8954305,22,6,21.1045695,6,20],["L",6,12],["C",6,10.8954305,6.8954305,10,8,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"termination-pseudostate",category:"UML",width:40,height:40,textarea:{region:$i},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",5.7142857,5.7142857],["C",5.7142857,5.7142857,15.2380952,15.2380952,34.2857143,34.2857143],["M",34.2857143,5.7142857],["L",5.7142857,34.2857143]]}],thumb:[{d:[["M",16,23],["C",19.8659932,23,23,19.8659932,23,16],["C",23,12.1340068,19.8659932,9,16,9],["C",12.1340068,9,9,12.1340068,9,16],["C",9,19.8659932,12.1340068,23,16,23],["Z"],["M",11,11],["C",11,11,14.3333333,14.3333333,21,21],["M",21,11],["L",11,21]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"use-case",category:"UML",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"class",category:"UML",type:"stack",width:280,height:200,row:3,heights:[40,80,80],outline:{path:function(t,e){return Ji(t,e,8)}},scene:[{d:[["M",0,40],["L",280,40]],height:40},{d:[["M",0,120],["L",280,120]],height:120}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:12},{name:"L",x:26,y:12}]},{d:[{name:"M",x:6,y:17.5},{name:"L",x:26,y:17.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Class</span></div>','<div style="text-align:left;">+ attribute1:type = defaultValue</div>\n      <div style="text-align:left;">+ attribute2:type</div>\n      <div style="text-align:left;">- attribute3:type</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>']},{name:"interface",type:"stack",width:280,height:200,row:2,heights:[64,90],outline:{path:function(t,e){return Ji(t,e,8)}},scene:[{d:[["M",0,64],["L",280,64]],height:64}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:6,y:16},{name:"L",x:26,y:16}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],htmls:['<div style="text-align:center;"><span style="font-weight:bold;">&lt;&lt;interface&gt;&gt;</span></div>\n      <div style="text-align:center;">Interface</div>','<div style="text-align:left;">+ operation1(params):returnType</div>\n      <div style="text-align:left;">- operation2(params)</div>\n      <div style="text-align:left;">- operation3()</div>'],category:"UML"},{name:"constraint",width:120,height:50,textarea:{region:function(t,e){var n=.1*t,r=16/380*e;return{minX:n+4,minY:r,maxX:t-n-4,maxY:e-r}}},outline:{name:"rect",x:0,y:0,width:120,height:50,rx:0,ry:0,style:{visibility:"hidden"}},scene:[{d:[["M",11,2],["L",10,2],["C",7.790861,2,6,3.790861,6,6],["L",6,19.9098301],["C",6,21.8036903,4.9299881,23.5350059,3.236068,24.381966],["L",1,25],["L",3.236068,25.618034],["C",4.9299881,26.4649941,6,28.1963097,6,30.0901699],["L",6,44],["C",6,46.209139,7.790861,48,10,48],["L",11,48]],attr:{fill:"transparent"}},{d:[["M",109,2],["L",110,2],["C",112.209139,2,114,3.790861,114,6],["L",114,19.9098301],["C",114,21.8036903,115.070012,23.5350059,116.763932,24.381966],["L",119,25],["L",116.763932,25.618034],["C",115.070012,26.4649941,114,28.1963097,114,30.0901699],["L",114,44],["C",114,46.209139,112.209139,48,110,48],["L",109,48]],attr:{fill:"transparent"}}],thumb:[{d:[["M",11,8],["L",11,9.0792291],["L",10.0378007,9.0792291],["L",9.9004779,9.0841809],["C",9.2360127,9.1336991,8.9037801,9.5546039,8.9037801,10.3468951],["L",8.9037801,10.3468951],["L",8.9037801,13.9100642],["L",8.8982764,14.0989026],["C",8.8432399,15.0236884,8.3754296,15.6573876,7.4948454,16],["C",8.4341352,16.3768737,8.9037801,17.0735189,8.9037801,18.0899358],["L",8.9037801,18.0899358],["L",8.9037801,21.6702355],["L",8.9082098,21.8216676],["C",8.9525075,22.5544031,9.3290378,22.9207709,10.0378007,22.9207709],["L",10.0378007,22.9207709],["L",11,22.9207709],["L",11,24],["L",9.814433,24],["L",9.6063574,23.9933191],["C",8.997079,23.9532334,8.5223368,23.7327623,8.1821306,23.3319058],["C",7.8155785,22.9321913,7.6323024,22.3668808,7.6323024,21.6359743],["L",7.6323024,21.6359743],["L",7.6323024,18.1413276],["L",7.6272015,17.9587794],["C",7.6033971,17.5465739,7.4962772,17.2305496,7.3058419,17.0107066],["C",7.0652921,16.7366167,6.6300114,16.5881513,6,16.5653105],["L",6,16.5653105],["L",6,15.4346895],["L",6.2061856,15.4190393],["C",6.7356497,15.366026,7.1022019,15.2227774,7.3058419,14.9892934],["C",7.5234823,14.7380443,7.6323024,14.3611706,7.6323024,13.8586724],["L",7.6323024,13.8586724],["L",7.6323024,10.3811563],["L",7.6378007,10.1635974],["C",7.6707904,9.5263383,7.8522337,9.0278373,8.1821306,8.6680942],["C",8.5601375,8.2226981,9.1042383,8,9.814433,8],["L",9.814433,8],["L",11,8],["Z"],["M",22.185567,8],["C",22.8957617,8,23.4398625,8.2226981,23.8178694,8.6680942],["C",24.1477663,9.0278373,24.3292096,9.5263383,24.3621993,10.1635974],["L",24.3676976,10.3811563],["L",24.3676976,13.8586724],["C",24.3676976,14.3611706,24.4765178,14.7380443,24.6941581,14.9892934],["C",24.8977981,15.2227774,25.2643503,15.366026,25.7938144,15.4190393],["L",26,15.4346895],["L",26,16.5653105],["C",25.3699885,16.5881513,24.9347079,16.7366167,24.6941581,17.0107066],["C",24.5037228,17.2305496,24.3966029,17.5465739,24.3727985,17.9587794],["L",24.3676976,18.1413276],["L",24.3676976,21.6359743],["C",24.3676976,22.3668808,24.1844215,22.9321913,23.8178694,23.3319058],["C",23.4776632,23.7327623,23.002921,23.9532334,22.3936426,23.9933191],["L",22.185567,24],["L",21,24],["L",21,22.9207709],["L",21.9621993,22.9207709],["C",22.6709622,22.9207709,23.0474925,22.5544031,23.0917902,21.8216676],["L",23.0962199,21.6702355],["L",23.0962199,18.0899358],["C",23.0962199,17.0735189,23.5658648,16.3768737,24.5051546,16],["C",23.6245704,15.6573876,23.1567601,15.0236884,23.1017236,14.0989026],["L",23.0962199,13.9100642],["L",23.0962199,10.3468951],["C",23.0962199,9.5546039,22.7639873,9.1336991,22.0995221,9.0841809],["L",21.9621993,9.0792291],["L",21,9.0792291],["L",21,8],["L",22.185567,8],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"activity-class",width:120,height:60,textarea:{region:function(t,e){var n=.128*t;return{minX:n+4,minY:4,maxX:t-n-4,maxY:e-4}}},outline:{name:"rect",x:0,y:0,width:120,height:60,rx:4,ry:4},scene:[{d:[["M",105,0],["L",105,60],["M",15,60],["L",15,0]]}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9,y:9},{name:"L",x:9,y:23}]},{d:[{name:"M",x:23,y:9},{name:"L",x:23,y:23}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"component",width:120,height:80,isClip:!1,textarea:{region:function(t,e){return{minX:28,minY:4,maxX:t-4,maxY:e-4}}},outline:{path:function(t,e){var n=t-12,r=(n-12)/2,a=e/2,i=r<4?r:4,o=a<4?a:4,c=2,l=14;if(e<80){var s=e/80;return[["M",+i+12,0],["l",n-2*i,0],["a",i,o,0,0,1,i,o],["l",0,e-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-n,0],["a",i,o,0,0,1,-i,-o],["l",0,o-(l*=s)],["l",(c*=s)-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,-24*s],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,o-l],["a",i,o,0,0,1,i,-o],["z"]]}return[["M",+i+12,0],["l",n-2*i,0],["a",i,o,0,0,1,i,o],["l",0,e-2*o],["a",i,o,0,0,1,-i,o],["l",2*i-n,0],["a",i,o,0,0,1,-i,-o],["l",0,-(e-o-(80-l))],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,-(80-4*l)],["l",c-12,0],["a",c,c,0,0,1,-c,-c],["l",0,2*c-l],["a",c,c,0,0,1,c,-c],["l",12-c,0],["l",0,o-l],["a",i,o,0,0,1,i,-o],["z"]]}},scene:[{path:function(t,e){var n=2,r=14;if(e<80){var a=e/80;return[["M",12,r*=a],["l",12-(n*=a),0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0],["M",12,e-2*r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0]]}return[["M",12,r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0],["M",12,80-2*r],["l",12-n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",n-12,0]]},attr:{fill:"transparent"}}],thumb:[{d:[["M",8.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",8.4,23],["C",8.1790861,23,8,22.8209139,8,22.6],["L",8,9.4],["C",8,9.1790861,8.1790861,9,8.4,9],["Z"]]},{d:[["M",6.4,12],["L",11.6,12],["C",11.8209139,12,12,12.1790861,12,12.4],["L",12,13.6],["C",12,13.8209139,11.8209139,14,11.6,14],["L",6.4,14],["C",6.1790861,14,6,13.8209139,6,13.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]},{d:[["M",6.4,18],["L",11.6,18],["C",11.8209139,18,12,18.1790861,12,18.4],["L",12,19.6],["C",12,19.8209139,11.8209139,20,11.6,20],["L",6.4,20],["C",6.1790861,20,6,19.8209139,6,19.6],["L",6,18.4],["C",6,18.1790861,6.1790861,18,6.4,18],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"multiplicity",width:110,height:70,isClip:!1,textarea:{region:function(t,e){return{minX:4,minY:.15*e+4,maxX:t-.1*t-4,maxY:e-4}}},outline:{d:[["M",106,0],["C",108.209139,-0,110,1.790861,110,4],["L",110,56],["C",110,58.209139,108.209139,60,106,60],["L",100,60],["L",100,66],["C",100,68.209139,98.209139,70,96,70],["L",4,70],["C",1.790861,70,0,68.209139,0,66],["L",0,14],["C",-0,11.790861,1.790861,10,4,10],["L",10,10],["L",10,4],["C",10,1.790861,11.790861,0,14,0],["L",106,0],["Z"]]},scene:[{d:[["M",10,10],["L",96,10],["C",98.209139,10,100,11.790861,100,14],["L",100,60]],attr:{fill:"transparent"}}],thumb:[{d:[["M",9.4,9],["L",26.6,9],["C",26.8209139,9,27,9.1790861,27,9.4],["L",27,19.6],["C",27,19.8209139,26.8209139,20,26.6,20],["L",9.4,20],["C",9.1790861,20,9,19.8209139,9,19.6],["L",9,9.4],["C",9,9.1790861,9.1790861,9,9.4,9],["Z"]]},{d:[["M",6.4,12],["L",23.6,12],["C",23.8209139,12,24,12.1790861,24,12.4],["L",24,22.6],["C",24,22.8209139,23.8209139,23,23.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,12.4],["C",6,12.1790861,6.1790861,12,6.4,12],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"note",width:120,height:80,outline:{d:[["M",120,79],["C",120,79.5522847,119.552285,80,119,80],["L",1,80],["C",.4477153,80,0,79.5522847,0,79],["L",0,1],["C",0,.4477153,.4477153,0,1,0],["L",100,0],["L",120,20],["L",120,79],["Z"]]},scene:[{d:[["M",120,20],["L",100.5,20],["C",100.223858,20,100,19.7761424,100,19.5],["L",100,0],["L",100,0]],attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",21,9],["L",21,9],["L",25.8828427,13.8828427],["C",25.9578573,13.9578573,26,14.0595988,26,14.1656854],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",21,9],["L",21,13.6],["C",21,13.8209139,21.1790861,14,21.4,14],["L",26,14],["L",26,14]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"history-pseudostate",width:40,height:40,textarea:{region:$i},outline:{name:"ellipse",cx:20,cy:20,rx:20,ry:20},scene:[{d:[["M",12,20],["L",28,20],["M",12,11],["L",12,29],["M",28,11],["L",28,29]]}],thumb:[{name:"ellipse",cx:16,cy:16,rx:7,ry:7},{d:[["M",18.319148900000002,19.9993969],["C",18.567375900000002,19.991959100000003,18.742907799999998,19.930596899999998,18.845744699999997,19.8153104],["C",18.9485816,19.700023899999998,19,19.568002200000002,19,19.4192454],["L",19,19.4192454],["L",19,12.5801515],["C",19,12.4313947,18.9450355,12.2975136,18.8351064,12.1785082],["C",18.7251773,12.0595027,18.5460993,12,18.2978723,12],["C",18.035460999999998,12,17.856383,12.0632216,17.7606383,12.1896649],["C",17.6648936,12.3161082,17.617021299999998,12.4462704,17.617021299999998,12.5801515],["L",17.617021299999998,12.5801515],["L",17.617021299999998,15.2689307],["L",14.382978699999999,15.2689307],["L",14.382978699999999,12.5801515],["C",14.382978699999999,12.4313947,14.3315603,12.2975136,14.2287234,12.1785082],["C",14.1258865,12.0595027,13.9503546,12,13.7021277,12],["C",13.4539007,12,13.2748227,12.0632216,13.1648936,12.1896649],["C",13.0549645,12.3161082,13,12.4462704,13,12.5801515],["L",13,12.5801515],["L",13,19.4192454],["C",13,19.553126499999998,13.0549645,19.6851482,13.1648936,19.8153104],["C",13.2748227,19.945472600000002,13.4539007,20.0068348,13.7021277,19.9993969],["C",13.9503546,19.991959100000003,14.1258865,19.930596899999998,14.2287234,19.8153104],["C",14.3315603,19.700023899999998,14.382978699999999,19.568002200000002,14.382978699999999,19.4192454],["L",14.382978699999999,19.4192454],["L",14.382978699999999,16.5184878],["L",17.617021299999998,16.5184878],["L",17.617021299999998,19.4192454],["C",17.617021299999998,19.553126499999998,17.6719858,19.6851482,17.7819149,19.8153104],["C",17.891844,19.945472600000002,18.070922,20.0068348,18.319148900000002,19.9993969],["Z"]],attr:{fill:"#595959","stroke-width":0}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"UML"},{name:"entity",category:"UML",width:50,height:50,isClip:!1,textarea:{region:$i},outline:{name:"ellipse",cx:25,cy:25,rx:25,ry:25},scene:[{d:[{name:"M",x:0,y:50},{name:"L",x:50,y:50}]}],thumb:[{d:[{name:"M",x:8,y:22},{name:"L",x:24,y:22}]},{name:"ellipse",cx:16,cy:16,rx:6,ry:6}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"activity",category:"UML",width:120,height:60,outline:{path:function(t,e){return Ji(t,e,Math.min(t,e)/2)}},scene:[],thumb:[{d:[["M",11,10],["L",21,10],["C",24.3137085,10,27,12.6862915,27,16],["C",27,19.3137085,24.3137085,22,21,22],["L",11,22],["C",7.6862915,22,5,19.3137085,5,16],["C",5,12.6862915,7.6862915,10,11,10],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"},{x:.11,y:.11,name:"NW"},{x:.11,y:.89,name:"SW"},{x:.89,y:.11,name:"NE"},{x:.89,y:.89,name:"SE"}]}],ic=[{name:"swimlane-vertical",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:450,widths:[1/3,2/3],height:600,heights:[.1],outline:{path:function(t,e){return Ji(t,e,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:12.5,y:9},{name:"L",x:12.5,y:23}]},{d:[{name:"M",x:19.5,y:9},{name:"L",x:19.5,y:23}]},{d:[{name:"M",x:6,y:12.5},{name:"L",x:26,y:12.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]},{name:"swimlane-horizontal",category:"swimlane",type:"swimlane",number:3,htmls:['<div style="text-align:center;"><span style="font-weight:bold;">Lane 1</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 2</span></div>','<div style="text-align:center;"><span style="font-weight:bold;">Lane 3</span></div>'],width:600,widths:[.1],height:400,heights:[1/3,2/3],outline:{path:function(t,e){return Ji(t,e,0)}},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[{name:"M",x:9.5,y:9},{name:"L",x:9.5,y:23}]},{d:[{name:"M",x:6,y:13.5},{name:"L",x:26,y:13.5}]},{d:[{name:"M",x:6,y:18.5},{name:"L",x:26,y:18.5}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}]}],oc=function(t,e){var n=(new DOMParser).parseFromString(e.join(""),"text/html"),r=0,a=[];!function t(e,n){Array.from(e).forEach((function(e){"#text"===e.nodeName?n(e):t(e.childNodes,n)}))}(n.body.childNodes,(function(e){r>=t.length||(e.nodeValue=t[r++],a.push(function(t){for(;"BODY"!==(null===(e=t.parentNode)||void 0===e?void 0:e.nodeName);){var e;t=t.parentNode}return t}(e).outerHTML))}));for(var i=r;i<t.length;i++)a.push("<div>".concat(t[i],"</div>"));return a},cc=function(t){return Array.from(t).map((function(t){return t.innerText}))},lc=[{name:"pyramid",category:"DSL",type:"dsl",htmls:["<div>第一层</div>","<div>第二层</div>","<div>第三层</div>"],width:450,height:450,outline:{path:function(t,e){return[["M",0,e],["L",t/2,0],["L",t,e],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:12.3,y:12.5},{name:"L",x:19.5,y:12.5}]},{d:[{name:"M",x:9.5,y:18},{name:"L",x:22.6,y:18}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var t=[],e=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){e.push({html:n}),t.push(1)})),{models:e,info:t}},toText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=(new DOMParser).parseFromString(t.join(""),"text/html");return cc(e.body.childNodes).join("\n")},toHtmls:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return oc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),t)}},{name:"stage",category:"DSL",type:"dsl",htmls:["<div>阶段一</div>","<div>阶段二</div>","<div>阶段三</div>"],width:450,height:50,outline:{path:function(t,e){return[["M",0,0],["L",t-25,0],["L",t,e/2],["L",t-25,e],["L",0,e],["Z"]]}},scene:[],thumb:[{d:[["M",6.7,10.5],["L",22.9466615,10.5],["C",23.0746361,10.5,23.1948849,10.5612336,23.270156,10.6647313],["L",27.1503514,16],["L",27.1503514,16],["L",23.270156,21.3352687],["C",23.1948849,21.4387664,23.0746361,21.5,22.9466615,21.5],["L",6.7,21.5],["C",6.4790861,21.5,6.3,21.3209139,6.3,21.1],["L",6.3,10.9],["C",6.3,10.6790861,6.4790861,10.5,6.7,10.5],["Z"]]},{d:[["M",13.6,10.5],["L",17.6,16],["L",13.6,21.5]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var t=[],e=[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){e.push({html:n}),t.push(1)})),{models:e,info:t}},toText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=(new DOMParser).parseFromString(t.join(""),"text/html");return cc(e.body.childNodes).join(",")},toHtmls:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return oc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(","),t)}},{name:"segmented pyramid",category:"DSL",type:"dsl",htmls:["<div>观点一</div>","<div>观点二</div>","<div>观点三</div>","<div>观点四</div>"],width:450,height:450,outline:{path:function(t,e){return[["M",0,e],["L",t/2,0],["L",t,e],["Z"]]}},scene:[],thumb:[{d:[["M",16.438108,6.7965599],["L",24.9424723,22.2590406],["C",25.0755505,22.501001,24.9872841,22.8050298,24.7453238,22.938108],["C",24.6715013,22.9787103,24.5886159,23,24.5043644,23],["L",7.4956356,23],["C",7.2194932,23,6.9956356,22.7761424,6.9956356,22.5],["C",6.9956356,22.4157485,7.0169253,22.3328631,7.0575277,22.2590406],["L",15.561892,6.7965599],["C",15.6949702,6.5545996,15.998999,6.4663332,16.2409594,6.5994113],["C",16.3240392,6.6451053,16.392414,6.7134801,16.438108,6.7965599],["Z"]]},{d:[{name:"M",x:20.5511187,y:14.4004187},{name:"L",x:11.0329065,y:14.5869445}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:11.2505579,y:14.370259}]},{d:[{name:"M",x:15.8351703,y:22.8219869},{name:"L",x:20.5511187,y:14.370259}]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(){var t=[],e=[];(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(n){e.push({html:n}),t.push(1)}));var n=Math.ceil(Math.sqrt(e.length));return{models:e,info:t,otherInfo:{rows:n}}},toText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=(new DOMParser).parseFromString(t.join(""),"text/html");return cc(e.body.childNodes).join("\n")},toHtmls:function(){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=oc((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n"),t),n=Math.ceil(Math.sqrt(e.length)),r=n*n,a=e.length;a<r;a++)e.push("");return e}},{name:"architecture",category:"DSL",type:"dsl",htmls:[["<div>模块1.1</div>","<div>模块1.2</div>"],["<div>模块2</div>"],["<div>模块3.1</div>","<div>模块3.2</div>"]],width:450,height:450,outline:{path:function(t,e){return Ji(t,e,4)}},scene:[],thumb:[{d:[["M",7,8.5],["L",25,8.5],["C",25.5522847,8.5,26,8.9477153,26,9.5],["L",26,22],["C",26,22.5522847,25.5522847,23,25,23],["L",7,23],["C",6.4477153,23,6,22.5522847,6,22],["L",6,9.5],["C",6,8.9477153,6.4477153,8.5,7,8.5],["Z"]]},{d:[["M",9.1,17],["L",14.15,17],["C",14.4813708,17,14.75,17.2686292,14.75,17.6],["L",14.75,19.9],["C",14.75,20.2313708,14.4813708,20.5,14.15,20.5],["L",9.1,20.5],["C",8.7686292,20.5,8.5,20.2313708,8.5,19.9],["L",8.5,17.6],["C",8.5,17.2686292,8.7686292,17,9.1,17],["Z"]]},{d:[["M",9.1,11],["L",22.9,11],["C",23.2313708,11,23.5,11.2686292,23.5,11.6],["L",23.5,13.9],["C",23.5,14.2313708,23.2313708,14.5,22.9,14.5],["L",9.1,14.5],["C",8.7686292,14.5,8.5,14.2313708,8.5,13.9],["L",8.5,11.6],["C",8.5,11.2686292,8.7686292,11,9.1,11],["Z"]]},{d:[["M",17.85,17],["L",22.9,17],["C",23.2313708,17,23.5,17.2686292,23.5,17.6],["L",23.5,19.9],["C",23.5,20.2313708,23.2313708,20.5,22.9,20.5],["L",17.85,20.5],["C",17.5186292,20.5,17.25,20.2313708,17.25,19.9],["L",17.25,17.6],["C",17.25,17.2686292,17.5186292,17,17.85,17],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],parse:function(t){var e=[],n=[];return t.forEach((function(t){t.forEach((function(t){n.push({html:t})})),e.push(t.length)})),{models:n,info:e}},toText:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){var e=(new DOMParser).parseFromString(t.join(""),"text/html");return cc(e.body.childNodes).join(",")})).join("\n")},toHtmls:function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("\n").map((function(e,n){return oc(e.split(","),t[n]||[])}))}}],sc=[].concat(D()(Jo),D()(tc),D()(ac),D()([{name:"er-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-entity",width:120,height:70,outline:{name:"rect",x:0,y:0,width:120,height:70,rx:1,ry:1},scene:[{name:"rect",x:5,y:5,width:110,height:60,rx:1,ry:1,attr:{fill:"transparent"}}],thumb:[{d:[["M",6.4,9],["L",25.6,9],["C",25.8209139,9,26,9.1790861,26,9.4],["L",26,22.6],["C",26,22.8209139,25.8209139,23,25.6,23],["L",6.4,23],["C",6.1790861,23,6,22.8209139,6,22.6],["L",6,9.4],["C",6,9.1790861,6.1790861,9,6.4,9],["Z"]]},{d:[["M",8.4,11],["L",23.6,11],["C",23.8209139,11,24,11.1790861,24,11.4],["L",24,20.6],["C",24,20.8209139,23.8209139,21,23.6,21],["L",8.4,21],["C",8.1790861,21,8,20.8209139,8,20.6],["L",8,11.4],["C",8,11.1790861,8.1790861,11,8.4,11],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"derived-attribute",width:120,height:70,outline:{d:[["M",60,70],["C",93.137085,70,120,54.3299662,120,35],["C",120,15.6700338,93.137085,0,60,0],["C",26.862915,0,0,15.6700338,0,35],["C",0,54.3299662,26.862915,70,60,70],["Z"]],attr:{stroke:{style:"dash"}}},scene:[],thumb:[{d:[["M",16,24],["C",22.0751322,24,27,20.418278,27,16],["C",27,11.581722,22.0751322,8,16,8],["C",9.9248678,8,5,11.581722,5,16],["C",5,20.418278,9.9248678,24,16,24],["Z"]],attr:{"stroke-dasharray":"2"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"multivalued-attribute",width:120,height:70,outline:{name:"ellipse",cx:60,cy:35,rx:60,ry:35},scene:[{name:"ellipse",cx:60,cy:35,rx:55,ry:30,attr:{fill:"transparent"}}],thumb:[{name:"ellipse",cx:16,cy:16,rx:11,ry:8},{name:"ellipse",cx:16,cy:16,rx:9,ry:6,attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[],thumb:[{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"weak-relationship",width:120,height:70,outline:{name:"polygon",points:[{x:60,y:0},{x:120,y:35},{x:60,y:70},{x:0,y:35}]},scene:[{name:"polygon",points:[{x:60.4285714,y:5},{x:111.857143,y:35},{x:60.4285714,y:65},{x:9,y:35}],attr:{fill:"transparent"}}],thumb:[{d:[["M",16.2309401,10.1632993],["L",24.0234012,15.6734014],["C",24.2037766,15.8009461,24.2466044,16.0505647,24.1190597,16.2309401],["C",24.0928359,16.2680261,24.0604872,16.3003748,24.0234012,16.3265986],["L",16.2309401,21.8367007],["C",16.0925332,21.9345692,15.9074668,21.9345692,15.7690599,21.8367007],["L",7.9765988,16.3265986],["C",7.7962234,16.1990539,7.7533956,15.9494353,7.8809403,15.7690599],["C",7.9071641,15.7319739,7.9395128,15.6996252,7.9765988,15.6734014],["L",15.7690599,10.1632993],["C",15.9074668,10.0654308,16.0925332,10.0654308,16.2309401,10.1632993],["Z"]]},{d:[["M",16.2309401,8.1632993],["L",26.8518283,15.6734014],["C",27.0322037,15.8009461,27.0750315,16.0505647,26.9474868,16.2309401],["C",26.921263,16.2680261,26.8889143,16.3003748,26.8518283,16.3265986],["L",16.2309401,23.8367007],["C",16.0925332,23.9345692,15.9074668,23.9345692,15.7690599,23.8367007],["L",5.1481717,16.3265986],["C",4.9677963,16.1990539,4.9249685,15.9494353,5.0525132,15.7690599],["C",5.078737,15.7319739,5.1110857,15.6996252,5.1481717,15.6734014],["L",15.7690599,8.1632993],["C",15.9074668,8.0654308,16.0925332,8.0654308,16.2309401,8.1632993],["Z"]],attr:{fill:"transparent"}}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",33,0],["L",33,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",16.5,22],["L",16.5,26],["M",16.5,7],["L",16.5,11]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"},{name:"total-generalization",width:66,height:68,isClip:!1,outline:{d:[["M",33,54],["L",1,14],["L",65,14],["L",33,54],["Z"],["M",33,54],["L",33,68],["M",23,0],["L",23,14],["M",43,0],["L",43,14]]},scene:[],thumb:[{d:[["M",16.5,22],["L",7,11],["L",26,11],["L",16.5,22],["Z"],["M",11.5,7],["L",11.5,11],["M",20.5,7],["L",20.5,11],["M",16.5,22],["L",16.5,26]]}],anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],category:"ER"}]),D()(ic),D()(lc));function uc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var dc=function(){function t(e){m()(this,t),c()(this,"autoSelect",!0),c()(this,"diagram",void 0),this.diagram=null==e?void 0:e.diagram,Object.assign(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?uc(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e))}return y()(t,[{key:"commandName",get:function(){return this.constructor.className}},{key:"execute",value:function(t){}},{key:"forward",value:function(){}},{key:"backward",value:function(){}},{key:"select",value:function(t){var e=this.diagram;this.autoSelect&&(t&&t.length>0?e.selector.select(t):(e.selector.clear(),e.tryFocus()))}}],[{key:"enable",value:function(t){return!0}}]),t}();c()(dc,"className","Command"),c()(dc,"isModelChange",!0),c()(dc,"Update",void 0),c()(dc,"Add",void 0);var hc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"map",new Map),t}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.model,n=void 0===e?{}:e,r=this.cellOptions,a=ir(n,void 0===r?{}:r);a[0].forEach((function(t){t.id||(t.id=Object(F.a)())}));var i=t.add.apply(t,D()(a));i.forEach((function(e,n){Object.assign(a[1][n],t.getCellOptions(e))})),this.changeArguments=a,this.select(i)}},{key:"forward",value:function(){var t=this.diagram,e=this.changeArguments,n=t.add.apply(t,D()(e));this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.changeArguments,n=t.find(e[0][0].id).parent;t.remove(e[0].map((function(t){return t.id}))),this.select(n&&n.model.id)}}]),n}();c()(hc,"className","Add");var fc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"getCells",value:function(){var t=this.changeArguments,e=this.diagram,n=t[0].map((function(t){return e.find(t)}));if(n.some((function(t){return!t})))throw new Error("can not find the cell");return n}},{key:"execute",value:function(){var t=this.diagram,e=this.model,n=this.cellOptions,r=void 0===n?{}:n,a=this.originModels,o=this.notSelect,c=this.id;Array.isArray(c)||(c=[c]),"object"===i()(c[0])&&(c=c.map((function(t){return t.model.id})));var l=ir(c,e,r);this.changeArguments=l;var s=this.getCells(),u=l[1];this.originModels=a||s.map((function(t,e){var n=u[e];return Object.keys(n).reduce((function(t,r){if("children"===r)return t;var a=n[r],i=s[e].model[r];return d()(a)?t[r]=Object.keys(a).reduce((function(t,e){var n=i&&i[e];return t[e]=null==n?null:n,t}),{}):t[r]=null==i?null:i,t}),{})})),this.originCellOptions=s.map((function(e){return t.getCellOptions(e)}));for(var h=0;h<u.length;h++)gn(this.originModels[h],u[h]);t.update(s,u,l[2]),o||this.select(s)}},{key:"forward",value:function(){var t=this.diagram,e=this.changeArguments,n=this.getCells(),r=e[1];t.update(n,r,e[2]),this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.originModels,n=this.originCellOptions,r=this.getCells();t.update(r,e,n),this.select(r)}}]),n}();c()(fc,"className","Update");var pc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"commands",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this.commands,e=t.length;t.forEach((function(t,n){t.autoSelect=n===e-1,t.execute()}))}},{key:"forward",value:function(){var t=this.commands,e=t.length;t.forEach((function(t,n){t.autoSelect=n===e-1,t.forward()}))}},{key:"backward",value:function(){for(var t=this.commands,e=t.length-1;e>=0;e--){var n=t[e];n.autoSelect=0===e,n.backward()}}}]),n}();c()(pc,"className","Compound");var mc=function(t){S()(n,pc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){}}]),n}();c()(mc,"className","NoneExecuteCompound");var vc=function(t){return t.reduce((function(t,e){return e.isStem?t.concat(e.getChildren()):t.concat(e)}),[])};var yc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.onlyCell,n=e?[e]:t.selector.selections,r=vc(t.deduplicate(n)).filter((function(t){return t.canCollapse()}));t.update(r,{collapsed:!0}),t.selector.select(r),this.cells=r.map((function(t){return t.model.id}))}},{key:"backward",value:function(){var t=this.diagram,e=this.cells;t.update(e,{collapsed:null}),t.selector.select(e)}},{key:"forward",value:function(){var t=this.diagram,e=this.cells;t.update(e,{collapsed:!0}),t.selector.select(e)}}]),n}();c()(yc,"className","Collapse"),c()(yc,"enable",(function(t){var e=t.selector.selections;return vc(t.deduplicate(e)).some((function(t){return t.canCollapse()}))}));var gc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.onlyCell,n=e?[e]:t.selector.selections,r=vc(t.deduplicate(n)).filter((function(t){return!t.canCollapse()&&t.canExpand()}));t.update(r,{collapsed:null}),t.selector.select(r),this.cells=r.map((function(t){return t.model.id}))}},{key:"backward",value:function(){var t=this.diagram,e=this.cells;t.update(e,{collapsed:!0}),t.selector.select(e)}},{key:"forward",value:function(){var t=this.diagram,e=this.cells;t.update(e,{collapsed:null}),t.selector.select(e)}}]),n}();c()(gc,"className","Expand"),c()(gc,"enable",(function(t){var e=t.selector.selections;return vc(t.deduplicate(e)).some((function(t){return!t.canCollapse()&&t.canExpand()}))}));var bc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){this.diagram.command.undo()}}]),n}();c()(bc,"className","Undo"),c()(bc,"enable",(function(t){return t.command.index>=0}));var xc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){this.diagram.command.redo()}}]),n}();c()(xc,"className","Redo"),c()(xc,"enable",(function(t){var e=t.command;return e.index<e.commands.length-1}));var kc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram.viewport;t.setViewport(t.zoom+.2)}}]),n}();c()(kc,"className","ZoomIn"),c()(kc,"isModelChange",!1),c()(kc,"enable",(function(t){var e=t.viewport;return e.zoom+.2<=e.maxZoom}));var wc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram.viewport;t.setViewport(t.zoom-.2)}}]),n}();c()(wc,"className","ZoomOut"),c()(wc,"isModelChange",!1),c()(wc,"enable",(function(t){var e=t.viewport;return e.zoom-.2>=e.minZoom}));var Cc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),r=e.call(this,t);var a=E()(r).diagram.viewport;return r.queue=!1,r.zoom=t.zoom<a.minZoom&&a.minZoom||t.zoom>a.maxZoom&&a.maxZoom||t.zoom,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.zoom;t.viewport.setViewport(e)}}]),n}();c()(Cc,"className","ZoomTo"),c()(Cc,"isModelChange",!1);var Ac=function(){function t(){m()(this,t),this.clipboardData={setData:function(t,e){this[t]=e},getData:function(t){return this[t]},files:[]}}return y()(t,[{key:"preventDefault",value:function(){}}]),t}();function Oc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ec(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oc(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pc(t,e){return on(t.reduce((function(t,n){return yr(n)?t.push.apply(t,[n].concat(D()(n.children),D()(n.contain.map(e.find.bind(e)).filter((function(t){return t}))))):br(n)||dr(n)?t.push.apply(t,[n].concat(D()(n.children))):fr(n)?n.deepEachWithoutSelf((function(e){t.push(e)})):t.push(n),t}),[]))}function Sc(){return(Sc=dt()(ft.a.mark((function t(e,n){var r,a,i,o;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.exporter.blob("png",{cells:Pc(e.selector.selections,e)});case 2:r=t.sent,a=new Blob([n.text],{type:"text/plain"}),i=new Blob([n.html],{type:"text/html"}),o=new window.ClipboardItem({"text/html":i,"text/plain":a,"image/png":r}),window.navigator.clipboard.write([o]);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Mc(t,e){e.importer.caches={};var n=e.selector.selections;if(0!==n.length){t.preventDefault();var a=e.exporter.clipboard(n);try{var i,o,c;document.hasFocus()&&null!==(i=window)&&void 0!==i&&null!==(o=i.navigator)&&void 0!==o&&null!==(c=o.clipboard)&&void 0!==c&&c.write&&pt.ua.chrome&&function(t,e){Sc.apply(this,arguments)}(e,a)}catch(t){console.warn("Asynchronous clipboard is not supported")}t.clipboardData.setData("text/html",a.html),t.clipboardData.setData("text/plain",a.text);try{r.LocalStorageUtil.setItem("lake_diagram_clipboard_data",JSON.stringify(Ec(Ec({},a),{},{recordTime:Date.now()})))}catch(t){console.warn("Failed to execute 'setItem' on 'Storage': Setting the value of 'lake_diagram_clipboard_data' exceeded the quota.")}}}var jc=new Ac;function Rc(t,e,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!document.execCommand(t))if("paste"!==t)e.command.execute(t.charAt(0).toUpperCase()+t.slice(1),{e:jc});else{var i=r.LocalStorageUtil.getItem("lake_diagram_clipboard_data");if(i){i=JSON.parse(i);var o=pt.ua.macos?"⌘+V":"Ctrl+V";a&&kt.a.info(Mr("已粘贴当前页面复制的内容，如需粘贴页面外内容请使用 ")+o+Mr(" 粘贴")),jc.clipboardData.setData("text/html",i.html),jc.clipboardData.setData("text/plain",i.text),e.command.execute("Paste",{e:jc,focusPoint:n})}}}window.__lake_diagram_board_custom_clipboard_event=jc;var Lc=Object.freeze({__proto__:null,getCopyImageCells:Pc,handleCopy:Mc,customClipboardEvent:jc,executeClipboardCommand:Rc});function Bc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Dc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bc(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({queue:!1},t))}return y()(n,[{key:"execute",value:function(){Mc(this.e,this.diagram)}}]),n}();c()(Dc,"className","Copy"),c()(Dc,"isModelChange",!1);var Nc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.e,n=this.focusPoint,r=e.clipboardData.getData("text/html"),a=e.clipboardData.getData("text/plain"),i=Array.from(e.clipboardData.files),o={text:a,html:r};i.length>0&&(""===r&&/^.+\.\w+$/.test(a)||""===a&&/^(<meta.+?>)?<img.+?>$/.test(r)||!a||!r)&&(o.files=i);var c=t.importer.clipboard(o,n);c?(this.handler=c,d()(c)&&(this.selectedCellId=t.selector.selections.map((function(t){return t.model.id})),t.destroyed||(t.signal.beforePasteSelect=!0,t.selector.select(this.handler.body.map((function(t){return t.id}))),t.signal.beforePasteSelect=!1))):this.queue=!1}},{key:"forward",value:function(){var t=this.handler,e=this.diagram;t&&(t.execute(),e.selector.select(this.handler.body.map((function(t){return t.id}))))}},{key:"backward",value:function(){var t=this.handler,e=this.diagram,n=this.selectedCellId;t&&(t.body.forEach((function(t){e.remove(t.id)})),n&&e.selector.select(n))}}]),n}();function _c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Nc,"className","Paste");var Ic=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){return m()(this,n),e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_c(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({queue:!1},t))}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.selector.selections[0];t.command.execute("ZoomTo",{zoom:1}),t.viewport.focus([e.x,e.y])}}]),n}();c()(Ic,"className","FocusSelection"),c()(Ic,"enable",(function(t){return 1===t.selector.selections.length}));var Tc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.id,n=this.endHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(t){return{html:t}}))),t.update(e,r)}},{key:"forward",value:function(){var t=this.diagram,e=this.endHTML,n=this.id,r={html:e};Array.isArray(e)&&(r=e.map((function(t){return{html:t}}))),t.update(n,r),this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(t){return{html:t}}))),t.update(e,r),this.select(e)}}]),n}();c()(Tc,"className","UpdateCellContent");var Fc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=Mr("链接"),n=window.getSelection(),r=null==n?void 0:n.getRangeAt(0),a=null==r?void 0:r.commonAncestorContainer;if(t.contentEditor.dom&&a===t.contentEditor.dom){var i=null==a?void 0:a.querySelectorAll("a");if(1===i.length){var o=i[0].getAttribute("href");o&&(e=o)}}t.contentEditor.execCommand("createLink",e)}}]),n}();c()(Fc,"className","CreateLink"),c()(Fc,"enable",(function(t){var e=t.getCell(t.contentEditor.dom);return!!t.contentEditor.getRange()&&!!e}));var zc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r.onBeginInsertLine=function(t){if(r.sourceCell){var e=E()(r),n=e.diagram,a=e.beginInsertEvent,i=n.viewport.invertClient([t.clientX,t.clientY]);n.emit("begininsertline",{source:{id:r.sourceCell.model.id,connection:null},target:{id:null,connection:[i[0],i[1]]}}),n.off(a,r.onBeginInsertLine)}},r}return y()(n,[{key:"bindBegineInsertEvent",value:function(){var t=this.diagram,e=this.sourceCell,n=this.beginInsertEvent;t.off(n,this.onBeginInsertLine),e&&t.on(n,this.onBeginInsertLine)}},{key:"execute",value:function(){var t=this.diagram,e=this.shape,n=this.beginInsertEvent,r=t.selector.selections;1!==r.length||r[0].isLine||r[0].isGroup||(this.sourceCell=r[0],n="mousemove"),t.selector.clear(),t.tryFocus(),t.interaction.changeMode("beginInsertLine"),t.settings.line.shape=e,this.beginInsertEvent=n,this.beginInsertEvent&&this.bindBegineInsertEvent()}}],[{key:"enable",value:function(){return!0}}]),n}();c()(zc,"className","BeginInsertLine"),c()(zc,"isModelChange",!1),dc.Add=hc,dc.Update=fc;var qc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.name,n=this.value,r=t.selector,a=t.contentEditor,i=r.selections,o=[];i.forEach((function(t){var e,n=t.getCanTextCell();Array.isArray(n)?(e=o).push.apply(e,D()(n)):o.push(t)}));var c=(o=on(o)).map((function(t){return t.textareaElement.htmlContainer})),l=c.map((function(t){return t.innerHTML}));t.contentEditor.batchEdit(c,e,n);var s=c.map((function(t){return t.innerHTML})),u={html:s};Array.isArray(s)&&(u=s.map((function(t){return{html:t}}))),this.endHTML=s,this.startHTML=l,this.id=o,t.update(o,u),1!==o.length||a.isBegin||a.prepareEdit()}},{key:"forward",value:function(){var t=this.diagram,e=this.endHTML,n=this.id,r={html:e};Array.isArray(e)&&(r=e.map((function(t){return{html:t}}))),t.update(n,r),this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.id,n=this.startHTML,r={html:n};Array.isArray(n)&&(r=n.map((function(t){return{html:t}}))),t.update(e,r),this.select(e)}}],[{key:"enable",value:function(t){return t.selector.selections.filter((function(t){return t.canUpdateText()})).length>0}}]),n}();c()(qc,"className","ContentCommand");var Yc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(t){var e=this.diagram,n=this.cells,r=n.map((function(t){return t.model.id})),a=n.map((function(t){return e.getCellOptions(t)}));n.forEach((function(e){e[t]()}));var i=n.map((function(t){return e.getCellOptions(t)}));this.beforeCellOptions=a,this.afterCellOptions=i,this.id=r,this.select(r)}},{key:"backward",value:function(){var t=this.diagram,e=this.id,n=this.beforeCellOptions;t.update(e,{},n),this.select(e)}},{key:"forward",value:function(){var t=this.diagram,e=this.id,n=this.afterCellOptions;t.update(e,{},n),this.select(e)}}]),n}();c()(Yc,"className","ZIndex");var Hc=function(t){S()(n,Yc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"toBack")}}]),n}();c()(Hc,"className","ToBack");var Gc=function(t){S()(n,Yc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"toFront")}}]),n}();c()(Gc,"className","ToFront");var Xc=function(t){S()(n,Yc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"forward")}}]),n}();c()(Xc,"className","Forward");var Wc=function(t){S()(n,Yc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"backward")}}]),n}();c()(Wc,"className","Backward");var Vc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){this.diagram.viewport.autoFit()}}]),n}();c()(Vc,"className","FitViewport"),c()(Vc,"isModelChange",!1);var Zc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram;t.selector.select(t.getCells().filter((function(t){return t.state.visible})))}}]),n}();c()(Zc,"className","SelectAll"),c()(Zc,"isModelChange",!1);var Uc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){this.diagram.viewport.setViewport(1)}}]),n}();c()(Uc,"className","ActualSize"),c()(Uc,"isModelChange",!1);var Kc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.selector.selections[0];t.contentEditor.prepareEdit(),t.contentEditor.beginEdit(),t.update(e,{})}}],[{key:"enable",value:function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return t.textareaElement}))}}]),n}();c()(Kc,"className","BeginEditContent"),c()(Kc,"isModelChange",!1);var Qc=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram;if("dragCanvas"===t.interaction.currentMode)t.interaction.changeMode("edit"),t.signal.buttonDragCanvas=!1;else t.highlight.clear(),t.interaction.changeMode("dragCanvas"),t.signal.buttonDragCanvas=!0}}]),n}();function $c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Qc,"className","ButtonDragCanvas"),c()(Qc,"isModelChange",!1);var Jc=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"index",-1),c()(this,"commands",[]),c()(this,"commandConstructors",void 0),this.commandConstructors={ToBack:Hc,ToFront:Gc,Forward:Xc,Backward:Wc,Add:hc,Update:fc,Compound:pc,NoneExecuteCompound:mc,Collapse:yc,Expand:gc,Undo:bc,Redo:xc,ZoomIn:kc,ZoomOut:wc,ZoomTo:Cc,ActualSize:Uc,FitViewport:Vc,UpdateCellContent:Tc,ContentCommand:qc,FocusSelection:Ic,Copy:Dc,Paste:Nc,CreateLink:Fc,BeginInsertLine:zc,SelectAll:Zc,ButtonDragCanvas:Qc,BeginEditContent:Kc}}return y()(t,[{key:"find",value:function(t){var e=this.diagram;return!t||e&&e.destroyed?null:"string"==typeof t?this.commandConstructors[t]:t.constructor}},{key:"enable",value:function(t){var e=this.find(t);return e&&(!e.enable||e.enable(this.diagram))||!1}},{key:"register",value:function(t){this.commandConstructors[t.className]=t}},{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this.commandConstructors[t](function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$c(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({diagram:this.diagram},e))}},{key:"execute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram;if(!n||!n.destroyed){"string"==typeof t&&(t=this.create(t,e));var r=t.constructor,a={commandName:r.className,command:t,prevent:!1,useTime:0,isModelChange:!0};if(n&&n.emit("beforecommandexecute",a),this.enable(t)&&!0!==a.prevent&&this.commands){var i=+new Date;t.execute(),!1!==t.queue&&(this.index>-1?this.commands=this.commands.slice(0,this.index+1):this.commands=[],this.commands.push(t),this.index=this.commands.indexOf(t)),a.useTime=+new Date-i,a.isModelChange=r.isModelChange,n&&n.emit("aftercommandexecute",a)}return t}}},{key:"redo",value:function(){var t=this.index,e=this.commands,n=this.diagram;if(e&&!(t>=e.length-1)){var r=e[++t];n&&n.emit("beforecommandforward",{command:r}),r.forward(),n&&n.emit("aftercommandforward",{command:r}),this.index=t}}},{key:"undo",value:function(){var t=this.index,e=this.commands,n=this.diagram;if(e&&!(t<0)){var r=e[t];n&&n.emit("beforecommandbackward",{command:r}),r.backward(),n&&n.emit("aftercommandbackward",{command:r}),this.index=--t}}},{key:"destroy",value:function(){this.commands=[]}}]),t}();function tl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function el(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tl(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function nl(t,e){return t.nodeType===Node.ELEMENT_NODE&&(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector).call(t,e)}function rl(t,e,n){for(;t&&n.contains(t);){if("string"==typeof e&&nl(t,e)||"function"==typeof e&&e(t))return t;t=t.parentNode}return null}function al(t,e){var n=t.getAttribute("style");return n&&n.includes(e)}function il(t){for(var e=t.firstChild;e;){var n=e.nextSibling;t.parentNode.insertBefore(e,t),e=n}t.parentNode.removeChild(t)}function ol(t,e){return e.tagName!==t||e.childNodes&&e.childNodes[0]&&3!==e.childNodes[0].nodeType&&(e.childNodes[0].tagName===t||1!==e.childNodes.length)?e.childNodes[0]&&ol(t,e.childNodes[0]):e}function cl(t,e){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return{};if(e){var i=e.startContainer;if(i===t)n=ol("SPAN",t),r=ol("DIV",t);else{var o=rl(i,(function(t){return 1===t.nodeType}),t);n=o,r=o}}else n=ol("SPAN",t),r=ol("DIV",t);return function(t,e,n,r){var a=function(t,e){if(!t)return{};var n=window.getComputedStyle(t),r=n["text-align"],a=parseInt(n["font-size"]),i=n.color;return{textAlign:r,fontSize:e.fontSize?e.fontSize.value:a,color:e.foreColor?e.foreColor.value:i}}(t,n),i=function(t,e,n){if(!t)return{};var r=window.getComputedStyle(t),a=parseInt(r["font-size"]),i=r.color;return{bold:e.bold?!e.bold.cancel:!!rl(t,(function(t){return al(t,"bold")}),n),italic:e.italic?!e.italic.cancel:!!rl(t,(function(t){return al(t,"italic")}),n),strikethrough:e.strikethrough?!e.strikethrough.cancel:!!rl(t,(function(t){return al(t,"line-through")}),n),underline:e.underline?!e.underline.cancel:!!rl(t,(function(t){return al(t,"underline")}),n),fontSize:e.fontSize?e.fontSize.value:a,color:e.foreColor?e.foreColor.value:i}}(e,n,r);return el(el({bold:!1,italic:!1,strikethrough:!1,underline:!1},a),i)}(r,n,a,t)}function ll(t){if(t.preventDefault(),this.isBegin){t.stopPropagation();var e=t.clipboardData.getData("text/plain"),n=t.clipboardData.getData("text/html");if(n){var r=(new DOMParser).parseFromString(n,"text/html");if(r&&1===r.body.childNodes.length&&"A"===r.body.childNodes[0].tagName)return this.execCommand("insertHTML",r.body.childNodes[0].outerHTML);if(n.includes("lake_diagram_content_editor_data"))return this.execCommand("insertHTML",r.querySelector("[data-lake_diagram_content_editor_data]").innerHTML)}return e&&/^https?:\/\/\S+$/.test(e)?this.execCommand("insertHTML",'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")):this.execCommand("insertText",e)}}function sl(t){return!t||t&&!t.match(/^[\x00-\x7F]/)||t.startsWith("javascript:")}function ul(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"copy";if(this.isBegin){t.stopPropagation(),"copy"===e&&t.preventDefault();var n=this.getRange(),r=document.createElement("div"),a=n.cloneContents();r.dataset.lake_diagram_content_editor_data=!0,r.appendChild(a),t.clipboardData.setData("text/html",r.outerHTML),t.clipboardData.setData("text",r.innerText)}}function dl(t,e,n){Ve(e,(function(e){if(1===e.nodeType){var n=e.getAttribute("style");n&&n.includes("font-size: x-small;")&&(e.style["font-size"]="".concat(t,"px"))}}),(function(t){return t.childNodes}));var r=[];Ve(e,(function(t){1===t.nodeType&&"FONT"===t.tagName&&r.push(t)}),(function(t){return t.childNodes})),r.length>0&&(n&&!n.collapsed&&Ve(n.commonAncestorContainer,(function(t){1===t.nodeType&&n.isPointInRange(t,0)&&(t.style["font-size"]="")}),(function(t){return t.childNodes})),r.forEach((function(e){var n=e.parentNode,r=document.createElement("span");r.style["font-size"]="".concat(t,"px"),n.insertBefore(r,e),r.appendChild(e),il(e);var a=r.childNodes[0];a&&"SPAN"===a.tagName&&1===r.childNodes.length&&(Object.keys(zr).forEach((function(t){a.style[t]&&"font-size"!==t&&(r.style[t]=a.style[t])})),il(a)),"SPAN"===n.tagName&&1===n.childNodes.length&&(Object.keys(zr).forEach((function(t){r.style[t]&&"font-size"!==t&&(n.style[t]=r.style[t])})),il(r))})))}c()(Jc,"className","Command");var hl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,t),c()(this,"onKey",void 0),c()(this,"offKey",void 0),c()(this,"events",void 0),c()(this,"destroyed",void 0),this.onKey="on",this.offKey="off",this.events=[],Object.assign(this,e)}return y()(t,[{key:"bind",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};t[(t===window||t instanceof HTMLElement||t instanceof SVGElement?"addEventListener":r.onKey)||this.onKey](e,n);var a={object:t,eventName:e,callback:n,options:r};return this.events.push(a),a}},{key:"_unbind",value:function(t){var e=t.object,n=t.eventName,r=t.callback,a=t.options;if(e[(e===window||e instanceof HTMLElement||e instanceof SVGElement?"removeEventListener":a.offKey)||this.offKey](n,r),this.events){var i=this.events.indexOf(t);-1!==i&&this.events.splice(i,1)}}},{key:"unbind",value:function(t){var e=this;t?this._unbind(t):this.events.concat([]).forEach((function(t){e._unbind(t)}))}},{key:"destroy",value:function(){this.events&&this.unbind(),this.events=[],this.destroyed=!0}}]),t}();function fl(t){return"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+t)))}var pl=["http:","https:","data:","dingtalk:","ftp:","mailto:","blob:"];function ml(t){return function(t){return"string"==typeof t&&!(t=t.toLowerCase()).startsWith("data:text/html")&&(!!pl.some((function(e){return t.startsWith(e)}))||!(!t.startsWith("./")&&!t.startsWith("/"))||t.indexOf(":")<0)}(t)?t:""}var vl=new Ct.a.FilterXSS({onIgnoreTag:function(){return""},css:{whiteList:zr},whiteList:{p:["style","id"],a:["href","title","target","style"],b:["style"],i:["style"],span:["style"],br:[],div:["style"]},onTag:function(t,e,n){var r=n.isClosing;if("a"===t&&!r&&"string"==typeof e){var a=e.match(/<a\s+(?:[^>]*?\s+)?href=(["'])(.*?)\1/);if(!a||!ml(a[2]))return""}},onTagAttr:function(t,e,n){if("a"===t&&"href"===e){var r=ml(n);return r?"".concat(e,'="').concat(r,'"'):""}}});function yl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return gl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bl(t){if(!t)return!1;var e=(new DOMParser).parseFromString(t,"text/html").querySelector("[data-lake_diagram_body]");return!!e&&{body:JSON.parse(e.dataset.lake_diagram_body),extraInformations:JSON.parse(e.dataset.lake_extra_informations||e.dataset.lake_computed_props_map)||{},optionsMap:{}}}function xl(t){return t&&(t=vl.process(t)),t||""}function kl(t){try{var e;e=t.includes("\r\n")?t.trim().split("\r\n"):t.trim().split("\n");var n,r,a,i,o,c=[],l=0,s=1/0,u=yl(e.map((function(t){if(0!==t.trim().length){var e=(t=t.replace(decodeURI("%0D"),"")).match(/^(\s*)(\S[\s\S]*)$/),n=b()(e,3),r=n[1],a=n[2],i=r.replace(/\t/g,"");return i.length>0&&i.length<s&&(s=i.length),{indent:r,html:a,spaceLength:i.length}}})).filter((function(t){return t})));try{for(u.s();!(o=u.n()).done;){var d,h=o.value,f=h.indent,p=h.html,m=s===1/0?f:f.replace(/\t/g," ".repeat(s)),v="",y=!0,g=yl(p);try{for(g.s();!(d=g.n()).done;){var x=d.value;if("\n"!==x)v+=x;else{if(y){v+="<div>",y=!1;continue}v+="</div><div>"}}}catch(t){g.e(t)}finally{g.f()}y||(v+="</div>"),!i&&m&&n&&(i=m.length);var k=m.length/i;if(k)if(k>l)r=a,a={html:v},r.children=[a],l+=1;else if(k===l)a={html:v},r.children.push(a);else{var w=0;for(r=n;w<k-1;)r=r.children[r.children.length-1],w++;a={html:v},l=k,r.children.push(a)}else n=r=a={html:v},c.push(n),l=0}}catch(t){u.e(t)}finally{u.f()}return c}catch(t){return null}}var wl=Object.freeze({__proto__:null,getLakeDataByHtml:bl,parseHTML:xl,structuredPlainText:kl});function Cl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Al=pt.HotKeyUtils.isHotkey,Ol=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this)).diagram=t,c()(E()(r),"eventHelper",new hl),c()(E()(r),"isBegin",!1),c()(E()(r),"dom",void 0),c()(E()(r),"eventObj",{}),c()(E()(r),"originCursor",void 0),c()(E()(r),"compositing",!1),c()(E()(r),"readyCommands",{}),r}return y()(n,[{key:"_getFormattingFlags",value:function(t,e){var n=[],r=0;switch(e){case"bold":case"italic":case"underline":case"strikethrough":t.forEach((function(t){var a=t.querySelector("span");("bold"===e?"bold"===(null==a?void 0:a.style.fontWeight):"italic"===e?"italic"===(null==a?void 0:a.style.fontStyle):"underline"===e?null==a?void 0:a.style.textDecorationLine.includes("underline"):null==a?void 0:a.style.textDecorationLine.includes("line-through"))?(r++,n.push(!1)):n.push(!0)})),r===t.length&&(n=n.map((function(){return!0})));break;default:n=t.map((function(){return!0}))}return n}},{key:"batchEdit",value:function(t,e,n){var r,a=this,i=window.getSelection();try{r=null==i?void 0:i.getRangeAt(0)}catch(t){}var o=this._getFormattingFlags(t,e);t.forEach((function(t,r){var c=document.createRange();c.selectNodeContents(t),null==i||i.removeAllRanges(),null==i||i.addRange(c);var l=t.getAttribute("contenteditable");t.setAttribute("contenteditable","true"),"fontSize"===e?(a._execCommand(e,"1"),dl(n,t,c)):o[r]&&a._execCommand(e,n),l||t.removeAttribute("contenteditable")})),null==i||i.removeAllRanges(),r&&(null==i||i.addRange(r))}},{key:"prepareEdit",value:function(){var t=this.dom;if(t){this.updateStartContent();var e=window.getSelection(),n=document.createRange();t.focus(),n.selectNodeContents(t),null==e||e.removeAllRanges(),null==e||e.addRange(n),this.emit("prepareedit")}}},{key:"closest",value:function(t,e){return rl(t,e,this.dom)}},{key:"getRange",value:function(){if(!this.dom)return null;var t=window.getSelection();try{var e=null==t?void 0:t.getRangeAt(0);return e&&!this.dom.contains(e.commonAncestorContainer)?null:e}catch(t){return null}}},{key:"_execCommand",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];document.execCommand("styleWithCss",!1,"true");var r=document.execCommand(t,n,e);return{result:r,eventObj:{name:t,showUI:n,value:e,result:r,target:void 0}}}},{key:"convertFontSize",value:function(t){var e=this.getRange();dl(t,this.dom,e)}},{key:"execReadyCommand",value:function(){this.readyCommands.fontSize&&this.convertFontSize(this.readyCommands.fontSize.value),this.readyCommands={}}},{key:"execCommand",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getRange();if(r&&t){if("fontSize"===t){var a=this._execCommand(t,"1",n),i=a.result,o=a.eventObj;return this.convertFontSize(e),this.afterExecCommand({name:t,value:e,result:i,eventObj:o}),i}if("createLink"===t){var c=this._execCommand(t,e,n),l=c.result,s=c.eventObj;if(l){var u,d,h=null===(u=this.dom)||void 0===u?void 0:u.querySelectorAll("a"),f=null===(d=r=this.getRange())||void 0===d?void 0:d.commonAncestorContainer;if(s.target=rl(f,"a",this.dom)||1===f.nodeType&&(null==f?void 0:f.querySelector("a")),h)for(var p=0;p<h.length;p++){var m=h[p];m.setAttribute("target","_blank"),m.style.cursor="default",sl(m.getAttribute("href"))&&m.setAttribute("href","")}}return this.afterExecCommand({name:t,value:e,result:l,eventObj:s}),l}var v=this._execCommand(t,e,n),y=v.result,g=v.eventObj;return this.afterExecCommand({name:t,value:e,result:y,eventObj:g}),y}}},{key:"getFirstTag",value:function(t){return ol(t,this.dom)}},{key:"afterExecCommand",value:function(t){var e=t.name,n=t.value,r=t.result,a=t.eventObj,i=this.getRange();if(null!=i&&i.collapsed)if(this.readyCommands[e])Object.assign(this.readyCommands[e],{value:n,result:r,cancel:!this.readyCommands[e].cancel});else{var o=this.getRange(),c=null==o?void 0:o.startContainer,l=c===this.dom?this.getFirstTag("SPAN"):this.closest(c,(function(t){return 1===t.nodeType}));this.readyCommands[e]={value:n,result:r,cancel:!!this.closest(l,(function(t){return al(t,"strikethrough"===e?"line-through":e)}))}}this.emit("execcommand",a),this.emitChangeEvent()}},{key:"emitChangeEvent",value:function(){this.emit("change",{dom:this.dom})}},{key:"emitTextareaKeydownEvent",value:function(t){this.emit("textareaKeydown",t)}},{key:"beginEdit",value:function(){if(this.dom){this.isBegin=!0,this.emit("beginedit",this.eventObj),document.execCommand("styleWithCss",!1,"true"),this.dom.classList.remove("selection-transparent");var t=escape(this.dom.innerText);if(this.dom.style.cursor="text","%u200B"===t||"%u200D"===t){var e=this.getRange();null==e||e.collapse()}this.emit("selectionchange")}}},{key:"forceEndEdit",value:function(){this.isBegin&&(this.endEdit(),this.prepareEdit())}},{key:"updateStartContent",value:function(){var t;this.eventObj&&(this.eventObj.startHTML=xl(null===(t=this.dom)||void 0===t?void 0:t.innerHTML))}},{key:"bind",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.eventHelper,a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cl(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({insertParagraphKey:function(t){},cancelKey:function(t){}},n),i=a.insertParagraphKey,o=a.cancelKey;this.originCursor=t.style.cursor,this.dom=t,t.setAttribute("contenteditable","true"),t.setAttribute("spellcheck","false"),t.focus({preventScroll:!0}),this.eventObj={dom:t},this.updateStartContent(),r.bind(t,"contextmenu",(function(t){e.isBegin&&t.stopPropagation()})),r.bind(document,"selectionchange",(function(){e.compositing||(e.execReadyCommand(),e.emit("selectionchange"))}),{onKey:"addEventListener",offKey:"removeEventListener"}),r.bind(t,"keydown",(function(t){var n=e.dom,r=e.diagram,a=e.getRange(),c=r.viewport.zoom;if(e.emitTextareaKeydownEvent(t),e.isBegin){if(Al("mod+k",t))return t.preventDefault(),t.stopPropagation(),void e.execCommand("createLink",Mr("链接"));if(i(t))return e.compositing||e.execCommand("insertParagraph",""),t.stopPropagation(),void t.preventDefault();if(o(t))return t.preventDefault(),t.stopPropagation(),void(e.compositing||e.forceEndEdit());if(Al("mod+s",t))return;if(function(t,e){var n=t.startContainer,r=t.startOffset;return!!t.collapsed&&function t(e,n,r){if(n>0)return!1;if(e===r)return!0;var a=e.parentNode;return!!a&&t(a,Array.from(a.childNodes).indexOf(e),r)}(n,r,e)}(a,n)&&"ArrowLeft"===t.key)return t.preventDefault(),void t.stopPropagation();if(function(t,e){var n=t.endContainer,r=t.endOffset;return!!t.collapsed&&function t(e,n,r){if(e.nodeType===Node.TEXT_NODE){if(n!==e.data.length)return!1}else if(n!==e.childNodes.length)return!1;if(e===r)return!0;var a=e.parentNode;return!!a&&t(a,Array.from(a.childNodes).indexOf(e)+1,r)}(n,r,e)}(a,n)&&"ArrowRight"===t.key)return t.preventDefault(),void t.stopPropagation();if(function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t.getBoundingClientRect(),i=e.getBoundingClientRect();return n=t.collapsed&&["x","y","width","height"].every((function(t){return 0===a[t]}))&&1===t.commonAncestorContainer.nodeType?t.commonAncestorContainer.getBoundingClientRect().y-i.y:a.y-i.y,(n=Math.abs(n/r))<6}(a,n,c)&&"ArrowUp"===t.key)return t.preventDefault(),void t.stopPropagation();if(function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t.getBoundingClientRect(),i=e.getBoundingClientRect();return n=t.collapsed&&["x","y","width","height"].every((function(t){return 0===a[t]}))&&1===t.commonAncestorContainer.nodeType?t.commonAncestorContainer.getBoundingClientRect().bottom-i.bottom:a.bottom-i.bottom,(n=Math.abs(n/r))<6}(a,n,c)&&"ArrowDown"===t.key)return t.preventDefault(),void t.stopPropagation();t.stopPropagation()}else{if(Al("mod+c",t)||Al("mod+v",t)||Al("mod+x",t)||Al("shift+enter",t)||Al("space",t))return;if(Al("mod+enter",t))return t.preventDefault(),t.stopPropagation(),void e.beginEdit();if(function(t){return!(t.altKey||t.ctrlKey||t.metaKey||["Enter","Tab","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Capslock","Esc","Home","Pause","Shift","Option","Alt","Help","Esc","Backspace","Delete","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(t.key))}(t))return t.stopPropagation(),void e.beginEdit();t.preventDefault()}})),r.bind(t,"compositionstart",(function(){e.compositing=!0})),r.bind(t,"compositionend",(function(){e.compositing=!1})),r.bind(t,"input",(function(t){t.stopPropagation(),e.isBegin?e.emitChangeEvent():t.preventDefault()})),r.bind(t,"paste",ll.bind(this)),r.bind(t,"copy",ul.bind(this)),r.bind(t,"cut",(function(t){ul.call(e,t,"cut")}))}},{key:"endEdit",value:function(){this.isBegin=!1,this.dom&&(this.eventObj.endHTML=xl(this.dom.innerHTML),this.dom.style.cursor=this.originCursor,this.dom.classList.add("selection-transparent")),this.emit("endedit",this.eventObj)}},{key:"unbind",value:function(){var t=this.dom,e=this.eventHelper;t&&(t.removeAttribute("contenteditable"),t.removeAttribute("spellcheck"),e.unbind(),this.endEdit(),this.dom=void 0)}},{key:"query",value:function(){return cl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dom,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getRange(),arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.readyCommands)}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(Ol,"className","ContentEditor");var El=function(){function t(e){m()(this,t),c()(this,"graphicGroup",void 0),c()(this,"dx",0),c()(this,"dy",0),this.graphicGroup=e}return y()(t,[{key:"translate",value:function(t,e){this.graphicGroup.update({matrix:[1,0,0,0,1,0,t,e,1]}),this.dx=t,this.dy=e}},{key:"getBBox",value:function(){return this.graphicGroup.getBBox()}},{key:"destroy",value:function(){this.graphicGroup.destroy()}}]),t}(),Pl=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"delegations",[])}return y()(t,[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this.diagram,n=new na;"function"==typeof t?t(n):((t=t.map((function(t){return e.find(t)})).filter((function(t){return t}))).sort((function(t,e){return t.getZIndex()-e.getZIndex()})),t.forEach((function(t){var e=new la({element:t.graphicGroup});n.add(e)}))),e.frontRootGroup.prepend(n);var r=new El(n);return this.delegations.push(r),r}},{key:"clear",value:function(){var t=this;this.delegations.forEach((function(e){t.remove(e)}))}},{key:"remove",value:function(t){var e=this.delegations;e.splice(e.indexOf(t),1),t.destroy()}},{key:"destroy",value:function(){this.delegations=[]}}]),t}();c()(Pl,"className","Delegator");var Sl=function(t,e){var n={};return e.forEach((function(e){var r=t.find(e);if(r){var a=r.mindmapParent;if(a&&a.isMindmap){var i=a.model.id,o=a.getChildren().indexOf(r),c=a.isTwoQuadrantLayout,l=o;if(c){var s,u,d=null!==(s=null===(u=r.model.layout)||void 0===u?void 0:u.quadrant)&&void 0!==s?s:1;i+=":"+d;var h=a.quadrantTreeLists[d-1];if(!h)throw new Error("no correct quad index list"+JSON.stringify(a.quadrantTreeLists));l=h.indexOf(o)}if(r.model.abstract){var f,p,m={id:r.model.id,index:o,q:c?null!==(f=null===(p=r.model.layout)||void 0===p?void 0:p.quadrant)&&void 0!==f?f:1:void 0,start:r.model.start,end:r.model.end};n[i]?n[i].abstracts.push(m):n[i]={indexes:[],childrenIds:[],childrenLength:a.model.children.filter((function(t){return!t.abstract})).length,abstracts:[m]}}else l>=0&&(n[i]?(n[i].indexes.push(l),n[i].childrenIds.push(r.model.id)):n[i]={indexes:[l],childrenIds:[r.model.id],childrenLength:a.model.children.filter((function(t){return!t.abstract})).length,abstracts:[]})}}})),n};function Ml(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jl(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ml(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ml(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Rl=function(t,e,n){var r,a,i="mindmap"===t.type;if(e&&e.isMindmap){if(delete t.type,delete t.x,delete t.y,delete t.zIndex,t.children){var o=t.layout,c=void 0===o?{}:o,l=c.type,s=void 0===l?"standard":l,u=c.quadrantConstraint,d=void 0===u?[1,2]:u;if(!i||"standard"!==s||null!==d&&2!==d.length)t.children.forEach((function(t){var e;2===(null===(e=t.layout)||void 0===e?void 0:e.quadrant)&&(t.layout.quadrant=1)}));else{t.children.sort((function(t,e){var n=t.layout,r=(void 0===n?{}:n).quadrant,a=void 0===r?1:r,i=t.abstract,o=e.layout,c=(void 0===o?{}:o).quadrant,l=void 0===c?1:c,s=e.abstract;return i&&s||!i&&!s?a-l:i?1:s?-1:0}));var h=t.children.filter((function(t){var e=t.layout,n=(void 0===e?{}:e).quadrant,r=void 0===n?1:n,a=t.abstract;return 1===r&&!a}));t.children.forEach((function(t){var e=t.layout,n=(void 0===e?{}:e).quadrant,r=void 0===n?1:n,a=t.abstract,i=t.start,o=void 0===i?0:i,c=t.end,l=void 0===c?0:c;return 2===r&&a&&(t.start=o+h.length,t.end=l+h.length),0}))}}}else t.layout&&delete t.layout.quadrant,delete t.collapsed,delete t.abstract,delete t.start,delete t.end,t.type="mindmap",t.layout=null!==(r=t.layout)&&void 0!==r?r:{type:"standard"},t.layout.type=null!==(a=t.layout.type)&&void 0!==a?a:"standard",i||t.children.forEach((function(t){t.layout&&(t.layout.quadrant=1)}));return t},Ll=function(t,e){e=e.concat([]);var n=Sl(t,e),r=[{},{}],a=e.filter((function(t){return!t.isMindmap})),i=a.map((function(t){return s()(t.model)})),o=e.filter((function(t){return t.isMindmap&&t.isStem})),c=o.length;a.push.apply(a,D()(o)),o.forEach((function(t){var e,n=s()(t.model);null!==(e=n.layout)&&void 0!==e&&e.quadrant&&delete n.layout.quadrant,i.push(n)})),Object.keys(n).forEach((function(e){var a=e.split(":"),i=b()(a,2),o=i[0],c=i[1],l=void 0===c?void 0:parseInt(c),s=null!=l?l:1,u=n[e],d=u.indexes,h=u.abstracts,f=u.childrenIds,p=u.childrenLength,m=t.find(o),v={normal:[],abstract:[]};f.forEach((function(e,n){var r=t.find(e);if(r){var a={cell:r,quadIndex:d[n]};v.normal.push(a)}})),m.getChildren().filter((function(t){return t.model.abstract&&t.realQuadrant===s})).forEach((function(t,e){var n=t.model,r=n.id,a=n.start,i=n.end;if(Pt()(a,i+1).every((function(t){return d.includes(t)}))){var o={cell:t,quadIndex:e};v.abstract.push(o)}else if(h.find((function(t){return r===t.id}))){var c={cell:t,quadIndex:e+p};v.normal.push(c)}})),r[s-1][e]=v})),r.forEach((function(t,e){Object.keys(t).forEach((function(n){var r,o,c=(null!==(r=null===(o=t[n])||void 0===o?void 0:o.normal)&&void 0!==r?r:[]).sort((function(t,e){return t.quadIndex-e.quadIndex}));a.push.apply(a,D()(c.map((function(t){return t.cell})))),i.push.apply(i,D()(c.map((function(t){var n=s()(t.cell.model),r=t.cell,a=r.x,i=r.y;return delete n.abstract,delete n.start,delete n.end,n.x=a,n.y=i,n.layout=jl(jl({},n.layout),{},{quadrant:e+1}),n}))))}))})),r.forEach((function(t,e){Object.keys(t).reduce((function(r,o){var c,l,u,d,h=n[o].indexes.sort(),f=null!==(c=null===(l=t[o])||void 0===l?void 0:l.normal)&&void 0!==c?c:[],p=(null!==(u=null===(d=t[o])||void 0===d?void 0:d.abstract)&&void 0!==u?u:[]).sort((function(t,e){return t.quadIndex-e.quadIndex}));return a.push.apply(a,D()(p.map((function(t){return t.cell})))),i.push.apply(i,D()(p.map((function(t){var n=s()(t.cell.model),a=t.cell,i=a.x,o=a.y;return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.start,a=t.end;if(t.start=e.indexOf(r)+n,t.end=e.indexOf(a)+n,t.start===n-1||t.end===n-1)throw new Error("wrong s and e for trans: ".concat(t.start,", ").concat(t.end))}(n,h,r),n.x=i,n.y=o,n.layout&&(n.layout.quadrant=e+1),n})))),r+f.length}),c)}));var l=t.deduplicate(a),u=i.filter((function(t){return l.find((function(e){return e.model.id===t.id}))}));return[l,u]},Bl=function(t,e,n,r,a){var i=[],o=[],c=[];if(e&&mr(e)){var l,s=e.isTwoQuadrantLayout;i.push.apply(i,D()(t.filter((function(t){return!!a&&!a(t)})))),i.forEach((function(){o.push({})}));var u=t.filter((function(t){return!a||a(t)}));s||(n=1);var d=[[],[]],h=[[],[]],f=1,p=null!==(l=e.model.children)&&void 0!==l?l:[],m=p.filter((function(t){return t.abstract})),v=p.length-m.length,y=e.quadrantTreeLists,g=[-1,-1];u.forEach((function(t){var e,n=(null===(e=t.layout)||void 0===e?void 0:e.quadrant)||1;t.abstract||(n>f?f=n:f>n&&(n=f,void 0===t.layout&&(t.layout={}),t.layout.quadrant=n),d[n-1].push(t))})),u.forEach((function(t){if(t.abstract){var e=t.start,n=t.end,r=t.layout,a=(void 0===r?{}:r).quadrant,i=void 0===a?1:a,o=d[i-1].length;e>g[i-1]&&e<=n&&n<o?(g[i-1]=n,h[i-1].push(t)):Ve(t,(function(t){c.push(t.id)}))}})),n&&(d.forEach((function(t){t.forEach((function(t){void 0===t.layout&&(t.layout={}),t.layout.quadrant=n}))})),h.reduce((function(t,e,r){return e.forEach((function(e){e.start+=t,e.end+=t,void 0===e.layout&&(e.layout={}),e.layout.quadrant=n})),t+d[r].length}),0),d=[Ot()(d)],h=[Ot()(h)]),d.reduce((function(t,a,c){var l=n?n-1:c,s=void 0===r||r>=y[l].length,u=0===l?0===y[l].length?0:y[l][y[l].length-1]+1:v,d=s?u:y[l][r];return a.forEach((function(n,r){Rl(n,e),i.push(n);var a={nth:d+r+t,parent:e.model.id};o.push(a)})),t+a.length}),0),d=[Ot()(d)],h.reduce((function(t,a,l){var u=n?n-1:l,h=y[u],f=null!=r?r:h.length;if(!m.some((function(t){var e=t.start,n=t.end,r=t.layout,a=(void 0===r?{}:r).quadrant;return u+1===(s?void 0===a?1:a:1)&&e<f&&f<=n}))){var p=m.findIndex((function(t,e){var n=t.start,r=t.layout,a=(void 0===r?{}:r).quadrant,i=s?void 0===a?1:a:1;return i>u+1||u+1===i&&n>=f})),g=v+d[0].length+(-1===p?m.length:p);return a.forEach((function(n,r){n.start+=f,n.end+=f,Rl(n,e),i.push(n);var a={nth:g+r+t};e&&(a.parent=e.model.id),o.push(a)})),t+a.length}return a.forEach((function(t){Ve(t,(function(t){c.push(t.id)}))})),t}),0)}else t.forEach((function(t){(!a||a(t))&&Rl(t),i.push(t);var n={};e&&(n.parent=e.model.id),o.push(n)}));return[i,o,c]};function Dl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Nl(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dl(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _l(t,e){var n=e.left,r=e.top,a=e.width,i=e.height,o=e.padding;t.setAttribute("viewBox",[n-o,r-o,a+2*o,i+2*o].join(",")),t.setAttribute("width","".concat(a)),t.setAttribute("height","".concat(i)),t.style.width="".concat(a,"px"),t.style.height="".concat(i,"px")}function Il(t){return"jpg"===t||"jpeg"===t}function Tl(t){var e=(new XMLSerializer).serializeToString(t);return e=e.replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[\x00-\x1F\x7F-\x9F]/g,""),"data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+e)))}function Fl(t){return zl.apply(this,arguments)}function zl(){return(zl=dt()(ft.a.mark((function t(e){var n,r;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r=Object.keys(e).map(function(){var t=dt()(ft.a.mark((function t(r){var a,i,o;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e[r],t.next=3,fetch(a).then((function(t){return t.blob()}));case 3:return i=t.sent,t.next=6,new Promise((function(t){var e=new FileReader;e.onload=function(){t(e.result)},e.readAsDataURL(i)}));case 6:o=t.sent,n[r]=o;case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=4,Promise.all(r);case 4:return t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ql(t){return Yl.apply(this,arguments)}function Yl(){return(Yl=dt()(ft.a.mark((function t(e){var n,r;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],r=e.map(function(){var t=dt()(ft.a.mark((function t(e){var r,a,i;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,a=e.fontURL,i=e.fontWeight,t.abrupt("return",Fl(a).then((function(t){n.push({name:r,fontDataURL:t,fontWeight:i})})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=4,Promise.all(r);case 4:return t.abrupt("return",n.map((function(t){var e=t.fontDataURL,n="@font-face{font-family:".concat(t.name,";src:");return Object.entries(e).forEach((function(t,r){var a=b()(t,2),i=a[0],o=a[1];r===Object.keys(e).length-1?n+="url(".concat(o,")format(").concat(i,");"):n+="url(".concat(o,")format(").concat(i,"),")})),n+="font-weight:".concat(t.fontWeight,";font-style:normal;}")})).join(""));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Hl(t,e){var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=e;var r=t.querySelector("defs");r?r.appendChild(n):t.insertBefore(n,t.firstChild)}function Gl(t,e){if(e.image&&e.image.src){var n=document.createElement("img");n.setAttribute("src",e.image.src),t.appendChild(n)}}function Xl(t,e){if(e.noteContent){var n=document.createElement("p");n.textContent=e.noteContent,t.appendChild(n)}}function Wl(t){var e=document.createElement("td");return t.textContent&&(e.textContent=t.textContent),Gl(e,t),Xl(e,t),e}var Vl=function(){function t(e){m()(this,t),this.diagram=e}var e,n,r;return y()(t,[{key:"canvas",value:(r=dt()(ft.a.mark((function t(){var e,n,r,a,i,o,c,l,s,u,d,h,f,p,m,v=arguments;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=v.length>0&&void 0!==v[0]?v[0]:{}).backgroundColor,r=e.paperClip,a=e.base64EncodedFonts,i=e.cells,o=this.svg(i),r&&(c=this.diagram.paper,l=c.size,_l(o,{left:0,top:0,width:l[0],height:l[1],padding:2})),a&&Hl(o,a),t.next=7,Promise.all(Array.from(o.querySelectorAll("image"),function(){var t=dt()(ft.a.mark((function t(e){var n,r;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.getAttribute("href"))){t.next=6;break}return t.next=4,Oi(n);case 4:(r=t.sent)&&e.setAttribute("href",r.toDataURL("image/png"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).concat(Array.from(o.querySelectorAll("img"),function(){var t=dt()(ft.a.mark((function t(e){var n,r;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.getAttribute("src"))){t.next=6;break}return t.next=4,Oi(n);case 4:(r=t.sent)&&e.setAttribute("src",r.toDataURL("image/png"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())));case 7:return s=parseFloat((null==o?void 0:o.getAttribute("width"))||"0"),u=parseFloat((null==o?void 0:o.getAttribute("height"))||"0"),d=s/u,h=window.devicePixelRatio>2?window.devicePixelRatio:2,e.width&&null==e.height?(f=e.width,p=e.width/d):e.height&&null==e.width?(p=e.height,f=e.height*d):e.width&&e.height?(f=e.width,p=e.height):(f=s,p=u),m=Tl(o),t.next=15,Oi(m,{backgroundColor:n,width:f,height:p,ratio:h});case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"json",value:function(t){var e=this.diagram,n={head:Nl({},e.head),body:[]};return t?t.forEach((function(t){var e=t.model;if(null!=e&&e.type){var r=s()(t.model);n.body.push(r)}})):e.rootGroup.rendererElement.childNodes.forEach((function(t,r){var a=e.getCell(t);if(a&&(a.model.zIndex=r,a.isRoot&&!a.model.isPlaceholder)){var i=s()(a.model);i.children&&0===i.children.length&&delete i.children,Ve(i,(function(){void 0!==i.html&&(i.html=xl(i.html))})),n.body.push(i)}})),n}},{key:"svg",value:function(t,e){e=Nl({type:"default"},e);var n=function(t,e){var n,r,a=t.getCells(),i=a.filter((function(t){return t.state.beginEdit||t.state.selected||t.state.highlight}));i.forEach((function(t){t.setDefault()})),e&&a.forEach((function(t){t.graphicGroup.rendererElement.setAttribute("data-id",t.model.id)}));var o=t.canvas.rendererElement.cloneNode(!0),c=o.querySelectorAll("foreignObject");if(null===(n=o.querySelector('[data-element="front_group"]'))||void 0===n||n.remove(),null===(r=o.querySelector('[data-element="back_group"]'))||void 0===r||r.remove(),o.style["background-color"]=null,e)for(var l=o.querySelectorAll("[data-id]"),s=0;s<l.length;s++){var u=l[s],d=u.getAttribute("data-id");d&&e.includes(d)||u.remove()}return c&&c.forEach((function(t){var e=t.getAttribute("width");e&&(e=Number(e))>0&&(e+=4,t.setAttribute("width",String(e)))})),i.forEach((function(t){t.updateState()})),e&&a.forEach((function(t){t.graphicGroup.rendererElement.removeAttribute("data-id")})),function(t){t.style.position="fixed",t.style.visibility="hidden",document.body.appendChild(t),_l(t,Object.assign(function(t){var e=1/0,n=1/0,r=-1/0,a=-1/0;return Array.from(t.childNodes).filter((function(t){return"root_group"===t.dataset.element})).forEach((function(t){if("defs"!==t.tagName.toLowerCase()){var i=t.getBBox(),o=i.x,c=i.y,l=i.width,s=i.height;o<e&&(e=o),o+l>r&&(r=o+l),c<n&&(n=c),c+s>a&&(a=c+s)}})),{left:e,top:n,width:r-e,height:a-n}}(t),{padding:2})),t.style.position="relative",t.style.visibility="visible",document.body.removeChild(t)}(o),o}(this.diagram,t&&t.map((function(t){return t.model.id}))),r=e.type;return"string"===r||"dom-string"===r?'<?xml version="1.0" encoding="utf-8"?>'+(new XMLSerializer).serializeToString(n):n}},{key:"image",value:function(){var t=this.svg(),e=new Image;return e.src=Tl(t),e}},{key:"blob",value:(n=dt()(ft.a.mark((function t(){var e,n,r,a,i,o,c,l=arguments;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=l.length>0&&void 0!==l[0]?l[0]:"jpeg",n=l.length>1&&void 0!==l[1]?l[1]:{},r=this.diagram,Il(e)&&(n.backgroundColor=null==r||null===(a=r.theme)||void 0===a||null===(i=a.values)||void 0===i?void 0:i.canvasBackgroundColor),window.lake_diagram_external_font){t.next=8;break}return t.next=7,ql(qr);case 7:window.lake_diagram_external_font=t.sent;case 8:return o=window.lake_diagram_external_font,t.next=11,this.canvas(Nl(Nl({},n),{},{base64EncodedFonts:o}));case 11:return c=t.sent,t.abrupt("return",new Promise((function(t){null==c||c.toBlob(t,"image/".concat(e),"jpeg"===e?.8:1)})));case 13:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"download",value:(e=dt()(ft.a.mark((function t(){var e,n,r,a,i,o,c,l,s,u=arguments;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=u.length>0&&void 0!==u[0]?u[0]:"jpeg",n=u.length>1&&void 0!==u[1]?u[1]:{},r=this.diagram,Il(e)&&(n.backgroundColor=null==r||null===(a=r.theme)||void 0===a||null===(i=a.values)||void 0===i?void 0:i.canvasBackgroundColor),window.lake_diagram_external_font){t.next=8;break}return t.next=7,ql(qr);case 7:window.lake_diagram_external_font=t.sent;case 8:return o=window.lake_diagram_external_font,t.next=11,this.canvas(Nl(Nl({},n),{},{base64EncodedFonts:o}));case 11:c=t.sent,l=document.createElement("a"),s=n.filename||"yuque_diagram",l.download="".concat(s,".").concat(e),c&&(l.href=c.toDataURL("image/".concat(e))),l.click();case 17:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"_textContent",value:function(t){return t?function(t){return(new DOMParser).parseFromString(t,"text/html").documentElement.textContent}(t):""}},{key:"doc",value:function(t){var e=this,n=document.createElement("div");return t.forEach((function(t){Ve(t,(function(t){if(rn(t.depth,[0,3])){if(t.textContent){var r=document.createElement("h".concat(t.depth+1));r.textContent=t.textContent,n.appendChild(r)}return Gl(n,t),void Xl(n,t)}return e.list([t]).childNodes.forEach((function(t){n.appendChild(t)})),!1}))})),n}},{key:"table",value:function(t){var e=document.createElement("table");t.forEach((function(t){Ve(t,(function(t,n){if(t.parent=n,!t.children||0===t.children.length){var r=document.createElement("tr"),a=Wl(t);for(r.prepend(a);n;){var i=Wl(n);r.prepend(i),n=n.parent}e.appendChild(r)}}))}));var n=0;return e.childNodes.forEach((function(t){var e=t.childNodes.length;e>n&&(n=e)})),e.childNodes.forEach((function(t){for(var e=t.childNodes.length,r=0;r<n-e;r++){var a=document.createElement("td");t.appendChild(a)}})),e}},{key:"list",value:function(t){var e=document.createElement("div");return t.forEach((function(t){var n=document.createElement("ul");Ve(t,(function(t,e){t.level=e?e.level+1:1;var r=document.createElement("li");e?e.childContainer.appendChild(r):n.appendChild(r),t.textContent&&(r.textContent=t.textContent),Gl(r,t),Xl(r,t),t.children&&t.children.length>0&&(t.childContainer=document.createElement("ul"),e?e.childContainer.appendChild(t.childContainer):n.appendChild(t.childContainer))})),e.appendChild(n)})),e}},{key:"dom",value:function(t){var e=this,n=this.diagram,r=n.settings.copyType;t||(t=n.getCells().filter((function(t){return t.isStem}))),t=n.deduplicate(t);var a=Ll(n,t),i=b()(a,2),o=i[0],c=i[1],l=document.createElement("div"),u=document.createElement("div"),d=[];o.forEach((function(t){d=d.concat(t.getAllCells())}));var h=d.reduce((function(t,e){var n=s()(e.computedProps)||{};if("line"===e.type)n.points=e.getPoints();else if(Cr(e)){var r=e.getPointBox();n.topLeft=[r.minX,r.minY],n.points=s()(e.model.points)}return n.swimlane=e.swimlane,n.x=e.x,n.y=e.y,hr(e)&&(n.x=null,n.y=null),n.rootType=e.stem.type,n.nth=e.getNth(),n.hasParent=!!e.parent,t[e.model.id]=n,t}),{})||{};u.dataset.lake_diagram_body=JSON.stringify(c);var f,p=JSON.stringify(h);return u.dataset.lake_extra_informations=p,l.appendChild(u),c.forEach((function(t,n){t.depth=null==o?void 0:o[n].depth,Ze(t,(function(t,e){t.depth=e.depth+1})),Ve(t,(function(t){t.textContent=e._textContent(t.html),t.note&&t.note.content&&(t.noteContent=e._textContent(t.note.content))}))})),f="doc"===r?this.doc(c):"table"===r?this.table(c):this.list(c),l.appendChild(f),l}},{key:"html",value:function(){return this.dom().outerHTML}},{key:"getText",value:function(){return this.dom().innerText}},{key:"clipboard",value:function(t){var e=this.dom(t);return{html:e.innerHTML,text:e.textContent}}},{key:"destroy",value:function(){}}]),t}();c()(Vl,"className","Exporter");var Zl=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"group",new na),c()(this,"eventHelper",new hl),c()(this,"arr",[]),c()(this,"destroyed",!1),this.group.css({"pointer-events":"none"})}return y()(t,[{key:"bind",value:function(){var t=this,e=this.diagram,n=this.eventHelper;n.unbind(),n.bind(e,"afterchange",(function(e){var n=e.action;t.arr.length>0&&("update"===n||"delete"===n)&&t.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(t){var e=this.diagram.viewport.zoom;t=t.filter((function(t){return t.multiSelectHighlight&&t.state.visible})),this.render(t,(function(t){return t.isLine?{type:"outline",shapeStyle:{fill:"none",stroke:"#3384F5","stroke-width":2/e}}:{type:"rect",shapeStyle:{fill:"none",stroke:"#fff","stroke-width":1/e},shadowStyle:{fill:"none",stroke:"#3384F5","stroke-width":1/e}}}))}},{key:"render",value:function(t,e){var n=this.group,r=this.diagram;cn(t,this.arr.map((function(t){return t.cell})))||(this.clear(),t&&!t.some((function(t){return!t||!t.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=t.map((function(t){var r=e(t),a=r.type,i=r.shapeStyle,o=r.shadowStyle,c={cell:t,type:"function"==typeof a?a(t):a,shape:i&&new ha(i),shadow:o&&new ha(o)};return c.shadow&&n.add(c.shadow),c.shape&&n.add(c.shape),c})),this.draw()))}},{key:"_updateShape",value:function(t){var e=t.cell,n=t.type,r=t.shape,a=t.shadow,i=e.getKeyShape();if(i){var o,c=i.attr("stroke-width"),l=c/2,s=e.graphicGroup.matrix.concat([]),u=i.getBBox();if(o="outline"===n?i.attr("d"):Jn(-l,-l,u.width+c,u.height+c),r.update({matrix:s,d:o}),a){var d=parseFloat(a.attr("stroke-width"))+parseFloat(r.attr("stroke-width")),h=u.width+c,f=u.height+c,p=o;e.isLine||(p=Mt()(o).scale(1+d/h,1+d/f).translate(-d/2,-d/2).toString()),a.update({matrix:s,d:p})}}}},{key:"_draw",value:function(){var t=this;this.arr.forEach((function(e){t._updateShape(e)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||0===this.arr.length||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.arr=[],this.destroyed=!0}}]),t}();c()(Zl,"className","Highlight");var Ul=function(){function t(e){m()(this,t),this.diagram=e}return y()(t,[{key:"json",value:function(t){this.diagram.add(t.body)}},{key:"clipboard",value:function(t,e){return"clipboard"}},{key:"destroy",value:function(){}}]),t}();c()(Ul,"className","Importer");var Kl=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t}},{key:"reset",value:function(){}}]),n}();var Ql=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){Si(e)&&!e.shiftKey&&"z"===e.key?(t.command.execute("Undo"),t.tryFocus()):(Si(e)&&"y"===e.key||Si(e)&&e.shiftKey&&"z"===e.key)&&(t.command.execute("Redo"),t.tryFocus())}))}}]),n}();var $l=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){if(Si(e)&&"/"===e.key){if(t.command.enable("Collapse"))return t.command.execute("Collapse");if(t.command.enable("Expand"))return t.command.execute("Expand")}}))}}]),n}();var Jl=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=t.selector;this.bind(window,"mousedown",(function(n){var r=t.selector.selections,a=t.getCell(n.target);if(!(a&&a.state.selected&&t.contentEditor.isBegin)){if(a)if(n.shiftKey||(pt.ua.macos?n.metaKey:n.ctrlKey))if(r.includes(a))e.select(r.filter((function(t){return t!==a})));else{var i=a.parent,o=!1;if(n.shiftKey&&a.isMindmap&&null!=i&&i.isMindmap&&!a.isAbstract)for(var c=function(){var t=r[l];if(t.isMindmap&&!t.isAbstract){var n=t.parent,c=t.realQuadrant;if(n===i&&a.realQuadrant===c){var s=n.quadrantTreeLists[c-1],u=[s.findIndex((function(e){return e===t.getNth()})),s.findIndex((function(t){return t===a.getNth()}))].sort(),d=b()(u,2),h=d[0],f=d[1],p=n.getChildren(),m=[];return Pt()(h,f+1).forEach((function(t){var e=s[t];m.push(p[e])})),e.select(Rt()(r.concat(m))),o=!0,"break"}}},l=r.length-1;l>=0&&"break"!==c();l--);o||e.select(r.concat([a]))}else r.includes(a)||e.select([a]);else fn(n.target,(function(t){var e,n;return(null==t||null===(e=t.dataset)||void 0===e?void 0:e.lake_prevent_click_unselect)||(null==t||null===(n=t.classList)||void 0===n?void 0:n.contains("lake-diagram-prevent-mouse-select"))}),window.document,(function(t){return t.parentNode}),(function(t){return!t}))||r.length>0&&e.clear();a&&a.state.selected&&!t.contentEditor.isBegin&&n.preventDefault()}}))}}]),n}();var ts=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"collapsedbutton:click",(function(e){var n=e.nativeEvent,r=e.cell;if(n.stopPropagation(),n.target.closest("[data-diagram-collapsed-button=true]")){if(t.command.enable("Collapse"))return t.command.execute("Collapse",{onlyCell:r});if(t.command.enable("Expand"))return t.command.execute("Expand",{onlyCell:r})}}))}}]),n}();var es=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"scroll",(function(t){(t.ctrlKey||pt.ua.macos&&t.metaKey)&&(t.preventDefault(),t.stopPropagation())})),this.bind(t,"wheel",(function(e){if(e.ctrlKey||pt.ua.macos&&e.metaKey){e.preventDefault(),e.stopPropagation();var n=e.wheelDelta||-e.deltaY;if(t.emit("wheelzoom"),Math.abs(n)>0){var r=t.viewport.zoom;n>0?t.viewport.setViewport(1.05*r):t.viewport.setViewport(r*(1/1.05))}}}))}}]),n}();var ns=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"copy",(function(e){t.command.execute("Copy",{e:e})}))}}]),n}();var rs=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"cut",(function(e){t.command.execute("Cut",{e:e})}))}}]),n}();var as=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"paste",(function(e){e.preventDefault(),t.command.execute("Paste",{e:e})}))}}]),n}();var is=pt.HotKeyUtils.isHotkey,os=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){is("mod+=",e)?(e.preventDefault(),t.command.execute("ZoomIn")):is("mod+shift+=",e)?(e.preventDefault(),t.command.execute("FitViewport")):is("mod+-",e)?(e.preventDefault(),t.command.execute("ZoomOut")):is("mod+0",e)?t.command.execute("ActualSize"):is("mod+8",e)&&t.command.execute("FocusSelection")}))}}]),n}();var cs=document.createElement("div"),ls=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=t.contentEditor;this.bind(e,"change",(function(e){var n=e.dom,r=t.getCell(n);!t.signal.preventUpdateCellContent&&r&&t.update(r,{html:n.innerHTML})})),this.bind(e,"beginedit",(function(e){var n=e.dom;t.signal.contentEditing=!0;var r=t.getCell(n);r&&r.beginEditContent()})),this.bind(e,"endedit",(function(e){var n=e.dom,r=e.startHTML,a=e.endHTML;t.signal.contentEditing=!1;var i=t.getCell(n);i&&(i.endEditContent(),cs.innerHTML=a,""===cs.textContent&&(a=-1!==a.indexOf("<br>")?a.replace("<br>","".concat("&#8203;","<br>")):"&#8203;"),r!==a&&"&#8203;"!==a?t.command.execute("UpdateCellContent",{id:i.model.id,startHTML:r,endHTML:a}):i.shouldRefreshEndEditContent()&&t.update(i))}))}}]),n}();var ss=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e;this.bind(t,"mousedown",(function(n){clearTimeout(e),e=setTimeout((function(){t.getCell(n.target)?t.tryFocus():t.focus()}))}))}}]),n}(),us=function(t){return t.reduce((function(t,e){return yr(e)?t.push.apply(t,D()(e.children)):dr(e)?t.push.apply(t,[e].concat(D()(e.children))):t.push(e),t}),[])};var ds=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),t=e.call(this),c()(E()(t),"selections",void 0),c()(E()(t),"lines",void 0),t.selections=[],t.lines=void 0,t}return y()(n,[{key:"init",value:function(t){var e=this;this.bind(t,"afterselect",(function(t){var n=t.selections,r=e.lines;if(1===n.length){if(function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].model.id!==e[n].model.id)return!1;return!0}(e.selections,n))return void(r&&r.forEach((function(t){return t.resizer.update()})));r&&r.forEach((function(t){return t.resizer.end()})),e.lines=n.filter((function(t){return sr(t)})),e.lines.forEach((function(t){return t.resizer.begin()}))}else r&&r.forEach((function(t){return t.resizer.end()})),e.lines=void 0;e.selections=n}))}}]),n}(),hs=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"_currentMode",null),c()(this,"defaultCursor","default"),c()(this,"defaultCursors",{read:"grab"}),c()(this,"modes",void 0),this.modes={edit:[new Ql,new $l,new Jl,new ts,new es,new ns,new rs,new as,new os,new ls,new ss,new ds],read:[new $l,new Jl,new ts,new os,new es,new ss,new ns],none:[]}}return y()(t,[{key:"currentMode",get:function(){return this._currentMode||"read"},set:function(t){this._currentMode=t}},{key:"_removeCurrentMode",value:function(){var t;this.currentMode&&(null===(t=this.modes[this.currentMode])||void 0===t||t.forEach((function(t){t.reset(),t.unbind()})))}},{key:"init",value:function(t){this.changeMode(t)}},{key:"addDefaultCursor",value:function(t){Object.assign(this.defaultCursors,t)}},{key:"registerMode",value:function(t,e){var n,r=this.modes;r[t]?r[t]=null===(n=r[t])||void 0===n?void 0:n.concat(e):this.modes[t]=e}},{key:"getModeCursor",value:function(){return this.defaultCursors[this.currentMode]||this.defaultCursor}},{key:"changeMode",value:function(t){var e=this,n=this.modes[t],r=this.diagram;r.selector.clear(),r.emit("beforemodechange",t),this._removeCurrentMode(),null==n||n.forEach((function(t){t.diagram=e.diagram,t.init(e.diagram)}));var a=r.viewportContainer;this.currentMode!==t&&(a.dataset.lakeBoardMode=t),this.currentMode=t,r.emit("aftermodechange");var i=this.defaultCursors[t]||this.defaultCursor;this.diagram.setCursor(i)}},{key:"destroy",value:function(){this._removeCurrentMode()}}]),t}();c()(hs,"className","Interaction");var fs=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"fill",{color:"#ffffff"}),c()(this,"eventHelper",new hl),c()(this,"visible",void 0),c()(this,"size",void 0),c()(this,"element",void 0),this.diagram=e}return y()(t,[{key:"init",value:function(t){Object.assign(this,{size:[200,200]},t),this.visible&&this.render(),this.bind()}},{key:"calculateBBox",value:function(){var t=this.diagram,e=this.size,n=t.rootGroup.getBBox(),r=t.viewport.zoom;if("auto"===e){var a={},i=t.width/r,o=t.height/r;if(n.width<i){var c=n.x+n.width/2,l=i/2;a.left=c-l,a.right=c+l}else a.left=n.x,a.right=n.x+n.width;if(n.height<o){var s=n.y+n.height/2,u=o/2;a.top=s-u,a.bottom=s+u}else a.top=n.y,a.bottom=n.y+n.height;return a}return 0===n.width&&0===n.height?Array.isArray(e)?{top:0,bottom:e[1],left:0,right:e[0]}:{top:0,bottom:t.height,left:0,right:t.width}:{top:Math.floor(n.y/e[1])*e[1],bottom:Math.ceil((n.y+n.height)/e[1])*e[1],left:Math.floor(n.x/e[0])*e[0],right:Math.ceil((n.x+n.width)/e[0])*e[0]}}},{key:"getBBox",value:function(){return this.calculateBBox()}},{key:"render",value:function(){var t=this.diagram,e=this.size,n=this.fill,r=t.defs,a=t.backRootGroup,i=Object(F.a)(),o=new Ga,c=new qa({dx:0,dy:2,stdDeviation:8,"flood-color":"rgba(115, 115, 115, 0.08)"});o.attr({id:i}),o.add(c),r.add(o);var l=b()(e,2),s=l[0],u=l[1],d=new Oa({x:0,y:0,width:s,height:u,fill:n.color});d.css({filter:"url(#".concat(i,")"),"pointer-events":"none"}),a.add(d),this.element=d}},{key:"bind",value:function(){var t=this;if(this.visible){var e=Bt()((function(){t.update()}),16);this.eventHelper.bind(this.diagram,"afterviewportchange",e)}}},{key:"update",value:function(t){t&&Object.assign(this,t);var e=this.diagram,n=this.fill,r=this.size;if(this.visible){this.element||this.render();var a=b()(r,2),i=a[0],o=a[1],c=e.viewport.paperBox,l=c.left,s=c.top;this.element.update({x:l,y:s,width:i,height:o,fill:n&&n.color||"#fff"})}}},{key:"destroy",value:function(){this.element&&this.element.destroy(),this.eventHelper.destroy()}}]),t}();c()(fs,"className","Paper");var ps=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"behaviours",void 0),this.behaviours=[]}return y()(t,[{key:"init",value:function(t){var e=this;t.forEach((function(t){e.registerPlugin(t)}))}},{key:"registerCell",value:function(t){var e=this.diagram;e&&(e.Cells[t.className]=t)}},{key:"registerPlugin",value:function(t){var e=this,n=this.diagram;if(n){var r=t.Cells,a=t.Commands,i=t.Extends,o=t.modes,c=t.defaultCursors,l=t.dataProcessor,s=t.settings;r&&r.forEach((function(t){e.registerCell(t)})),o&&o.forEach((function(t){var r=t.mode,a=t.Behaviours.map((function(t){return t instanceof Kl?t:new t}));n.interaction.registerMode(r,a),e.behaviours=e.behaviours.concat(a)})),a&&a.forEach((function(t){n.command.register(t)})),i&&n.addExtend(i),l&&n.addDataProcessor(l),c&&n.interaction.addDefaultCursor(c),s&&Object.assign(n.settings,s)}}},{key:"destroy",value:function(){this.diagram=void 0,this.behaviours.forEach((function(t){return t.destroy()}))}}]),t}();c()(ps,"className","Register");var ms=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"_selections",void 0),this._selections=[]}return y()(t,[{key:"selections",get:function(){return this._selections}},{key:"_select",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.diagram.cellMap;t.map((function(t){return"string"==typeof t?r[t]:t})).forEach((function(t){if(t.state.selected!==n){var r=e.selections.indexOf(t);n?(t.select(),-1===r&&e.selections.push(t)):(t.unSelect(),-1!==r&&e.selections.splice(r,1))}}))}},{key:"select",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(t)||(t=[t]);var n=this.diagram,r=this.selections,a={selections:D()(r)},i={selections:D()(t).map((function(t){return n.find(t)})).filter((function(t){return t}))},o={before:a,after:i,selections:i.selections},c=cn(a.selections,i.selections);!c&&n.emit("beforeselectionchange",o),n.emit("beforeselect",o),this._select(a.selections,!1),this._select(t,e),n.emit("afterselect",o),!c&&n.emit("afterselectionchange",o)}},{key:"clear",value:function(){this.select([])}},{key:"destroy",value:function(){}}]),t}();c()(ms,"className","Selector");var vs=function(){function t(e){m()(this,t),c()(this,"listeners",[]),c()(this,"params",void 0),this.params=e}return y()(t,[{key:"tap",value:function(t,e){this.listeners.push({name:t,listener:e})}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.listeners.forEach((function(t){return t.listener.apply(void 0,e)}))}},{key:"apply",value:function(t){this.listeners.forEach((function(e){return e.listener.apply(void 0,D()(t))}))}},{key:"destroy",value:function(){this.listeners=[]}}]),t}();c()(vs,"className","SyncHook");var ys=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"zoom",1),c()(this,"eventHelper",new hl),c()(this,"focusPoint",[0,0]),c()(this,"minZoom",.02),c()(this,"maxZoom",4),c()(this,"m",void 0),c()(this,"n",void 0),c()(this,"autoFitPadding",8),c()(this,"scrollBarSize",20),c()(this,"scrollLeft",void 0),c()(this,"scrollTop",void 0),c()(this,"isPreventDefault",void 0),c()(this,"destroyed",void 0),c()(this,"viewportCanvasBox",void 0),c()(this,"containerBox",void 0),c()(this,"canvasWidth",void 0),c()(this,"canvasHeight",void 0),c()(this,"paperBox",void 0),c()(this,"opRecord",void 0),c()(this,"viewBox",void 0)}return y()(t,[{key:"init",value:function(){this._initContainerSize(),this.setViewport(1),this._bindEvent()}},{key:"getViewportClientBox",value:function(){var t=this.diagram,e=this.scrollBarSize,n=t.viewportContainer.getBoundingClientRect(),r=n.x||n.left,a=n.y||n.top,i=n.width-e,o=n.height-e;return{minX:r,minY:a,maxX:r+i,maxY:a+o,x:r,y:a,width:i,height:o}}},{key:"getViewportCanvasBox",value:function(){var t=this.getViewportClientBox(),e=t.minX,n=t.minY,r=t.maxX,a=t.maxY,i=this.invertClient([e,n]),o=this.invertClient([r,a]);return{minX:i[0],minY:i[1],maxX:o[0],maxY:o[1],x:i[0],y:i[1],width:o[0]-i[0],height:o[1]-i[1]}}},{key:"width",get:function(){return this.diagram.width}},{key:"height",get:function(){return this.diagram.height}},{key:"_resetFocusPoint",value:function(){var t=this.focusPoint,e=this.getViewportClientBox();t[0]=e.x+e.width/2,t[1]=e.y+e.height/2}},{key:"_bindEvent",value:function(){var t=this,e=this.diagram,n=this.eventHelper,r=e.viewportContainer;n.bind(r,"scroll",Bt()((function(){ro(t.scrollLeft,r.scrollLeft,1)&&ro(t.scrollTop,r.scrollTop,1)||t.setScroll(r.scrollLeft,r.scrollTop)}),16)),n.bind(e,"aftercommandexecute",(function(e){if(e.isModelChange){if(t.isPreventDefault||t.destroyed)return;t.refresh()}})),this._trackVisualFocus()}},{key:"translate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scrollLeft,r=this.scrollTop;this.setScroll(n+t,r+e)}},{key:"preventDefault",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPreventDefault=t}},{key:"scrollIntoView",value:function(t){var e=this.diagram,n=this.scrollBarSize,r=e.width,a=e.height,i=e.canvas.getBoundingClientRect();if(!(i.width<=r&&i.height<=a)){var o=this.convertViewport([t.x,t.y]),c=this.convertViewport([t.x+t.width,t.y+t.height]),l=this.scrollLeft,s=this.scrollTop;o[0]<0?l-=Math.abs(o[0])+20:c[0]>r-n&&(l+=c[0]-r+n+20),o[1]<0?s-=Math.abs(o[1])+20:c[1]>a-n&&(s+=c[1]-a+n+20),l===this.scrollLeft&&s===this.scrollTop||this.setScroll(l,s)}}},{key:"_trackVisualFocus",value:function(){var t=this,e=this.diagram,n=this.focusPoint,r=this.eventHelper;r.bind(e,"mousemove",(function(t){var e=t.clientX,r=t.clientY;n[0]=e,n[1]=r})),r.bind(e,"mouseleave",(function(e){e.relatedTarget&&1===e.relatedTarget.nodeType&&e.relatedTarget.closest(".lake-diagram-prevent-mouseleave-reset-focus-point")||t._resetFocusPoint()}))}},{key:"_resizeViewport",value:function(){var t=this.diagram,e=t.viewportContainer,n=t.width,r=t.height;e.style.width="".concat(n,"px"),e.style.height="".concat(r,"px"),e.style.maxWidth="".concat(n,"px"),e.style.maxHeight="".concat(r,"px")}},{key:"_initContainerSize",value:function(){this.diagram.viewportContainer.style.overflow="auto",this._resizeViewport()}},{key:"_change",value:function(){var t=this.scrollLeft,e=this.scrollTop,n=this.canvasWidth,r=this.canvasHeight,a=this.viewBox,i=this.diagram;i.emit("beforeviewportchange"),this._resizeViewport(),i.canvas.rendererElement.style.display="block",i.canvas.rendererElement.style.width="".concat(n,"px"),i.canvas.rendererElement.style.height="".concat(r,"px"),i.canvas.rendererElement.setAttribute("viewBox",a.join(",")),i.viewportContainer.scrollLeft=t,i.viewportContainer.scrollTop=e,this._setMatrix(),i.emit("afterviewportchange"),this.viewportCanvasBox=this.getViewportCanvasBox()}},{key:"_setMatrix",value:function(){var t=this.zoom,e=this.scrollLeft,n=this.scrollTop,r=this.viewBox;this.n=[t,0,0,0,t,0,-t*r[0],-t*r[1],1],this.m=[t,0,0,0,t,0,-e-t*r[0],-n-t*r[1],1]}},{key:"isInnerCanvasPoint",value:function(t){var e=this.viewportCanvasBox,n=e.minX,r=e.maxX,a=e.minY,i=e.maxY;return!(t[0]<n||t[0]>r||t[1]<a||t[1]>i)}},{key:"focusFirstRoot",value:function(){var t=this.diagram,e=t.getCells().filter((function(t){return t.isStem}))[0];e&&(this.autoFit(),t.viewport.focus([e.x+e.width/2,e.y+e.height/2]),t.viewport.setViewport(1))}},{key:"focusGraphicCenter",value:function(){var t=this.diagram;if(t.getCells().length>0){var e=t.rootGroup.getBBox();t.viewport.focus([e.x+e.width/2,e.y+e.height/2]),t.viewport.setViewport(1)}}},{key:"setScroll",value:function(t,e){this.destroyed||(this._setScrollLeft(t),this._setScrollTop(e),this._change())}},{key:"getPadding",value:function(t,e){var n=this.diagram;return n.options.padding||[n.height/2,n.width/2]}},{key:"moveTo",value:function(t,e){var n=this.zoom,r=this.invertViewport([0,0]);this.setScroll(this.scrollLeft+(t-r[0])*n,this.scrollTop+(e-r[1])*n)}},{key:"_restoreCanvasTlPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.zoom;this.setViewport(e),this.moveTo.apply(this,D()(t))}},{key:"refresh",value:function(){var t=this.getViewportClientBox();this.setViewport(this.zoom,[t.x,t.y])}},{key:"_setScrollLeft",value:function(t){var e=this.diagram,n=this.canvasWidth,r=this.scrollBarSize,a=n-e.width+r;this.scrollLeft=Je(t,0,a)}},{key:"_setScrollTop",value:function(t){var e=this.diagram,n=this.canvasHeight,r=this.scrollBarSize,a=n-e.height+r;this.scrollTop=Je(t,0,a)}},{key:"setViewport",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoom,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focusPoint;(t=Je(t,this.minZoom,this.maxZoom))!==this.zoom&&(this.opRecord=void 0),this.zoom=t;var n,r,a=this.diagram,i=this.m,o=a.width,c=a.paper.getBBox(),l=this.getPadding(c,t),s=this.getViewportClientBox(),u=c.right-c.left,d=c.bottom-c.top,h=u*t+2*l[1],f=d*t+2*l[0],p=[c.left-l[1]/t,c.top-l[0]/t,h/t,f/t];if(i){var m=[e[0]-s.x,e[1]-s.y,1],v=w.mat3.invert([],i),y=w.vec3.transformMat3([],[m[0],m[1],1],v),g=[t,0,0,0,t,0,-t*p[0],-t*p[1],1],b=w.vec3.transformMat3([],y,g);n=b[0]-m[0],r=b[1]-m[1]}else n=(h-o)/2,r=l[0]-c.top;this.paperBox=c,this.canvasWidth=h,this.canvasHeight=f,this.zoom=t,this.viewBox=p,this.containerBox=s,this._setScrollLeft(n),this._setScrollTop(r),this._change()}},{key:"convertViewport",value:function(t){t=zi(t);var e=this.m;return w.vec3.transformMat3([],[t.x,t.y,1],e)}},{key:"invertViewport",value:function(t){t=zi(t),this.m;var e=w.mat3.invert([],this.m);return w.vec3.transformMat3([],[t.x,t.y,1],e)}},{key:"convertViewportAbs",value:function(t){return w.vec3.transformMat3([],[t[0],t[1],1],this.n)}},{key:"invertViewportAbs",value:function(t){var e=w.mat3.invert([],this.n);return w.vec3.transformMat3([],[t[0],t[1],1],e)}},{key:"convertClient",value:function(t){t=zi(t);var e=this.getViewportClientBox(),n=w.vec3.transformMat3([],[t.x,t.y,1],this.m);return[n[0]+e.x,n[1]+e.y]}},{key:"invertClient",value:function(t){t=zi(t);var e=this.getViewportClientBox(),n=[t.x-e.x,t.y-e.y,1],r=w.mat3.invert([],this.m),a=w.vec3.transformMat3([],[n[0],n[1],1],r);return[a[0],a[1]]}},{key:"getCenter",value:function(){var t=this.getViewportClientBox();return this.invertClient([t.x+t.width/2,t.y+t.height/2])}},{key:"getFocus",value:function(){var t=this.focusPoint;return this.invertClient(t)}},{key:"toObject",value:function(){var t=this.zoom,e=this.diagram;return{zoom:t,tlCanvasPoint:this.invertViewport([0,0]),width:e.width,height:e.height}}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.tlCanvasPoint||t.originCanvasTlPoint;if(e){var n=t.zoom;this._restoreCanvasTlPoint(e,n)}else"number"==typeof t.scrollLeft&&"number"==typeof t.scrollTop&&(this.setViewport(t.zoom),this.setScroll(t.scrollLeft,t.scrollTop))}},{key:"setWYSIWYG",value:function(t){var e=this.diagram,n=this.scrollBarSize;if(e.width>t.width&&e.height>t.height)this.set({zoom:t.zoom,tlCanvasPoint:t.tlCanvasPoint});else{var r=Math.min((e.width-n)/(t.width-n),(e.height-n)/(t.height-n))*t.zoom;this.set({zoom:r,tlCanvasPoint:t.tlCanvasPoint})}}},{key:"_focus",value:function(t){var e=this.getViewportClientBox(),n=w.vec3.transformMat3([],[t[0],t[1],1],this.m),r=[e.width/2,e.height/2],a=r[0]-n[0],i=r[1]-n[1];this._setScrollLeft(this.scrollLeft-a),this._setScrollTop(this.scrollTop-i),this._setMatrix()}},{key:"focus",value:function(t){this._focus(t),this._change()}},{key:"autoFit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.minZoom,n=t.maxZoom,r=t.zoom,a=this.getViewportClientBox(),i=this.diagram.rootGroup.getBBox();e=e||this.minZoom,n=n||1,null==r&&(a.width-=2*this.autoFitPadding,a.height-=2*this.autoFitPadding,r=Math.min(a.width/i.width,a.height/i.height)),r=Je(r,e,n),this._focus([i.x+i.width/2,i.y+i.height/2]),this._resetFocusPoint(),this.setViewport(r),this.opRecord="autoFit"}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.destroyed=!0}}]),t}();c()(ys,"className","Viewport");var gs,bs,xs,ks=window.getSelection(),ws=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this)).diagram=t,c()(E()(r),"eventHelper",new hl),c()(E()(r),"destroyed",!1),c()(E()(r),"emitQueryChange",void 0),r.emitQueryChange=Nt()((function(){r.destroyed||r.emit("querychange",{query:r._getQuery()})}),32),r}return y()(n,[{key:"init",value:function(){var t=this,e=this.diagram,n=this.eventHelper,r=this.emitQueryChange;n.bind(e.contentEditor,"selectionchange",(function(){t._updateEditRange(),r()})),n.bind(e,"afterselect",(function(){t._updateEditRange(),r()}))}},{key:"_updateEditRange",value:function(){var t=this.diagram;try{var e=null==ks?void 0:ks.getRangeAt(0);if(!e)return;t.canvasContainer.contains(e.commonAncestorContainer)&&!xs&&(gs=e.cloneRange()),bs=e.cloneRange()}catch(t){return}}},{key:"_setRange",value:function(t){t&&(null==ks||ks.removeAllRanges(),null==ks||ks.addRange(t))}},{key:"_getSelections",value:function(){return this.diagram.selector.selections.filter((function(t){var e;return null===(e=t.canUpdateText)||void 0===e?void 0:e.call(t)}))}},{key:"_getQuery",value:function(){var t,e=this.diagram,n=this._getSelections();if(n.length>1){var r=n.filter((function(t){return t.textareaElement}));r.sort((function(t,e){return t.x-e.x}));var a=r.map((function(t){return t.textareaElement.htmlContainer}));t=e.contentEditor.query(a[0],null)}else{var i;t=dr(n[0])?e.contentEditor.query(null===(i=n[0].children[0])||void 0===i?void 0:i.textareaElement.htmlContainer,null):hr(n[0])?e.contentEditor.query(n[0].textareaElement.htmlContainer,null):e.contentEditor.query()}return t}},{key:"execCommand",value:function(t,e){var n=this.diagram,r=this.emitQueryChange;n.contentEditor.isBegin?(gs.commonAncestorContainer!==bs.commonAncestorContainer&&(xs=!0),xs&&this._setRange(gs),n.contentEditor.execCommand(t,e),gs=null==ks?void 0:ks.getRangeAt(0).cloneRange(),xs=!1):n.command.execute("ContentCommand",{name:t,value:e}),r()}},{key:"destroy",value:function(){this.eventHelper&&this.eventHelper.destroy(),this.destroyed=!0}}]),n}();c()(ws,"className","ContentEditorPlus");var Cs=Object.freeze({__proto__:null,CommandManager:Jc,ContentEditor:Ol,Delegator:Pl,Exporter:Vl,Highlight:Zl,Importer:Ul,Interaction:hs,Paper:fs,Register:ps,Selector:ms,SyncHook:vs,Viewport:ys,ContentEditorPlus:ws}),As=function(){function t(e){if(m()(this,t),c()(this,"default",void 0),c()(this,"anchors",void 0),c()(this,"stem",void 0),c()(this,"root",void 0),c()(this,"type",void 0),c()(this,"model",void 0),c()(this,"zIndex",void 0),c()(this,"matrix",void 0),c()(this,"graphicGroup",void 0),c()(this,"state",void 0),c()(this,"diagram",void 0),c()(this,"eventHelper",void 0),c()(this,"destroyed",void 0),c()(this,"cellMap",void 0),c()(this,"parent",void 0),c()(this,"depth",void 0),c()(this,"isStem",void 0),c()(this,"isRoot",void 0),c()(this,"isCell",void 0),c()(this,"cache",void 0),c()(this,"penetratedKeys",void 0),c()(this,"width",void 0),c()(this,"height",void 0),!e.diagram)throw new Error("cell requires diagram!");if(!e.cellMap)throw new Error("cell requires cellMap")}return y()(t,[{key:"init",value:function(t){Object.assign(this,t),this.stem=this.stem||this,this.root=this.root||this,this.type=this.stem.model.type,this.zIndex=this.model.zIndex||0}},{key:"setDefault",value:function(){}},{key:"get",value:function(t){return s()(this[t])}},{key:"draw",value:function(){}},{key:"percentage2Relative",value:function(t){return[(t=zi(t)).x*this.width,t.y*this.height]}},{key:"relative2Percentage",value:function(t){return[(t=zi(t)).x/this.width,t.y/this.height]}},{key:"canvas2percentage",value:function(t){return t=zi(t),this.relative2Percentage(this.canvas2Relative(t))}},{key:"percentage2Canvas",value:function(t){return this.relative2Canvas(this.percentage2Relative(t))}},{key:"relative2Canvas",value:function(t){t=zi(t);var e=w.vec3.transformMat3([],[t.x,t.y,1],this.matrix),n=b()(e,2);return{x:n[0],y:n[1]}}},{key:"canvas2Relative",value:function(t){t=zi(t);var e=w.vec3.transformMat3([],[t.x,t.y,1],w.mat3.invert([],this.matrix)),n=b()(e,2);return{x:n[0],y:n[1]}}},{key:"capture",value:function(t){var e=this.graphicGroup,n=this.state;!0===t?e.css({"pointer-events":"auto"}):!1===t&&e.css({"pointer-events":"none"}),n.capture=t}},{key:"rotateTo",value:function(t){var e=[1,0,0,0,1,0,0,0,1];w.mat3.fromRotation(e,t),this.matrix[0]=e[0],this.matrix[1]=e[1],this.matrix[3]=e[3],this.matrix[4]=e[4],this.graphicGroup.update({matrix:this.matrix})}},{key:"getBBox",value:function(){var t=this.percentage2Canvas([0,0]),e=this.percentage2Canvas([1,0]),n=this.percentage2Canvas([0,1]),r=this.percentage2Canvas([1,1]),a=Math.min(t.x,e.x,n.x,r.x),i=Math.min(t.y,e.y,n.y,r.y),o=Math.max(t.x,e.x,n.x,r.x),c=Math.max(t.y,e.y,n.y,r.y);return{minX:a,minY:i,maxX:o,maxY:c,x:a,y:i,width:o-a,height:c-i}}},{key:"eventDelegation",value:function(){}},{key:"getEventObject",value:function(t){return{cell:this,nativeEvent:t}}},{key:"getChildren",value:function(){var t=this.cellMap;return(this.model.children||[]).map((function(e){return t[e.id]}))}},{key:"getAllChildren",value:function(){var t=[];return this.deepEachWithoutSelf((function(e){return t.push(e),!0})),t}},{key:"getAllCellsByZIndex",value:function(){var t=this.getAllCells();return t.sort((function(t,e){return t.getZIndex()-e.getZIndex()})),t}},{key:"getAllCells",value:function(){var t=this.cellMap,e=[];return Ve(this.model,(function(n){return e.push(t[n.id]),!0})),e}},{key:"getSiblings",value:function(){var t=this,e=this.cellMap;return this.parent?this.parent.model.children.filter((function(e){return e.id!==t.model.id})).map((function(t){return e[t.id]})):[]}},{key:"delegateEvent",value:function(t,e,n){var r=this,a=this.eventHelper,i=this.diagram;a.bind(t,e,(function(t){i.emit(n,r.getEventObject(t))}))}},{key:"hide",value:function(){this.graphicGroup.css({display:"none"}),this.state.visible=!1}},{key:"show",value:function(){this.graphicGroup.css({display:""}),this.state.visible=!0}},{key:"updateState",value:function(){}},{key:"select",value:function(){this.state.selected=!0,this.state.highlight=!1,this.updateState()}},{key:"unSelect",value:function(){this.state.selected=!1,this.updateState()}},{key:"highlight",value:function(){this.state.highlight=!0,this.updateState()}},{key:"unHighlight",value:function(){this.state.highlight=!1,this.updateState()}},{key:"toBack",value:function(){this.graphicGroup.toBack()}},{key:"toFront",value:function(){this.graphicGroup.toFront()}},{key:"forward",value:function(){this.graphicGroup.forward()}},{key:"backward",value:function(){this.graphicGroup.backward()}},{key:"getZIndex",value:function(){var t=this.graphicGroup.getZIndex();return qt()(t)?t:-1}},{key:"getNth",value:function(){return this.parent?this.parent.model.children.indexOf(this.model):0}},{key:"forEach",value:function(t){var e=this.cellMap;this.model.children.forEach((function(n,r){t(e[n.id],r)}))}},{key:"deepEach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t.children},n=this.cellMap;Ve(this.model,(function(e){return t(n[e.id])}),e)}},{key:"deepEachWithoutSelf",value:function(t){var e=this.cellMap;Ze(this.model,(function(n){return t(e[n.id])}))}},{key:"render",value:function(){}},{key:"update",value:function(t){this.updateModel(t),this.draw()}},{key:"updateModel",value:function(t){t&&(f()(this.model,t,(function(t,e){if(Array.isArray(t))return e})),this._normalize(),this._merge())}},{key:"_normalize",value:function(){var t=this;Object.keys(this.model).forEach((function(e){var n=t.model[e];null==n?t.model[e]=void 0:d()(n)&&(Object.values(n).every((function(t){return null==t}))?t.model[e]=void 0:Object.keys(n).forEach((function(r){null==n[r]&&(t.model[e][r]=void 0)})))}))}},{key:"_merge",value:function(){var t=this,e=this.model,n=this.penetratedKeys;Object.keys(e).filter((function(t){return n.includes(t)})).forEach((function(n){var r=e[n],a=t.default&&s()(t.default[n]);d()(r)&&a?Object.keys(r).forEach((function(e){var i=r[e];t[n][e]=null==i?a[e]:i})):t[n]=null==r?a:r}))}},{key:"isCacheStale",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.some((function(e){return!Ft()(t.cache[e],t[e])}))}},{key:"drawPosition",value:function(){}},{key:"drawCollapse",value:function(){}},{key:"drawInherit",value:function(){}},{key:"destroy",value:function(){var t;null===(t=this.diagram)||void 0===t||t.cleanDomCellMap(this.graphicGroup.rendererElement),this.eventHelper.destroy(),this.graphicGroup.destroy(),this.destroyed=!0}}],[{key:"getDefaultProps",value:function(){return{model:{},parent:null,computedProps:{},penetratedKeys:[],anchors:[],state:{visible:!0,capture:!0,selected:!1,beginEdit:!1},cache:{},matrix:[1,0,0,0,1,0,0,0,1],isCell:!0,graphicGroup:new na,eventHelper:new hl}}}]),t}();function Os(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(As,"className","Cell"),c()(As,"mergeKeys",["penetratedKeys","Subcells"]),c()(As,"Line",void 0);var Es={plugins:[]};function Ps(t){if(t&&t.body){var e=[];t.body.forEach((function(t){Ve(t,(function(t,n){t.isPlaceholder?e.push({model:t,parent:n}):(function(t){if(t&&t.layout){var e=t.layout.type,n=t.layout,r=n.quadrants,a=n.direction;"standrad"===e?(1===(r=Array.isArray(r)?r.length:Number(r))&&(cn(a,[-1,0])||cn(a,[0,-1])?t.layout.quadrantConstraint=[2]:t.layout.quadrantConstraint=[1]),cn(a,[-1,0])?t.layout.direction=[1,0]:cn(a,[0,-1])&&(t.layout.direction=[0,1])):"indent"===e&&(cn(a,[1,0])?t.layout.quadrantConstraint=[1]:cn(a,[-1,0])&&(t.layout.quadrantConstraint=[2]),t.layout.direction=[1,1])}}(t),function(t){if("line"===t.type&&t.children&&delete t.children,t.image&&t.image.src){var e=ml(t.image.src);t.image.src=vl.process(e)}}(t))}))})),e.forEach((function(e){var n=e.model,r=e.parent,a=r?r.children:t.body,i=a.indexOf(n);i>-1&&a.splice(i,1)}))}}function Ss(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}var Ms=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","hover","drop","dragover","contextmenu"],js=["pointerdown","pointermove","pointerup"],Rs=["touchstart","touchmove","touchend"],Ls=["keydown","keyup","keypress"],Bs=["compositionstart","compositionend"],Ds=["copy","paste","cut"],Ns=["wheel","scroll"],_s=pt.HotKeyUtils.isHotkey,Is=function(t){S()(n,T.a);var e=Ss(n);function n(t){var r;m()(this,n),r=e.call(this),c()(E()(r),"options",void 0),c()(E()(r),"nativeEvents",void 0),c()(E()(r),"dataProcessors",void 0),c()(E()(r),"Cells",void 0),c()(E()(r),"head",void 0),c()(E()(r),"cellMap",void 0),c()(E()(r),"elementMap",void 0),c()(E()(r),"domCellMap",void 0),c()(E()(r),"signal",void 0),c()(E()(r),"settings",void 0),c()(E()(r),"container",void 0),c()(E()(r),"viewportContainer",void 0),c()(E()(r),"canvasContainer",void 0),c()(E()(r),"input",void 0),c()(E()(r),"calculatedContainer",void 0),c()(E()(r),"theme",void 0),c()(E()(r),"rough",void 0),c()(E()(r),"width",void 0),c()(E()(r),"height",void 0),c()(E()(r),"extend",void 0),c()(E()(r),"canvas",void 0),c()(E()(r),"rootGroup",void 0),c()(E()(r),"frontRootGroup",void 0),c()(E()(r),"backRootGroup",void 0),c()(E()(r),"defs",void 0),c()(E()(r),"destroyed",void 0),c()(E()(r),"command",void 0),c()(E()(r),"delegator",void 0),c()(E()(r),"contentEditor",void 0),c()(E()(r),"contentEditorPlus",void 0),c()(E()(r),"exporter",void 0),c()(E()(r),"importer",void 0),c()(E()(r),"interaction",void 0),c()(E()(r),"paper",void 0),c()(E()(r),"highlight",void 0),c()(E()(r),"register",void 0),c()(E()(r),"selector",void 0),c()(E()(r),"viewport",void 0),c()(E()(r),"vertexRotateResize",void 0),c()(E()(r),"groupRotateResize",void 0),c()(E()(r),"abstractView",void 0),c()(E()(r),"groupManager",void 0),c()(E()(r),"lineAlign",void 0),c()(E()(r),"connect",void 0),c()(E()(r),"lineCellAlign",void 0),c()(E()(r),"lineResizer",void 0),c()(E()(r),"font",void 0),c()(E()(r),"mouseDragCanvas",void 0),c()(E()(r),"modelManager",void 0),c()(E()(r),"align",void 0),c()(E()(r),"swimlane",void 0),c()(E()(r),"swimlaneResize",void 0),c()(E()(r),"drawBaseResizer",void 0),c()(E()(r),"penDrawInteract",void 0),c()(E()(r),"hooks",{forceDecorateImportModels:new vs(["models"]),decorateImportModels:new vs(["models"]),decorateAddVertexModel:new vs(["model"]),decorateAddStackModel:new vs(["model"]),decorateAddMindmapAbstract:new vs(["model"]),decorateAddMindmapStemModel:new vs(["model"]),decorateAddMindmapCellModel:new vs(["model"]),decorateAddLineModel:new vs(["model"]),decorateAddSwimlaneModel:new vs(["model"]),decorateAddSwimlaneChildModel:new vs(["model"]),decorateAddPenModel:new vs(["model"]),decorateAddDslModel:new vs(["model"]),decorateAddDslChildModel:new vs(["model"]),decorateNonMindmapCellModels:new vs(["models","sourceTheme"])}),c()(E()(r),"spm",void 0);var a=f()({locale:{},width:500,height:500,plugins:[],paper:null,padding:null,mode:"edit",head:{}},t);r.options=a,r.nativeEvents=[].concat(Ms,js,Rs,Ls,Bs,Ds,Ns),r.dataProcessors=[Ps],r.Cells={Cell:As,Line:As.Line},r.head={version:"2.0.0"},r.cellMap={},r.elementMap={},r.signal={keydown:{}},r.settings={};var i=a.container,o=r._createViewportContainer(),l=r._createCanvasContainer(),s=r._createInputElement();return r.container=i,r.viewportContainer=o,r.canvasContainer=l,r.input=s,i.appendChild(o),o.appendChild(l),o.appendChild(s),r.width=a.width,r.height=a.height,r.calculatedContainer=r._appendCalculatedContainer(),r.domCellMap=new WeakMap,r._initCanvas(),r._initExtend(),r._initEvent(),r}return y()(n,[{key:"_initEvent",value:function(){var t,e=this,n=this.viewportContainer,r=this.nativeEvents,a=!1,i=!1,o=0,c=function(t,n){var r=t,a=r.target,i={target:a,clientX:r.clientX,clientY:r.clientY,button:r.button,preventDefault:function(){t.preventDefault()},stopPropagation:function(){t.stopPropagation()}},o=e.getCell(a);o&&(i.cell=o,e.emit("".concat(o.type,":").concat(n),i)),e.emit(n,i)};r.forEach((function(r){"mousedown"===r?n.addEventListener(r,(function(e){a=!0,c(e,r),o=e.button,t=[e.clientX,e.clientY]})):"mousemove"===r?n.addEventListener(r,(function(n){i&&e.emit("drag",{evt:n,button:o}),a&&!i&&lo(n.clientX,n.clientY,t[0],t[1])>8&&(i=!0,e.emit("dragstart",{evt:n,button:o})),e.emit(r,n)})):"mouseup"===r?n.addEventListener(r,(function(t){c(t,r),i?(e.emit("dragend",{evt:t}),i=!1):2===t.button&&e.emit("contextmenu",t),a=!1})):"contextmenu"===r?n.addEventListener(r,(function(t){t.preventDefault()})):"pointerdown"===r||"pointerup"===r?n.addEventListener(r,(function(t){c(t,r)})):n.addEventListener(r,(function(t){"touchmove"!==r||"free-hand"!==e.interaction.currentMode&&"eraser"!==e.interaction.currentMode?e.emit(r,t):t.preventDefault()}))})),Ts._boundGlobalEvent||(window.addEventListener("mousedown",(function(t){!t.target.closest("[data-lake_prevent_click_unselect]")||t.target.matches("input")||t.target.matches("textarea")||t.preventDefault()})),Ts._boundGlobalEvent=!0)}},{key:"_createViewportContainer",value:function(){var t=document.createElement("div");return t.classList.add("lake-diagram-viewport-container"),t.setAttribute("style","position: relative; outline: none; user-select: text"),t.setAttribute("tabindex","0"),t.setAttribute("focusable","true"),t.setAttribute("dragable","false"),t.addEventListener("dragstart",(function(t){return t.preventDefault()})),t}},{key:"_createCanvasContainer",value:function(){return document.createElement("div")}},{key:"_createInputElement",value:function(){var t=this,e=document.createElement("div");return e.setAttribute("contenteditable","true"),e.style.position="fixed",e.style.top="-300px",e.style.left="-300px",e.style.right="0",e.style.bottom="0",e.style.width="100px",e.style.height="40px",e.margin="auto",e.style["z-index"]=2,e.style.outline="none",e.style.opacity=0,e.style["pointer-events"]="none",e.addEventListener("keydown",(function(e){_s("mod+v",e)||t.selector.selections.length>0&&(_s("mod+c",e)||_s("mod+x",e))})),e.addEventListener("beforeinput",(function(t){t.preventDefault()})),pt.ua.mobile&&e.addEventListener("focus",(function(){e.blur()})),e}},{key:"_appendCalculatedContainer",value:function(){var t=this.options.container,e=document.createElement("div"),n=document.createElement("div");return e.appendChild(n),t.appendChild(e),e.setAttribute("style","opacity: 0; height: 0;width: 0"),e.style.overflow="hidden",n.style.width="10000px",n}},{key:"_initExtend",value:function(){var t,e=this.options;this.extend={},this.addExtend(Object.keys(Cs).map((function(t){return Cs[t]}))),this.register.init(Es.plugins.concat(e.plugins)),this.paper.init(e.paper||{size:[828,1170]}),this.viewport.init(),this.interaction.init(e.mode),null===(t=this.mouseDragCanvas)||void 0===t||t.init(),this.contentEditorPlus.init()}},{key:"_initCanvas",value:function(){var t=this.canvasContainer,e=this.calculatedContainer;this.canvas=new aa({container:t,calculatedContainer:e}),this.rootGroup=new na,this.frontRootGroup=new na,this.backRootGroup=new na,this.rootGroup.dataset({element:"root_group"}),this.frontRootGroup.dataset({element:"front_group"}),this.backRootGroup.dataset({element:"back_group"}),this.defs=new Na,this.canvas.add(this.defs),this.canvas.add(this.backRootGroup),this.canvas.add(this.rootGroup),this.canvas.add(this.frontRootGroup)}},{key:"insertBefore",value:function(t,e){if(t.isStem&&e.isStem)for(var n=this.rootGroup,r=t.getAllCellsByZIndex(),a=e.getAllCellsByZIndex(),i=0;i<r.length;i++)n.insertBefore(r[i].graphicGroup,a[0].graphicGroup)}},{key:"cleanDomCellMap",value:function(t){var e=this.domCellMap;Ve(t,(function(t){e.delete(t)}),(function(t){return t.childNodes}))}},{key:"addExtend",value:function(t){var e=this;t.forEach((function(t){var n=t.className,r=n.charAt(0).toLowerCase()+n.substring(1),a=new t(e);e.extend[r]=a,e[r]=a}))}},{key:"addDataProcessor",value:function(t){this.dataProcessors.push(t)}},{key:"inherit",value:function(t,e){var n=this.cellMap;e||(e=this.getCells().filter((function(t){return t.isStem}))),e.forEach((function(e){Ve(e.model,(function(e,r){e=n[e.id],r=r&&n[r.id]||e.parent,e.computedProps=r?xt()({},r.computedProps,vn(e,t)):vn(e,t)}))}))}},{key:"deepEach",value:function(t){var e=this.cellMap;Object.keys(e).forEach((function(n){t(e[n])}))}},{key:"focus",value:function(){var t=this.input,e=window.getSelection(),n=document.createRange();t.innerHTML="ddd",n.setStart(t.childNodes[0],1),n.setEnd(t.childNodes[0],2),null==e||e.removeAllRanges(),null==e||e.addRange(n)}},{key:"tryFocus",value:function(){this.viewportContainer.contains(document.activeElement)||this.focus()}},{key:"clear",value:function(){this.rootGroup.clear(),this.cellMap={}}},{key:"destroy",value:function(){var t;if(!this.destroyed){var e=this.canvas,n=this.viewportContainer,r=this.extend,a=this.calculatedContainer;this.deepEach((function(t){t.destroy()})),Object.keys(r).forEach((function(t){r[t].destroy()})),null===(t=n.parentNode)||void 0===t||t.removeChild(n),a.remove(),e.destroy(),this.destroyed=!0}}},{key:"export",value:function(){this.emit("beforeexporter");var t=this.exporter.json();return this.emit("afterexporter"),t}},{key:"import",value:function(t){var e=this.dataProcessors,n=this.head;t.head&&Object.assign(n,t.head),this.emit("beforeimport"),e.forEach((function(e){e(t)}));var r=this.importer.json(t);return this.emit("afterimport"),this.viewport.refresh(),r}},{key:"setCursor",value:function(t){this.canvas.css({cursor:t})}},{key:"resetCursor",value:function(){this.setCursor(this.interaction.getModeCursor())}},{key:"isSelected",get:function(){return this.selector.selections.length>0}}]),n}();c()(Is,"_boundGlobalEvent",void 0);var Ts=function(t){S()(n,t);var e=Ss(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n)}(function(t){return function(t){S()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"changePaper",value:function(t){Object.assign(this.paper,t),this.viewport.refresh()}},{key:"changeSize",value:function(t,e){this.width=t,this.height=e,this.viewport.refresh()}}]),n}(t)}(function(t){return function(t){S()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"deduplicate",value:function(t){var e=this;if(!t||0===t.length)return t;if((t=t.concat([])).every((function(e){return e.depth===t[0].depth})))return t;Ht()(t,["depth"]);for(var n=0;n<t.length;n++){var r=t[n];r&&Ze(r.model,(function(n){n=e.find(n.id);var r=t.indexOf(n);-1!==r&&(t[r]=null)}))}return t.filter((function(t){return t}))}},{key:"snapshot",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[e.map((function(t){return s()(t.model)})),e.map((function(e){return t.getCellOptions(e)}))]}},{key:"getCell",value:function(t){var e,n=this.canvas,r=this.cellMap,a=this.domCellMap,i=this.rootGroup,o=this.find(null==t||null===(e=t.dataset)||void 0===e?void 0:e.cellid);if(o)return o;if(!t||!i.rendererElement.contains(t)||n.rendererElement===t)return null;var c=a.get(t);if(c)return c;for(var l=Object.keys(r),s=0;s<l.length;s++){var u=r[l[s]];if(u.graphicGroup.rendererElement.contains(t))return a.set(t,u),u}return null}},{key:"getCellOptions",value:function(t){var e=this,n=this.cellMap,r=[];return Ve(t.model,(function(t){var a=n[t.id],i=e.getSibling(a);i&&(i.unshift(a.model.id),i.push(a.getZIndex()),r.push(i))})),{parent:t.parent&&t.parent.model.id,nth:t.getNth(),siblingSheets:r}}},{key:"getSibling",value:function(t){var e=t.graphicGroup.getSiblingRendererElement();if(e){var n=this.getCell(e[1]);return n?(e[1]=n.model.id,e):null}return null}},{key:"getCells",value:function(){var t=[];return this.deepEach((function(e){t.push(e)})),t}},{key:"getCellsByZIndex",value:function(){var t=[];return this.deepEach((function(e){t.push([e,e.getZIndex()])})),t.sort((function(t,e){var n=b()(t,2)[1],r=b()(e,2)[1];return n>r?1:n<r?-1:0})),t.map((function(t){return t[0]}))}},{key:"getFreehands",value:function(){return this.getCells().filter((function(t){return kr(t)}))}}]),n}(t)}(function(t){S()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"find",value:function(t){if(null!=t){var e=this.cellMap;return t instanceof As?t:e[t]}}},{key:"layout",value:function(t){var e=this.find(t);if(e&&!e.destroyed){if(!e.isStem)throw new Error("Only stem type cell can be layouted!");if(e.executeLayout){var n=this.cellMap;e.executeLayout(),this.emit("afterstemcelllayout",{stem:this}),Ve(e.model,(function(t){var r=n[t.id];return r!==e&&r.drawPosition(),!0}))}}}},{key:"findByContent",value:function(t){return this.getCells().find((function(e){return e.html.includes(t)}))}},{key:"_draw",value:function(t){var e=this;this.emit("beforedraw",t);var n=t.cells,r=void 0===n?[]:n,a=t.stems,i=void 0===a?[]:a,o=t.relatedLines,c=void 0===o?[]:o;i.forEach((function(t){!t.destroyed&&e.layout(t)})),r.forEach((function(t){!t.destroyed&&t.draw()})),c.forEach((function(t){!t.destroyed&&t.draw()})),this.emit("afterdraw",t)}},{key:"_getStems",value:function(t){return on(t.map((function(t){return t.stem})))}},{key:"_getRoots",value:function(t){return on(t.map((function(t){return t.root})))}},{key:"_processSiblingSheets",value:function(t){var e=this.cellMap;t.sort((function(t,e){return e[3]-t[3]}));for(var n=0;n<t.length;n++){var r=t[n],a=e[r[0]],i=e[r[2]];if(a&&i){var o=r[1];"before"!==o&&"after"!==o||i.graphicGroup[o](a.graphicGroup)}}}},{key:"getRelatedLines",value:function(t){var e=this.cellMap,n=t.reduce((function(t,e){return t[e.stem.model.id]=!0,t}),{}),r=this.getCells().filter((function(t){return t.isLine})),a=[];return r.forEach((function(t){["source","target"].some((function(r){var a=t[r].id,i=e[a];return a&&!i||i&&n[i.stem.model.id]}))&&a.push(t)})),a}},{key:"_getCellConstructors",value:function(t){var e=this.Cells;if(!t)return[e.Cell];var n=t.charAt(0).toUpperCase()+t.substring(1),r=e[n+"Stem"],a=e[n+"Cell"];return r&&a?[r,a]:a||(a=e[n])?[a]:void 0}},{key:"_getId",value:function(t){var e=this.cellMap;return null==t||e[t]?Object(F.a)():t}},{key:"_add",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={action:"add"};this.emit("beforechange",n);var r=this.cellMap,a=this.rootGroup,i=[],o=[];e.forEach((function(e){var n,a,c,l,s,u=e.model,d=e.options,h=[];if(d.parent){if((l=r[d.parent])&&(a=l.stem.model,c=l.root.model,n=t._getCellConstructors(a.type),s=l,hn(l.model,u),"number"==typeof d.nth&&d.nth>=0)){var f=l.model.children;ln(f,f.indexOf(u),d.nth),l.model.children=l.model.children.filter((function(t){return t}))}}else c=u;if(Ve(u,(function(e,i){i&&i.id&&(l=r[i.id]);var o=l?l.depth+1:0,s=0===o,u=!!e.type||s;u&&(a=e,n=t._getCellConstructors(e.type)),void 0!==e.html&&(e.html=xl(e.html)),e.id=t._getId(e.id);var d=e.id,f=u?n[0]:n[n.length-1],p={model:e,cellMap:r,parent:l,depth:o,isStem:u,isRoot:s,stem:r[a.id],root:r[c.id],diagram:t},m=new f(p),v=f.getDefaultProps();return m.default=Zi(v),Object.assign(m,v),m.init(p),r[d]=m,h.push(m),!0})),s){var p=t.find(u.id);i.push({cell:p,insertBeforeCell:s})}o=o.concat(h)})),o.sort((function(t,e){return t.zIndex-e.zIndex})),o.forEach((function(t){a.add(t.graphicGroup)})),i.forEach((function(t){var e=t.cell,n=t.insertBeforeCell;a.insertBefore(e.graphicGroup,n.graphicGroup)}));var c=[];e.forEach((function(t){var e=t.options;e.siblingSheets&&(c=c.concat(e.siblingSheets))})),this._processSiblingSheets(c);var l=e.map((function(t){return t.model})),s=this._getStems(o),u=this._getRoots(s),d=this.getRelatedLines(s);return n.models=l,n.stems=s,n.cells=o,n.roots=u,n.relatedLines=d,this._draw(n),this.emit("afterchange",n),l.map((function(t){return r[t.id]}))}},{key:"add",value:function(t,e){var n,r={};if(Array.isArray(t))n=t.map((function(t){return{model:t}}));else{if(!d()(t))throw new Error("Params is illegal");n=[{model:t,options:e}]}return Array.isArray(e)?n.forEach((function(t,n){t.options=e[n]})):d()(e)&&n.forEach((function(t){t.options=e})),n.forEach((function(t){t.options||(t.options=r)})),this._add(s()(n))}},{key:"_update",value:function(t){var e=this,n=this.cellMap,r=[],a={action:"update",models:[]},i=[];t=t.map((function(t){var n=e.find(t.id);return n?(t.cell=n,a.models.push(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Os(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Os(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:n.model.id},t.model)),t):null})).filter((function(t){return t})),a.arr=t,this.emit("beforechange",a),t.forEach((function(t){var e=t.model,a=t.options,o=t.cell,c=n[a.parent];if(c){var l=o.parent!==c,s=c.stem.type===o.stem.type,u=c.isStem&&o.isStem;if(l&&(s||u)){if(o.parent){var d=o.parent.model.children;d.splice(d.indexOf(o.model),1)}hn(c.model,o.model),o.parent=c,o.isRoot=!1,o.stem!==o&&o.deepEach((function(t){t.stem=c.stem})),o.deepEach((function(t){t.root=c.root,t.depth=t.parent.depth+1}))}}else if(null===a.parent&&o.isStem&&o.parent){var h=o.parent.model.children;h.splice(h.indexOf(o.model),1),o.parent=null,o.isRoot=!0,o.depth=0,o.deepEachWithoutSelf((function(t){t.root=o,t.depth=t.parent.depth+1}))}var f=a.nth;if(void 0!==f&&o.parent){var p=o.parent.model.children;ln(p,p.indexOf(o.model),f)}a.siblingSheets&&(i=i.concat(a.siblingSheets)),o.updateModel(e),r.push(o),void 0!==e.collapsed&&Ve(o.model,(function(t){var e=n[t.id];return e!==o&&e.drawCollapse(),!0}))})),this._processSiblingSheets(i);var o=this._getStems(r),l=this._getRoots(o),s=this.getRelatedLines(o);a.cells=r,a.stems=o,a.roots=l,a.relatedLines=s,this._draw(a),this.emit("afterchange",a)}},{key:"update",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(("string"==typeof t||"object"===i()(t)&&t.isCell)&&d()(n))e=[{id:t}];else{if(!Array.isArray(t))throw new Error("Please set id !");e=t.map((function(t){return{id:t}}))}d()(n)?e.forEach((function(t){t.model=n})):Array.isArray(n)&&e.forEach((function(t,e){t.model=n[e]})),d()(r)?e.forEach((function(t){t.options=r})):Array.isArray(r)?e.forEach((function(t,e){t.options=r[e]})):e.forEach((function(t){t.options={}})),e.forEach((function(t){t.model=t.model||{},t.model=It()(t.model),t.options=t.options||{},t.options=It()(t.options)})),this._update(e)}},{key:"_remove",value:function(t){var e=this,n=t.map((function(t){return e.find(t)})).filter((function(t){return t}));if(0!==n.length){n=this.deduplicate(n);var r=this.cellMap,a=n.map((function(t){return t.getAllCells()})).reduce((function(t,e){return t.concat(e)})),i=on(n.map((function(t){return t.stem}))),o=this.getRelatedLines(i),c=[],l={},s={action:"remove",stems:i,models:c,relatedLines:o};return n.forEach((function(t,e){if(c.push(t.model),t.parent){var n={nth:t.parent.model.children.indexOf(t.model),model:c[e]};l[t.parent.model.id]=l[t.parent.model.id]?l[t.parent.model.id].concat(n):[n]}else{var r={nth:-1,model:c[e]};l.root=l.root?l.root.concat(r):[r]}})),this.emit("beforechange",s),n.forEach((function(t){if(t.parent){var e=t.parent.model.children;e.splice(e.indexOf(t.model),1)}})),a.forEach((function(t){t.destroy();var n=e.selector.selections.indexOf(t);-1!==n&&e.selector.selections.splice(n,1),delete r[t.model.id]})),this._draw(s),this.emit("afterchange",s),{eventObj:s,deletedModelsInfo:l}}}},{key:"remove",value:function(t){return Array.isArray(t)||(t=[t]),this._remove(t)}}]),n}(Is)))),Fs=function(){function t(e){m()(this,t),c()(this,"cell",void 0),c()(this,"destroyed",!1),c()(this,"shapeElement",void 0),this.cell=e}return y()(t,[{key:"render",value:function(){}},{key:"update",value:function(){}},{key:"draw",value:function(){}},{key:"drawInherit",value:function(){}},{key:"drawPosition",value:function(){}},{key:"setDefault",value:function(){}},{key:"updateState",value:function(){}},{key:"destroy",value:function(){this.destroyed=!0}}]),t}();function zs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zs(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}window.____lake_diagram_version="2.0.0";var Ys=function(t){S()(n,As);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"Subcells",void 0),c()(E()(t),"subcells",void 0),c()(E()(t),"textareaContentStyleSheets",void 0),c()(E()(t),"x",void 0),c()(E()(t),"y",void 0),c()(E()(t),"opacity",void 0),c()(E()(t),"roughFillStyle",void 0),c()(E()(t),"stroke",void 0),c()(E()(t),"isGroup",void 0),c()(E()(t),"isGeometry",void 0),c()(E()(t),"isLine",void 0),c()(E()(t),"isImage",void 0),c()(E()(t),"isText",void 0),c()(E()(t),"isVertex",void 0),c()(E()(t),"isBoardCell",void 0),c()(E()(t),"stem",void 0),t}return y()(n,[{key:"getRoughGraphicOptions",value:function(){var t=this.roughFillStyle;if(t)return{roughFillStyle:t}}},{key:"getOuterWidth",value:function(){return this.model.width}},{key:"shouldRefreshEndEditContent",value:function(){return!1}},{key:"beginEditContent",value:function(){}},{key:"endEditContent",value:function(){}},{key:"isContentEmpty",value:function(){var t=this.html,e=document.createElement("div");return e.innerHTML=t,!e.textContent||"%E2%80%8B"===encodeURI(e.textContent)}},{key:"canRough",value:function(){return!1}},{key:"canTextVerticalAlign",value:function(){return!0}},{key:"canDragCanvas",value:function(){return!0}},{key:"canDelete",value:function(){return!0}},{key:"canFill",value:function(){return!0}},{key:"canStroke",value:function(){return!0}},{key:"canStrokeWidth",value:function(){return!0}},{key:"canStrokeStyle",value:function(){return!0}},{key:"canConnect",value:function(){return!0}},{key:"canRotate",value:function(){return!0}},{key:"canCollapse",value:function(){var t=this.model;return t.children&&t.children.length>0&&!0!==this.collapsed}},{key:"canExpand",value:function(){var t=this.model;return t.children&&t.children.length>0&&!0===this.collapsed}},{key:"canUseAddLineButton",value:function(){return!1}},{key:"canArrange",value:function(){return!!this.isStem}},{key:"canText",value:function(){return!0}},{key:"canUpdateText",value:function(){return this.textareaElement}},{key:"canRound",value:function(){return!1}},{key:"getCanTextCell",value:function(){return this}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"center",get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"updateTextareaStyleSheets",value:function(){var t=this.textareaContentStyleSheets,e=this.getPadding(),n=t.find((function(t){return"self"===t.query}));if("self"===n.query){var r=this.getOuterWidth();n.css.width=r?r-e[1]-e[3]+"px":""}}},{key:"getTextareaPosition",value:function(t){return{x:0,y:0}}},{key:"snapAnchor",value:function(t){var e=this,n=this.percentage2Canvas({x:.5,y:.5}),r=[t.x-n.x,t.y-n.y];return this.anchors.map((function(t){var a=e.percentage2Canvas(t);return qs(qs({},a),{},{rad:w.vec2.angle(r,[a.x-n.x,a.y-n.y])})})).sort((function(t,e){return t.rad-e.rad}))}},{key:"getPoint",value:function(t){var e=this.anchors;if("string"==typeof t){var n=e.find((function(e){return e.name===t}));if(n)return this.percentage2Canvas(n)}if("number"==typeof t)if(t>=1&&t<e.length){var r=e[t-1];if(r)return this.percentage2Canvas(r)}else if(t>=0)return this.getPointAtPercent(t);if(Array.isArray(t)){var a=b()(t,2),i=a[0],o=a[1];return t.every((function(t){return t>=0&&t<=1}))?this.percentage2Canvas({x:i,y:o}):{x:i,y:o}}throw new Error("unknown connection point ".concat(t))}},{key:"getKeyShape",value:function(){var t;return Ze(this.graphicGroup,(function(e){if(e.isPath)return t=e,!1})),t}},{key:"isPointInShape",value:function(t){var e=Yi(this.canvas2Relative(t)),n=this.getKeyShape();return n.isPointInFill(e)||n.isPointInStroke(e)}},{key:"isPointInFill",value:function(t){var e=Yi(this.canvas2Relative(t));return this.getKeyShape().isPointInFill(e)}},{key:"isPointInStroke",value:function(t){var e=Yi(this.canvas2Relative(t));return this.getKeyShape().isPointInStroke(e)}},{key:"getIntersectionPoint",value:function(t){var e=this.canvas2Relative(t),n={x:.5*this.width,y:.5*this.height},r=n.x,a=n.y,i=e.x,o=e.y,c=this.getKeyShape(),l=null==c?void 0:c.getIntersectionPoint(i,o,r,a),s={x:Je((l=l||{x:0,y:0}).x/this.width,0,1),y:Je(l.y/this.height,0,1)};return this.percentage2Canvas(s)}},{key:"getPointAtLength",value:function(t){return this.relative2Canvas(this.getKeyShape().getPointAtLength(t))}},{key:"getPointAtPercent",value:function(t){var e=this.getKeyShape(),n=e.getTotalLength(),r=e.getPointAtLength(t*n);return this.relative2Canvas(r)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var t=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*t)}}return{"stroke-dasharray":"none"}}},{key:"getAlignBBox",value:function(){return this.getBBox()}},{key:"getKeyShapeBox",value:function(){var t=this.getKeyShape().getBBox(),e=this.x+t.x,n=this.y+t.y;return{x:e,y:n,width:t.width,height:t.height,minX:e,minY:n,maxX:e+t.width,maxY:n+t.height}}},{key:"getFullBBox",value:function(){var t=1/0,e=1/0,n=-1/0,r=-1/0;return this.deepEach((function(a){if(a.state.visible){var i=a.getBBox();t=Math.min(t,i.minX),e=Math.min(e,i.minY),n=Math.max(n,i.maxX),r=Math.max(r,i.maxY)}return!0})),{x:t,y:e,width:n-t,height:r-e,minX:t,minY:e,maxX:n,maxY:r}}},{key:"getTextBox",value:function(){return this.getBBox()}},{key:"toBack",value:function(){if(this.isStem){var t=this.diagram,e=t.groupManager.getStemsByZIndex(),n=e.indexOf(this);if(0!==n&&-1!==n){var r=e[0];t.insertBefore(this,r)}}}},{key:"toFront",value:function(){if(this.isStem){var t=this.diagram,e=t.groupManager.getStemsByZIndex(),n=e.indexOf(this),r=e.length;if(n!==r-1){var a=e[r-1];t.insertBefore(this,a),t.insertBefore(a,this)}}}},{key:"forward",value:function(){if(this.isStem){var t=this.diagram,e=t.groupManager.getStemsByZIndex(),n=e.indexOf(this);if(n!==e.length-1){var r=e[n+1];t.insertBefore(r,this)}}}},{key:"backward",value:function(){if(this.isStem){var t=this.diagram,e=t.groupManager.getStemsByZIndex(),n=e.indexOf(this);if(0!==n&&-1!==n){var r=e[n-1];t.insertBefore(this,r)}}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var t=this.x,e=this.y,n=this.width,r=this.height,a=this.rotate;this.matrix=Qi(t,e,n,r,a)}}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stroke:{width:1},rotate:0,penetratedKeys:["strokeStyle","defaultContentStyle","roughFillStyle"],multiSelectHighlight:!0,isBoardCell:!0,defaultContentStyle:{color:"rgb(38, 38, 38)"},defaultFontFamily:Fr})}}]),n}();c()(Ys,"className","BoardCell");var Hs=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"geometryClipPath",void 0),c()(E()(t),"clipPath",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell.diagram.defs,e=new Ta({id:this.cell.clipPathID}),n=new ha({"clip-rule":"evenodd","fill-rule":"evenodd"});e.add(n),t.add(e),this.geometryClipPath=n,this.clipPath=e}},{key:"draw",value:function(){var t=this.cell,e=this.geometryClipPath,n=t.outlineElement.attr("d");e.update({d:n})}},{key:"destroy",value:function(){this.geometryClipPath.destroy(),this.clipPath.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function Gs(t){var e=t.radius,n=t.outer,r=t.width+2*n,a=t.height+2*n;return"capsule"===t.shape&&(e=r<a?r/2:a/2),Jn(-n,-n,r,a,e)}function Xs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ws(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xs(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Vs=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"group",new na),r.subCell=new Hs(E()(r)),r.diagram=t.diagram,r}return y()(n,[{key:"getSytle",value:function(){var t=this.cell,e=t.border,n=t.computedProps,r=vn(e,{fill:!0});return r.stroke=e.stroke||n.treeEdge.stroke,r["stroke-width"]=t.getBorderStrokeWidth(),"line"===e.shape&&(r.stroke="rgba(255,255,255,0)",r.fill="rgba(255,255,255,0)"),r}},{key:"createRendererElement",value:function(){var t=this.group,e=this.cell;if(!this.element||e.stem.isCacheStale("roughFillStyle")){var n=e.getRoughGraphicOptions(),r=new(n?ti:ha)(Ws({},n));n?this.group.update({"clip-path":"null"}):this.group.update({"clip-path":"url(#".concat(this.clipPathID,")")}),t.clear(),this.element=r,e.borderElement=r,this.outlineElement=r,e.cache.borderShape=e.border.shape,t.add(this.element)}}},{key:"render",value:function(){this.cell.graphicGroup.add(this.group),this.subCell.render()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var t=this.cell,e=this.element,n=t.getRoughGraphicOptions(),r=t.cache,a=t.width,i=t.height,o=t.border,c=o.outer,l=o.radius,s=o.shape,u=this.getSytle(),d=yn(u,r.borderStyle,["stroke","fill","stroke-width"]);d["stroke-width"]&&!n&&(d["stroke-width"]*=2),a===r.width&&ro(i,r.height,1)&&o.shape===r.borderShape||(d.d=Gs({radius:l,outer:c,width:a,height:i,shape:s})),t.stem.isCacheStale("roughFillStyle")&&(d=Ws({d:Gs({radius:l,outer:c,width:a,height:i,shape:s})},u)),Object.keys(d).length>0&&(e.update(d),this.subCell.draw(),r.borderStyle=u)}},{key:"destroy",value:function(){this.element&&this.element.destroy()}}]),n}();c()(Vs,"className","Border"),c()(Vs,"configName","border"),c()(Vs,"zIndex",1);var Zs=ba,Us=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"render",value:function(){var t=this.cell,e=new Zs;this.element=e,t.imageElement=e}},{key:"draw",value:function(){var t=this.cell,e=this.element,n=t.graphicGroup,r=t.image,a=t.contentBox,i=t.diagram.imageManager,o=t.getPadding();if(r.src){if(n.children.includes(e)||n.add(e),r){var c=r.src,l=r.width,s=r.height,u=r.naturalWidth,d=r.naturalHeight;e.update({x:a.x+(a.width-r.width)/2,y:o[0],width:l,height:s}),e.dataset({raw_src:r.src}),i.setImageHref(e,c,u,d)}}else e.remove()}},{key:"destroy",value:function(){this.element.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function Ks(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ks(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ks(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(Us,"className","ImageSubcell"),c()(Us,"configName","image"),c()(Us,"zIndex",2),We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n[data-lake-mindmap-icon-selected=\"true\"].lake-diagram-mindmap-icon {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-lake-board-mode='edit'] .lake-diagram-mindmap-icon:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n");var $s=ya,Js=["html","width","height","textVerticalAlign","icons"],tu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"render",value:function(){var t=this.cell,e=t.graphicGroup,n=new $s({styleSheets:t.textareaContentStyleSheets,html:t.html});n.htmlContainer.classList.add("selection-transparent"),e.add(n),this.element=n,t.textareaElement=n,t.textarea=this,this.initCalculatedDOM()}},{key:"initCalculatedDOM",value:function(){var t=this.cell.diagram,e=document.createElement("div");t.calculatedContainer.appendChild(e),this.calculatedDOM=e}},{key:"update",value:function(){var t=this.cell,e=this.calculatedDOM,n=t.cache,r=t.textareaContentStyleSheets,a=Qs(Qs({},t.stem.defaultContentStyle),t.defaultContentStyle);if(n.html!==t.html&&(e.innerHTML=t.html),t.updateTextareaStyleSheets(),this._shouldRender()){if(a){var i=r.find((function(t){return"self"===t.query}));i&&Object.assign(i.css,a),a["font-family"]||(i.css["font-family"]=t.defaultFontFamily)}mn(e,r),this._setBBox()}}},{key:"getPosition",value:function(){var t=this.cell,e=this.getBBox();return t.getTextareaPosition(e)}},{key:"calculateBBox",value:function(){var t=this.calculatedDOM;t.style.display="inline-block";var e=t.getBoundingClientRect();return t.style.display="none",{x:e.x,y:e.y,width:Math.ceil(e.width),height:Math.ceil(e.height)}}},{key:"_setBBox",value:function(){this.box=this.calculateBBox()}},{key:"_shouldRender",value:function(){var t=this.cell,e=t.cache;return Js.some((function(n){var r=e[n],a=t[n];return"number"==typeof r&&"number"==typeof a?!ro(a,r,1):!Ft()(a,r)}))||t.stem.isCacheStale("roughFillStyle")}},{key:"getBBox",value:function(){return this.box}},{key:"draw",value:function(){var t=this.cell,e=this.element,n=this.box;t.cache;var r=t.textareaContentStyleSheets,a={};this._shouldRender()&&(a.html=t.html,mn(e.htmlContainer,r),Object.assign(a,Qs({width:n.width+2,height:n.height},this.getPosition()))),Object.keys(a).length>0&&(e.update(a),"read"===t.diagram.interaction.currentMode&&e.htmlContainer.querySelectorAll("a").forEach((function(t){var e=t.href,n=window.location.origin+window.location.pathname;(e===n||e.startsWith(n+location.search+"#"))&&t.removeAttribute("target")})))}},{key:"destroy",value:function(){this.element.destroy(),this.calculatedDOM.remove()}}]),n}();c()(tu,"className","Textarea"),c()(tu,"configName","textarea"),c()(tu,"zIndex",2);var eu=function(t){S()(n,tu);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"drawInherit",value:function(){this.update(),this.draw()}},{key:"calculateBBox",value:function(){var t=_()(L()(n.prototype),"calculateBBox",this).call(this),e=this.cell,r=this.calculatedDOM,a=e.image&&e.image.src;return r.textContent||e.state.beginEdit||!a?t:{x:t.x,y:t.y,width:t.width+1,height:0}}},{key:"getPosition",value:function(){var t=this.cell,e=t.image,n=t.contentBox,r=e&&e.src&&e.height+2||0;return{x:n.x,y:n.y+r}}}]),n}();c()(eu,"className","MindmapTextarea");var nu=ya,ru=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"container",void 0),c()(E()(t),"size",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell.graphicGroup,e=new nu,n=e.htmlContainer;n&&(n.classList.add("lake-diagram-mindmap-icon-container"),n.style.display="flex",n.style.alignItems="center",n.style.boxSizing="border-box"),this.container=e,t.add(e)}},{key:"draw",value:function(){var t=this.cell,e=this.container,n=this.size,r=t.validIconKeys,a=t.model.icons,i=void 0===a?{}:a,o=this.getBBox(),c=e.htmlContainer;if(c){var l=c.children,s=r;if(s.length>0){c.style.width=o.width+"px",c.style.height=n+4+"px",e.attr(o),e.show();for(var u=0,d=0;;){var h=l[d],f=void 0,p=s[u];if(p){var m=s[u];if(h){var v=h.getAttribute("lake-mindmap-icon-key");v===m?(d++,u++):Lr.indexOf(v)<Lr.indexOf(m)?(h.remove(),h=null):(f=this.newIconElement(m),c.insertBefore(f,h),d++,u++)}else f=this.newIconElement(m),c.appendChild(f),d++,u++}else{if(!h)break;h.remove(),h=null}var y=f||h;y&&(_r(p,i[p])!==y.src&&(y.setAttribute("src",_r(p,i[p])),y.setAttribute("lake-mindmap-icon-key",p)),y.style.width=n+4+"px",y.style.height=n+4+"px",y.dataset.lakeMindmapIconSelected="false")}}else e.hide()}}},{key:"updateSize",value:function(){if(this.size=this.getIconSize(),isNaN(this.size))throw new Error("mindmap icon size nan")}},{key:"getIconSize",value:function(){var t=this.cell,e=t.subcells,n=t.isStem?18:14,r=e.find((function(t){return t instanceof eu}));if(!r.calculatedDOM)return n+2;for(var a=r.calculatedDOM,i=r.calculatedDOM,o=n;(null===(c=a.childNodes)||void 0===c?void 0:c.length)>0;){var c;if((a=a.childNodes[0])instanceof HTMLElement)i=a;else if(a){var l=window.getComputedStyle(i).fontSize.match(/^[0-9]*px/);if(l){var s=parseFloat(l[0]);"number"!=typeof s||isNaN(s)||(o=s)}}}return o+2}},{key:"getBBox",value:function(){var t=this.cell.validIconKeys,e=n.style.marginRight;return 0===t.length?{width:0,height:0}:{x:this.cell.getPadding()[3]-2,y:(this.cell.height-this.size-4)/2,width:(this.size+4+e)*t.length-e,height:this.size+4}}},{key:"newIconElement",value:function(t){var e=document.createElement("img");e.className="lake-diagram-mindmap-icon",e.setAttribute("lake-mindmap-icon-key",t);var r=n.style.marginRight;return e.style.border="none",e.style.padding="2px",e.style.marginRight="".concat(r,"px"),e.style.borderRadius="6px",e.style.userSelect="none",e.style.boxSizing="border-box",e}}]),n}();c()(ru,"className","MindmapIcons"),c()(ru,"zIndex",3),c()(ru,"style",{marginRight:0});var au=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"element",void 0),t}return y()(n,[{key:"setDefault",value:function(){var t=this.element;t&&t.hide()}},{key:"updateState",value:function(){var t=this.element,e=this.cell;if(e.state.selected){var n={d:""};n.d=e.borderElement.attr("d"),t.update(n),t.show()}else t.hide()}},{key:"render",value:function(){this.element=new ha({stroke:"#3384F5",fill:"transparent"}),this.element.css({"pointer-events":"none"}),this.cell.outlineElement=this.element,this.cell.graphicGroup.add(this.element)}},{key:"draw",value:function(){}},{key:"destroy",value:function(){_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();c()(au,"className","MindmapOutline"),c()(au,"configName","outline"),c()(au,"zIndex",3);var iu=ya,ou=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),r=e.call(this,t);var a=t.note,i=a.width,o=a.height,c=a.padding;return r.size=[i+c[1]+c[3],o+c[0]+c[2]],r}return y()(n,[{key:"render",value:function(){var t=this.cell.note,e=t.width,n=t.height,r=new iu({width:e,height:n}),a=r.htmlContainer;a.classList.add("lake-diagram-note"),a.classList.add("lake-icon"),a.classList.add("lake-icon-diagram-cell-note"),a.style.cursor="pointer",a.style["vertical-align"]="top",a.style.color="#8C8C8C",a.style["font-size"]=e+"px",a.style.width=e+"px",a.style.height=n+"px",a.style["line-height"]=e+"px",this.element=r}},{key:"draw",value:function(){var t=this.cell,e=this.element,n=t.model,r=t.note,a=t.graphicGroup,i=t.width,o=t.height,c=t.border;n.note?(e.attr({x:i-r.width-r.padding[1],y:(o-r.height)/2}),c.fill&&(e.htmlContainer.style.color=yi(c.fill)),a.add(e)):e.remove()}}]),n}();function cu(t){var e=t.naturalWidth/t.naturalHeight,n=t.firstInsertRatio?t.naturalWidth*t.firstInsertRatio:t.naturalWidth;return t.width=n>=480?480:n,t.height=t.width/e,t}c()(ou,"className","Note"),c()(ou,"zIndex",3);var lu=[Vs,au,Us,ou,eu,ru],su=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"getRoughGraphicOptions",value:function(){var t=this.computedProps.roughFillStyle;if(t)return{roughFillStyle:t}}},{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.model.children||(this.model.children=[]),this.Subcells.sort((function(t,e){return t.zIndex-e.zIndex})),this.Subcells.forEach((function(t){var n=t.configName;n&&!e[n]&&(e[n]={},!e.default[n]&&(e.default[n]={}))})),this.initSubcell(),this.render(),this.eventDelegation()}},{key:"minContentWidth",get:function(){var t=this.border;if(t){var e=t.shape;if("rect"===e)return 38;if("capsule"===e)return 42}return 32}},{key:"minHeight",get:function(){return 16}},{key:"isPlaceholder",get:function(){return this.model.isPlaceholder}},{key:"getMinWidth",value:function(){return this.minContentWidth+this.getIconsWidth()}},{key:"updateTextareaStyleSheets",value:function(){var t=this.textareaContentStyleSheets,e=this.model,n=this.minHeight,r=this.subcells;if(!this.model.width){var a=this.getMinWidth(),i=this.getPadding(),o=i[1]+i[3]+this.getNoteWidth()+this.getIconsWidth(),c=i[0]+i[2],l=r.find((function(t){return t instanceof eu})),s=t.find((function(t){return"self"===t.query}));e.image&&e.image.src&&e.image.width?l.calculateBBox().width<e.image.width&&(s.css.width=e.image.width-1+"px",s.css["max-width"]=""):(s.css["max-width"]="480px",s.css.width=""),s.css["min-width"]=a-o+"px",s.css["min-height"]=n-c+"px"}}},{key:"updateTextareaCSS",value:function(){var t=this.textareaContentStyleSheets,e=this.model,n=this.minHeight,r=this.subcells,a=this.getMinWidth(),i=this.getPadding(),o=i[1]+i[3]+this.getNoteWidth()+this.getIconsWidth(),c=i[0]+i[2],l=r.find((function(t){return t instanceof eu})),s=t.find((function(t){return"self"===t.query}));if(e.width){var u=Math.max(e.width,a);s.css.width=u-o+"px",s.css["max-width"]="",s.css["min-width"]=a-o+"px",s.css["min-height"]=n-c+"px"}mn(l.calculatedDOM,t),l._setBBox()}},{key:"deprecatedGetBBox",value:function(){var t=this.graphicGroup.rendererElement.getBBox(),e=this.x+t.x,n=this.y+t.y;return{x:e,y:n,width:t.width,height:t.height,minX:e,minY:n,maxX:e+t.width,maxY:n+t.height}}},{key:"getTimelineLayoutAlign",value:function(){var t=this.getTimelineLayoutSourceCell(),e="";return[t,this].forEach((function(t){t&&"line"===t.border.shape?e+="b":e+="c"})),e}},{key:"getTimelineLayoutSourceCell",value:function(){var t=this.parent;if(this.isStem)return null;var e=this.getNth();return 0===e?t:this.getSiblings()[e-1]}},{key:"showCollapsedButton",value:function(){this.state.collapsedButtonVisible||(this.state.collapsedButtonVisible=!0,this.updateState())}},{key:"hideCollapsedButton",value:function(){this.state.collapsedButtonVisible&&(this.state.collapsedButtonVisible=!1,this.updateState())}},{key:"findSubcell",value:function(t){return this.subcells.find((function(e){return e.constructor.className===t}))}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()&&this.image&&this.image.src}},{key:"canStroke",value:function(){return"line"!==this.border.shape}},{key:"canRotate",value:function(){return!1}},{key:"canStrokeWidth",value:function(){return!1}},{key:"canStrokeStyle",value:function(){return!1}},{key:"canFill",value:function(){return"line"!==this.border.shape}},{key:"get",value:function(t){var e=_()(L()(n.prototype),"get",this).call(this,t);return"border"===t?(e.stroke=e.stroke||this.computedProps.treeEdge.stroke,e["stroke-width"]=this.getBorderStrokeWidth(),e):"treeEdge"===t?(e.stroke=this.computedProps.treeEdge.stroke,e["stroke-width"]=this.getTreeEdgeStrokeWidth(),e):e}},{key:"getKeyShape",value:function(){return this.borderElement}},{key:"getPadding",value:function(){return[4,8,4,8]}},{key:"getBorderStrokeWidth",value:function(){return this.border["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getTreeEdgeStrokeWidth",value:function(){return this.computedProps.treeEdge["stroke-width"]||this.getDefaultStrokeWidth()}},{key:"getDefaultStrokeWidth",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.depth;return this.stem.tapered&&function(t){return t<=2?3:t>=2&&t<=4?2:1}(t)||3}},{key:"initSubcell",value:function(){var t=this;this.subcells=this.Subcells.map((function(e){return new e(t)}))}},{key:"eventDelegation",value:function(){var t=this.graphicGroup,e=this.imageElement;this.delegateEvent(e,"mouseenter","mindmapcellimage:mouseenter"),this.delegateEvent(e,"mouseleave","mindmapcellimage:mouseleave"),this.delegateEvent(t,"mouseenter","mindmapcell:mouseenter"),this.delegateEvent(t,"mouseleave","mindmapcell:mouseleave")}},{key:"render",value:function(){this.subcells.forEach((function(t){t.render()})),this.updateModel(this.model)}},{key:"draw",value:function(){this.drawInner(),this.updateCache(),this.updateState()}},{key:"updateModel",value:function(t){t&&""===t.html&&(t.html="&#8203;"),_()(L()(n.prototype),"updateModel",this).call(this,t),this.calculate()}},{key:"isInCollapsed",value:function(){for(var t=this.parent;t;){if(!0===t.collapsed)return!0;t=t.parent}return!1}},{key:"getCellQuadrant",value:function(){for(var t=this;1!==t.depth;)t=t.parent;return t.model.quadrant}},{key:"drawInner",value:function(){this.subcells.forEach((function(t){t.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"drawInherit",value:function(){"capsule"===this.border.shape&&this.image.src&&this.calculate(),this.subcells.forEach((function(t){t.drawInherit()}))}},{key:"drawPosition",value:function(){this.subcells.forEach((function(t){t.drawPosition()}));var t=this.graphicGroup,e=this.x,n=this.y,r=this.cache;if(!r.matrix||e!==r.matrix[6]||n!==r.matrix[7]){var a=[1,0,0,0,1,0,e,n,1];t.update({matrix:a}),r.matrix=a,this.matrix=a}}},{key:"drawCollapse",value:function(){this.isInCollapsed()?this.hide():this.show()}},{key:"getNoteWidth",value:function(){return this.model.note&&this.findSubcell("Note").size[0]||0}},{key:"getIconsWidth",value:function(){return this.model.icons?this.findSubcell("MindmapIcons").getBBox().width:0}},{key:"calculate",value:function(){this.calculateSize()}},{key:"calculateSize",value:function(){var t=this,e=this.cache,n=this.findSubcell("MindmapTextarea");n.update();var r=this.findSubcell("MindmapIcons");r.updateSize(),this.model.width&&this.updateTextareaCSS(),this.textareaBBox=n.box;var a=this.getPadding(),i={noteWidth:this.getNoteWidth(),padding:a,iconsBBox:r.getBBox()};e.html&&this.html&&e.html!==this.html&&(this.model.height=null),(["image","width","height","html"].some((function(n){return e[n]!==t[n]}))||this.isCacheStale("icons"))&&(this.calculateImageSize(i),this.contentHeight=this.getContentHeight(i),this.contentWidth=this.getContentWidth(i),this.height=this.getHeight(i),this.width=this.getWidth(i),this.contentBox=this.getContentBox(i),"capsule"===this.border.shape&&(i.padding=this.getPadding(),this.contentHeight=this.getContentHeight(i),this.contentWidth=this.getContentWidth(i),this.height=this.getHeight(i),this.width=this.getWidth(i),this.contentBox=this.getContentBox(i)))}},{key:"getContentBox",value:function(t){var e=t.padding,n=t.noteWidth,r=t.iconsBBox,a=this.width,i=this.contentWidth,o=this.contentHeight;return{x:(a-i-e[1]-e[3]-n-r.width)/2+e[3]+r.width,y:e[0],width:i,height:o}}},{key:"getHasModelSizeContentWidth",value:function(t){var e,n=t.padding,r=t.noteWidth,a=t.iconsBBox,i=this.model,o=this.border,c=this.getMinWidth(),l=Math.max(i.width,c),s=n[1]+n[3]+r+a.width,u=l-s;return"capsule"===o.shape&&(e=l>i.height?l-i.height+s:l/2,u=Math.min(u,e)),u}},{key:"calculateImageSize",value:function(t){var e=t.padding,r=this.image,a=this.model;if(!r.height||a.height){if(!r.src)return Object.assign(r,{width:0,height:0});var i=r.naturalWidth/r.naturalHeight,o=this.getTextareaHeight(),c=this.getHasModelSizeContentWidth(t),l=a.height-e[0]-e[2]-o-4,s=((l=Math.max(l>0?l:0,36))>0?c/l:i)<=i?c/i:l,u=s*i;_()(L()(n.prototype),"updateModel",this).call(this,{image:{width:u,height:s}})}}},{key:"getWidth",value:function(t){var e=t.padding,n=t.noteWidth,r=t.iconsBBox,a=this.isPlaceholder,i=this.model,o=this.border,c=this.contentWidth,l=this.contentHeight;if(a)return i.width;var s,u=this.getMinWidth();if(i.width)s=Math.max(i.width,u);else if(s=c+e[1]+e[3]+n+r.width,"capsule"===o.shape){var d=e[1]+e[3];l>d&&(s+=l-d)}return nn(Math.ceil(s),u)}},{key:"getHeight",value:function(t){var e=t.padding;return this.isPlaceholder?this.model.height:nn(this.contentHeight+e[0]+e[2],this.minHeight)}},{key:"getContentWidth",value:function(t){var e=t.padding,n=t.noteWidth,r=t.iconsBBox,a=this.textareaBBox,i=this.image,o=this.model;if(o.width){var c=this.getMinWidth();return Math.max(o.width,c)-n-e[1]-e[3]-r.width}return Math.ceil(Math.max(a.width,i.width))||100}},{key:"getTextareaHeight",value:function(){var t=this.textareaBBox,e=this.image,n=this.diagram;return e.src&&this.isContentEmpty()&&!n.contentEditor.isBegin?0:t.height}},{key:"getContentHeight",value:function(t){var e=this.image,n=this.getTextareaHeight();return Math.ceil(n+e.height)}},{key:"updateState",value:function(){this.setDefault(),this.subcells.forEach((function(t){t.updateState()}))}},{key:"setDefault",value:function(){this.subcells.forEach((function(t){t.setDefault()}))}},{key:"updateCache",value:function(){this.cache.width=this.width,this.cache.height=this.height,this.cache.html=this.html,this.cache.collapsed=this.collapsed,this.cache.icons=s()(this.icons),this.cache.roughFillStyle=this.computedProps.roughFillStyle}},{key:"preventDelete",value:function(){return!1}},{key:"beginEditContent",value:function(){this.state.beginEdit=!0,this.updateState()}},{key:"endEditContent",value:function(){this.state.beginEdit=!1,this.updateState()}},{key:"getEventObject",value:function(t){return{cell:this,nativeEvent:t}}},{key:"destroy",value:function(){this.subcells.forEach((function(t){t.destroy()})),_()(L()(n.prototype),"destroy",this).call(this)}},{key:"getNewQuadIndexByNewRealIndex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.quadrantTreeLists[e-1],r=n.findIndex((function(e){return e>=t}));return-1!==r?r:n.length}},{key:"mindmapParent",get:function(){var t=this.parent;return t&&t.isMindmap?t:void 0}},{key:"quadrantTreeLists",get:function(){var t=this.getChildren();if(this.isTwoQuadrantLayout){var e=[[],[]];return t.forEach((function(t,n){var r=t.model,a=r.layout,i=(void 0===a?{}:a).quadrant,o=void 0===i?1:i,c=r.abstract,l=Math.min(2,Math.max(1,o));c||e[l-1].push(n)})),e}return[Pt()(t.filter((function(t){return!t.model.abstract})).length)]}},{key:"isTwoQuadrantLayout",get:function(){return n.modelIsTwoQuadrantLayout(this.model)}},{key:"realQuadrant",get:function(){var t=this.mindmapParent;if(t){var e=this.model.layout,n=(void 0===e?{}:e).quadrant,r=void 0===n?1:n;if(t.layoutQuadrantConstraint&&t.layoutQuadrantConstraint.length>1)return r}return 1}},{key:"quadrantNth",get:function(){var t=this.parent&&this.parent.isTwoQuadrantLayout,e=this.getNth();if(t){var n=this.parent.quadrantTreeLists[this.realQuadrant-1];if(!this.isAbstract)return n.indexOf(e)}return this.parent&&this.parent.isMindmap?e:-1}},{key:"abstractCoveredCells",get:function(){var t=this.model,e=t.abstract,n=t.start,r=t.end,a=this.realQuadrant;if(this.parent&&e&&void 0!==n&&void 0!==r){var i=this.parent.getChildren();return this.parent.quadrantTreeLists[a-1].slice(n,r+1).map((function(t){return i[t]}))}return[]}},{key:"abstractCoveredCellsWithAllChildren",get:function(){var t=this.model,e=t.abstract,n=t.start,r=t.end,a=this.realQuadrant;if(this.parent&&e&&void 0!==n&&void 0!==r){var i=this.parent.getChildren();return this.parent.quadrantTreeLists[a-1].slice(n,r+1).map((function(t){return i[t]})).reduce((function(t,e,n){return t.concat(e).concat(e.getAllChildren())}),[])}return[]}},{key:"validIconKeys",get:function(){var t=this.model.icons;return t?Lr.filter((function(e,n){return"number"==typeof t[e]&&t[e]>=0&&t[e]<Dr[n]})):[]}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{x:0,y:0,rotate:0,collapsed:!1,html:"&#8203;",layout:{},image:{width:0,height:0},note:{width:14,height:14,padding:[0,8,0,0]},anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],Subcells:lu,penetratedKeys:["x","y","width","collapsed","quadrant","zIndex","html","layout","rainbow","tapered","note","treeEdge","icons","roughFillStyle"].concat(lu.map((function(t){return t.configName}))),isMindmap:!0,multiSelectHighlight:!1,resizeRotatePoints:["tr"]})}},{key:"modelIsTwoQuadrantLayout",value:function(t){var e=t.layout,n=void 0===e?{}:e,r=n.type,a=void 0===r?"standard":r,i=n.quadrantConstraint,o=void 0===i?void 0:i;return"mindmap"===t.type&&"standard"===a&&(!o||o.length>1)}}]),n}();function uu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function du(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?uu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hu(t){"flowchart"===t.type&&(t.type="geometry"),"edge"===t.type&&(t.type="line")}function fu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mu(t,e){switch((t=pu(pu({"stroke-linecap":"butt","stroke-linejoin":"round"},e),t)).name){case"rect":return new(e?si:Oa)(t);case"ellipse":return new(e?ri:ma)(t);case"polygon":return new(e?oi:wa)(t);default:return new(e?ti:ha)(t)}}function vu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(su,"className","MindmapBase");var gu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"sceneKeys",[]),c()(E()(t),"group",new na),c()(E()(t),"elements",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell;vr(t)?t.clipGroup.add(this.group):t.graphicGroup.add(this.group)}},{key:"renderElements",value:function(){var t=this.group,e=this.cell,n=e.stencil,r=[],a=e.getRoughGraphicOptions();n.scene.forEach((function(e){var n=mu(e,a);e.attr&&n.update(e.attr),t.add(n),r.push(n)})),this.elements=r}},{key:"update",value:function(){var t=this.cell,e=this.elements;t.isCacheStale("shape","roughFillStyle")&&(e&&e.forEach((function(t){return t.remove()})),this.renderElements())}},{key:"draw",value:function(){var t=this.cell,e=this.elements,n=t.stroke,r=t.width,a=t.height,i=t.stencil,o=yu({},t.convertStrokeStyle());t.isCacheStale("stroke","roughFillStyle")&&(o.stroke=n.color,o["stroke-width"]=!0===(null==i?void 0:i.open)?2*n.width:n.width),e.forEach((function(t,e){var n,c,l=null===(n=i.scene[e])||void 0===n?void 0:n.path;if(l)c=l(r,a);else{var s=r/i.width,u=a/i.height;c=t.getPath(s,u)}t.update(yu(yu({},o),{},{d:c},i.scene[e].attr))}))}}]),n}();function bu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var xu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"shapeElement",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell,e=new na;this.group=e,ur(t)||dr(t)?t.clipGroup.add(this.group):yr(t)?t.group.add(this.group):t.graphicGroup.add(e)}},{key:"update",value:function(){var t=this.cell,e=this.group,n=t.createOutlineShapeElement();if(n){if(e.clear(),vr(t)){var r=t.stencil.outline;r.style&&n.css(r.style)}e.add(n),this.shapeElement=n,t.outlineElement=n}}},{key:"draw",value:function(){var t=this.cell,e=this.shapeElement,n=t.stroke,r=t.fill,a=t.stencil;if(n){var i={},o=t.getOutlinePath(e),l=t.getRoughGraphicOptions();o&&(i.d=o);var s=n.width;a&&(!1===a.isClip||l||(s*=2)),t.isCacheStale("stroke","roughFillStyle")&&Object.assign(i,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({stroke:n.color,"stroke-width":s},t.convertStrokeStyle())),yr(t)||lr(t)||dr(t)?i.fill="transparent":t.isCacheStale("fill","roughFillStyle")&&(i.fill=r.color),e.update(i)}}}]),n}();function ku(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}["getTotalLength","isPointInFill","isPointInStroke"].forEach((function(t){Object.defineProperty(xu.prototype,t,{value:function(){var e;return(e=this.shapeElement)[t].apply(e,arguments)}})}));var wu=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"textareaContentStyleSheets",void 0),c()(E()(t),"rotate",void 0),c()(E()(t),"fill",void 0),c()(E()(t),"textareaRegion",void 0),c()(E()(t),"textVerticalAlign",void 0),c()(E()(t),"outlineElement",void 0),c()(E()(t),"clipPathID",Object(F.a)()),c()(E()(t),"clipGroup",new na),t}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.initSubcell(),this.eventDelegation(),this.render()}},{key:"canUseAddLineButton",value:function(){return!0}},{key:"initSubcell",value:function(){var t=this;this.subcells=this.Subcells.map((function(e){return new e(t)}))}},{key:"getEventObject",value:function(t){return{cell:this,nativeEvent:t}}},{key:"eventDelegation",value:function(){var t=this.graphicGroup;this.delegateEvent(t,"mouseenter","vertexcell:mouseenter"),this.delegateEvent(t,"mouseleave","vertexcell:mouseleave")}},{key:"draw",value:function(){this.subcells.forEach((function(t){return t.draw()})),this.graphicGroup.attr({opacity:this.opacity}),this.drawPosition(),this.updateCache()}},{key:"updateCache",value:function(){var t=this,e=this.cache;["x","y","width","height","rotate","shape","fill","stroke","controlPoints","round","roughFillStyle"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ku(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ku(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"render",value:function(){var t=this.model;this.subcells.forEach((function(t){return t.render()})),this.updateModel(t),this.graphicGroup.prepend(this.clipGroup)}},{key:"getTextareaPosition",value:function(t){var e=this.width,n=this.height,r=this.getPadding(),a=t.height;return{x:Math.max((e-t.width)/2,r[3]),y:(n-a)/2}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var t=this.graphicGroup,e=this.matrix;t.update({matrix:e})}}},{key:"updateMatrix",value:function(){if(this.isCacheStale("x","y","width","height","rotate")){var t=this.x,e=this.y,n=this.width,r=this.height,a=this.rotate;this.matrix=Qi(t,e,n,r,a)}}},{key:"getKeyShape",value:function(){var t;return null===(t=this.subcells.find((function(t){return t instanceof xu})))||void 0===t?void 0:t.shapeElement}},{key:"destroy",value:function(){this.subcells.forEach((function(t){return t.destroy()})),_()(L()(n.prototype),"destroy",this).call(this)}},{key:"beforeUpdateModel",value:function(t){if(this.constraints&&this.constraints.proportion){var e=this.width/this.height;t.height>0&&null==t.width?t.width=t.height*e:t.width>0&&(t.height=t.width/e)}}},{key:"afterUpdateModel",value:function(){if(this.updateMatrix(),this.subcells.forEach((function(t){t.update()})),this.stencil){var t=this.getRoughGraphicOptions();!1===this.stencil.isClip||t?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}}},{key:"updateModel",value:function(t){this.beforeUpdateModel(t),_()(L()(n.prototype),"updateModel",this).call(this,t),this.afterUpdateModel()}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{html:"",x:0,y:0,rotate:0,anchors:[{x:.5,y:0,name:"N"},{x:.5,y:1,name:"S"},{x:0,y:.5,name:"W"},{x:1,y:.5,name:"E"}],opacity:1,penetratedKeys:["x","y","width","height","category","stroke","fill","rotate","html","shape","image","constraints","opacity"],textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],Subcells:[xu,Hs],isVertex:!0})}}]),n}();c()(wu,"className","VertexCell");var Cu=function(t,e){return{minX:4,minY:4,maxX:t-4,maxY:e-4}};var Au=function(t){S()(n,wu);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"stencil",void 0),c()(E()(t),"stencils",void 0),c()(E()(t),"controlPoints",void 0),c()(E()(t),"round",void 0),c()(E()(t),"shape",void 0),c()(E()(t),"isGeometry",!0),c()(E()(t),"outlineElement",void 0),t}return y()(n,[{key:"canRough",value:function(){return!0}},{key:"canRound",value:function(){return void 0!==this.model.round}},{key:"updateTextareaStyleSheets",value:function(){var t=this.textareaContentStyleSheets,e=this.textareaRegion;t.find((function(t){return"self"===t.query})).css.width="".concat(e.maxX-e.minX,"px")}},{key:"getTextareaPosition",value:function(t){var e=this.textareaRegion,n=this.textVerticalAlign,r={x:e.minX,y:0};return r.y="top"===n?e.minY:"bottom"===n?e.maxY-t.height:(e.minY+e.maxY-t.height)/2,r}},{key:"_updateStencil",value:function(){var t=this.shape,e=this.stencils,n=t||"process";if(!this.stencil||this.stencil.name!==n){var r=e.find((function(t){return t.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this._updateAnchors(),this._updateDefaultSize(),this.cache={}}}},{key:"_updateTextareaRegion",value:function(){var t,e=this.stencil,n=this.width,r=this.height,a=this.controlPoints,i=(null==e||null===(t=e.textarea)||void 0===t?void 0:t.region)||Cu;this.textareaRegion=i(n,r,a)}},{key:"_updateDefaultSize",value:function(){var t=this,e=this.stencil;["width","height"].forEach((function(n){null==t[n]&&(t[n]=e[n])}))}},{key:"_updateAnchors",value:function(){for(var t=this.anchors,e=this.stencil,n=function(){var n=t[r],a=e.anchors.find((function(t){return t.name===n.name}));a&&(t[r]=a)},r=0;r<t.length;r++)n()}},{key:"afterUpdateModel",value:function(){this._updateStencil(),this._updateTextareaRegion(),_()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var t=this.stencil,e=this.getRoughGraphicOptions();return mu(t.outline,e)}}},{key:"getOutlinePath",value:function(t){if(this.isCacheStale("width","height","shape","controlPoints","round","roughFillStyle")){var e,n=this.width,r=this.height,a=this.stencil,i=this.controlPoints,o=this.round;if(a.outline.path)e=a.outline.path(n,r,i,o);else{var c=n/a.width,l=r/a.height;e=t.getPath(c,l)}return e}return null}},{key:"render",value:function(){_()(L()(n.prototype),"render",this).call(this);var t=this.model;t.width||(t.width=this.width),t.height||(t.height=this.height)}},{key:"getOuterWidth",value:function(){return this.width}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stencils:sc,shape:"process",stroke:{color:"#595959",width:2},fill:{color:"#fff"},Subcells:[gu,tu],textVerticalAlign:"center",penetratedKeys:["textVerticalAlign","controlPoints","round"]})}}]),n}();c()(Au,"className","Geometry");var Ou=ha,Eu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).eventHelper=new hl,r}return y()(n,[{key:"render",value:function(){var t=this.cell.graphicGroup,e=new Ou;t.add(e),this.element=e,this.delegateEvent()}},{key:"delegateEvent",value:function(){var t=this.element,e=this.cell;e.delegateEvent(t,"mouseenter","groupcellrect:mouseenter"),e.delegateEvent(t,"mouseleave","groupcellrect:mouseleave")}},{key:"getClassNames",value:function(){return this.classNames.join(" ")}},{key:"draw",value:function(){var t=this.cell,e=this.element,n=t.width,r=t.height;t.isCacheStale("width","height")&&e.update({d:Jn(0,0,n,r),"stroke-width":1,fill:"rgba(0, 0, 0, 0)"})}},{key:"updateState",value:function(){var t=this.cell,e=this.element,n=t.diagram,r=t.state,a=r.actived,i=r.hover,o=n.signal;return a||i&&!o.dragging?e.update({stroke:"rgba(9, 109, 217, 0.4)"}):e.update({stroke:"none"})}},{key:"destroy",value:function(){this.element.destroy(),this.eventHelper.destroy()}}]),n}();var Pu=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"isGroup",!0),r}return y()(n,[{key:"children",get:function(){return this.getChildren()}},{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.subcells=this.Subcells.map((function(t){return new t(e)})),this.render()}},{key:"canText",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"render",value:function(){var t=this.model;this.subcells.forEach((function(t){return t.render()})),this.updateModel(t)}},{key:"hover",value:function(t){this.state.hover=t,this.updateState()}},{key:"updateState",value:function(){this.subcells.forEach((function(t){t.updateState()}))}},{key:"_hasEntity",value:function(){var t=!1;return this.deepEach((function(e){return!!e.isGroup||(t=!0,!1)})),t}},{key:"_drawInner",value:function(){var t=this.graphicGroup,e=this.getChildren(),n=1/0,r=1/0,a=-1/0,i=-1/0;this.show(),e.forEach((function(t){var e;e=t.isGroup?t.getBBox():sr(t)?t.getPointBox():pr(t)?t.getFullBBox():t.getBBox(),n=Math.min(n,e.minX),r=Math.min(r,e.minY),a=Math.max(a,e.maxX),i=Math.max(i,e.maxY)}));var o=[1,0,0,0,1,0,n,r,1];this.x=n,this.y=r,this.width=a-n,this.height=i-r,this.matrix=o,this.isCacheStale("x","y","width","height")&&(this.subcells.forEach((function(t){return t.draw()})),t.update({matrix:o})),this.cache.x=n,this.cache.y=r,this.cache.width=a-n,this.cache.height=i-r}},{key:"draw",value:function(){var t=this.diagram.interaction;if(!this._hasEntity()||"edit"!==t.currentMode)return this.hide();this._drawInner()}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{fill:"rgba(2, 2, 2, 0.3)",x:0,y:0,width:1,height:1,isGroup:!0,Subcells:[Eu]})}}]),n}();c()(Pu,"className","GroupCell");var Su=ba,Mu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"render",value:function(){var t=this.cell,e=new Su;this.element=e,t.graphicGroup.add(e)}},{key:"update",value:function(){var t=this.cell,e=this.element,n=t.diagram,r=t.image,a=n.imageManager;if(r&&t.isCacheStale("image","width","height")){var i=r.src,o=r.naturalWidth,c=r.naturalHeight;e.update({width:t.width,height:t.height}),a.setImageHref(e,i,o,c)}}},{key:"destroy",value:function(){this.element.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var ju=function(t){S()(n,wu);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return mu({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(t){if(this.isCacheStale("width","height","shape")){var e=this.width/120,n=this.height/60;return t.getPath(e,n)}return null}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},image:{},shape:"image",stroke:{width:1},Subcells:[Mu],isImage:!0})}}]),n}();c()(ju,"className","ImageCell");var Ru=function(){function t(e){m()(this,t),c()(this,"line",void 0),c()(this,"points",void 0),this.line=e}return y()(t,[{key:"getFirstInsertControlPoints",value:function(){return!1}},{key:"getTextareaPosition",value:function(){return this.line.getPointByPercent(void 0===this.line.textPosition?.5:this.line.textPosition)}},{key:"getControlPointButtonPosition",value:function(t){return this.line.controlPoints[t]}},{key:"updatePoints",value:function(){var t=this.line,e=t.source,n=t.target,r=t.sourceCell,a=t.targetCell,i=t.controlPoints.map((function(t){var e=b()(t,2);return{x:e[0],y:e[1]}})).filter((function(t){return!isNaN(t.x)})),o=i.length,c=t.getEndpoint(e),l=t.getEndpoint(n);if(Hi(c)&&Hi(l))if(c&&l){if(c.x===l.x&&c.y===l.y&&0===i.length)return l.x+=2,l.y+=2,void(this.points=[c,l]);"elbow"===t.shape?(r&&!e.connection&&(c=r.snapAnchor(i[0]||l)[0]),a&&!n.connection&&(l=a.snapAnchor(i[o-1]||c)[0])):(r&&!e.connection&&(c=r.getIntersectionPoint(i[0]||l)),a&&!n.connection&&(l=a.getIntersectionPoint(i[o-1]||c))),this.points=[c].concat(i).concat(l)}else this.points=[c,l]}},{key:"getPoints",value:function(){return this.points||this.updatePoints(),this.points}},{key:"getPath",value:function(){return""}}]),t}();var Lu=function(t){S()(n,Ru);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"getPath",value:function(){var t,e=this.line,n=e.tailOffset,r=e.tipOffset,a=this.getPoints();if(2===a.length){(t=Fn(e)).unshift(["M",a[0].x,a[0].y]);var i={x:t[0][1],y:t[0][2]},o={x:t[1][1],y:t[1][2]},c={x:t[1][5],y:t[1][6]},l={x:t[1][3],y:t[1][4]};i=uo(o.x,o.y,i.x,i.y,n),c=uo(l.x,l.y,c.x,c.y,r),t[0][1]=i.x,t[0][2]=i.y,t[1][5]=c.x,t[1][6]=c.y}else if(3===a.length){var s=a[0],u=a[1],d=a[2];s=uo((u={x:(u.x-.25*d.x-.25*s.x)/.5,y:(u.y-.25*d.y-.25*s.y)/.5}).x,u.y,s.x,s.y,n),d=uo(u.x,u.y,d.x,d.y,r),u={x:(a[1].x-.25*d.x-.25*s.x)/.5,y:(a[1].y-.25*d.y-.25*s.y)/.5},t=[["M",s.x,s.y],["Q",u.x,u.y,d.x,d.y]]}else{(t=zn(a)).unshift(["M",a[0].x,a[0].y]);var h=t.length-1,f={x:t[h][5],y:t[h][6]},p={x:t[h][3],y:t[h][4]},m={x:t[0][1],y:t[0][2]},v={x:t[1][1],y:t[1][2]};m=uo(v.x,v.y,m.x,m.y,n),f=uo(p.x,p.y,f.x,f.y,r),t[0][1]=m.x,t[0][2]=m.y,t[h][5]=f.x,t[h][6]=f.y}return Yn(t)}}]),n}();function Bu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Du(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Nu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Du(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Du(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var _u=new(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,t),Object.assign(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({expandRectGap:16},e))}return y()(t,[{key:"getExpandedBBox",value:function(t){var e=this.expandRectGap;return{minX:t.minX-e,minY:t.minY-e,maxX:t.maxX+e,maxY:t.maxY+e}}},{key:"getRectLines",value:function(t){var e=500;return[{x1:t.minX,y1:t.minY-e,x2:t.minX,y2:t.maxY+e},{x1:t.minX-e,y1:t.minY,x2:t.maxX+e,y2:t.minY},{x1:t.maxX,y1:t.minY-e,x2:t.maxX,y2:t.maxY+e},{x1:t.minX-e,y1:t.maxY,x2:t.maxX+e,y2:t.maxY}]}},{key:"getVertexLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ray",r=500;return"all"===e?[{x1:t.x,y1:t.y,x2:t.x,y2:t.y-r,type:n},{x1:t.x,y1:t.y,x2:t.x-r,y2:t.y,type:n}]:"N"===e||"S"===e?["N"===e?{x1:t.x,y1:t.y,x2:t.x,y2:t.y-r,type:n}:{x1:t.x,y1:t.y,x2:t.x,y2:t.y+r,type:n}]:["W"===e?{x1:t.x,y1:t.y,x2:t.x-r,y2:t.y,type:n}:{x1:t.x,y1:t.y,x2:t.x+r,y2:t.y,type:n}]}},{key:"vMiddleLine",value:function(t,e){var n;n=Math.abs(t.minX-e.maxX)<Math.abs(t.maxX-e.minX)?(t.minX+e.maxX)/2:(t.maxX+e.minX)/2;var r=((t.minY+t.maxY)/2+(e.minY+e.maxY)/2)/2;return{x1:n,y1:r-500,x2:n,y2:r+500}}},{key:"hMiddleLine",value:function(t,e){var n;n=Math.abs(t.minY-e.maxY)<Math.abs(t.maxY-e.minY)?(t.minY+e.maxY)/2:(t.maxY+e.minY)/2;var r=((t.minX+t.maxX)/2+(e.minX+e.maxX)/2)/2;return{x1:r-500,y1:n,x2:r+500,y2:n}}},{key:"cost",value:function(t){var e,n=t.vertex,r=t.end,a=t.middleLine,i=0,o=0;return e=n.distance+mo(n.x,n.y,r.x,r.y),n.from&&n.from.from&&fo(n.x,n.y,n.from.x,n.from.y)!==fo(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(i=-1),a&&n.from&&n.from.from&&ko(n,a)&&!ko(n.from.from,a)&&n.from&&n.from.from&&fo(n.x,n.y,n.from.x,n.from.y)!==fo(n.from.x,n.from.y,n.from.from.x,n.from.from.y)&&(o=2),-e+i+o}},{key:"getSide",value:function(t,e){var n=[(t.minX+t.maxX)/2,(t.minY+t.maxY)/2],r=[t.maxX,t.minY],a=[t.maxX,t.maxY],i=[r[0]-n[0],r[1]-n[1]],o=[a[0]-n[0],a[1]-n[1]],c=[e[0]-n[0],e[1]-n[1]],l=w.vec2.angle(i,o),s=l/2,u=[0,s],d=[u[1],s+Math.PI-l],h=[d[1],s+Math.PI],f=[2*Math.PI-s,2*Math.PI],p=w.vec2.angle(c,[1,0]);return c[1]<0&&(p=2*Math.PI-p),rn(p,u)||rn(p,f)?"E":rn(p,d)?"S":rn(p,h)?"W":"N"}},{key:"dedupePoints",value:function(t){if(t.length>=3){for(var e=[t[0]],n=1;n<t.length-1;n++){var r=t[n-1],a=t[n],i=t[n+1];ro(r.x,a.x)&&ro(i.x,a.x)||ro(r.y,a.y)&&ro(i.y,a.y)||e.push(a)}return e.push(t[t.length-1]),e}return t}},{key:"getExpandPoint",value:function(t,e,n){return"N"===n?{x:t.x,y:e.minY}:"S"===n?{x:t.x,y:e.maxY}:"W"===n?{x:e.minX,y:t.y}:"E"===n?{x:e.maxX,y:t.y}:null}},{key:"find",value:function(t,e){var n=this,r=t.cell,a=e.cell,i=r&&r.getBBox(),o=a&&a.getBBox(),c=i&&this.getExpandedBBox(i),l=o&&this.getExpandedBBox(o),s=[];s=c?s.concat(this.getRectLines(c)):s,s=l?s.concat(this.getRectLines(l)):s;var u,d,h,f=new _o("start"),p=new _o("end"),m=[t.x,t.y],v=[e.x,e.y];Object.assign(f,{x:m[0],y:m[1]}),Object.assign(p,{x:v[0],y:v[1]}),i?(d=this.getSide(i,m),s=s.concat(this.getVertexLine(f,d))):s=s.concat(this.getVertexLine(f,"all","straight")),o?(h=this.getSide(o,v),s=s.concat(this.getVertexLine(p,h))):s=s.concat(this.getVertexLine(p,"all","straight")),a&&r&&("E"===d&&"W"===h?u=r.x+r.width<a.x?this.vMiddleLine(i,o):this.hMiddleLine(i,o):"W"===d&&"E"===h?u=r.x+r.width<a.x?this.hMiddleLine(i,o):this.vMiddleLine(i,o):"S"===d&&"N"===h?u=r.y+r.height>a.y?this.vMiddleLine(i,o):this.hMiddleLine(i,o):"N"===d&&"S"===h&&(u=r.y+r.height>a.y?this.hMiddleLine(i,o):this.vMiddleLine(i,o))),t.d&&("N"===d?f.y-=t.d:"S"===d?f.y+=t.d:"E"===d?f.x+=t.d:"W"===d&&(f.x-=t.d)),e.d&&("N"===h?p.y-=e.d:"S"===h?p.y+=e.d:"E"===h?p.x+=e.d:"W"===h&&(p.x-=e.d)),u&&s.push(u);var y=qo(s);i&&o&&!oo(c,l)&&y.getAllEdges().forEach((function(t){var e=t.startVertex,n=t.endVertex,r={x1:e.x,y1:e.y,x2:n.x,y2:n.y};(xo(r,i)||xo(r,o))&&y.deleteEdge(t)}));var g,b=this.getExpandPoint(f,c,d)||f,x=this.getExpandPoint(p,l,h)||p,k=y.snap(b),w=y.snap(x);return k.from=f,w.from=p,(g=ro(k.x,w.x)&&ro(k.y,w.y)?[]:Yo(y,k,w,(function(t,e,r){return n.cost({vertex:t,start:e,end:r,middleLine:u})}))).unshift(f),g.push(p),this.dedupePoints(g)}},{key:"destroy",value:function(){this.destroyed=!0}}]),t}()),Iu=function(t){S()(n,Ru);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"truncate",value:function(t){var e=this.line,n=e.tailOffset,r=e.tipOffset,a=Qn(t),i=a[a.length-1],o=a[a.length-2],c=a[0],l=a[1],s=uo(o[1],o[2],i[1],i[2],r),u=uo(l[1],l[2],c[1],c[2],n);return i[1]=s.x,i[2]=s.y,c[1]=u.x,c[2]=u.y,Yn(a)}},{key:"getPath",value:function(){return this.truncate(this._getPath())}},{key:"_getPath",value:function(){var t=this.line,e=t.source,n=t.target,r=t.diagram;if(!r)return"";var a=this.getPoints();if(t.controlPoints.length>0)return Yn(Xn(t.controlPoints,a,t.resizer.getElbowMergeSig()));var i=r.find(e.id),o=r.find(n.id),c=t.getEndpoint(e),l=t.getEndpoint(n);if(null!=i&&i===o&&lo(c.x,c.y,l.x,l.y)<8&&0!==t.controlPoints.length)return Yn([["M",(c=i.getPoint([1,.5])).x,c.y-8],["l",16,0],["l",0,16],["L",c.x,c.y+8]]);if(!c||!l)return Yn([["M",0,0],["L",50,0],["L",50,50]]);if(!i&&!o&&0===t.controlPoints.length){if(c.x===l.x)return"M".concat(c.x,",").concat(c.y," L").concat(l.x,",").concat(l.y);var s=.5*(c.x+l.x);return"M".concat(c.x,",").concat(c.y," L").concat(s,",").concat(c.y," L").concat(s,",").concat(l.y," L").concat(l.x,",").concat(l.y)}return $n(_u.find(Nu(Nu({cell:i},a[0]),{},{d:0}),Nu(Nu({cell:o},a[1]),{},{d:0})))}}]),n}(),Tu={none:function(){return{baseOffset:0,pc:0,path:[]}},"open-triangle":function(t){return{baseOffset:0,pc:1,fill:"none",path:[["M",-1*t,-1*t*Math.sin(no(30))],["L",0,0],["L",-1*t,t*Math.sin(no(30))]]}},"one-side-up":function(t){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*t,-1*t*Math.sin(no(30))]]}},"one-side-down":function(t){return{baseOffset:0,pc:0,fill:"none",path:[["M",0,0],["L",-1*t,t*Math.sin(no(30))]]}},arrow:function(t){return{baseOffset:2*t*Math.cos(no(20))-t,pc:1/(2*Math.sin(no(20))),path:[["M",-t*Math.cos(no(20)),-t*Math.sin(no(20))],["A",t,t,20,0,1,-t*Math.cos(no(20)),t*Math.sin(no(20))],["L",0,0],["Z"]]}},"hollow-triangle":function(t){return{baseOffset:t,pc:1,fill:"white",path:[["M",0,0],["L",-1*t,-1*t*Math.sin(no(30))],["L",-1*t,t*Math.sin(no(30))],["Z"]]}},"sharp-solid-square":function(t){var e=t/=2,n=Math.tan(no(60))*e;return{baseOffset:2*n,pc:1,path:[["M",0,0],["L",-n,-e],["L",-2*n,0],["L",-n,e],["Z"]]}},"sharp-hollow-square":function(t){var e=t/=2,n=Math.tan(no(60))*e;return{baseOffset:2*n,pc:1,fill:"white",path:[["M",0,0],["L",-n,-e],["L",-2*n,0],["L",-n,e],["Z"]]}},"flat-solid-square":function(t){return{baseOffset:2*(t*=Math.tan(no(30))),pc:.5,path:[["M",0,-1*t],["L",-2*t,-1*t],["L",-2*t,t],["L",0,t],["Z"]]}},"flat-hollow-square":function(t){return{baseOffset:2*(t*=Math.tan(no(30))),pc:.5,fill:"white",path:[["M",0,-1*t],["L",-2*t,-1*t],["L",-2*t,t],["L",0,t],["Z"]]}},"solid-circle":function(t){return{baseOffset:2*(t*=Math.tan(no(30))),pc:.5,path:Gn(-1*t,0,t)}},"hollow-circle":function(t){return{baseOffset:2*(t*=Math.tan(no(30))),pc:.5,fill:"white",path:Gn(-t,0,t)}},"cross-circle":function(t){var e=-(t*=Math.tan(no(30))),n=t;return{baseOffset:2*t,pc:.5,fill:"white",path:Gn(e,0,n)+Yn([["M",e,-n],["L",e,n],["M",-2*n,0],["L",0,0]])}},"half-open-circle":function(t){return{baseOffset:t*=Math.tan(no(30)),pc:0,fill:"none",path:[["M",0,0],["m",0,-t],["A",t,t,0,1,0,0,t]]}},"end-vertical-line":function(t){return{baseOffset:0,pc:.5,fill:"none","stroke-linecap":"square",path:[["M",0,-(t*=Math.tan(no(30)))],["L",0,t]]}},"middle-vertical-line":function(t){return{baseOffset:t/=1.5,pc:0,fill:"none",path:[["M",-1*t,2*-t/3],["L",-1*t,2*t/3],["M",-1*t,0],["L",0,0]]}},"double-vertical-line":function(t){var e=2*(t/=1.5)/3;return{baseOffset:2*t,pc:0,fill:"none",path:[["M",-2*t,-e],["L",-2*t,e],["M",-t,-e],["L",-t,e],["M",-2*t,0],["L",0,0]]}},"single-slash":function(t){return{baseOffset:t/=1.5,pc:0,path:[["M",0,0],["L",-t,0],["M",-(t+t*Math.cos(no(60))),-t*Math.sin(no(60))],["L",-(t-t*Math.cos(no(60))),t*Math.sin(no(60))]]}},"three-line":function(t){return{baseOffset:t,pc:0,fill:"none",path:[["M",-1*t,0],["L",0,0],["M",-1*t,0],["L",0,-1*Math.sin(no(30))*t],["M",-1*t,0],["L",0,Math.sin(no(30))*t]]}},"three-line-plus-vertical":function(t){var e=Math.sin(no(30))*t;return{baseOffset:t,pc:0,fill:"none",path:[["M",-t,0],["L",0,0],["M",-t,0],["L",0,-e],["M",-t,0],["L",0,e],["M",-t,-e],["L",-t,e]]}},"three-line-plus-circle":function(t){var e=Math.sin(no(30))*t,n=-t-e;return{baseOffset:t+2*e,pc:0,fill:"white",path:Yn([["M",-t,0],["L",0,0],["M",-t,0],["L",0,-e],["M",-t,0],["L",0,e]])+Gn(n,0,e)}},"circle-vertical":function(t){var e=.5*t,n=-(t+e);return{baseOffset:2*t,pc:0,fill:"white",path:Yn([["M",-e,-e],["L",-e,e],["M",0,0],["L",-t,-0]])+Gn(n,0,e)}}},Fu=["none","open-triangle","one-side-up","one-side-down","arrow","hollow-triangle","sharp-solid-square","sharp-hollow-square","flat-solid-square","flat-hollow-square","solid-circle","hollow-circle","cross-circle","half-open-circle","end-vertical-line","middle-vertical-line","double-vertical-line","single-slash","three-line","three-line-plus-vertical","three-line-plus-circle","circle-vertical"];var zu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t,r){var a;return m()(this,n),(a=e.call(this,t)).type=r,c()(E()(a),"element",void 0),c()(E()(a),"group",void 0),c()(E()(a),"stencil",void 0),c()(E()(a),"sp",void 0),c()(E()(a),"ep",void 0),c()(E()(a),"cell",void 0),a.cell=t,a}return y()(n,[{key:"render",value:function(){var t=this.cell,e=t.graphicGroup,n=new na;n.update({"clip-path":"url(#".concat(t.clipPathID,")")}),this.group=n,e.add(this.group)}},{key:"createRendererElement",value:function(){var t=this.group,e=this.cell;if(e.isCacheStale("shape","roughFillStyle")){var n=new(e.getRoughGraphicOptions()?ti:ha)({"stroke-miterlimit":"10",roughFillStyle:"solid"});t.add(n),this.element&&this.element.remove(),this.element=n}}},{key:"getEndPointName",value:function(){var t=this.cell;return("tip"===this.type?t.target.marker:t.source.marker)||"none"}},{key:"getOhterEndPointName",value:function(){var t=this.cell;return("tail"===this.type?t.target.marker:t.source.marker)||"none"}},{key:"getRatio",value:function(){return 6+2*(this.cell.stroke.width-1)}},{key:"update",value:function(){var t=this.cell,e=this.type,n=this.getEndPointName(),r=this.getRatio();this.stencil=Tu[n](r);var a=this.stencil,i=a.baseOffset,o=a.pc,c=Tu[this.getOhterEndPointName()](r),l=c.baseOffset+c.pc,s=i+t.stroke.width*o;t["".concat(e,"Offset")]=s;var u=t.getPoints();if(Array.isArray(u)){var d=u.length,h=u[0],f=u[1];if("tip"===e&&(h=u[d-1],f=u[d-2]),h&&f){var p=lo(h,f),m=t.target.marker&&"none"!==t.target.marker&&t.source.marker&&"none"!==t.source.marker?40:20;if(p<=(m=Math.max(m,s+l+20))){var v=Je(p/m*r,.01,r);this.stencil=Tu[n](v);var y=this.stencil,g=y.baseOffset,b=y.pc;s=g+t.stroke.width*b}t["".concat(e,"Offset")]=s}}}},{key:"computeEndPoints",value:function(){this.update();var t,e,n,r,a=this.type,i=this.cell,o=i.d,c=i.shape,l=Qn(o),s=this.cell.getPoints();if("curve"===c){if(l.length<=1)return;if("tail"===a)t=s[0].x,e=s[0].y,n=l[1][1],r=l[1][2];else{var u=s.length;if(t=s[u-1].x,e=s[u-1].y,2===s.length)n=l[1][3],r=l[1][4];else if(3===s.length)n=l[1][1],r=l[1][2];else{var d=l.length-1;n=l[d][3],r=l[d][4]}}}else if("tail"===a)if("straight"===c)t=s[0].x,e=s[0].y,n=s[1].x,r=s[1].y;else{t=s[0].x,e=s[0].y;var h=b()(l[1],3);n=h[1],r=h[2]}else if("straight"===c){var f=s.length;t=s[f-1].x,e=s[f-1].y,n=s[f-2].x,r=s[f-2].y}else{t=s[s.length-1].x,e=s[s.length-1].y;var p=b()(l[l.length-2],3);n=p[1],r=p[2]}this.sp={x:n,y:r},this.ep={x:t,y:e}}},{key:"draw",value:function(){this.createRendererElement();var t=this.cell,e=this.element,n=this.type,r=t.stroke;if(this.computeEndPoints(),this.ep&&this.sp){var a=[1,0,0,0,1,0,-1*t.stroke.width*this.stencil.pc,0,1],i=[1,0,0,0,1,0,this.ep.x,this.ep.y,1],o=w.mat3.rotate([],[1,0,0,0,1,0,0,0,1],ho(this.sp.x,this.sp.y,this.ep.x,this.ep.y)),c=a;if("tail"===n){var l=t.source.marker;"one-side-up"!==l&&"one-side-down"!==l&&"single-slash"!==l||w.mat3.multiply(c,[1,0,0,0,-1,0,0,0,1],c)}w.mat3.multiply(c,o,c),w.mat3.multiply(c,i,c),e.update({stroke:r.color,d:this.stencil.path,"stroke-width":t.stroke.width,"stroke-linecap":this.stencil["stroke-linecap"]||"butt",fill:this.stencil.fill||r.color,matrix:c}),e.dataset({test_id:("tip"===n?t.target.marker:t.source.marker)||"none"})}}},{key:"destroy",value:function(){this.group.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var qu=ha,Yu=Ta,Hu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"render",value:function(){var t=this.cell.diagram.defs,e=new Yu({id:this.cell.clipPathID}),n=new qu({"clip-rule":"evenodd","fill-rule":"evenodd"});n.update({fill:"black",opacity:.1}),e.add(n),t.add(e),this.lineTextClipPath=n,this.clipPath=e}},{key:"draw",value:function(){var t=this.cell,e=this.lineTextClipPath,n=t.textarea,r=n.box,a=r.width,i=r.height,o=n.getPosition(),c=o.x,l=o.y,s=t.getBBox(),u=s.x,d=s.y,h=s.width,f=s.height;r.width>0?e.update({d:Jn(u-15,d-15,h+30,f+30)+Jn(c,l,a,i)}):e.update({d:Jn(u-15,d-15,h+30,f+30)})}},{key:"destroy",value:function(){this.lineTextClipPath.destroy(),this.clipPath.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();var Gu=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"group",new na),c()(E()(r),"element",void 0),c()(E()(r),"cell",void 0),r.cell=t,r}return y()(n,[{key:"render",value:function(){var t=mu({name:"path"});this.element=t,this.group.add(this.element),this.cell.graphicGroup.add(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){if("center"!==this.cell.textDirection){this.group.show();var t=this.cell.getPointByPercent(this.cell.textPosition);this.element.update({d:Gn(t.x,t.y,this.cell.stroke.width),fill:this.cell.stroke.color})}else this.group.hide()}},{key:"destroy",value:function(){var t;null===(t=this.group)||void 0===t||t.remove()}}]),n}();function Xu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Wu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xu(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Vu(t){for(var e=[],n=1;n<t+1;n++)e.push(n);return e}function Zu(t,e,n){n=n||Vu(e);for(var r,a,i,o={},c=0;c<t.length;c++){for(a=r=t[c],i=1;!n.includes(a)&&i<100;)i%2==1?(a+=i)>e&&(a%=e):(a-=i)<1&&(a=e+a%e),i++;o[r]=a}return o}var Uu=function(t){var e=t.abstract,n=t.start,r=void 0===n?0:n,a=t.parent,i=t.direction;if(e&&a){var o=a.children,c=void 0===o?[]:o;if("timeline"===a.layout){var l=c[r].quadrantConstraint,s=(void 0===l?[]:l)[0],u=i[1];switch(s){case 1:case 2:return 0!==u&&(t.quadrantConstraint=[u>0?1:2]),{direction:[0,1],layout:"timeline"};case 3:case 4:return 0!==u&&(t.quadrantConstraint=[u>0?2:1]),{direction:[0,-1],layout:"timeline"};default:return}}if("indent"===a.layout){var d=a,h=d.directions,f=void 0===h?[]:h,p=d.layout,m=void 0===p?"":p,v=t.mergedQuadrant,y=void 0===v?0:v;return{direction:[Math.sign(f[y-1][0]),0],layout:m}}}},Ku=function(){function t(e){m()(this,t),c()(this,"algorithms",void 0),c()(this,"model",void 0),c()(this,"options",void 0),c()(this,"tree",void 0),c()(this,"trees",void 0),c()(this,"destroyed",void 0),c()(this,"beforeLayoutAdjust",void 0),c()(this,"afterLayoutAdjust",void 0),Object.assign(this,Wu({algorithms:{},model:{}},e))}return y()(t,[{key:"buildTree",value:function(){var t=this.model,e=this.parse(t);e.x=void 0!==t.x?t.x:0,e.y=void 0!==t.y?t.y:0,e.layout=e.layout||"standard",this.tree=e}},{key:"parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.algorithms,a=Wu(Wu({w:10,h:10,quadrant:void 0,quadrantConstraint:void 0,direction:[1,0],collapsed:!1,layout:void 0},t),{},{origin:t,depth:n,children:[],parent:e,isAbstractUnderTimeline:!1,ax:0,ay:0,al:0,ad:"x",ap:1,quadrantTreeLists:[]});if(a.quadrant?a.quadrant=Number(a.quadrant):a.quadrant=1,t.children&&!t.collapsed)for(var i=0;i<t.children.length;i++){var o=t.children[i];a.children.push(this.parse.call(this,o,a,n+1))}return a.layout&&(a.algorithm=r[a.layout],this.calculateDQ(a)),a}},{key:"calculateDQ",value:function(t){t.quadrants=t.algorithm.constructor.QUADRANTS,t.directionAngles=function(t,e){for(var n=[],r=2*Math.PI/e,a=Ao(t,[1,0]),i=0;i<e;i++){var o=a+r*i;o=o>=2*Math.PI?o-2*Math.PI:o,n.push(o)}return n}(t.direction,t.quadrants),t.directions=t.directionAngles.map((function(t){return[Number(Math.cos(t).toFixed(3)),Number(Math.sin(t).toFixed(3))]})),t.quadrantRange=Vu(t.quadrants),t.childQuadrantRange=on(t.children.map((function(t){return t.quadrant}))),t.quadrantConstraint=t.quadrantConstraint||t.quadrantRange}},{key:"splitSubTrees",value:function(){var t=this.tree,e=[t];Ze(t,(function(t){t.layout&&(t.isSubTree=!0,t.x=0,t.y=0,t.tx=0,t.ty=0,e.unshift(t))})),this.trees=e}},{key:"firstMergeQuadrant",value:function(){var t=this;this.trees.forEach((function(e){t.mergeQuadrant(e,"mergedQuadrant")}))}},{key:"mergeQuadrant",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mergedQuadrant",r=t.quadrantConstraint,a=t.quadrants,i=Zu(t.childQuadrantRange,a,r);null===(e=t.children)||void 0===e||e.forEach((function(t){t[n]=i[t.quadrant]}))}},{key:"fixQuadrantConflict",value:function(){var t=this;this.trees.concat([]).reverse().forEach((function(e){if(e.parent){for(var n=e.quadrants,r=function(t){if(t.parent){var e=t,n=e.parent;if(t.abstract){var r=Uu(t);if(r)return r}for(;n&&!n.layout;)e=n,n=n.parent;var a=n,i=a.directions,o=void 0===i?[]:i,c=a.layout,l=void 0===c?"":c;return{direction:o[e.mergedQuadrant-1],layout:l}}}(e),a=[],i=0,o=function(){var n=e.quadrantRange,o=e.directions,c=void 0===o?[]:o;if(0===(a=n.filter((function(t,e){return Bi(c[e],r.direction)}))).length){var l=e.algorithm.constructor.VAILD_DIRECTION_ANGLES,s=Ao(r.direction,[1,0]);if(!l.some((function(t){return ro(t,s)})))return"break";t.forceUseUpDirection(e,r.direction)}i++};0===a.length&&i<10&&"break"!==o(););if(e.upDirection=r.direction,e.upLayoutType=r.layout,a.length>0){var c=Zu(e.quadrantConstraint,n,a);e.quadrantConstraint=Object.keys(c).map((function(t){return c[t]})),t.mergeQuadrant(e,"mergedQuadrant")}else delete e.layout,e.isSubTree=!1}}))}},{key:"forceUseUpDirection",value:function(t,e){t.direction=e,this.calculateDQ(t)}},{key:"filterSimilarSubTree",value:function(){this.trees.forEach((function(t){if(!t.parent)return!0;var e=t.quadrantConstraint,n=void 0===e?[]:e,r=t.upDirection,a=t.upLayoutType,i=t.directions,o=void 0===i?[]:i,c=t.layout;!t.abstract&&a===c&&1===n.length&&ao(r,o[n[0]-1])&&(t.isSubTree=!1)}))}},{key:"removeSubTree",value:function(){this.trees=this.trees.filter((function(t){var e=t.isSubTree;return!t.parent||e}))}},{key:"setUpAndDown",value:function(){var t=this,e=this.trees,n=this.tree;n.upDirection=n.directions[n.quadrantConstraint[0]-1],n.upLayoutType=n.layout,n.upSignX=Math.sign(n.upDirection[0]),n.upSignY=Math.sign(n.upDirection[1]),e.forEach((function(e){var n=t.splitTreeByQuadrant(e);(n=n.filter((function(t){return t.children&&t.children.length>0}))).forEach((function(e){t.setUp(e)})),e.quadrantTrees=n})),this.setDown(n)}},{key:"splitTreeByQuadrant",value:function(t){for(var e=t.quadrants,n=void 0===e?0:e,r=t.directionAngles,a=void 0===r?[]:r,i=t.directions,o=void 0===i?[]:i,c=t.children,l=void 0===c?[]:c,s=[],u=0;u<n;u++){var d=Wu(Wu({},t),{},{directionAngle:a[u],quadrantTreeDirection:o[u],children:[]});s.push(d),t.quadrantTreeLists.push([])}return l.forEach((function(e,n){var r;null===(r=s[e.mergedQuadrant-1].children)||void 0===r||r.push(e),e.abstract||t.quadrantTreeLists[e.mergedQuadrant-1].push(n)})),s.forEach((function(e){e.quadrantTreeLists=t.quadrantTreeLists})),s}},{key:"setUp",value:function(t){var e;null===(e=t.children)||void 0===e||e.forEach((function(e){Ve(e,(function(e){e.upDirection=t.quadrantTreeDirection;var n=e.abstract,r=e.parent;if(n&&r){var a=Uu(e);a&&(e.upDirection=a.direction)}e.upLayoutType=t.layout,e.upSignX=Math.sign(e.upDirection[0]),e.upSignY=Math.sign(e.upDirection[1])}),(function(t){if(!t.isSubTree)return t.children}))}))}},{key:"setDown",value:function(t){Ve(t,(function(t){t.isSubTree?(t.downDirection=t.directions[t.quadrantConstraint[0]-1],t.downLayoutType=t.layout):(t.downDirection=t.upDirection,t.downLayoutType=t.upLayoutType),t.downSignX=Math.sign(t.downDirection[0]),t.downSignY=Math.sign(t.downDirection[1])}))}},{key:"layout",value:function(){var t=this,e=this.trees,n=this.tree;e.forEach((function(e){var n=e.algorithm,r=e.quadrantTrees,a=[];(void 0===r?[]:r).forEach((function(t){n.layout(t,a)})),t.calculateSubTreeBBox(e),a.push(e),e.zNodes=a})),n.zNodes=function t(e){return e.reduce((function(e,n){return Array.isArray(n)?[].concat(D()(e),D()(t(n))):[].concat(D()(e),[n])}),[])}(n.zNodes)}},{key:"calculateSubTreeBBox",value:function(t){if(t.collapsed)return t.tx=t.x,t.ty=t.y,t.tw=t.w,void(t.th=t.h);var e=t.x,n=t.x+t.w,r=t.y,a=t.y+t.h;Ze(t,(function(t){var i,o,c,l;t.isSubTree?(i=t.tx,o=t.ty,c=t.tx+t.tw,l=t.ty+t.th):(i=t.x,o=t.y,c=t.x+t.w,l=t.y+t.h),i<e&&(e=i),o<r&&(r=o),c>n&&(n=c),l>a&&(a=l)}),(function(e){if(!e.isSubTree||e===t)return e.children})),t.tx=e,t.ty=r,t.tw=n-e,t.th=a-r}},{key:"execute",value:function(){return this.buildTree(),this.splitSubTrees(),this.firstMergeQuadrant(),this.fixQuadrantConflict(),this.filterSimilarSubTree(),this.removeSubTree(),this.setUpAndDown(),this.beforeLayoutAdjust&&this.beforeLayoutAdjust(this.tree),this.layout(),this.afterLayoutAdjust&&this.afterLayoutAdjust(this.tree),this.tree}},{key:"destroy",value:function(){var t=this;this.destroyed=!0,Object.keys(this).forEach((function(e){t[e]=void 0}))}}]),t}(),Qu=Object.freeze({__proto__:null,Event:hl,Layout:Ku,Comparator:Do});var $u=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),t=e.call(this),Object.assign(E()(t),r);var a=E()(t),i=a.group,o=a.cell,c=["source","target"].map((function(t){return _i(t)}));return c.forEach((function(t){return i.add(t.group)})),t.buttons=c,t.diagram=o.diagram,t.eventHelper=new hl,t.cellModel=null,t}return y()(n,[{key:"update",value:function(){var t=this.buttons,e=this.cell,n=this.diagram,r=this.group;if(r&&r.parent){var a=b()(t,2),i=a[0],o=a[1],c=e.getPoints(),l=c[0],s=c[c.length-1],u=1/n.viewport.zoom;i.group.update({scale:u,x:l.x,y:l.y}),o.group.update({scale:u,x:s.x,y:s.y})}}},{key:"bindEvent",value:function(){var t,e,n,r,a=this,i=this.buttons,o=this.cell,l=this.diagram,u=this.eventHelper,d=!0,h=function(){l.resetCursor(),t=void 0,e=void 0,n=void 0,r=void 0,d=!0,l.lineResizer.reset()};i.forEach((function(n){var i=n.name,c=n.group;u.bind(c,"mousedown",(function(){l.lineAlign.init(a.cell,i),t=i,e=xt()({connection:null,id:null},vn(o.model[t],{connection:!0,id:!0})),r=s()(o.controlPoints),l.emit("endpointcontrolpointmousedown"),l.lineResizer.init(a.cell,i)}))})),u.bind(l,"mousemove",(function(e){if("source"===t||"target"===t){d&&(d=!1,l.emit("endpointcontrolpointmousemovestart"));var i="source"===t?o.target:o.source,s=l.viewport.invertClient([e.clientX,e.clientY]);n=l.lineResizer.resize(e),i.id&&n.id===i.id&&null==i.connection&&null==n.connection&&r.length>0&&(n.id=null,n.connection=s),l.update(o,c()({},t,n)),a.update()}})),u.bind(l,"mouseup",(function(){var i,s,u;"source"!==t&&"target"!==t||("elbow"===o.shape?l.command.execute("Update",{id:o.model.id,model:(i={},c()(i,t,n),c()(i,"controlPoints",Ii(o,!0)),i),originModels:(s={},c()(s,t,e),c()(s,"controlPoints",r),s)}):l.command.execute("Update",{id:o.model.id,model:c()({},t,n),originModels:(u={},c()(u,t,e),c()(u,"controlPoints",r),u)}),a.emit("endpointControlMouseup"),h())})),u.bind(l,"keydown",(function(n){var r=a.cell,i=a.diagram;!t||"Esc"!==n.key&&"Escape"!==n.key||(i.update(r,c()({},t,e)),a.update(),h())})),u.bind(l,"afterviewportchange",Bt()((function(){var t=a.buttons,e=a.cell;t&&e&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null}}]),n}();var Ju=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),t=e.call(this),Object.assign(E()(t),r);var a=E()(t).cell;return t.diagram=a.diagram,t.eventHelper=new hl,t.onMove=!1,t}return y()(n,[{key:"_refresh",value:function(){var t=this.group,e=this.cell,n=Fi(e);t&&t.clear();var r=e.controlPoints.map((function(t,e){return Ni(e,!1)})),a=n.map((function(t,e){return Ni(e,!0)}));a.forEach((function(e){return t.add(e.group)})),r.forEach((function(e){return t.add(e.group)})),this.buttons=r,this.uiButtons=a,this.uiPoints=n}},{key:"update",value:function(){var t=this.cell;this._refresh();var e=this.buttons,n=this.diagram,r=this.group,a=this.uiButtons,i=this.uiPoints;if(r.parent)if(t.isLoop&&0===t.controlPoints.length)r.css({display:"none"});else{this.onMove?r.css({display:"none"}):r.css({display:""});var o=1/n.viewport.zoom;e.forEach((function(e){var n=e.group,r=e.index,a=t.getControlPointButtonPosition(r);n.update({scale:o,x:a[0],y:a[1]})})),a.forEach((function(t){var e=t.group,n=t.index;e.update({scale:o,x:i[n][0],y:i[n][1]})}))}}},{key:"bindEvent",value:function(){var t,e,n,r,a=this,i=this.cell,o=this.diagram,c=this.eventHelper,l=this.group,u=!1,d={},h=!0,f=!1,p=function(){o.resetCursor(),t=void 0,e=void 0,n=void 0,u=!1,a.onMove=!1,r=void 0,d={},h=!0,f=!1};c.bind(o,"mousedown",(function(r){if("true"===(d=r.target&&r.target.dataset).isUIPoints&&"false"===d.isControlPoint){var c=Number(d.index);e=c,n={controlPoints:s()(i.controlPoints)},u=!0,f=!0}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var l=Number(d.index);t=l,n={controlPoints:s()(i.controlPoints)},u=!1,a.afterMove=!1,f=!0}o.emit("endpointcontrolpointmousedown")})),c.bind(o,"mousemove",(function(n){if(f&&h&&(o.emit("endpointcontrolpointmousemovestart"),h=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&u){var r=Number(d.index);e=r;var c=Ti({cell:i,uiPoints:a.uiPoints,uiPointIndex:e});o.update(i,{controlPoints:c}),t=r,u=!1}if(void 0!==t){var l=o.viewport.invertClient([n.clientX,n.clientY]),p=s()(i.controlPoints),m=p[[t]];void 0!==m&&(m[0]=l[0],m[1]=l[1]),o.update(i,{controlPoints:p}),a.onMove=!0}})),c.bind(o,"mouseup",(function(){if(void 0!==t)if(a.onMove){var c=s()(i.controlPoints);o.command.execute("Update",{id:i.model.id,model:{controlPoints:c},originModels:n,diagram:o}),l.css({display:""}),p()}else r=t,t=void 0;else void 0!==e&&p()})),c.bind(o,"dblclick",(function(){if(void 0!==r&&void 0===e){var t=s()(i.controlPoints);o.update(i,n),t.splice(r,1),o.command.execute("Update",{id:i.model.id,model:{controlPoints:t},diagram:o}),p()}})),c.bind(o,"keydown",(function(e){var r=a.cell,i=a.diagram;!t||"Esc"!==e.key&&"Escape"!==e.key||(i.update(r,n),a.update(),p())})),c.bind(o,"afterviewportchange",Bt()((function(){var t=a.buttons,e=a.cell;t&&e&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}();var td=function(t){S()(n,T.a);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,n),t=e.call(this),c()(E()(t),"lastPoints",void 0),Object.assign(E()(t),r);var a=E()(t).cell;return t.diagram=a.diagram,t.eventHelper=new hl,t.onMove=!1,t.mergeSig=!1,t}return y()(n,[{key:"_refresh",value:function(){var t=this.group,e=this.cell,n=Fi(e,this.mergeSig);t&&t.clear();var r=n.map((function(t,r){return 0===e.controlPoints.length||0===r||r===n.length-1?Ni(r,!0,!0,t):Ni(r,!1,!0,t)}));r.forEach((function(e){return t.add(e.group)})),this.uiButtons=r,this.uiPoints=n}},{key:"update",value:function(){var t=this.cell;Ft()(this.lastPoints,t.getPoints())||(this._refresh(),this.lastPoints=t.getPoints());var e=this.diagram,n=this.group,r=this.uiButtons,a=this.uiPoints;if(n.parent){this.onMove?n.css({display:"none"}):n.css({display:""});var i=t.getPoints(),o=i[0],c=i[i.length-1],l=1/e.viewport.zoom;r.forEach((function(t){var e=t.group,n=t.index;0===n?lo(o.x,o.y,a[n][0],a[n][1])<8.5&&e.css({display:"none"}):n===r.length-1&&lo(c.x,c.y,a[n][0],a[n][1])<8.5&&e.css({display:"none"}),e.update({scale:l,x:a[n][0],y:a[n][1]})}))}}},{key:"bindEvent",value:function(){var t,e,n,r,a=this,i=this.cell,o=this.diagram,c=this.eventHelper,l=this.group,u=!1,d={},h=!0,f=!1,p=function(){o.resetCursor(),t=void 0,e=void 0,n=void 0,u=!1,a.onMove=!1,d={},a.mergeSig=!1,r=void 0,h=!0,f=!1};c.bind(o,"mousedown",(function(c){if(d=c.target&&c.target.dataset,r=[c.clientX,c.clientY],"true"===d.isUIPoints&&"false"===d.isControlPoint){var l=Number(d.index);e=l,n={controlPoints:0===i.controlPoints.length?null:s()(i.controlPoints)},u=!0,f=!0,e=void 0,o.setCursor(0===a.uiPoints[l][2]?"row-resize":"col-resize")}if("false"===d.isUIPoints&&"true"===d.isControlPoint){var h=Number(d.index);t=0===h?0:h===a.uiPoints.length-1?i.controlPoints.length-1:h-1,n={controlPoints:s()(i.model.controlPoints)},u=!1,f=!0;var p=a.uiPoints[h];p&&o.setCursor("V"===p[p.length-1]?"row-resize":"col-resize")}o.emit("endpointcontrolpointmousedown")})),c.bind(o,"mousemove",(function(n){if(f&&h&&(o.emit("endpointcontrolpointmousemovestart"),h=!1),d!=={}&&"true"===d.isUIPoints&&"false"===d.isControlPoint&&u){var r=Number(d.index);e=r;var c=Ti({cell:i,uiPoints:a.uiPoints,uiPointIndex:e});o.update(i,{controlPoints:c}),t=0===r?0:r===a.uiPoints.length-1?i.controlPoints.length-1:r-1,u=!1,a.mergeSig=!0}if(void 0!==t){a.onMove=!0;var l=o.viewport.invertClient([n.clientX,n.clientY]),p=s()(i.controlPoints),m=p[t];void 0!==m&&("V"===m[m.length-1]?m[1]=l[1]:m[0]=l[0]),o.update(i,{controlPoints:p})}})),c.bind(o,"dblclick",(function(t){var e,n=null===(e=t.target)||void 0===e?void 0:e.dataset;"false"===n.isUIPoints&&"true"===n.isControlPoint&&1===i.controlPoints.length&&(o.command.execute("Update",{id:i.model.id,model:{controlPoints:[]}}),p())})),c.bind(o,"mouseup",(function(e){if(void 0!==t&&lo(r[0],r[1],e.clientX,e.clientY)>4){var a=Ii(i,!0);o.command.execute("Update",{id:i.model.id,model:{controlPoints:a},originModels:n,diagram:o}),l.css({display:""}),p()}else p()})),c.bind(o,"keydown",(function(e){var r=a.cell,i=a.diagram;!t||"Esc"!==e.key&&"Escape"!==e.key||(i.update(r,n),a.update(),p())})),c.bind(o,"afterviewportchange",Bt()((function(){var t=a.uiButtons,e=a.cell;t&&e&&a.update()}),16))}},{key:"begin",value:function(){this.update(),this.bindEvent()}},{key:"end",value:function(){this.eventHelper.unbind()}},{key:"destroy",value:function(){this.eventHelper.unbind(),this.group&&this.group.clear(),this.group=null,this.diagram=null,this.cell=null,this.buttons=null,this.uiButtons=null,this.uiPoints=null}}]),n}(),ed=function(){function t(e){m()(this,t),this.cell=e,c()(this,"eventHelper",new hl),c()(this,"subResizers",void 0),c()(this,"lineControlPointResizer",void 0),c()(this,"lineEndpointResize",void 0),c()(this,"group",void 0),c()(this,"diagram",void 0),c()(this,"isBegin",void 0),this._init(e)}return y()(t,[{key:"update",value:function(){this.subResizers.forEach((function(t){return t.update()}))}},{key:"bindEvent",value:function(){var t=this,e=this.eventHelper,n=this.cell,r=n.diagram;e.bind(r,"endpointcontrolpointmousedown",(function(){"elbow"===n.shape&&(t.lineControlPointResizer.mergeSig=!0)})),e.bind(r,"endpointcontrolpointmousemovestart",(function(){t.group.hide()})),e.bind(r,"mouseup",(function(){"elbow"===n.shape&&(t.lineControlPointResizer.mergeSig=!1),t.group.show()}))}},{key:"begin",value:function(){var t=this.subResizers;this.diagram.frontRootGroup.add(this.group),t.forEach((function(t){return t.begin()})),this.isBegin=!0}},{key:"end",value:function(){var t=this.subResizers,e=this.group;t.forEach((function(t){return t.end()})),e&&e.remove(),this.isBegin=!1}},{key:"destroy",value:function(){this.group.remove(),this.subResizers.forEach((function(t){return t.destroy()})),this.isBegin=!1,this.eventHelper.destroy()}},{key:"renew",value:function(t){this.destroy(),this._init(t),this.begin()}},{key:"_init",value:function(t){var e=new na,n=[],r=new na,a=new $u({group:r,cell:t});e.add(r),n.push(a);var i,o=new na;i="elbow"===t.shape?new td({group:o,cell:t}):new Ju({group:o,cell:t}),e.add(o),n.push(i),this.cell=t,this.diagram=t.diagram,this.subResizers=n,this.group=e,this.lineEndpointResize=a,this.lineControlPointResizer=i,this.bindEvent()}},{key:"getElbowMergeSig",value:function(){return this.lineControlPointResizer.mergeSig}}]),t}();var nd=function(t){S()(n,Ru);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"getPath",value:function(){var t=this.line,e=t.getPoints(),n=t.tipOffset,r=t.tailOffset,a=e[e.length-1],i=e[e.length-2],o=uo(i.x,i.y,a.x,a.y,n),c=e[0],l=e[1],s=[uo(l.x,l.y,c.x,c.y,r)];return 0===t.controlPoints.length?s.push(o):s=s.concat(t.controlPoints.map((function(t){var e=b()(t,2);return{x:e[0],y:e[1]}})).filter((function(t){return!isNaN(t.x)})),o),$n(s)}}]),n}();function rd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ad(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var id={"stroke-linejoin":"round"},od=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"element",void 0),c()(E()(t),"hitElement",void 0),t}return y()(n,[{key:"createRendererElement",value:function(){var t=this.cell,e=t.graphicGroup;if(!this.element||t.isCacheStale("shape","roughFillStyle")){var n=t.getRoughGraphicOptions(),r=new(n?ti:ha)(ad(ad({"clip-path":"url(#".concat(t.clipPathID,")")},n),id)),a=new ha(id);r.capture(!1),e.prepend(r),this.element&&this.element.remove(),this.hitElement&&this.hitElement.remove(),this.element=r,this.hitElement=a,t.wireElement=r,!a.parent&&e.insertAfter(a,r)}}},{key:"draw",value:function(){this.createRendererElement();var t=this.cell,e=this.element,n=this.hitElement,r=t.d,a=t.stroke,i={d:r};e.update(ad(ad({stroke:a.color,"stroke-width":a.width,fill:"none"},t.convertStrokeStyle()),i)),n.update({stroke:"rgba(255,255,255,0)","stroke-width":a.width+8,fill:"none",d:i.d})}},{key:"destroy",value:function(){this.element.destroy(),this.hitElement.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function cd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var ld=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"tailOffset",0),c()(E()(r),"tipOffset",0),c()(E()(r),"shape",void 0),c()(E()(r),"shapes",void 0),c()(E()(r),"resizer",void 0),c()(E()(r),"textareaElement",void 0),c()(E()(r),"wireElement",void 0),c()(E()(r),"target",void 0),c()(E()(r),"source",void 0),c()(E()(r),"textPosition",void 0),c()(E()(r),"textDirection",void 0),c()(E()(r),"isLoop",void 0),c()(E()(r),"sourceCell",void 0),c()(E()(r),"targetCell",void 0),c()(E()(r),"controlPoints",void 0),c()(E()(r),"d",void 0),r}return y()(n,[{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.subcells=this.Subcells.map((function(t){return new t(e)})),this.subcells.unshift(new zu(this,"tail")),this.subcells.unshift(new zu(this,"tip")),this.subcells.push(new Hu(this)),this.shapes={straight:new nd(this),curve:new Lu(this),elbow:new Iu(this)},this.render(),this.resizer=new ed(this)}},{key:"canRough",value:function(){return!0}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(t){var e=this.getShapeObj().getTextareaPosition(),n=this.getPercentPointSlope(this.textPosition),r=e.x-t.width/2,a=e.y-t.height/2;return"left"===this.textDirection?n>=0&&n<=15?a=e.y-t.height-5:15<n&&n<=75?(r=e.x+5,a=e.y-t.height-5):75<=n&&n<=105?r=e.x+5:105<n&&n<165?(r=e.x+5,a=e.y+5):165<=n&&n<=195?a=e.y+5:195<n&&n<=255?(r=e.x-5-t.width,a=e.y+5):255<=n&&n<=285?r=e.x-5-t.width:285<n&&n<345?(r=e.x-5-t.width,a=e.y-t.height-5):345<=n&&n<=360&&(a=e.y-t.height-5):"right"===this.textDirection&&(n>=0&&n<=15?a=e.y+5:15<n&&n<=75?(r=e.x-5-t.width,a=e.y+5):75<=n&&n<=105?r=e.x-5-t.width:105<n&&n<165?(r=e.x-5-t.width,a=e.y-t.height-5):165<=n&&n<=195?a=e.y-t.height-5:195<n&&n<=255?(r=e.x+5,a=e.y-t.height-5):255<=n&&n<=285?r=e.x+5:285<n&&n<345?(r=e.x+5,a=e.y+5):345<=n&&n<=360&&(a=e.y+5)),{x:r,y:a}}},{key:"getKeyShape",value:function(){return this.wireElement}},{key:"isConnected",value:function(){return this.target.id||this.source.id}},{key:"getPointBox",value:function(){var t=1/0,e=1/0,n=-1/0,r=-1/0;return this.getPoints().forEach((function(a){t=Math.min(t,a.x),e=Math.min(e,a.y),n=Math.max(n,a.x),r=Math.max(r,a.y)})),{x:t,y:e,width:n-t,height:r-e,minX:t,minY:e,maxX:n,maxY:r}}},{key:"getKeyShapeBox",value:function(){var t=this.getKeyShape().getBBox(),e=t.x,n=t.y;return{x:e,y:n,width:t.width,height:t.height,minX:e,minY:n,maxX:e+t.width,maxY:n+t.height}}},{key:"canArrange",value:function(){var t=this;return["source","target"].every((function(e){var n=t[e];return!n.id&&Array.isArray(n.connection)}))}},{key:"isDrawable",value:function(){var t=this.diagram,e=this.target,n=this.source,r=t.find(n.id),a=n.id&&!r||r&&!1===r.state.visible,i=t.find(e.id),o=e.id&&!i||i&&!1===i.state.visible;return!(a||o)}},{key:"updateTextareaStyleSheets",value:function(){var t=this.textareaContentStyleSheets.find((function(t){return"self"===t.query}));this.diagram.contentEditor.isBegin&&this.diagram.contentEditor.dom===this.textareaElement.htmlContainer?(t.css["min-width"]="12px",t.css["min-height"]="24px"):(t.css["min-width"]=0,t.css["min-height"]=0)}},{key:"shouldRefreshEndEditContent",value:function(){return this.isContentEmpty()}},{key:"canFill",value:function(){return!1}},{key:"beginEditContent",value:function(){this.textareaElement.css({outline:"1px solid #096DD9"})}},{key:"endEditContent",value:function(){this.textareaElement.css({outline:"none"})}},{key:"getPointByPercent",value:function(t){var e=this.wireElement,n=e.getTotalLength();return e.getPointAtLength(t*n)}},{key:"getPercentPointSlope",value:function(t){var e=this.getTwoPointsByPercent(t),n=b()(e,2),r=n[0],a=n[1];return eo(ho(r.x,r.y,a.x,a.y))}},{key:"getTwoPointsByPercent",value:function(t){var e=this.wireElement,n=e.getTotalLength(),r=n*t;return[e.getPointAtLength(Je(r-1,0,n)),e.getPointAtLength(Je(r+1,0,n))]}},{key:"getPadding",value:function(){return[0,0,0,0]}},{key:"getEndpoint",value:function(t){var e=this.diagram,n=t.id,r=t.connection,a=e.find(n);if(a)return r?a.getPoint(r):a.getPoint([.5,.5]);if(Array.isArray(r)){var i=b()(r,2);return{x:i[0],y:i[1]}}return r}},{key:"getAlignBBox",value:function(){var t=this.wireElement.rendererElement.getBBox();return{x:t.x,y:t.y,width:t.width,height:t.height,minX:t.x,minY:t.y,maxX:t.x+t.width,maxY:t.y+t.height}}},{key:"getBBox",value:function(){var t=this.graphicGroup.rendererElement.getBBox();return{x:t.x,y:t.y,width:t.width,height:t.height,minX:t.x,minY:t.y,maxX:t.x+t.width,maxY:t.y+t.height}}},{key:"getShapeObj",value:function(){var t=this.shape;return this.shapes[t]}},{key:"getFirstInsertControlPoints",value:function(){return this.getShapeObj().getFirstInsertControlPoints()}},{key:"getControlPointButtonPosition",value:function(t){return this.getShapeObj().getControlPointButtonPosition(t)}},{key:"getPath",value:function(){var t=this.shape,e=this.sourceCell,n=this.isLoop,r=this.getShapeObj();if(n&&0===this.controlPoints.length){var a=null==e?void 0:e.getPoint([1,.5]);return Yn([["M",a.x,a.y-8],["l",16,-4],["l",0,24],["L",a.x,a.y+8]])}if(r)return r.getPath();throw new Error("unsupported line shape ".concat(t))}},{key:"updatePath",value:function(){this.isCacheStale("shape","source","target","controlPoints")&&(this.d=this.getPath())}},{key:"render",value:function(){var t=this.model;this.subcells.forEach((function(t){return t.render()})),this.renderModel(t)}},{key:"renderModel",value:function(t){_()(L()(n.prototype),"updateModel",this).call(this,t),this.subcells.forEach((function(t){t.update()}))}},{key:"_updateResizer",value:function(){var t=this.diagram;this.resizer&&this.resizer.update(),1===t.selector.selections.length&&t.selector.selections[0]===this||this.resizer.end()}},{key:"updateModel",value:function(t){var e=!1;void 0!==t.shape&&t.shape!==this.shape&&(t.controlPoints=null,e=!0),_()(L()(n.prototype),"updateModel",this).call(this,t),e&&(this.updatePoints(),this.resizer&&this.resizer.renew(this)),this.subcells.forEach((function(t){t.update()}))}},{key:"draw",value:function(){if(this.isDrawable()){var t=this.source,e=this.target,n=this.diagram,r=n.find(t.id),a=n.find(e.id);this.isLoop=null!=r&&r===a,this.sourceCell=r,this.targetCell=a,this.show(),this.updatePoints(),this.updatePath(),this.subcells.forEach((function(t){return t.draw()})),this.drawPosition(),this.graphicGroup.attr({opacity:this.opacity}),this._updateResizer()}else this.hide();this.updateCache()}},{key:"updatePoints",value:function(){this.getShapeObj().updatePoints()}},{key:"updateCache",value:function(){var t=this,e=this.cache;["shape","source","target","roughFillStyle"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var t=this.graphicGroup,e=this.matrix;t.update({matrix:e}),this.resizer.update()}}},{key:"getPoints",value:function(){return this.shapes[this.shape].getPoints()}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var t=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*t)}}return{"stroke-dasharray":"none"}}},{key:"destroy",value:function(){this.subcells.forEach((function(t){return t.destroy()})),this.resizer.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","font-family":'PingFangSC-Regular, "PingFang SC", sans-serif',"line-height":"1.74","word-break":"break-word","box-sizing":"border-box"}}],shape:"straight",stroke:{color:"#595959",width:2},textPosition:.5,textDirection:"center",html:'<div style="text-align: center;">'.concat("&#8203;","</div>"),source:{},target:{},controlPoints:[],opacity:1,Subcells:[od,Gu,tu],penetratedKeys:["source","target","stroke","fill","html","shape","controlPoints","opacity","textPosition","textDirection"],isLine:!0,isLoop:!1})}}]),n}();c()(ld,"className","LineCell"),c()(ld,"Shapes",{});var sd=function(t){S()(n,wu);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"textarea",void 0),t}return y()(n,[{key:"getTextareaPosition",value:function(t){var e=this.textareaRegion,n=this.textVerticalAlign,r={x:e.minX,y:0};return r.y="top"===n?e.minY:"bottom"===n?e.maxY-t.height:(e.minY+e.maxY-t.height)/2,r}},{key:"canRough",value:function(){return!0}},{key:"getRoughGraphicOptions",value:function(){}},{key:"_updateSize",value:function(){var t=this.subcells.find((function(t){return t instanceof tu})),e=this.getPadding();t.update();var n=t.getBBox();n&&(this.width="number"!=typeof this.model.width?n.width+e[1]+e[3]:this.width,this.height="number"!=typeof this.model.height?n.height+e[1]+e[3]:this.height)}},{key:"_updateTextareaRegion",value:function(){var t=this.width,e=this.height;this.textareaRegion={minX:4,minY:4,maxX:t-4,maxY:e-4}}},{key:"afterUpdateModel",value:function(){this._updateSize(),this._updateTextareaRegion(),_()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape"))return mu({name:"rect",x:0,y:0,width:120,height:60,rx:1,ry:1})}},{key:"getOutlinePath",value:function(t){if(this.isCacheStale("width","height","shape")){var e=this.width/120,n=this.height/60;return t.getPath(e,n)}return null}},{key:"getPadding",value:function(){return[4,4,4,4]}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{fill:{color:"rgba(255,255,255,0)"},shape:"text",stroke:{width:1},isText:!0,Subcells:[tu],penetratedKeys:["textVerticalAlign"]})}}]),n}();c()(sd,"className","TextCell");var ud=new Map;ud.set(0,new Map([["tc",2],["rc",0],["bc",0],["lc",1],["tl",2],["tr",3],["br",0],["bl",1]]));var dd=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"tolerance",5),c()(this,"lengthTolerance",10),c()(this,"bleed",10),c()(this,"toAlignPointSets",[]),c()(this,"toAlignLengths",[]),c()(this,"toAlignDistributes",[]),c()(this,"refLines",[]),c()(this,"widthLines",[]),c()(this,"heightLines",[]),c()(this,"distributeWLines",[]),c()(this,"distributeHLines",[]),c()(this,"showLine",!0),c()(this,"refLinesGroup",void 0),c()(this,"startBox",void 0),c()(this,"preventAlignX",!1),c()(this,"preventAlignY",!1),c()(this,"alignRst",{dx:0,dy:0}),this.diagram=e,this.refLinesGroup=new na,e.frontRootGroup.add(this.refLinesGroup)}return y()(t,[{key:"getPointsByBox",value:function(t){var e={x:t.maxX,y:t.minY,weight:0,box:t},n={x:t.minX,y:t.maxY,weight:0,box:t};return[{x:(t.minX+t.maxX)/2,y:(t.minY+t.maxY)/2,weight:1,box:t},e,n]}},{key:"getPointsByPoint",value:function(t){return[t]}},{key:"getPointsByCell",value:function(t){var e=t.getBBox();return this.getPointsByBox(e)}},{key:"drawRefLines",value:function(){var t=this.refLines,e=this.refLinesGroup,n=1/this.diagram.viewport.zoom;t.forEach((function(t){var r=t.x1,a=t.y1,i=t.x2,o=t.y2;e.add(new ha({d:"M".concat(r,",").concat(a," L").concat(i,",").concat(o),stroke:"#1672F3","stroke-width":n}))}))}},{key:"drawDistributeLines",value:function(){var t=this.refLinesGroup,e=1/this.diagram.viewport.zoom,n=3/this.diagram.viewport.zoom,r=1.5/this.diagram.viewport.zoom;this.distributeWLines.forEach((function(a){var i=b()(a,5),o=i[0],c=i[1],l=i[2],s=i[3],u=i[4];o+=r,c-=r,l+=r,s-=r;var d=u-n,h=u+n;t.add(new ha({d:"M".concat(o,",").concat(u," L").concat(c,",").concat(u," M").concat(o,",").concat(d," L").concat(o,",").concat(h," M").concat(c,",").concat(d," L").concat(c,",").concat(h),stroke:"#1672F3","stroke-width":e})),t.add(new ha({d:"M".concat(l,",").concat(u," L").concat(s,",").concat(u," M").concat(l,",").concat(d," L").concat(l,",").concat(h," M").concat(s,",").concat(d," L").concat(s,",").concat(h),stroke:"#1672F3","stroke-width":e}))})),this.distributeHLines.forEach((function(a){var i=b()(a,5),o=i[0],c=i[1],l=i[2],s=i[3],u=i[4];o+=r,c-=r,l+=r,s-=r;var d=u-n,h=u+n;t.add(new ha({d:"M".concat(u,",").concat(o," L").concat(u,",").concat(c," M").concat(d,",").concat(o," L").concat(h,",").concat(o," M").concat(d,",").concat(c," L").concat(h,",").concat(c),stroke:"#1672F3","stroke-width":e})),t.add(new ha({d:"M".concat(u,",").concat(l," L").concat(u,",").concat(s," M").concat(d,",").concat(l," L").concat(h,",").concat(l," M").concat(d,",").concat(s," L").concat(h,",").concat(s),stroke:"#1672F3","stroke-width":e}))}))}},{key:"drawRefLengths",value:function(){var t=this.refLinesGroup,e=1/this.diagram.viewport.zoom,n=5/this.diagram.viewport.zoom,r=15/this.diagram.viewport.zoom;this.widthLines.forEach((function(a){var i=a.x1,o=a.y1,c=a.x2,l=a.y2;o-=r,l-=r,t.add(new ha({d:"M".concat(i,",").concat(o," L").concat(c,",").concat(l," M").concat(i,",").concat(o-n," L").concat(i,",").concat(o+n," M").concat(c,",").concat(l-n," L").concat(c,",").concat(l+n),stroke:"#1672F3","stroke-width":e}))})),this.heightLines.forEach((function(a){var i=a.x1,o=a.y1,c=a.x2,l=a.y2;i-=r,c-=r,t.add(new ha({d:"M".concat(i,",").concat(o," L").concat(c,",").concat(l," M").concat(i-n,",").concat(o," L").concat(i+n,",").concat(o," M").concat(c-n,",").concat(l," L").concat(c+n,",").concat(l),stroke:"#1672F3","stroke-width":e}))}))}},{key:"prepareForDistribute",value:function(t){var e=this.diagram,n=e.viewport.getViewportCanvasBox(),r=Er(t),a=e.groupManager.getCells().filter((function(e){if(!e.isStem||sr(e)||t.includes(e))return!1;var a=e.getBBox();return!io(a,r)&&oo(a,n)}));this.toAlignDistributes=a.map((function(t){return t.getBBox()}))}},{key:"prepareForLength",value:function(t){this.startBox=t.getBBox();var e=this.diagram,n=e.viewport.getViewportCanvasBox(),r=e.groupManager.getCells().filter((function(e){return!(!e.isStem||sr(e)||e===t)&&oo(e.getBBox(),n)}));this.toAlignLengths=r.map((function(t){return t.getBBox()}))}},{key:"updateToAlignPointSet",value:function(t){this.toAlignPointSets=t}},{key:"updateToAlginPoints",value:function(t){var e=this,n=[];Array.isArray(t)?n=t:t&&(n=[t]);var r=this.diagram,a=r.paper,i=r.viewport.getViewportCanvasBox(),o=r.groupManager.getCells().filter((function(t){if("line"===t.model.type)return!1;for(var e=0;e<n.length;e++){var r=n[e];if(t.stem===r.stem)return!1}return oo(t.getBBox(),i)})),c=[];if(o.forEach((function(t){c.push(e.getPointsByCell(t))})),a.visible){var l=a.getBBox();c.push(this.getPointsByBox({minX:l.left,minY:l.top,maxX:l.right,maxY:l.bottom}))}this.toAlignPointSets=c}},{key:"alignDistribute",value:function(t){var e=this,n=5/this.diagram.viewport.zoom,r={dx:0,dy:0};if(0===this.toAlignDistributes.length)return r;var a=[],i=[];this.toAlignDistributes.forEach((function(n){e.isIntersectVericallly(n,t)&&a.push(n),e.isIntersectHorizontally(n,t)&&i.push(n)}));var o=1/0,c=1/0,l=1/0,s=1/0,u=(t.minX+t.maxX)/2,d=(t.minY+t.maxY)/2;if(this.distributeWLines=[],this.distributeHLines=[],0===this.alignRst.dx)for(var h=0;h<a.length;h++)for(var f=h+1;f<a.length;f++){var p=a[h],m=a[f],v=m,y=p;if(p.maxX<m.minX&&(v=p,y=m),this.horizontalDistance(p,m)>this.regionWidth(t)&&this.isIntersectVericallly(p,m)){var g=(v.maxX+y.minX)/2;if((c=Math.abs(u-g))<=n&&c<o){o=c,r.dx=g-u,this.distributeWLines=[[v.maxX,t.minX+r.dx,t.maxX+r.dx,y.minX,0]];var b=[v.minY,v.maxY,y.minY,y.maxY];b.sort((function(t,e){return t-e}));var x=(b[1]+b[2])/2;this.distributeWLines[0][4]=x}}}if(0===this.alignRst.dy)for(var k=0;k<i.length;k++)for(var w=k+1;w<i.length;w++){var C=i[k],A=i[w],O=A,E=C;if(C.minY<A.minY&&(O=C,E=A),this.verticalDistance(C,A)>this.regionHeight(t)&&this.isIntersectHorizontally(C,A)){var P=(O.maxY+E.minY)/2;if((s=Math.abs(d-P))<=n&&s<l){l=s,r.dy=P-d,this.distributeHLines=[[O.maxY,t.minY+r.dy,t.maxY+r.dy,E.minY,0]];var S=[O.minX,O.maxX,E.minX,E.maxX];S.sort((function(t,e){return t-e}));var M=(S[1]+S[2])/2;this.distributeHLines[0][4]=M}}}return this.draw(),r}},{key:"regionWidth",value:function(t){return t.maxX-t.minX}},{key:"regionHeight",value:function(t){return t.maxY-t.minY}},{key:"isIntersectVericallly",value:function(t,e){return!(t.maxY<e.minY||t.minY>e.maxY)}},{key:"isIntersectHorizontally",value:function(t,e){return!(t.maxX<e.minX||t.minX>e.maxX)}},{key:"horizontalDistance",value:function(t,e){return Math.min(Math.abs(t.minX-e.maxX),Math.abs(t.maxX-e.minX))}},{key:"verticalDistance",value:function(t,e){return Math.min(Math.abs(t.minY-e.maxY),Math.abs(t.maxY-e.minY))}},{key:"alignByLength",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===to(t.r)){var a,i,o=this.diagram,c=this.toAlignLengths,l=this.lengthTolerance/o.viewport.zoom;this.widthLines=[],this.heightLines=[];var s=1/0,u=1/0;c.forEach((function(e){var r=Math.abs(e.width-t.w),o=Math.abs(e.height-t.h);n.preventAlignX||r<=l&&(ro(r,s)?n.widthLines.push({x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}):r<s&&(s=r,a=e.width,n.widthLines=[{x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}])),n.preventAlignY||o<=l&&(ro(o,u)?n.heightLines.push({x1:e.x,y1:e.y,x2:e.x,y2:e.y+e.height}):o<u&&(u=o,i=e.height,n.heightLines=[{x1:e.x,y1:e.y,x2:e.x,y2:e.y+e.height}]))})),this.adjustRect(t,a,i,e,r),this.addItselfRefLengths(t),this.draw()}}},{key:"addItselfRefLengths",value:function(t){var e=Or(t);this.widthLines.length>0&&!this.preventAlignX&&this.widthLines.push({x1:e.minX,y1:e.minY,x2:e.maxX,y2:e.minY}),this.heightLines.length>0&&!this.preventAlignY&&this.heightLines.push({x1:e.minX,y1:e.minY,x2:e.minX,y2:e.maxY})}},{key:"adjustRect",value:function(t,e,n,r,a){var i,o=this.startBox;e=e||t.w,n=n||t.h,a&&(n=t.h*e/t.w);var c=Or(t);switch(null===(i=ud.get(t.r))||void 0===i?void 0:i.get(r)){case 0:ro(c.minX,o.minX)||(t.x=o.minX-e),ro(c.minY,o.minY)||(t.y=o.minY-n);break;case 1:ro(c.maxX,o.maxX)&&(t.x=o.maxX-e),ro(c.minY,o.minY)||(t.y=o.minY-n);break;case 2:ro(c.maxX,o.maxX)&&(t.x=o.maxX-e),ro(c.maxY,o.maxY)&&(t.y=o.maxY-n);break;case 3:ro(c.minX,o.minX)||(t.x=o.minX-e),ro(c.maxY,o.maxY)&&(t.y=o.maxY-n)}t.w=e,t.h=n}},{key:"alignByPoint",value:function(t){return this.align("Point",t)}},{key:"alignByBox",value:function(t){return this.align("Box",t)}},{key:"align",value:function(t,e){var n,r=this,a=this.bleed,i=this.showLine,o=this.toAlignPointSets,c=this.diagram,l=this.preventAlignX,s=this.preventAlignY,u={dx:0,dy:0},d=this.tolerance/c.viewport.zoom;if(0===o.length)return u;"Point"===t?(n=this.getPointsByPoint(e))[1]=n[2]=n[0]:n=this.getPointsByBox(e);var h=[];return this.refLines=[],n.forEach((function(t,e){o.forEach((function(n){if(0===e)h.push(r.computeDis(t,n[0]));else for(var a=1;a<n.length;++a)h.push(r.computeDis(t,n[a]))}))})),l||(h.sort((function(t,e){return t.hDis-e.hDis})),[h[0]].forEach((function(t){t.hDis<d&&(u.dx=t.dx,r.refLines.push({x1:t.to.x,x2:t.to.x,y1:Math.min(t.to.box.minY,t.from.box.minY)-a,y2:Math.max(t.to.box.maxY,t.from.box.maxY)+a}))}))),s||(h.sort((function(t,e){return t.vDis-e.vDis})),[h[0]].forEach((function(t){t.vDis<d&&(u.dy=t.dy,r.refLines.push({x1:Math.min(t.to.box.minX,t.from.box.minX)-a,x2:Math.max(t.to.box.maxX,t.from.box.maxX)+a,y1:t.to.y,y2:t.to.y}))}))),i&&this.draw(),this.alignRst=u,u}},{key:"computeDis",value:function(t,e){var n=e.x-t.x,r=e.y-t.y;return{from:t,to:e,weight:t.weight+e.weight,dx:n,dy:r,hDis:Math.abs(n),vDis:Math.abs(r)}}},{key:"draw",value:function(){this.refLinesGroup.clear(),this.drawRefLengths(),this.drawDistributeLines(),0===this.widthLines.length&&0===this.heightLines.length&&this.drawRefLines()}},{key:"clear",value:function(){this.refLines=[],this.widthLines=[],this.heightLines=[],this.distributeWLines=[],this.distributeHLines=[],this.toAlignPointSets=[],this.refLinesGroup.clear()}},{key:"reset",value:function(){this.alignRst={dx:0,dy:0},this.clear(),this.preventAlignX=!1,this.preventAlignY=!1}},{key:"destroy",value:function(){}}]),t}();function hd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fd(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(dd,"className","Align");var pd=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"startTime",void 0),c()(this,"tmpTargetCell",void 0),c()(this,"lastTmpTargetCell",void 0),c()(this,"sourceCell",void 0),c()(this,"targetCell",void 0),c()(this,"group",new na),c()(this,"anchors",void 0),c()(this,"cacheDockCell",void 0),c()(this,"cachePath",new Map),c()(this,"getInnerConnection",(function(t,e){var n=e.canvas2percentage({x:t[0],y:t[1]});return{id:e.model.id,connection:n}})),e.frontRootGroup.prepend(this.group),this.anchors=[]}return y()(t,[{key:"getConnectableCells",value:function(t){return this.diagram.getCellsByZIndex().filter((function(e){var n,r,a,i;return e.canConnect()&&(!t||(r=t,!(io(a=e.getBBox(),i=r.getBBox())||io(i,a))))&&(null==t||null===(n=t.model)||void 0===n?void 0:n.id)!==e.model.id}))}},{key:"isPointInPath",value:function(t,e){return Array.isArray(t)&&(t={x:t[0],y:t[1]}),kr(e)?e.isPointInFill(t):e.isPointInFill(t)&&!e.isPointInStroke(t)}},{key:"init",value:function(t,e){var n=t[e],r=t.getEndpoint(n),a="source"===e?t.target:t.source;if(this.sourceCell=this.diagram.find(a.id),!this.targetCell)for(var i=this.getConnectableCells(this.sourceCell),o=i.length-1;o>=0;o--){var c=i[o];if(this.isPointInPath(r,c))return void(this.targetCell=c)}}},{key:"isPointNearCell",value:function(t,e){e=zi(e);var n=t.canvas2Relative(e),r=t.width,a=t.height,i=8;return Cr(t)&&(i=24),!(n.x<-i||n.x>r+i||n.y<-i||n.y>a+i)}},{key:"findEndPoint",value:function(t){for(var e,n=this.getConnectableCells(this.sourceCell),r=n.length-1;r>=0;r--){var a=n[r];if(this.isPointNearCell(a,t)){this.dock(a);var i=this.getConnection(a,t);if(i){if(this.lastTmpTargetCell=this.tmpTargetCell,this.tmpTargetCell=a,i===a){e={id:a.model.id,connection:null};break}e={id:a.model.id,connection:i};break}}}if(this.cacheDockCell&&!this.isPointNearCell(this.cacheDockCell,t)&&this.clearDock(),!e&&this.tmpTargetCell&&(this.tmpTargetCell=void 0,this.startTime=void 0),this.tmpTargetCell&&this.tmpTargetCell!==this.targetCell&&(this.targetCell=void 0),this.targetCell){if(this.isPointInPath(t,this.targetCell))return this.getInnerConnection(t,this.targetCell);this.startTime=void 0,this.targetCell=void 0}return this.tmpTargetCell&&this.lastTmpTargetCell===this.tmpTargetCell&&this.isPointInPath(t,this.tmpTargetCell)&&(this.startTime||(this.startTime=Date.now()),Date.now()-this.startTime>=1500)?(this.targetCell=this.tmpTargetCell,this.tmpTargetCell=void 0,this.startTime=void 0,this.getInnerConnection(t,this.targetCell)):e||{id:null,connection:t}}},{key:"getCellConnectStateElement",value:function(t){if(Cr(t)){var e;if(this.cachePath.has(t.model.id))e=this.cachePath.get(t.model.id);else{var n=t.getKeyShapeBox();e=new ha({d:Jn(n.x,n.y,n.width,n.height),stroke:"#3384F5",fill:"transparent","stroke-width":2}),this.cachePath.set(t.model.id,e)}return e}var r=new ha({"stroke-width":1,stroke:"#3384F5",fill:"rgba(192,217,252,0.2)"});r.dataset({testid:"connect_dock_line"});var a=t.getKeyShape(),i=D()(t.matrix),o=a.attr("d");return r.update({matrix:i,d:o}),r}},{key:"dock",value:function(t){var e,n=this;if(this.cacheDockCell!==t){this.clearDock(),this.cacheDockCell=t,this.group.add(this.getCellConnectStateElement(t));var r,a=1/this.diagram.viewport.zoom;r=null!==(e=t.stencil)&&void 0!==e&&e.antiAnchors?t.stencil.antiAnchors:t.anchors;var i=0;mr(t)||(i=t.rotate/360*2*Math.PI),r.forEach((function(e){var r,o=n.createAnchor(e.name);n.group.add(o.group);var c,l,s=t.percentage2Canvas(e);!1===(null===(r=t.stencil)||void 0===r?void 0:r.closed)||t.isPointInStroke(s)||Cr(t)?(c=s,l=[e.x,e.y]):(c=t.getIntersectionPoint(s),l=t.canvas2percentage(c)),o.group.update(fd(fd({},c),{},{scale:a,rotate:i})),n.anchors.push({x:l[0],y:l[1],shape:o.shape})}))}}},{key:"clearDock",value:function(){this.cacheDockCell=void 0,this.group.clear(),this.anchors=[]}},{key:"getConnection",value:function(t,e){for(var n=t.canvas2Relative({x:e[0],y:e[1]}),r=n.x,a=n.y,i=t.width,o=t.height,c=[r,a],l=Cr(t)?24:8,s=0;s<this.anchors.length;s++){var u=this.anchors[s],d=[u.x*i,u.y*o];if(lo(c[0],c[1],d[0],d[1])<=l)return[Je(u.x,0,1),Je(u.y,0,1)]}var h,f=t.getKeyShape();if(Cr(t)){if(h=Ki(this.cachePath.get(t.model.id),e,8)){var p=t.canvas2percentage(h);return[Je(p[0],0,1),Je(p[1],0,1)]}}else if(h=Ki(f,[r,a],8))return[Je(h[0]/i,0,1),Je(h[1]/o,0,1)];var m=Yi({x:r,y:a});if(kr(t)){if(t.isPointInFill(zi(e)))return t}else if(Cr(t)){if(f.isPointInFill(Yi({x:e[0],y:e[1]})))return t}else if(f.isPointInFill(m))return t}},{key:"createAnchor",value:function(t){var e=new oa,n=new ha({d:Gn(0,0,3),stroke:"#3384F5",fill:"white"});return e.add(n),{group:e,shape:n,name:t}}},{key:"reset",value:function(){this.clearDock(),this.cachePath.clear(),this.tmpTargetCell=void 0,this.startTime=void 0,this.sourceCell=void 0}},{key:"destroy",value:function(){}}]),t}();c()(pd,"className","Connect");var md=new Sa;md.css({fontFamily:"system-ui"});var vd=function(){function t(e){m()(this,t),this.diagram=e,this.diagram.canvas.calculateCanvas.appendChild(md.rendererElement)}return y()(t,[{key:"measureTextLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fontSize:"12px"};return md.update({text:t}),md.css({fontSize:e.fontSize}),md.getBBox().width}},{key:"destroy",value:function(){}}]),t}();c()(vd,"className","Font");var yd=function(){function t(e){m()(this,t),this.diagram=e,this.group=null}return y()(t,[{key:"getStemsByZIndex",value:function(){var t,e=this.diagram,n=this.group;return(t=n?n.getChildren():e.getCells().filter((function(t){return t.isRoot}))).sort((function(t,e){return t.getZIndex()-e.getZIndex()})),t}},{key:"_getGroupCells",value:function(t){var e=[];return t.deepEachWithoutSelf((function(t){if(t.isGroup)return e.push(t),!1;e.push(t)})),e}},{key:"getCells",value:function(){var t=this.diagram,e=this.group;return e?this._getGroupCells(e):t.getCells().filter((function(t){return t.isRoot})).reduce((function(t,e){return e.isStem&&!e.isGroup?e.deepEach((function(e){t.push(e)})):t.push(e),t}),[])}},{key:"enter",value:function(t,e){this.group&&this.exit();var n,r=this.diagram,a=r.getCells(),i=t.getChildren();return i.forEach((function(t){if(t.isStem&&!t.isGroup)t.deepEach((function(t){if(t.isPointInShape(e))return n=t,!1}));else if(t.isPointInShape(e))return n=t,!1})),n?(a.forEach((function(t){i.includes(t.stem)?t.capture(!0):t.capture(!1)})),t.state.actived=!0,this.group=t,r.emit("afteractivedgroupchange"),n):null}},{key:"exit",value:function(){var t=this.group,e=this.diagram;if(t){for(var n=e.getCells(),r=t;r;)r.isGroup&&r.show(),r=r.parent;n.forEach((function(t){return t.capture(!0)})),t.state.actived=!1}this.group=null,e.emit("afteractivedgroupchange")}},{key:"destroy",value:function(){this.destroyed=!0,this.group=null}}]),t}();c()(yd,"className","GroupManager");var gd=function(t,e,n){var r,a,i,o=new Ln(e);if(void 0!==t.width||void 0!==t.height)r=o.tl,t=Object.assign({},{x:e.x,y:e.y,width:e.w,height:e.h},t),a=[t.width/e.w,t.height/e.h],i=function(t){return[(t[0]-r.x)*a[0]+r.x,(t[1]-r.y)*a[1]+r.y]};else if(void 0!==t.x||void 0!==t.y){var c=o.tl,l=[(t=Object.assign({},{x:e.x,y:e.y,width:e.w,height:e.h},t)).x-c.x,t.y-c.y];a=[1,1],i=function(t){return[t[0]+l[0],t[1]+l[1]]}}return n.map((function(t){var e=t.type;if("line"===e||"points"===e)return{type:e,points:t.points.map((function(t){return i(t)}))};var n=i([t.x,t.y]),r=b()(n,2);return{x:r[0],y:r[1],w:t.w*a[0],h:t.h*a[1],r:t.r,type:e}}))};function bd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xd(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var kd={lake_prevent_click_unselect:!0,group_resize_controller:!0},wd=function t(e){var n=e.type;if("group"===n){var r=[],a=[],i=[];return e.getChildren().forEach((function(e){var n=t(e);Array.isArray(n)?(r.push.apply(r,D()(n[0])),a.push.apply(a,D()(n[1])),i.push.apply(i,D()(n[2]))):(r.push(n.cell),a.push(n.data),i.push(n.originModel))})),[r,a,i]}if("line"===n){var o={},c=e,l=c.source,u=c.target,d=c.controlPoints,h=[];return!l.id&&l.connection&&(h.push(l.connection),o.source=s()(l)),h.push.apply(h,D()(d)),o.controlPoints=d,!u.id&&u.connection&&(h.push(u.connection),o.target=s()(u)),{cell:e,data:{type:"line",points:h},originModel:o}}if(Cr(e)){var f=s()(e.points);return{cell:e,data:{type:"points",points:f},originModel:{points:f}}}return{cell:e,data:{type:n,x:e.x,y:e.y,w:e.width,h:e.height,r:e.rotate},originModel:{x:e.x,y:e.y,width:e.width,height:e.height,rotate:e.rotate}}},Cd=function(t,e,n){return t.map((function(t,r){if("line"===t.type){var a=t.points,i=e[r],o={};return i.source.id||(o.source={},o.source.connection=a.shift()),i.target.id||(o.target={},o.target.connection=a.pop()),o.controlPoints=D()(a),"elbow"===i.shape&&o.controlPoints.forEach((function(t,e){t.push(i.controlPoints[e][2])})),o}if("points"===t.type)return{points:t.points};var c={x:t.x,y:t.y,width:t.w,height:t.h,rotate:t.r};return"stack"===t.type&&delete c.height,"lc"===n||"rc"===n?c.height=void 0:"tc"!==n&&"bc"!==n||(c.width=void 0),c}))},Ad=function(){function t(e){m()(this,t);var n=new na,r=pi("tc",kd),a=pi("bc",kd),i=pi("lc",kd),o=pi("rc",kd),c=fi("tl",kd),l=fi("tr",kd),s=fi("bl",kd),u=fi("br",kd),d=mi("rotate");n.on("mousedown",(function(t){t.stopPropagation(),t.preventDefault()})),n.add(r.group),n.add(a.group),n.add(i.group),n.add(o.group),n.add(c.group),n.add(l.group),n.add(s.group),n.add(u.group),n.add(d.group),this.diagram=e,this.group=n,this.tl=c,this.tr=l,this.bl=s,this.br=u,this.tc=r,this.bc=a,this.lc=i,this.rc=o,this.rotateBtn=d,this.eventHelper=new hl}return y()(t,[{key:"init",value:function(t){var e=this.tl,n=this.tr,r=this.bl,a=this.br,i=this.rotateBtn;Array.isArray(t)?(this.cells=t,e.group.css({display:"none"}),n.group.css({display:"none"}),r.group.css({display:"none"}),a.group.css({display:"none"}),i.group.css({display:"none"})):(this.groupCell=t,e.group.css({display:"initial"}),n.group.css({display:"initial"}),r.group.css({display:"initial"}),a.group.css({display:"initial"}),i.group.css({display:"initial"}))}},{key:"update",value:function(){var t,e,n,r,a,i=this.groupCell,o=this.tl,c=this.tr,l=this.bl,s=this.br,u=this.tc,d=this.bc,h=this.lc,f=this.rc,p=this.diagram,m=this.rotateBtn,v=this.cells,y=1/p.viewport.zoom,g=y,b=8*y;if(v){var x=Er(v.reduce((function(t,e){return e.isAbstract?t.concat(e.abstractCoveredCellsWithAllChildren,e):t.concat(e)}),[]),(function(t){return mr(t)?t.getKeyShapeBox():sr(t)?t.getPointBox():t.getBBox()})),k=x.minX,w=x.minY,C=x.maxX,A=x.maxY;t={x:k,y:w},e={x:C,y:w},n={x:k,y:A},r={x:C,y:A}}else{if(!i)return;t=i.percentage2Canvas({x:0,y:0}),e=i.percentage2Canvas({x:1,y:0}),n=i.percentage2Canvas({x:0,y:1}),r=i.percentage2Canvas({x:1,y:1});var O=14*y;a=i.relative2Canvas({x:-O,y:i.height+O})}o.group.update(xd(xd({},t),{},{scale:y,rotate:0})),c.group.update(xd(xd({},e),{},{scale:y,rotate:0})),l.group.update(xd(xd({},n),{},{scale:y,rotate:0})),s.group.update(xd(xd({},r),{},{scale:y,rotate:0})),m.group.update(xd(xd({},a),{},{scale:y,rotate:0})),u.shape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(e.x,",").concat(e.y),"stroke-width":b}),d.shape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),h.shape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(n.x,",").concat(n.y),"stroke-width":b}),f.shape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(r.x,",").concat(r.y),"stroke-width":b}),u.visShape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(e.x,",").concat(e.y),"stroke-width":g}),d.visShape.update({d:"M".concat(n.x,",").concat(n.y," L").concat(r.x,",").concat(r.y),"stroke-width":g}),h.visShape.update({d:"M".concat(t.x,",").concat(t.y," L").concat(n.x,",").concat(n.y),"stroke-width":g}),f.visShape.update({d:"M".concat(e.x,",").concat(e.y," L").concat(r.x,",").concat(r.y),"stroke-width":g})}},{key:"bindEvent",value:function(){var t,e,n,r,a,i,o,c,l,u,d=this,h=this.groupCell,f=this.tl,p=this.tr,m=this.bl,v=this.br,y=this.tc,g=this.bc,x=this.lc,k=this.rc,C=this.eventHelper,A=this.rotateBtn,O=h.diagram,E=O.viewport.zoom,P=-1;[f,p,m,v,y,g,x,k,A].forEach((function(o){var c=o.shape,l=o.name;C.bind(c,"mousedown",(function(o){u=O.viewport.invertClient([o.clientX,o.clientY]),O.contentEditor.unbind(),t=l,e={x:h.x,y:h.y,w:h.width,h:h.height,r:0};var c=wd(h),s=b()(c,3);r=s[0],n=s[1],a=s[2];for(var d=0;d<n.length;d++)if("line"!==n[d].type||n[d].points[0]){P=d;break}i=n[P]}))})),C.bind(O,"mousemove",(function(a){if(t){var i,f=O.viewport.invertClient([a.clientX,a.clientY]);if("rotate"===t){var p=function(t,e,n,r){var a=Sn(n),i=jn(a,t,e),o=to(n.r+i);o=Math.ceil(o);for(var c=[-180,-90,0,90,180],l=0;l<c.length;l++){var s=c[l];if(ro(o,s,4)){o=s;break}}return{newChildrenRect:r.map((function(t){if("line"===t.type||"points"===t.type)return{type:t.type,points:t.points.map((function(t){var e=[];return w.vec2.rotate(e,[t[0]-a.x,t[1]-a.y],[0,0],no(o)),e[0]+=a.x,e[1]+=a.y,e}))};var e=Mo(a,o,[t]),n=b()(e,1)[0];return{x:n.x,y:n.y,w:t.w,h:t.h,r:n.r}})),groupRotate:o}}({x:u[0],y:u[1]},{x:f[0],y:f[1]},e,n);i=p.newChildrenRect,O.emit("cellrotate",{cell:h,rotate:p.groupRotate})}else{var m=!1;["tl","tr","bl","br"].includes(t)&&(m=!0),i=function(t,e,n,r,a){var i,o,c,l=new Ln(n),s=t,u=[];if(a){switch(e){case"tl":case"br":u=[l.tl,l.br];break;case"tr":case"bl":u=[l.tr,l.bl];break;case"tc":case"bc":u=[l.tc,l.bc];break;case"lc":case"rc":u=[l.lc,l.rc];break;default:u=[]}2===u.length&&(s=Rn(u,t))}switch(e){case"tl":o=l.tl,i=l.br,c=[o.x-s.x,o.y-s.y];break;case"tr":o=l.tr,i=l.bl,c=[s.x-o.x,o.y-s.y];break;case"bl":o=l.bl,i=l.tr,c=[o.x-s.x,s.y-o.y];break;case"br":o=l.br,i=l.tl,c=[s.x-o.x,s.y-o.y];break;case"rc":o=l.rc,i=l.lc,c=[s.x-o.x,0];break;case"lc":o=l.lc,i=l.rc,c=[o.x-s.x,0];break;case"bc":o=l.bc,i=l.tc,c=[0,s.y-o.y];break;case"tc":o=l.tc,i=l.bc,c=[0,o.y-s.y]}var d=[1+c[0]/n.w,1+c[1]/n.h];d[0]<0&&(d[0]=.01),d[1]<0&&(d[1]=.01);var h=function(t){return[(t[0]-i.x)*d[0]+i.x,(t[1]-i.y)*d[1]+i.y]};return{newChildrenRect:r.map((function(t){var e=t.type;if("line"===e||"points"===e)return{type:e,points:t.points.map((function(t){return h(t)}))};var n=h([t.x,t.y]),r=b()(n,2);return{x:r[0],y:r[1],w:t.w*d[0],h:t.h*d[1],r:t.r,type:e}}))}}({x:f[0],y:f[1]},t,e,n,m).newChildrenRect}o=s()(i[P]),c=Cd(i,r,t),O.update(r,c),"rotate"===t?d.hide():d.update(),O.emit("groupresizestart")}else if(a.target.dataset.group_resize_controller){var v;if("line"===a.target.dataset.type){var y=Qn(a.target.getAttribute("d"));v=bi([y[1][1]-y[0][1],y[1][2]-y[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else v=xi(O.viewport.invertClient([a.clientX,a.clientY]),h.getBBox());l||(l=!0),O.setCursor(v)}else l&&(O.resetCursor(),l=void 0)})),C.bind(O,"mouseup",(function(){var s=d.groupCell;O.resetCursor();var u=!1;if(o&&i&&P>=0)if("line"===i.type||"points"===i.type){var h=i.points[0],f=o.points[0];h[0]===f[0]&&h[1]===f[1]||(u=!0)}else o.x===i.x&&o.y===i.y&&o.w===i.w&&o.h===i.h&&o.r===i.r||(u=!0);u&&O.command.execute("Update",{id:r.map((function(t){return t.model.id})),model:c,originModels:a,select:function(){O.selector.select([s.model.id])}}),t=void 0,e=void 0,n=void 0,r=void 0,a=void 0,o=void 0,i=void 0,c=void 0,l=void 0})),C.bind(O,"afterviewportchange",Bt()((function(){E!==O.viewport.zoom&&(d.update(),E=O.viewport.zoom)})))}},{key:"begin",value:function(){this.diagram.frontRootGroup.add(this.group),this.update(),this.show(),this.cells||this.bindEvent()}},{key:"end",value:function(){this.group&&this.group.remove(),this.groupCell=void 0,this.cells=void 0,this.eventHelper.unbind()}},{key:"show",value:function(){this.group.css({display:"initial"})}},{key:"hide",value:function(){this.group.css({display:"none"})}},{key:"destroy",value:function(){this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}}]),t}();c()(Ad,"className","GroupRotateResize");var Od=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"group",new na),c()(this,"eventHelper",new hl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new na).css({"pointer-events":"none"})}return y()(t,[{key:"bind",value:function(){var t=this,e=this.diagram,n=this.eventHelper;n.unbind(),n.bind(e,"afterchange",(function(e){var n=e.action;t.arr.length>0&&("update"===n||"delete"===n)&&t.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(t){var e=this.diagram.viewport.zoom;t=t.filter((function(t){return t.state.visible})),this.render(t,(function(){return{shapeStyle:{fill:"none",stroke:"#3384F5","stroke-width":1/e}}}))}},{key:"render",value:function(t,e){var n=this.group,r=this.diagram;this.clear(),t&&!t.some((function(t){return!t||!t.isCell}))&&(r.frontRootGroup.add(n),this.bind(),this.arr=t.map((function(t){var r=e(t),a=r.type,i=r.shapeStyle,o={cell:t,type:"function"==typeof a?a(t):a,shape:i&&new ha(i)};return o.shape&&n.add(o.shape),o})),this.draw())}},{key:"updateShape",value:function(t){var e,n=t.cell,r=t.shape,a=[1,0,0,0,1,0,0,0,1];if(sr(n)){var i=n.getPointBox();e=Jn(i.x,i.y,i.width,i.height)}else if(kr(n)||wr(n)){var o=n.getKeyShapeBox();e=Jn(o.x,o.y,o.width,o.height)}else if(pr(n)){var c=n.percentage2Canvas({x:0,y:0}),l=n.percentage2Canvas({x:1,y:0}),s=n.percentage2Canvas({x:0,y:1});e=$n([c,l,n.percentage2Canvas({x:1,y:1}),s,c])+"z"}else mr(n)&&(e=n.borderElement.attr("d"),a=D()(n.matrix));r.update({matrix:a,d:e,"stroke-width":1})}},{key:"_draw",value:function(){var t=this;this.arr.forEach((function(e){t.updateShape(e)}))}},{key:"draw",value:function(){this.arr.length>0&&this._draw()}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),t}();c()(Od,"className","Highlight");var Ed=function(){function t(e){m()(this,t),this.diagram=e,this.eventHelper=new hl,this.zoom=-1/0,this.arr=[],this.maxStashes={},this.bindEvent()}return y()(t,[{key:"bindEvent",value:function(){var t=this,e=this.diagram;this.eventHelper.bind(e,"afterviewportchange",Nt()((function(){e.destroyed||t._update()}),100))}},{key:"setImageHref",value:function(t,e,n,r){this.arr.push({image:t,href:e,naturalWidth:n,naturalHeight:r}),this._setImageHref(t,e,n,r)}},{key:"_setImageHref",value:function(t,e,n,a){var i,o=this.diagram,c=this.maxStashes,l=o.viewport.zoom,s=Number(t.attr("width")),u=t.attr("href"),d=c[e],h=s*l;d&&d.clientWidth>h?i=d.href:(i=r.OssUtil.resizeImage({maxWidth:h,src:e,data:{width:h,originWidth:n,originHeight:a}})||e,c[e]={clientWidth:h,href:i}),u!==i&&t.update({href:i})}},{key:"_gc",value:function(){this.arr=this.arr.filter((function(t){return t&&!t.image.destroyed}))}},{key:"_refreshOssUrl",value:function(){var t=this,e=this.arr,n=this.diagram,r=this.zoom;n.viewport.zoom>r&&(e.forEach((function(e){var n=e.image,r=e.href,a=e.naturalWidth,i=e.naturalHeight;t._setImageHref(n,r,a,i)})),this.zoom=n.viewport.zoom)}},{key:"_update",value:function(){this._gc(),this._refreshOssUrl()}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.destroyed=!0}}]),t}();function Pd(t,e,n){if(t&&!t.id){var r=t.connection;t.connection=[r[0]+e,r[1]+n]}}c()(Ed,"className","ImageManager");var Sd=function(t){S()(n,Ul);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).caches={},r}return y()(n,[{key:"clone",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.diagram,r=function(t){var e=1/0,n=1/0,r=-1/0,a=-1/0;return t.forEach((function(t){var i,o,c,l;if("edge"===t.type){var s=[];t.source&&!t.source.id&&t.source.connection&&s.push(t.source.connection),t.target&&!t.target.id&&t.target.connection&&s.push(t.target.connection);var u=s.map((function(t){return t[0]})),d=s.map((function(t){return t[1]}));i=Math.min.apply(Math,D()(u)),o=Math.min.apply(Math,D()(d)),c=Math.max.apply(Math,D()(u)),l=Math.max.apply(Math,D()(d))}else i=t.x,o=t.y,c=t.x+(t.width||0),l=t.y+(t.height||0);i<e&&(e=i),o<n&&(n=o),c>r&&(r=c),l>a&&(a=l)})),{minX:e,minY:n,maxX:r,maxY:a}}(t);if(!oo(r,n.viewport.viewportCanvasBox)){var a=n.viewport.getCenter(),i=a[0]-(r.minX+r.maxX)/2,o=a[1]-(r.minY+r.maxY)/2;t.forEach((function(t){!function(t,e,n){"edge"===t.type?(Pd(t.source,e,n),Pd(t.target,e,n)):(t.x=(t.x||0)+e,t.y=(t.y||0)+n)}(t,i,o)}))}return gi(t,e),t}}]),n}(),Md=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"line",void 0),c()(this,"refLinesGroup",new na),c()(this,"fixedPoint",void 0),c()(this,"ns",void 0),c()(this,"we",void 0),c()(this,"nwse",void 0),c()(this,"nesw",void 0),c()(this,"_enable",!1),this.diagram.frontRootGroup.add(this.refLinesGroup)}return y()(t,[{key:"init",value:function(t,e){this.line=t;var n=t.getPoints();this.fixedPoint="source"===e?n[1]:n[n.length-2]}},{key:"align",value:function(t){if(t=zi(t),t=function(t,e){t=zi(t),e=zi(e);var n=t,r=n.x,a=n.y,i=e,o=i.x,c=i.y,l=co(r,a,o,c);return Math.abs(l)<.1&&Math.abs(c-a)<8?e.y=a:Math.abs(l)>10&&Math.abs(o-r)<8&&(e.x=r),e}(this.fixedPoint,t),!this._enable)return t;var e=this.createOneRefLine(t);if(e){this.refLinesGroup.clear(),this.refLinesGroup.add(e.path);var n=1/(this.diagram.viewport.zoom||1);e.path.update({"stroke-width":n});var r=e.start,a=e.end;return Rn([{x:r[0],y:r[1]},{x:a[0],y:a[1]}],t)}return t}},{key:"createOneRefLine",value:function(t){var e=this.fixedPoint,n=e.x,r=e.y,a=eo(ho(n,r,t.x,t.y));return(a=a>180?a-180:a)>=0&&a<22.5?{path:new ha({d:"M".concat(n-5e4,",").concat(r," L").concat(n+5e4,",").concat(r),stroke:"#1672F3"}),start:[n-5e4,r],end:[n+5e4,r]}:a>=22.5&&a<67.5?{path:new ha({d:"M".concat(n-5e4,",").concat(r-5e4," L").concat(n+5e4,",").concat(r+5e4),stroke:"#1672F3"}),start:[n-5e4,r-5e4],end:[n+5e4,r+5e4]}:67.5<=a&&a<112.5?{path:new ha({d:"M".concat(n,",").concat(r-5e4," L").concat(n,",").concat(r+5e4),stroke:"#1672F3"}),start:[n,r-5e4],end:[n,r+5e4]}:112.5<=a&&a<157.5?{path:new ha({d:"M".concat(n+5e4,",").concat(r-5e4," L").concat(n-5e4,",").concat(r+5e4),stroke:"#1672F3"}),start:[n+5e4,r-5e4],end:[n-5e4,r+5e4]}:157.5<=a&&a<=180?{path:new ha({d:"M".concat(n-5e4,",").concat(r," L").concat(n+5e4,",").concat(r),stroke:"#1672F3"}),start:[n-5e4,r],end:[n+5e4,r]}:void 0}},{key:"reset",value:function(){this.refLinesGroup.clear()}},{key:"setEnable",value:function(t){this._enable=t}},{key:"destroy",value:function(){}}]),t}();c()(Md,"className","LineAlign");var jd=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"group",new na),c()(this,"highlightPath",void 0),e.frontRootGroup.add(this.group)}return y()(t,[{key:"align",value:function(t,e,n){t=zi(t),e=zi(e);var r,a,i=[0,0],o=0,c=!1;return 0===(null==n?void 0:n.rotate)&&(ro(t.y,e.y,4)?(i=[e.x,t.y],c=!0,o=0):ro(t.x,e.x,4)&&(i=[t.x,e.y],c=!0,o=1),c&&(ro((r=function(t){return[Je(t[0],0,1),Je(t[1],0,1)]}(r=n.canvas2percentage(i)))[o],0,.1)?(r[o]=0,a=r):ro(r[o],1,.1)&&(r[o]=1,a=r),a))?(this.highlight(t,i),a):(this.clearHighlight(),null)}},{key:"highlight",value:function(t,e){var n;this.highlightPath||(this.highlightPath=new ha({stroke:"#1672F3"}),this.group.add(this.highlightPath)),t=zi(t),e=zi(e);var r,a,i=24/this.diagram.viewport.zoom;t.x===e.x?(r=t.y<e.y?t:e,a=t.y>=e.y?t:e,n="M".concat(r.x,",").concat(r.y-i," L").concat(a.x,",").concat(a.y+i)):(r=t.x<e.x?t:e,a=t.x>=e.x?t:e,n="M".concat(r.x-i,",").concat(r.y," L").concat(a.x+i,",").concat(a.y)),this.highlightPath.update({d:n})}},{key:"clearHighlight",value:function(){this.group.clear(),this.highlightPath=null}},{key:"reset",value:function(){this.clearHighlight()}},{key:"destroy",value:function(){}}]),t}();c()(jd,"className","LineCellAlign");var Rd=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"line",void 0),c()(this,"name",void 0),c()(this,"basePoint",void 0),c()(this,"highlight",void 0),c()(this,"group",new na)}return y()(t,[{key:"init",value:function(t,e){this.line=t,this.name=e,this.diagram.lineAlign.init(t,e),this.diagram.connect.init(t,e),this.highlight=_i(e,3),this.highlight.group.hide(),this.highlight.shape.update({stroke:"#3384F5",fill:"#3384F5"}),this.diagram.frontRootGroup.add(this.highlight.group);var n=this.line.getPoints();"target"===this.name?this.basePoint=n[0]:this.basePoint=n[n.length-1]}},{key:"resize",value:function(t){if(!this.line)throw new Error("line not exist, must call prepareUpdate before updateEndPoint");var e,n=this.diagram,r=n.viewport.invertClient([t.clientX,t.clientY]),a=n.connect.findEndPoint(r);if(a.id){n.lineAlign.reset();var i=n.lineCellAlign.align(this.basePoint,r,n.find(a.id));i&&(a.connection=i),this.updateHighlight(a)}else if(!a.id&&a.connection){var o=n.lineAlign.align(r);a.connection=[(e=o).x,e.y],this.highlight.group.hide()}return a}},{key:"updateHighlight",value:function(t){if(this.line){var e,n=1/this.diagram.viewport.zoom,r=this.line.getPoints();e=t.id&&!t.connection?zi(r[r.length-1]):this.line.getEndpoint(t),this.highlight.group.show(),this.highlight.group.update({scale:n,x:e.x,y:e.y})}}},{key:"reset",value:function(){var t,e;null===(t=this.highlight)||void 0===t||null===(e=t.group)||void 0===e||e.remove(),this.diagram.lineAlign.reset(),this.diagram.connect.reset(),this.diagram.lineCellAlign.reset(),this.group.clear()}},{key:"destroy",value:function(){}}]),t}();c()(Rd,"className","LineResizer");var Ld='<div style="text-align:center;">&nbsp;</div>',Bd=["text","mindmap","geometry","stack","image","swimlane","dsl"],Dd=function(t){return!!t.type&&Bd.includes(t.type)};function Nd(t,e,n){if(t.type){if(Dd(t)){var r="number"==typeof t.x?t.x:0,a="number"==typeof t.y?t.y:0;return{x:r+e,y:a+n}}if(Wo(t)){var i={};return t.target&&!t.target.id&&t.target.connection&&(i.target=s()(t.target),Array.isArray(i.target.connection)&&(i.target.connection[0]+=e,i.target.connection[1]+=n)),t.source&&!t.source.id&&t.source.connection&&(i.source=s()(t.source),Array.isArray(i.source.connection)&&(i.source.connection[0]+=e,i.source.connection[1]+=n)),i}if(function(t){return!!t.type&&"freehand"===t.type}(t)){var o={};return o.points=t.points.map((function(t){return[t[0]+e,t[1]+n,t[2]]})),o}if(function(t){return!!t.type&&"pen"===t.type}(t)){var c={};return c.points=t.points.map((function(t){return[t[0]+e,t[1]+n]})),c}}return{}}function _d(t,e,n){return!!t.type&&(Dd(t)?("number"==typeof t.x?t.x=t.x+e:t.x=e,"number"==typeof t.y?t.y=t.y+n:t.y=n):Wo(t)?(t.target&&!t.target.id&&Array.isArray(t.target.connection)&&(t.target.connection[0]+=e,t.target.connection[1]+=n),t.source&&!t.source.id&&Array.isArray(t.source.connection)&&(t.source.connection[0]+=e,t.source.connection[1]+=n),t.controlPoints&&t.controlPoints.forEach((function(t){"number"==typeof t[0]&&(t[0]+=e),"number"==typeof t[1]&&(t[1]+=n)}))):Vo(t)&&t.points.forEach((function(t){t[0]+=e,t[1]+=n})),!0)}function Id(t,e,n){return t.map((function(t){return Nd(t,e,n)}))}function Td(t,e,n){t.forEach((function(t){Ve(t,(function(t){return _d(t,e,n)}))}))}function Fd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var zd=function(){function t(){m()(this,t),c()(this,"destroyed",void 0)}return y()(t,[{key:"bbox",value:function(t){return function(t){var e={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,width:10,height:10};return t.forEach((function(t){Ve(t,(function(n){var r=1/0,a=1/0,i=-1/0,o=-1/0;if(Dd(n)){var c=n.width||50,l=n.height||50;r=n.x,a=n.y,i=n.x+c,o=n.y+l}else if(Wo(t)){var s=[],u=[];t.target&&!t.target.id&&t.target.connection&&(s.push(t.target.connection[0]),u.push(t.target.connection[1])),t.source&&!t.source.id&&t.source.connection&&(s.push(t.source.connection[0]),u.push(t.source.connection[1])),t.controlPoints&&t.controlPoints.forEach((function(t){"number"==typeof t[0]&&s.push(t[0]),"number"==typeof t[1]&&u.push(t[1])})),r=Math.min.apply(Math,s),a=Math.min.apply(Math,u),i=Math.max.apply(Math,s),o=Math.max.apply(Math,u)}else if(Vo(t)){var d=[],h=[];t.points.forEach((function(t){d.push(t[0]),h.push(t[1])})),r=Math.min.apply(Math,d),a=Math.min.apply(Math,h),i=Math.max.apply(Math,d),o=Math.max.apply(Math,h)}r<e.minX&&(e.minX=r),a<e.minY&&(e.minY=a),i>e.maxX&&(e.maxX=i),o>e.maxY&&(e.maxY=o)}))})),e.width=e.maxX-e.minX,e.height=e.maxY-e.minY,e}(t)}},{key:"translate",value:function(t,e,n,r){var a=r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({deep:!0,returnUpdateModels:!1},r),i=a.deep,o=a.returnUpdateModels?[]:null,l=function(t,e,n){if(_d(t,e,n),o){var r=Nd(t,e,n);r&&o.push(r)}};return t.forEach((function(t){!0===i?Ve(t,(function(t){l(t,e,n)})):l(t,e,n)})),o}},{key:"destroy",value:function(){this.destroyed=!0}}]),t}();c()(zd,"className","ModelManager");var qd=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this)).diagram=t,r}return y()(n,[{key:"init",value:function(){if("read"!==this.diagram.interaction.currentMode){var t,e,n,r,a=this.diagram,i=!1,o=!1,c=!1,l="edit";this.bind(a,"dragstart",(function(l){var s=l.evt,d=l.button;t=s.clientX,e=s.clientY,n=a.viewport.scrollLeft,r=a.viewport.scrollTop,function(t){return!!(2===t||0===t&&c||"dragCanvas"===a.interaction.currentMode)}(d)&&(2===d&&(o=!0),i=!0,a.input.style.display="none","dragCanvas"!==a.interaction.currentMode&&u(),a.setCursor("grabbing"),a.selector.select([]))})),this.bind(a,"drag",Bt()((function(i){var o=i.evt;if("dragCanvas"===a.interaction.currentMode){var c=n-(o.clientX-t),l=r-(o.clientY-e);a.viewport.setScroll(c,l)}}),16));var s=function(){o=!1};this.bind(a,"dragend",(function(){s(),!i||c||a.signal.buttonDragCanvas||(d(),a.tryFocus())})),this.bind(a,"mouseleave",(function(){s(),i&&!a.signal.buttonDragCanvas&&d()})),this.bind(a,"keydown",(function(t){" "===t.key&&(t.preventDefault(),c=!0,"dragCanvas"!==a.interaction.currentMode&&(a.highlight.clear(),a.selector.select([]),u()))})),this.bind(a,"keyup",(function(t){" "===t.key&&(c=!1,a.signal.buttonDragCanvas=!1,o||d())})),this.bind(window,"blur",d)}function u(){l=a.interaction.currentMode,a.interaction.changeMode("dragCanvas")}function d(){i=!1,c=!1,o=!1,a.input.style.display="","dragCanvas"===a.interaction.currentMode&&(a.interaction.changeMode(l),l="edit")}}},{key:"destroy",value:function(){this.unbind()}}]),n}();c()(qd,"className","MouseDragCanvas");var Yd=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this)).diagram=t,r.init(),r}return y()(n,[{key:"init",value:function(){var t=this.diagram;this.bind(t,"keydown",(function(e){"read"!==t.interaction.currentMode&&"edit"!==t.interaction.currentMode&&("v"!==e.key&&"Esc"!==e.key&&"Escape"!==e.key||t.interaction.changeMode("edit"))}))}}]),n}();function Hd(t,e,n){var r=new Ln(n),a=Rn([r.tl,r.tr],e),i=Rn([r.tl,r.bl],e),o=Rn([r.tr,r.br],e),c=Rn([r.bl,r.br],e),l=Je(Rn([i,o],t).x,0,n.w),s=Je(Rn([a,c],t).y,0,n.h);return[Pn(i,{x:l,y:e.y})/n.w,Pn(a,{x:e.x,y:s})/n.h]}function Gd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Xd(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gd(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(Yd,"className","VBackToEdit");var Wd=function(){function t(e){m()(this,t),c()(this,"cell",void 0),c()(this,"diagram",void 0),c()(this,"controlPointsButtons",void 0),c()(this,"roundButton",void 0),c()(this,"group",void 0),c()(this,"eventHelper",void 0),c()(this,"shape",void 0),c()(this,"isMouseMove",void 0),this.diagram=e,this.group=new na,this.group.on("mousedown",(function(t){t.stopPropagation(),t.preventDefault()})),this.eventHelper=new hl}return y()(t,[{key:"init",value:function(t){this.cell=t,this.shape=this.cell.shape,this.prepareButtons()}},{key:"begin",value:function(){this.controlPointsButtons&&(this.isMouseMove=!1,this.diagram.frontRootGroup.add(this.group),this.update(),this.bindEvent())}},{key:"end",value:function(){this._clear(),this.eventHelper.unbind()}},{key:"_clear",value:function(){this.group&&this.group.clear()}},{key:"update",value:function(){var t=this;if(this.cell){this.shape!==this.cell.shape&&(this._clear(),this.eventHelper.unbind(),this.prepareButtons(),this.bindEvent(),this.shape=this.cell.shape);var e=1/(this.diagram.viewport.zoom||1),n=this.cell.rotate/360*2*Math.PI;if(this.controlPointsButtons.length>0&&this.cell.controlPoints.forEach((function(r,a){var i=t.cell.percentage2Canvas({x:Je(r[0],0,1),y:Je(r[1],0,1)});t.controlPointsButtons[a].group.update(Xd(Xd({},i),{},{scale:e,rotate:n}))})),this.roundButton){var r=Je(this.cell.round/this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2/this.cell.width);this.isMouseMove||(this.cell.round<8&&(r=8/this.cell.width),this.cell.width<8?this.roundButton.group.hide():this.roundButton.group.show());var a=r,i=this.cell.percentage2Canvas({x:r,y:a});this.roundButton.group.update(Xd(Xd({},i),{},{scale:e,rotate:n}))}}}},{key:"destroy",value:function(){this.group.remove()}},{key:"hide",value:function(){this.group.hide()}},{key:"show",value:function(){this.group.show()}},{key:"prepareButtons",value:function(){this.createControlPointsButtons(),this.createRoundButton()}},{key:"bindEvent",value:function(){var t,e,n,r=this,a=!1;function i(){e=void 0,n=void 0}this.controlPointsButtons.forEach((function(o,c){var l=o.shape;r.eventHelper.bind(l,"mousedown",(function(){r.diagram.contentEditor.unbind(),a=!0,t=c,e={controlPoints:r.cell.controlPoints}})),r.eventHelper.bind(r.diagram,"mousemove",Bt()((function(e){a&&(n=r.computeControlPoints(e,t),r.diagram.update(r.cell,{controlPoints:n}))}),16)),r.eventHelper.bind(r.diagram,"mouseup",(function(){a&&(a=!1,t=0,Ft()(e.controlPoints,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{controlPoints:n},originModels:[e]}),i()))}))})),this.roundButton&&(this.eventHelper.bind(this.roundButton.shape,"mousedown",(function(){r.diagram.contentEditor.unbind(),a=!0,e={round:r.cell.round}})),this.eventHelper.bind(this.diagram,"mousemove",Bt()((function(t){a&&(r.isMouseMove=!0,n=r.computeRoundPoint(t),r.diagram.update(r.cell,{round:n}))}),16)),this.eventHelper.bind(this.diagram,"mouseup",(function(){a&&(r.isMouseMove=!1,r.update(),a=!1,Ft()(e.round,n)||(r.diagram.command.execute("Update",{id:r.cell,model:{round:n},originModels:[e]}),i()))})))}},{key:"createRoundButton",value:function(){"number"==typeof this.cell.round?this.roundButton=this.createButton("round"):this.roundButton=void 0}},{key:"createControlPointsButtons",value:function(){var t=this;this.cell.controlPoints?this.controlPointsButtons=this.cell.controlPoints.map((function(){return t.createButton("control_point")})):this.controlPointsButtons=[]}},{key:"createButton",value:function(t){var e=new oa,n=9*Math.sin(Math.PI/4),r=Jn(n/-2,n/-2,n,n,1.5),a=w.mat3.rotate([],[1,0,0,0,1,0,0,0,1],Math.PI/4),i=new ha({d:r,stroke:"rgba(255,255,255,0.8)","stroke-width":1,fill:"#3384F5",matrix:a});return i.dataset({testid:t}),e.add(i),this.group.add(e),{group:e,shape:i}}},{key:"computeControlPoints",value:function(t,e){var n=this.diagram.viewport.invertClient([t.clientX,t.clientY]),r=this.cell.stencil.controlPointsConfig,a=this.cell.controlPoints,i=a[e],o=w.vec3.transformMat3([],w.vec3.clone([n[0],n[1],1]),w.mat3.invert([],this.cell.matrix)),c=b()(o,2),l=Hd({x:c[0],y:c[1]},{x:i[0]*this.cell.width,y:i[1]*this.cell.height},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0}),u=["x","y"].map((function(t,n){var o=[0,1],c=r[e][t].limit;return void 0===c?o=[0,1]:Array.isArray(c)?o=c.map((function(t){return"string"==typeof t?a[Number(t)][n]:t})):!0===c&&(o=[i[n],i[n]]),Je(l[n],o[0],o[1])})),d=s()(a);return d[e]=u,["x","y"].forEach((function(t,n){var a=r[e][t].proportional;if(a){var o=u[n]-i[n];a.forEach((function(t){d[Number(t)][n]+=o}))}})),d}},{key:"computeRoundPoint",value:function(t){var e=this.diagram.viewport.invertClient([t.clientX,t.clientY]),n=w.vec3.transformMat3([],w.vec3.clone([e[0],e[1],1]),w.mat3.invert([],this.cell.matrix)),r=b()(n,2),a=Hd({x:r[0],y:r[1]},{x:Je(this.cell.round,0,Math.min(this.cell.width,this.cell.height)/2),y:0},{x:0,y:0,w:this.cell.width,h:this.cell.height,r:0});return Je(a[0]*this.cell.width,0,Math.min(this.cell.width,this.cell.height)/2)}}]),t}();function Vd(t,e){return[t[0]+e[0],t[1]+e[1]]}function Zd(t,e){return[t[0]-e[0],t[1]-e[1]]}function Ud(t,e){return[t[0]*e,t[1]*e]}function Kd(t){return Math.hypot(t[0],t[1])}function Qd(t,e,n){var r=Math.sin(n),a=Math.cos(n),i=t[0]-e[0],o=t[1]-e[1],c=i*r+o*a;return[i*a-o*r+e[0],c+e[1]]}function $d(t){return t.map((function(t){return Math.round(100*t)/100}))}var Jd=function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=function(t){return function(t,e){return[t[0]/e,t[1]/e]}(t,Kd(t))}(Zd(e,t)),i=Vd(t,Ud(a,function(t,e){return function(t,e){return t[0]*e[0]+t[1]*e[1]}(t,e)/Kd(e)}(Zd(n,t),a)));if(r){if(i[0]<Math.min(t[0],e[0]))return t[0]<e[0]?t:e;if(i[0]>Math.max(t[0],e[0]))return t[0]>e[0]?t:e;if(i[1]<Math.min(t[1],e[1]))return t[1]<e[1]?t:e;if(i[1]>Math.max(t[1],e[1]))return t[1]>e[1]?t:e}return i};function th(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function eh(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?th(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):th(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nh={lake_prevent_click_unselect:"true",vertex_resize_controller:"true"},rh=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"cell",void 0),c()(this,"group",new na),c()(this,"eventHelper",new hl),c()(this,"controlPointsManager",void 0),c()(this,"tl",void 0),c()(this,"tr",void 0),c()(this,"bl",void 0),c()(this,"br",void 0),c()(this,"tc",void 0),c()(this,"bc",void 0),c()(this,"lc",void 0),c()(this,"rc",void 0),c()(this,"rotateBtn",void 0),c()(this,"resizeRotatePoints",[]),c()(this,"cursors",void 0);var n=pi("tc",nh),r=pi("bc",nh),a=pi("lc",nh),i=pi("rc",nh),o=fi("tl",nh),l=fi("tr",nh),s=fi("bl",nh),u=fi("br",nh),d=mi("rotate");this.group.on("mousedown",(function(t){t.stopPropagation(),t.preventDefault()})),this.group.add(n.group),this.group.add(r.group),this.group.add(a.group),this.group.add(i.group),this.group.add(o.group),this.group.add(l.group),this.group.add(s.group),this.group.add(u.group),this.group.add(d.group),this.tl=o,this.tr=l,this.bl=s,this.br=u,this.tc=n,this.bc=r,this.lc=a,this.rc=i,this.rotateBtn=d,this.controlPointsManager=new Wd(e)}return y()(t,[{key:"init",value:function(t){var e=this,n=this.tl,r=this.tr,a=this.bl,i=this.br,o=this.tc,c=this.bc,l=this.lc,s=this.rc,u=this.rotateBtn;this.cell=t;var d={tl:n,tr:r,bl:a,br:i,tc:o,bc:c,lc:l,rc:s,rotate:u};t.resizeRotatePoints?this.resizeRotatePoints=t.resizeRotatePoints.map((function(t){return d[t]})):this.resizeRotatePoints=Object.keys(d).map((function(t){return d[t]})),this.cursors={},this.resizeRotatePoints.forEach((function(t){t===l||t===s?e.cursors["ew-resize"]=!0:t===o||t===c?e.cursors["ns-resize"]=!0:t===n||t===i?e.cursors["nwse-resize"]=!0:t!==a&&t!==r||(e.cursors["nesw-resize"]=!0)})),vr(t)&&this.controlPointsManager.init(t)}},{key:"update",value:function(){var t=this.cell,e=this.tl,n=this.tr,r=this.bl,a=this.br,i=this.tc,o=this.bc,c=this.lc,l=this.rc,s=this.rotateBtn,u=this.diagram;if(t){this.controlPointsManager.update();var d=1/u.viewport.zoom,h=no(t.rotate||0),f=t.percentage2Canvas({x:0,y:0}),p=t.percentage2Canvas({x:1,y:0}),m=t.percentage2Canvas({x:0,y:1}),v=t.percentage2Canvas({x:1,y:1});if(mr(t)){var y=Qn(t.outlineElement.attr("d"));y&&(p=t.getPointAtLength(y[1][1]+y[2][1]))}else hr(t)&&([f,p,m,v].forEach((function(e){e.x+=t.x,e.y+=t.y})),"stage"===t.parent.shape&&0!==t.nth&&(f.x-=25,m.x-=25));var g=d,b=8*d,x=12*d+t.stroke.width/2,k=t.relative2Canvas({x:0-x,y:t.height+x});e.group.update(eh(eh({},f),{},{scale:d,rotate:h})),n.group.update(eh(eh({},p),{},{scale:d,rotate:h})),r.group.update(eh(eh({},m),{},{scale:d,rotate:h})),a.group.update(eh(eh({},v),{},{scale:d,rotate:h})),s.group.update(eh(eh({},k),{},{scale:d,rotate:h})),i.shape.update({d:"M".concat(f.x,",").concat(f.y," L").concat(p.x,",").concat(p.y),"stroke-width":b}),o.shape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(v.x,",").concat(v.y),"stroke-width":b}),c.shape.update({d:"M".concat(f.x,",").concat(f.y," L").concat(m.x,",").concat(m.y),"stroke-width":b}),l.shape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(v.x,",").concat(v.y),"stroke-width":b}),i.visShape.update({d:"M".concat(f.x,",").concat(f.y," L").concat(p.x,",").concat(p.y),"stroke-width":g}),o.visShape.update({d:"M".concat(m.x,",").concat(m.y," L").concat(v.x,",").concat(v.y),"stroke-width":g}),c.visShape.update({d:"M".concat(f.x,",").concat(f.y," L").concat(m.x,",").concat(m.y),"stroke-width":g}),l.visShape.update({d:"M".concat(p.x,",").concat(p.y," L").concat(v.x,",").concat(v.y),"stroke-width":g}),[e,n,r,a,s].forEach((function(t){return t.group.css({visibility:"hidden"})})),this.resizeRotatePoints.forEach((function(t){return t.group.css({visibility:"initial"})})),mr(t)&&[i,o,c,l].forEach((function(t){return t.group.css({visibility:"hidden"})}))}}},{key:"bindEvent",value:function(){var t,e,n,r,a,i,o,c,l=this,u=this.cell,d=this.eventHelper,h=u.diagram,f=h.viewport.zoom,p=function(){if(t&&e&&i&&r.points){var n;if("rotate"===t){var a=[e.x+e.w/2,e.y+e.h/2];return r.points.map((function(t){var e=[t[0],t[1]];return e=Qd(e,a,no(i.r)),kr(u)?[].concat(D()(e),[t[2]]):e}))}var o=[0,0],c=1,l=1;switch(null===(n=ud.get(0))||void 0===n?void 0:n.get(t)){case 0:c=ro((o=[e.x,e.y])[0],i.x)?1:-1,l=ro(o[1],i.y)?1:-1;break;case 1:c=ro((o=[e.x+e.w,e.y])[0],i.x+i.w)?1:-1,l=ro(o[1],i.y)?1:-1;break;case 2:c=ro((o=[e.x+e.w,e.y+e.h])[0],i.x+i.w)?1:-1,l=ro(o[1],i.y+i.h)?1:-1;break;case 3:c=ro((o=[e.x,e.y+e.h])[0],i.x)?1:-1,l=ro(o[1],i.y+i.h)?1:-1}for(var s=i.w/e.w*c,d=i.h/e.h*l,h=[],f=0;f<r.points.length;f++){var p=r.points[f],m=Vd(Ud(Zd(p,o),s),o),v=b()(m,1)[0],y=Vd(Ud(Zd(p,o),d),o),g=b()(y,2)[1];h.push(kr(u)?[v,g,p[2]]:[v,g])}return h}};function m(){var e,n,r,a,o;if(Cr(u))return{points:p()};var c,l,s={x:null===(e=i)||void 0===e?void 0:e.x,y:null===(n=i)||void 0===n?void 0:n.y,width:null===(r=i)||void 0===r?void 0:r.w,height:null===(a=i)||void 0===a?void 0:a.h,rotate:null===(o=i)||void 0===o?void 0:o.r};return"lc"===t||"rc"===t?s.height=void 0:"tc"!==t&&"bc"!==t||(s.width=void 0),mr(u)&&(s={width:Je(null===(c=i)||void 0===c?void 0:c.w,u.getMinWidth(),1/0),height:Je(null===(l=i)||void 0===l?void 0:l.h,u.minHeight,1/0)}),s}this.resizeRotatePoints.forEach((function(a){var i=a.shape,l=a.name;d.bind(i,"mousedown",(function(a){if(h.contentEditor.unbind(),t=l,n=h.viewport.invertClient([a.clientX,a.clientY]),Cr(u)){r={points:s()(u.points)};var i=u.getPointBox();e={x:i.x,y:i.y,w:i.width,h:i.height,r:0}}else r={x:u.x,y:u.y,width:u.width,height:u.height,rotate:u.rotate},e={x:u.x,y:u.y,w:u.width,h:u.height,r:u.rotate};h.align.updateToAlginPoints(u),h.align.prepareForLength(u),"tc"!==t&&"bc"!==t||(h.align.preventAlignX=!0),"lc"!==t&&"rc"!==t||(h.align.preventAlignY=!0);var d=new Ln(e);c=bo(d.tl.x,d.tl.y,d.br.x,d.br.y),o=bo(d.tr.x,d.tr.y,d.bl.x,d.bl.y)}))})),d.bind(h,"mousemove",(function(r){if(t){var s=h.viewport.invertClient([r.clientX,r.clientY]),d=h.signal.keydown.Shift||u.constraints&&u.constraints.proportion;if(e)if("rotate"===t&&n)w={x:n[0],y:n[1]},C={x:s[0],y:s[1]},O=d&&15,E=Sn(A=e),P=jn(E,w,C),(S=A.r+P)>=180&&(S-=360),S<=-180&&(S+=360),O&&(S=O*Math.round(S/O)),i=wn(wn({},A),{},{r:S}),l.alignRotate(i),h.emit("cellrotate",{cell:u,rotate:i.r});else{var f=("tl"===t||"br"===t)&&c||("bl"===t||"tr"===t)&&o;d&&("rc"!==t&&"bc"!==t||(f=c),"lc"!==t&&"tc"!==t||(f=o));var p=f&&f.f(s[0]);s[1]=d&&p?p:s[1];var v,y=h.align.alignByPoint({x:s[0],y:s[1],weight:1,box:u.getBBox()});s[0]+=y.dx,s[1]+=y.dy,d&&f&&(0!==y.dx?(v=f.f(s[0]))&&(s[1]=v):0!==y.dy&&(v=f.fy(s[1]))&&(s[0]=v)),d&&("rc"===t?t="br":"lc"===t?t="bl":"tc"===t?t="tr":"bc"===t&&(t="br")),(i=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Ln(n),i=null,o=[],c=t;if(r){switch(e){case"tl":case"br":o=[a.tl,a.br];break;case"tr":case"bl":o=[a.tr,a.bl];break;case"tc":case"bc":o=[a.tc,a.bc],i="height";break;case"lc":case"rc":o=[a.lc,a.rc],i="width";break;default:o=[]}2===o.length&&(c=Rn(o,t))}var l=[];switch(e){case"tl":l=[a.br];break;case"tr":l=[a.bl];break;case"bl":l=[a.tr];break;case"br":l=[a.tl];break;case"bc":l=[a.tl,a.tr];break;case"tc":l=[a.bl,a.br];break;case"lc":l=[a.tr,a.br];break;case"rc":l=[a.tl,a.bl];break;default:l=[]}var s,u=l.length;return 1===u?s=function(t,e,n){var r=An(t,e),a=En(e,r,-n),i=a.x,o=a.y,c=Math.abs(2*(i-r.x)),l=Math.abs(2*(o-r.y));return{x:r.x-c/2,y:r.y-l/2,w:c,h:l,r:n}}(l[0],c,n.r):2===u&&(s=r?function(t,e,n,r){var a,i,o=b()(t,2),c=o[0],l=o[1],s=An(c,l),u=e,d=An(s,u),h=Pn(s,u),f=n.w/n.h;return"width"===r?i=(a=h)/f:a=f*(i=h),{x:d.x-a/2,y:d.y-i/2,w:a,h:i,r:n.r}}(l,c,n,i):function(t,e,n){var r=t.map((function(t){return On(t,-n)})),a=b()(r,2),i=a[0],o=a[1],c=On(e,-n),l=0,s=0,u={x:0,y:0};ro(i.y,o.y)?(l=Math.abs(i.x-o.x),s=Math.abs(c.y-i.y),u={x:(i.x+o.x)/2,y:(i.y+c.y)/2}):ro(i.x,o.x)&&(s=Math.abs(i.y-o.y),l=Math.abs(c.x-i.x),u={x:(i.x+c.x)/2,y:(i.y+o.y)/2});var d=On(u,n);return{x:d.x-l/2,y:d.y-s/2,w:l,h:s,r:n}}(l,c,n.r)),s}({x:s[0],y:s[1]},t,e))&&!mr(l.cell)&&h.align.alignByLength(i,t,d)}if(h.update(u,m()),l.update(),-1!==["tl","bl","tr","br"].indexOf(t)){var g=bi(h.viewport.invertClient([r.clientX,r.clientY]),u.getBBox(),Math.PI/8);h.setCursor(g)}h.signal.vertexResizing=!0,h.emit("vertexresizestart")}else if(r.target.dataset.vertex_resize_controller){var x;if("line"===r.target.dataset.type){var k=Qn(r.target.getAttribute("d"));x=bi([k[1][1]-k[0][1],k[1][2]-k[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}else x=xi(h.viewport.invertClient([r.clientX,r.clientY]),u.getBBox());a||(a=!0),l.cursors[x]&&h.setCursor(x)}else a&&(h.resetCursor(),a=void 0);var w,C,A,O,E,P,S})),d.bind(h,"mouseup",(function(){h.emit("vertexresizeend"),i&&e&&(e.x!==i.x||e.y!==i.y||e.w!==i.w||e.h!==i.h||e.r!==i.r)&&(yr(u)?h.command.execute("UpdateSwimlane",{id:u,model:m(),originModels:[r]}):h.command.execute("Update",{id:u,model:m(),originModels:[r]}),h.signal.vertexResizing=!1,h.emit("aftervertexresize")),t=void 0,e=void 0,i=void 0,n=void 0,a=void 0,r=void 0,h.align.reset()})),d.bind(h,"afterviewportchange",Bt()((function(){f!==h.viewport.zoom&&(l.update(),f=h.viewport.zoom)}))),d.bind(h,"vertexresizestart",(function(){return l.hide()})),d.bind(h,"vertexresizeend",(function(){return l.show()}))}},{key:"hide",value:function(){this.group.css({display:"none"}),this.controlPointsManager.hide()}},{key:"show",value:function(){this.group.css({display:"initial"}),this.controlPointsManager.show()}},{key:"begin",value:function(){this.cell.diagram.frontRootGroup.add(this.group),this.controlPointsManager.begin(),this.update(),this.show(),Cr(this.cell)&&this.cell.points.length<=2||this.bindEvent()}},{key:"end",value:function(){this.hide(),this.eventHelper.unbind(),this.controlPointsManager.end(),this.diagram&&this.diagram.align.reset()}},{key:"destroy",value:function(){this.controlPointsManager.destroy(),this.diagram&&this.diagram.resetCursor(),this.eventHelper.unbind(),this.group&&this.group.remove()}},{key:"alignRotate",value:function(t){t.r=Math.ceil(t.r);for(var e=[-180,-90,0,90,180],n=0;n<e.length;n++){var r=e[n];if(ro(t.r,r,4)){t.r=r;break}}}}]),t}();c()(rh,"className","VertexRotateResize");var ah=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),(r=e.call(this)).diagram=t;var a=r.diagram.signal.keydown;function i(t,e){var n=function(t){return function(t){return pt.ua.macos?"Meta"===t.key:"Control"===t.key}(t)?["Mod",t.key]:["Alt","Shift"].includes(t.key)&&[t.key]}(t);n&&n.forEach((function(t){a[t]=e}))}return r.bind(window,"keydown",(function(t){i(t,!0)})),r.bind(window,"keyup",(function(t){i(t,!1)})),r.bind(window,"blur",(function(){for(var t in a)a[t]=!1})),r}return y()(n)}();c()(ah,"className","KeyboardPressKey");var ih=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"aftercommandexecute",(function(t){var e=t.command,n=t.commandName;if(!("Add"!==n&&"AddVertex"!==n&&"AddStack"!==n&&"AddStackVertex"!==n||"geometry"!==e.model.type&&"stack"!==e.model.type)){var a;try{a=JSON.parse(r.LocalStorageUtil.getItem("lake_diagram_graphic_latest_used"))||[]}catch(t){a=[]}var i=e.model.shape,o=sc.findIndex((function(t){return t.name===i}));if(o>=0){var c=sc[o],l=a.findIndex((function(t){return t.name===i}));if(l>=0){var s=a.splice(l,1);a.unshift(s[0])}else a.unshift({name:i,category:c.category}),a.length>6&&a.pop();r.LocalStorageUtil.setItem("lake_diagram_graphic_latest_used",JSON.stringify(a))}}}))}}]),n}();var oh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"updateControlPoints",value:function(t){var e=this.beforeData,n=this.afterData;t.forEach((function(t){var r=t.model,a=r.controlPoints,i=[0,0];["source","target"].forEach((function(t){var a=r[t]&&r[t].id||"".concat(r.id,"-").concat(t);if(a){var o=e[a],c=n[a];if(i&&o&&c){var l=w.vec2.sub([],c.slice(0,2),o.slice(0,2));i=cn(l,[0,0])?null:w.vec2.add(i,i,l)}}})),i&&!cn(i,[0,0])&&(i=i.map((function(t){return t/2})),Ft()(e["".concat(r.id,"-controlPoints")],n["".concat(r.id,"-controlPoints")])&&t.update({controlPoints:a.map((function(t){return[t[0]+i[0],t[1]+i[1],t[2]]}))}))}))}},{key:"getData",value:function(t){var e={},n=this.diagram;return t.forEach((function(t){var r=t.model;["source","target"].forEach((function(t){var a=r[t]&&r[t].id;if(a){var i=n.find(a),o=i.percentage2Canvas([.5,.5]);e[i.model.id]=[o.x,o.y]}else r[t].connection&&(e["".concat(r.id,"-").concat(t)]=r[t].connection)})),e["".concat(r.id,"-controlPoints")]=s()(t.controlPoints)})),e}},{key:"getLines",value:function(){return this.diagram.getCells().filter((function(t){return t.isLine})).filter((function(t){return t.isDrawable()&&t.model.controlPoints}))}},{key:"onBeforeChange",value:function(){var t=this.getLines();this.beforeData=this.getData(t)}},{key:"onAfterChange",value:function(){var t=this.getLines();this.afterData=this.getData(t),this.updateControlPoints(t)}},{key:"reset",value:function(){this.beforeData={},this.afterData={}}},{key:"init",value:function(){var t=this.diagram;this.reset(),this.bind(t,"beforechange",this.onBeforeChange.bind(this)),this.bind(t,"afterchange",this.onAfterChange.bind(this))}}]),n}();var ch=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.groups=[]}},{key:"_calculateGroups",value:function(t,e){var n=[];t.concat(e).forEach((function(t){for(var e=t.parent;e&&!n.includes(e);)e.isGroup&&n.push(e),e=e.parent})),this.groups=n.sort((function(t,e){return e.depth-t.depth}))}},{key:"_draw",value:function(){var t=this.groups,e=this.diagram,n=this.action,r=e.rootGroup;t.forEach((function(t){if("add"===n){var e=t.getAllChildren(),a=e.length;if(a>0){e.sort((function(t,e){return t.getZIndex()-e.getZIndex()}));var i=e[a-1];r.insertBefore(t.graphicGroup,i.graphicGroup),r.insertBefore(i.graphicGroup,t.graphicGroup)}}t.draw()}))}},{key:"_initEvent",value:function(){var t=this.diagram;this.bind(t,"beforechange",this._onBeforeChange.bind(this)),this.bind(t,"afterchange",this._onAfterChange.bind(this))}},{key:"_onBeforeChange",value:function(t){var e=t.stems,n=t.relatedLines,r=t.action;this.destroyed||"remove"===r&&this._calculateGroups(e,n)}},{key:"_onAfterChange",value:function(t){var e=t.stems,n=t.relatedLines,r=t.action;this.destroyed||("update"!==r&&"add"!==r||this._calculateGroups(e,n),this.action=r,this._draw(),this._initParam())}}]),n}();var lh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"afterchange",(function(e){if(e){var n=e.models,r=e.action;"remove"===r?function(t,e){e.forEach((function(e){t.emit("vertexcell:remove",{id:e.id})}))}(t,n):"update"===r&&function(t,e){for(var n={},r=!1,a=function(){var a=e[i],o=t.find(a.id),c=["x","y","width","height","shape","rotate","controlPoints","round"];lr(o)&&c.push("html"),mr(o)&&c.push("html"),yr(o)&&c.push("widths","heights"),Cr(o)&&c.push("points");var l,s=!1;mr(o)&&(a.hasOwnProperty("width"),s=!0),(ur(o)||fr(o)||mr(o)||yr(o)||Cr(o))&&c.some((function(t){return null!=a[t]}))&&(s=!0),s&&(n[a.id]=!0,r||(function(t){for(;t.parent;){if(t.parent.state.selected)return!0;t=t.parent}return!1}(o)||t.selector.selections.length>1)&&(r=!0),o.state.selected&&(Cr(o)?t.drawBaseResizer.update():t.vertexRotateResize.update()),null===(l=t.swimlaneResize)||void 0===l||l.update(),t.emit("vertexcell:update",{cell:o}))},i=0;i<e.length;i++)a();r&&t.groupRotateResize.update()}(t,n)}}))}}]),n}();var sh={default:{insertParagraphKey:function(t){return"Enter"===t.key},cancelKey:function(t){return"Escape"===t.key}}},uh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=t.contentEditor;function n(){if(!t.signal.mouseMultiSelecting){var n=t.selector.selections,r=n[0];if(1===n.length&&r&&r.textareaElement&&r.canText()){var a=r.textareaElement;if(t.destroyed)return;var i=a.htmlContainer;if(e.dom&&e.dom!==i&&e.unbind(),!e.dom&&t.viewportContainer.contains(i)){var o=sh[r.type]||sh.default;e.bind(i,o)}e.isBegin||e.prepareEdit()}else e.unbind(),t.focus()}}var r=Nt()(n,32);this.bind(t,"afterselect",(function(){t.signal.beforePasteSelect?r():n()})),this.bind(t,"keydown",(function(n){if(!(t.selector.selections.length>1)&&n.key&&["Up","ArrowUp","Left","ArrowLeft","Down","ArrowDown","Right","ArrowRight"].includes(n.key)){var r=t.getCell(n.target);sr(r)&&(e.unbind(),t.focus())}})),this.bind(t,"mousedown",(function(e){var n=t.getCell(e.target);n&&n.textareaElement&&!n.textareaElement.htmlContainer.contains(e.target)&&e.preventDefault()})),this.bind(t,"dblclick",(function(n){var r=n.target,a=n.clientX,i=n.clientY,o=t.getCell(r);if(o&&o.state.selected&&o.textareaElement&&!t.contentEditor.isBegin&&o.canText()){t.selector.selections.length>1&&t.selector.select([o]),e.prepareEdit(),e.beginEdit();var c={};if(sr(o)&&function(t){var e=(new DOMParser).parseFromString(t,"text/html").body;if(0===e.childElementCount){if(""===e.innerText)return!0}else if(1===e.childElementCount){var n;if("​"===(null===(n=e.firstElementChild)||void 0===n?void 0:n.innerText))return!0}return!1}(o.html)){var l=t.viewport.invertClient([a,i]),s=o.getKeyShape().getClosestPoint(l[0],l[1]);c.textPosition=s.percentage}t.update(o,c)}})),this.bind(t,"click",(function(e){var n=t.getCell(e.target);if(n&&n.textareaElement&&n.textareaElement.htmlContainer.contains(e.target)&&"A"===e.target.tagName){if(t.signal.keydown.Mod){var r=e.target.getAttribute("href");if(r)return void window.open(r,"_blank")}e.preventDefault()}}))}}],[{key:"registerContentEditorOptions",value:function(t,e){sh[t]=e}}]),n}();var dh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e;this.bind(t,"afteractivedgroupchange",(function(){e&&(e.updateState(),e=null);var n=t.groupManager.group;n&&(n.updateState(),e=n)}))}}]),n}();var hh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"afterselect",(function(e){var n=e.selections;n.length>1?t.highlight.select(n.filter((function(t){return t.multiSelectHighlight}))):t.highlight.clear()}))}}]),n}();var fh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"resizer",void 0),c()(E()(t),"selections",[]),c()(E()(t),"cell",void 0),t}return y()(n,[{key:"init",value:function(t){var e=this,n=t.groupRotateResize,r=t.vertexRotateResize,a=t.swimlaneResize,i=t.drawBaseResizer;this.bind(t,"afterselect",(function(t){var o,c=t.selections;if(e.selections=c,e.resizer&&(e.resizer.end(),e.resizer=void 0),1===c.length)o=c[0],fr(o)?e.resizer=n:ur(o)||mr(o)||dr(o)||hr(o)?e.resizer=r:yr(o)||gr(o)?e.resizer=a:Cr(o)&&(e.resizer=i);else{var l=e.selections.filter((function(t){return!xr(t)}));l.length>1&&(e.resizer=n,o=l)}e.resizer&&(e.cell=o,e.resizer.init(o),e.resizer.begin())})),this.bind(t,"aftercommandbackward",(function(){e.resizer&&(e.resizer.end(),e.resizer.init(e.cell),e.resizer.begin())})),this.bind(t,"aftercommandforward",(function(){e.resizer&&(e.resizer.end(),e.resizer.init(e.cell),e.resizer.begin())})),this.bind(t,"cell:dragstart",(function(){e.resizer&&e.resizer.hide()})),this.bind(t,"cell:dragend",(function(){e.resizer&&(e.resizer.update(),e.resizer.show())}))}}]),n}();var ph=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"beforechange",(function(t){var e=t.action,n=t.arr;"update"===e&&n.forEach((function(t){var e=t.cell,n=t.model;if(n.shape){if("geometry"!==e.type)return;var r=sc.find((function(t){return t.name===n.shape}));["controlPoints","round"].forEach((function(t){var a=null==r?void 0:r[t];a?n[t]=a:(delete e.model[t],delete e[t])}))}}))}))}}]),n}();function mh(t){var e={stems:[],originModels:[]};return t.forEach((function(t){t.deepEach((function(t){if(!t.isStem)return!1;!function(t){var n=function(t){var e,n=t.model;return sr(t)?e={type:n.type,source:s()(n.source),target:s()(n.target)}:kr(t)||wr(t)?e={type:n.type,points:s()(n.points)}:t.isGroup||(e={type:n.type,x:t.x,y:t.y}),e}(t);n&&Object.keys(n).length>0&&(e.stems.push(t),e.originModels.push(n))}(t)}),(function(e){return"swimlane"===e.type?e.contain.map((function(e){var n;return null===(n=t.diagram.find(e))||void 0===n?void 0:n.model})).filter((function(t){return t})):e.children}))})),e}var vh=[],yh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(){this._initParam(),this._initEvent()}},{key:"_initParam",value:function(){this.originModels=null,this.stems=null,this.dx=0,this.dy=0,this.prepare=!1,this.selectionIds=void 0}},{key:"executeCommand",value:function(){var t=this.diagram,e=this.stems,n=this.dx,r=this.dy,a=this.originModels,i=this.selectionIds;!t.destroyed&&a&&(t.command.execute("Update",{id:e,model:Id(e,n,r),originModels:a,select:function(){t.selector.select(i)}}),this._initParam())}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"keydown",(function(n){var r,a=e.selector.selections,i=a.filter((function(t){return vh.every((function(e){return e(t)}))})),o=0,c=0;if(!(i.length<=0)){switch(t.selectionIds=a.map((function(t){return t.model.id})),r=n.shiftKey?10:1,n.key){case"Left":case"ArrowLeft":o=-r;break;case"Right":case"ArrowRight":o=r;break;case"Up":case"ArrowUp":c=-r;break;case"Down":case"ArrowDown":c=r;break;default:return}if(0!==o||0!==c){var l=mh(i),s=l.stems,u=l.originModels;t.originModels=t.originModels||u,t.prepare||(t.prepare=!0,e.align.updateToAlginPoints(a));var d=Er(a),h=e.align.alignByBox({minX:d.minX+o,minY:d.minY+c,maxX:d.maxX+o,maxY:d.maxY+c}),f=!1;Math.abs(h.dx)<1&&0!==h.dx&&(f=!0,o+=h.dx),Math.abs(h.dy)<1&&0!==h.dy&&(f=!0,c+=h.dy),f||e.align.clear(),n.preventDefault(),e.update(s,Id(s,o,c)),t.stems=s}}})),this.bind(e,"keyup",Nt()((function(){t.executeCommand()}),400))}}],[{key:"filterCell",value:function(t){vh.push(t)}}]),n}();var gh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){0!==t.selector.selections.length||"s"!==e.key||Si(e)||(e.preventDefault(),t.command.execute("BeginInsertGeometry"))}))}}]),n}();var bh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=this;this.bind(t,"keydown",(function(n){if(Si(n)&&"l"===n.key){n.preventDefault();var r=t.selector.selections;if(e.cell=r[0],2===r.length&&r.every((function(t){return!t.isLine&&!t.isGroup})))return t.command.execute("Add",{model:{type:"line",shape:null,source:{id:r[0].model.id},target:{id:r[1].model.id,marker:"arrow"}}});t.command.execute("BeginInsertLine",{shape:null,marker:"arrow"})}}))}}]),n}();var xh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){0!==t.selector.selections.length||"t"!==e.key||Si(e)||(e.preventDefault(),t.command.execute("BeginInsertText"))}))}}]),n}();var kh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){t.selector.selections.some((function(t){return t.textareaElement}))&&Si(e)&&("b"===e.key?(e.preventDefault(),t.command.execute("ContentCommand",{name:"bold"})):"i"===e.key?t.command.execute("ContentCommand",{name:"italic"}):"k"===e.key?t.command.execute("CreateLink"):"u"===e.key?t.command.execute("ContentCommand",{name:"underline"}):e.shiftKey&&"x"===e.key&&t.command.execute("ContentCommand",{name:"strikethrough"}))}))}}]),n}();var wh=new Ac,Ch=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){var n=t.selector,r=t.viewport;n.selections.length>0&&"d"===e.key&&Si(e)&&(e.preventDefault(),t.command.execute("Copy",{e:wh}),t.command.execute("Paste",{e:wh,focusPoint:r.getFocus()}))}))}}]),n}();function Ah(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Oh(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ah(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ah(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Eh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){if(!Si(e)&&["Backspace","Delete"].includes(e.key)){if(e.preventDefault(),t.selector.selections.every((function(t){return xr(t)}))||t.selector.selections.every((function(t){return hr(t)})))return;var n=t.deduplicate(t.selector.selections);if(1===n.length&&n[0].isMindmap){var r=n[0],a=r.graphicGroup.rendererElement.querySelector('[data-lake-mindmap-icon-selected="true"]');if(a){var i=a.getAttribute("lake-mindmap-icon-key"),o={icons:Oh(Oh({},r.model.icons||{}),{},c()({},i,null))};return t.command.execute("Update",{id:r.model.id,model:o,notSelect:!0}),void t.tryFocus()}}t.command.execute("Delete",{cells:n.map((function(t){return t.model.id}))}),t.tryFocus()}}))}}]),n}();var Ph=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){var n=t.selector;t.groupManager.group&&"Escape"===e.key&&!Si(e)&&(e.preventDefault(),n.clear())}))}}]),n}();var Sh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){"g"===e.key&&Si(e)&&!e.shiftKey?(e.preventDefault(),t.command.execute("MakeGroup")):("g"===e.key||"G"===e.key)&&Si(e)&&e.shiftKey&&(e.preventDefault(),t.command.execute("Ungroup"))}))}}]),n}();var Mh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){var n;e.altKey&&(n={ArrowLeft:"AlignLeft",ArrowRight:"AlignRight",ArrowUp:"AlignTop",ArrowDown:"AlignBottom",KeyH:"AlignHCenter",KeyV:"AlignVCenter"}[e.code]),Si(e)&&(n=(e.altKey?{BracketLeft:"Backward",BracketRight:"Forward"}:{BracketLeft:"ToBack",BracketRight:"ToFront"})[e.code]),n&&(e.preventDefault(),t.command.execute(n))}))}}]),n}();var jh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){Si(e)&&"a"===e.key&&(e.preventDefault(),e.stopPropagation(),t.command.execute("SelectAll"),t.tryFocus())}))}}]),n}();var Rh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=function(){t.lineAlign.setEnable(!1),t.lineAlign.reset()};this.bind(window,"keydown",(function(){t.signal.keydown.Shift&&t.lineAlign.setEnable(!0)})),this.bind(window,"keyup",(function(){t.signal.keydown.Shift||e()})),this.bind(window,"blur",(function(){e()}))}}]),n}();function Lh(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bh(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lh(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lh(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Dh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),t=e.call(this),c()(E()(t),"updateLine",(function(e){var n=E()(t),r=n.diagram,a=n.line,i=n.origin,o=n.sourceCell,c=r.viewport.invertClient([e.clientX,e.clientY]);if(i&&!a&&o&&lo(i[0],i[1],c[0],c[1])>8)t.line=r.add(t.initLine(c))[0],t.line.graphicGroup.css({cursor:"crosshair"}),r.lineResizer.init(t.line,"target"),r.setCursor("crosshair"),t.clearButton();else if(a){var l=r.lineResizer.resize(e);r.update(a,xt()({},r.settings.line,{target:l}))}})),c()(E()(t),"commitLine",(function(e){var n=E()(t),r=n.line,a=n.diagram,i=n.origin,o=n.sourceCell;if(r||i){var c;if(r)c=r.model,a.remove(r);else if(i){t.updateCurrentDirection(e);var l=t.getTargetConnection(t.currentDirection);c=t.initLine(l)}var s=Object(F.a)();a.command.execute("Add",{model:Bh(Bh({},c),{},{id:s})}),t.clear(),null==c.target.id&&requestAnimationFrame((function(){a.emit("vertexcell:prompt",{line:a.find(s),sourceCell:o})}))}})),c()(E()(t),"revertLine",(function(e){var n=E()(t),r=n.line,a=n.diagram;r&&("Esc"!==e.key&&"Escape"!==e.key||(a.remove(r),t.clear()))})),t.cacheEndpointId=null,t.eventHelper=new hl,t}return y()(n,[{key:"_initHoverButtonDefs",value:function(){var t=this.diagram.defs,e=Object(F.a)(),n=new ha({id:e,fill:"rgba(95, 159, 246, 0.6)",stroke:"rgba(255,255,255,0.15)","stroke-width":1,d:Gn(0,0,5)});t.add(n),this.hoverButtonDefId=e,this.hoverButtonDef=n}},{key:"_initButtonDefs",value:function(){var t=this.diagram.defs,e=Object(F.a)(),n=new ha({id:e,fill:"rgba(51, 132, 245, 0.3)",stroke:"rgba(255,255,255,0.15)","stroke-width":1,d:Gn(0,0,3.5)});t.add(n),this.buttonDefId=e,this.buttonDef=n}},{key:"_initDefs",value:function(){this._initHoverButtonDefs(),this._initButtonDefs()}},{key:"_initButton",value:function(){var t=this,e=this.buttonDefId,n=this.hoverButtonDefId,r=this.diagram,a=new na,i={};["N","E","S","W"].forEach((function(o){var c=new oa,l=new Ba({width:15.27,height:15.27,href:"#".concat(e)}),s=new ha({fill:"rgba(0,0,0,0)",d:Jn(-7.635,-7.635,15.27,15.27)});c.add(l),c.add(s),l.css("pointer-events","none"),s.dataset({testid:"add_line_button_".concat(o)}),s.on("mousedown",(function(n){var a=r.viewport.invertClient([n.clientX,n.clientY]),i=b()(a,2),c=i[0],s=i[1];t.origin=[c,s],l.update({href:"#".concat(e)}),t.updateCurrentDirection(o),r.emit("addlinebuttonmousedown"),r.vertexRotateResize.hide()})),s.on("mouseenter",(function(){r.signal.mouseMultiSelecting||l.update({href:"#".concat(n)})})),s.on("mouseleave",(function(){l.update({href:"#".concat(e)})})),a.add(c),i[o]=c})),a.css({cursor:"copy"}),a.dataset({lake_prevent_click_unselect:!0,testid:"add_line_button_group"}),this.buttonMap=i,this.buttonGroup=a}},{key:"updateButton",value:function(){var t=this.diagram,e=this.sourceCell,n=this.buttonGroup,r=this.buttonMap;if(e){var a=1/t.viewport.zoom,i=e.rotate,o=e.width,c=e.height,l=16/t.viewport.zoom;0===o&&(o=1/0),0===c&&(c=1/0),t.frontRootGroup.add(n),Object.keys(r).forEach((function(t){var n,s=r[t];switch(t){case"N":n=e.percentage2Canvas([.5,-l/c]);break;case"E":n=e.percentage2Canvas([1+l/o,.5]);break;case"S":n=e.percentage2Canvas([.5,1+l/c]);break;case"W":n=e.percentage2Canvas([-l/o,.5])}s.update(Bh(Bh({},n),{},{scale:a,rotate:i}))}))}}},{key:"clearButton",value:function(){var t=this.showButtonGroup;t&&(t.remove(),this.showButtonGroup=null)}},{key:"hide",value:function(){this.buttonGroup.hide()}},{key:"show",value:function(){this.buttonGroup.show()}},{key:"initLine",value:function(t){var e=this.sourceCell,n=this.currentDirection,r=this.diagram,a={type:"line",source:{id:e.model.id,connection:n},target:{connection:t}};return r.hooks.decorateAddLineModel.call(a),a}},{key:"getTargetConnection",value:function(t){var e=this.sourceCell,n=e.getPoint(t),r=n.x,a=n.y,i=e.rotate;switch(t){case"N":i+=270;break;case"E":break;case"S":i+=90;break;case"W":i+=180;break;default:throw new Error("unexpected direction ".concat(t))}var o=no(i);return[r+50*Math.cos(o),a+50*Math.sin(o)]}},{key:"updateCurrentDirection",value:function(t){var e=this.diagram;if("string"==typeof t)this.currentDirection=t;else{var n=e.viewport.invertClient([t.clientX,t.clientY]),r=b()(n,2),a=r[0],i=r[1],o=this.sourceCell,c=o.getPoint([.5,.5]);if(lo(c.x,c.y,n[0],n[1])>16){var l=ho(c.x,c.y,a,i),s=o.rotate;s<0&&(s+=360);var u=l-(s=no(s));u<0&&(u+=2*Math.PI),this.currentDirection=Xi(u)}}}},{key:"updateBoundingRect",value:function(t){var e=t.graphicGroup.getBoundingClientRect(),n=e.x,r=e.y,a=r-15.27-16,i=n+e.width+15.27+16,o=r+e.height+15.27+16,c=n-15.27-16;this.boundingRect={top:a,right:i,bottom:o,left:c}}},{key:"update",value:function(t){t&&(this.sourceCell=t,this.showButtonGroup=this.buttonGroup,this.updateBoundingRect(t),this.updateButton())}},{key:"clear",value:function(){this.diagram.lineResizer.reset(),this.clearButton(),this.sourceCell=null,this.boundingRect=null,this.origin=null,this.line=null,this.diagram.resetCursor()}},{key:"init",value:function(t){var e,n=this,r=t.selector;this._initDefs(),this._initButton(),this.eventHelper.bind(t,"afterviewportchange",Bt()((function(){e!==t.viewport.zoom&&n.sourceCell&&(n.updateButton(),e=t.viewport.zoom)}))),this.bind(t,"afterselect",(function(){var e=r.selections,a=e[0];1!==e.length||a.isLine||!a.canUseAddLineButton()||n.line||t.signal.cellDragStart?n.clear():n.update(a)})),this.bind(t,"vertexcell:update",(function(t){t.cell===n.sourceCell&&n.updateButton()})),this.bind(t,"vertexcell:remove",(function(t){var e=t.id,r=n.sourceCell;r&&r.model.id===e&&n.clear()})),this.bind(t,"cell:dragstart",(function(){n.clear()})),this.bind(t,"mousemove",Bt()((function(t){n.origin&&n.updateLine(t)}),16)),this.bind(t,"mouseup",this.commitLine),this.bind(t,"keydown",this.revertLine),this.bind(t,"vertexresizestart",(function(){return n.hide()})),this.bind(t,"vertexresizeend",(function(){return n.show()}))}},{key:"reset",value:function(){this.hoverButtonDef&&this.hoverButtonDef.destroy(),this.buttonDef&&this.buttonDef.destroy()}}]),n}(),Nh=function(){var t,e=window.appData;return"dark"===(null===(t=(void 0===e?{}:e).themeManager)||void 0===t?void 0:t.current)},_h=function(t){return Nh()?Wr[t]:Xr[t]},Ih=[{name:"rect",title:Mr("矩形")},{name:"rounded-rect",title:Mr("圆角矩形")},{name:"circle",title:Mr("圆形")},{name:"triangle",title:Mr("三角形")},{name:"diamond",title:Mr("菱形")},{name:"parallelogram",title:Mr("平行四边形")},{name:"trapezoid",title:Mr("梯形")},{name:"cross",title:Mr("十字")},{name:"comment-2",title:Mr("标注 2")},{name:"comment",title:Mr("标注")},{name:"polygon",title:Mr("五边形")},{name:"star",title:Mr("五角星")},{name:"arrow-1",title:Mr("左箭头")},{name:"arrow-2",title:Mr("右箭头")},{name:"arrow-3",title:Mr("双向箭头")},{name:"pentagon-arrow",title:Mr("五边箭头")},{name:"process-arrow",title:Mr("流程箭头")},{name:"cloud",title:Mr("云")}],Th=[{name:"swimlane-vertical",title:Mr("泳道垂直")},{name:"swimlane-horizontal",title:Mr("泳道水平")}],Fh=[{name:"pyramid",title:Mr("金字塔")},{name:"segmented pyramid",title:Mr("分段金字塔")},{name:"stage",title:Mr("阶段图")},{name:"architecture",title:Mr("架构图")}],zh=[{name:"process",title:Mr("过程")},{name:"decision",title:Mr("决策")},{name:"start-end",title:Mr("起止符")},{name:"subroutine",title:Mr("预定义流程")},{name:"document",title:Mr("文档")},{name:"multi-document",title:Mr("多文档")},{name:"manual-input",title:Mr("手动输入")},{name:"preparation",title:Mr("准备")},{name:"data",title:Mr("数据")},{name:"database",title:Mr("数据库")},{name:"hard-disk",title:Mr("硬盘")},{name:"internal-storage",title:Mr("内部存储")},{name:"paper-tape",title:Mr("条带")},{name:"manual-loop",title:Mr("手动循环")},{name:"delay",title:Mr("延迟")},{name:"stored-data",title:Mr("存储数据")},{name:"merge",title:Mr("合并")},{name:"connector",title:Mr("连接器")},{name:"or",title:Mr("或者")},{name:"summing-junction",title:Mr("汇总连接")},{name:"display",title:Mr("显示")},{name:"off-page",title:Mr("页外连接符")},{name:"loop-limit",title:Mr("循环起止符")},{name:"card",title:Mr("卡片")},{name:"sort",title:Mr("排序")},{name:"collate",title:Mr("整理")},{name:"parallel",title:Mr("并行模式")},{name:"annotation",title:Mr("批注")}],qh=[{name:"actor",title:Mr("角色")},{name:"use-case",title:Mr("用例")},{name:"package",title:Mr("包")},{name:"frame",title:Mr("组合片段")},{name:"constraint",title:Mr("约束")},{name:"note",title:Mr("注释")},{name:"class",title:Mr("类")},{name:"activity-class",title:Mr("活动类")},{name:"simple-class",title:Mr("简单类")},{name:"interface",title:Mr("接口")},{name:"multiplicity",title:Mr("多类例")},{name:"frequency",title:Mr("时间信号")},{name:"activation",title:Mr("激活")},{name:"entity",title:Mr("实体")},{name:"control",title:Mr("控制")},{name:"boundary",title:Mr("绑定")},{name:"deletion",title:Mr("删除")},{name:"state",title:Mr("状态")},{name:"object",title:Mr("对象")},{name:"start",title:Mr("开始")},{name:"finish",title:Mr("结束")},{name:"termination-pseudostate",title:Mr("流终止")},{name:"history-pseudostate",title:Mr("历史")},{name:"choice",title:Mr("分支")},{name:"activity",title:Mr("活动")},{name:"send-signal",title:Mr("发送信号")},{name:"receive-signal",title:Mr("接收信号")},{name:"fork",title:Mr("同步")},{name:"component",title:Mr("组件")},{name:"node",title:Mr("节点")}],Yh=[{name:"er-entity",title:Mr("实体")},{name:"weak-entity",title:Mr("弱实体")},{name:"derived-attribute",title:Mr("派生属性")},{name:"attribute",title:Mr("属性")},{name:"multivalued-attribute",title:Mr("多值属性")},{name:"relationship",title:Mr("关系")},{name:"weak-relationship",title:Mr("弱关系")},{name:"generalization",title:Mr("概化")},{name:"total-generalization",title:Mr("全部概化")}];function Hh(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Gh(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hh(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hh(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xh=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n);var a=Gh({width:32,height:32},t),i=a.width,o=a.height,c=a.noFill,l=t.matrix||[1,0,0,0,1,0,0,0,1];i>0&&(l[0]=i/32),o>0&&(l[4]=o/32),r=e.call(this,Gh(Gh({},t),{},{matrix:l}));var s=t.stencil,u=t.title,d=s.name,h=s.thumb,f=new Oa({x:0,y:0,width:i,height:o,rx:2,fill:c?"none":"#ffffff",stroke:"none"});return r.add(new Ra({title:u})),r.add(f),h.forEach((function(t){var e=mu(t);t.attr&&e.update(t.attr),r.add(e)})),E()(r).rendererElement.setAttribute("data-name",d),r.css({cursor:"pointer"}),r}return y()(n)}();var Wh=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),r=e.call(this,t),c()(E()(r),"shapes",void 0),c()(E()(r),"_height",0);var a=t.key,i=t.title,o=t.shapes;return r.shapes=o,r.title=i,r.rendererElement.setAttribute("data-group",a),r.init(),r}return y()(n,[{key:"init",value:function(){var t=this,e=12,n=0;if(0!==this.shapes.length){Nh();var r=new Sa({text:this.title,matrix:[1,0,0,0,1,0,12,15,1],fill:_h("text")});this.text=r,r.css({fontSize:"14px","dominant-baseline":"hanging"}),this.add(r),n+=39,this.shapes.forEach((function(r){var a=r.name,i=r.title,o=sc.find((function(t){return t.name===a}));e>=200&&(e=12,n+=34);var c=new Xh({stencil:o,matrix:[1,0,0,0,1,0,e,n,1],noFill:!0,stroke:_h("text"),fill:"transparent",title:i});t.add(c),e+=32})),n+=32,this._height=n}}},{key:"height",get:function(){return this._height}}]),n}();function Vh(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Zh(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vh(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vh(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Uh={basic:{title:Mr("基础图形"),shapes:Ih},flowchart:{title:Mr("流程图"),shapes:zh},UML:{title:Mr("UML"),shapes:qh},ER:{title:Mr("ER"),shapes:Yh},DSL:{title:Mr("Smart"),shapes:Fh}},Kh=function(t){S()(n,na);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n);var a=Zh({groups:["basic"]},t);return r=e.call(this,a),c()(E()(r),"latest",{title:Mr("最近使用"),shapes:[]}),c()(E()(r),"latestGroup",void 0),c()(E()(r),"shapeGroups",[]),c()(E()(r),"_height",0),c()(E()(r),"backgroundColor",void 0),c()(E()(r),"groupMap",void 0),c()(E()(r),"cancelThemeListener",void 0),r.groups=a.groups,r.containerHeight=a.containerHeight,r.init(),r.bindEvent(),r}return y()(n,[{key:"width",get:function(){return 215}},{key:"height",get:function(){return this._height}},{key:"init",value:function(){var t,e=this,n=this.options;this.backgroundColor=null!==(t=n.backgroundColor)&&void 0!==t?t:_h("background");var r=0;this.groupMap=s()(Uh);var a=this.groups.map((function(t){var n;if("latest"===t)(n=e.latest).shapes=e.getLatest();else{n=e.groupMap[t];var a=e.options.basicWithSwimlane;"basic"===t&&a&&(n.shapes=[].concat(D()(n.shapes),D()(Th)))}var i=r,o=new Wh(Zh(Zh({},n),{},{key:t,title:n.title}));return o.update({matrix:[1,0,0,0,1,0,0,i,1]}),r+=o.height,n.height=o.height,"latest"===t&&(e.latestGroup=o),e.shapeGroups.push(o),o}));this.background=new Oa({x:0,y:0,width:215,height:r,fill:this.backgroundColor}),this.add(this.background),a.forEach((function(t){return e.add(t)})),this.updateHeight(r)}},{key:"getLatest",value:function(){var t,e=r.LocalStorageUtil.getItem("lake_diagram_graphic_latest_used");try{t=JSON.parse(e)||[]}catch(e){t=[]}for(var n=function(){var e,n=t[a];n.title="";var r=null===(e=Uh[n.category])||void 0===e?void 0:e.shapes;if(r){var i=r.findIndex((function(t){return t.name===n.name}));i>=0&&(n.title=r[i].title)}},a=0;a<t.length;a++)n();return t}},{key:"bindEvent",value:function(){var t,e,n,r,a=this;this.on("mouseover",Bt()((function(t){for(var e=t.target.closest("[data-name]"),n=a.rendererElement.querySelectorAll("[data-name]"),r=0;r<n.length;r++){var i=n[r],o=i.querySelector("path");o&&o.setAttribute("fill",i===e?_h("hover"):"transparent")}}),16)),this.on("mouseleave",Bt()((function(){if(t){var e=t.querySelector("path");e&&e.setAttribute("fill","transparent")}}),16)),this.on("click",(function(e){var n=e.target.closest("[data-name]");if(n){var r,i=n.dataset.name,o=n.closest("[data-group]").dataset.group,c=sc[sc.findIndex((function(t){return t.name===i}))],l=(null==c||null===(r=c.outline)||void 0===r?void 0:r.attr)||{},s=c.type||"geometry",u=c.category;a.emit("shape:select",{shape:i,group:o,type:s,category:u,attr:l}),t=n}})),this.cancelThemeListener=(e=function(){a.init()},null==(r=(void 0===(n=window.appData)?{}:n).themeManager)?void 0:r.onChange(e))}},{key:"updateGroups",value:function(t){this.groups=t,this.init(),this.updatePosition()}},{key:"updatePosition",value:function(){var t=this,e=0;this.groups.forEach((function(n,r){var a,i=t.shapeGroups[r];a="latest"===n?t.latest:t.groupMap[n];var o=e;e+=a.height,i.update({matrix:[1,0,0,0,1,0,0,o,1]})})),this.updateHeight(e),this.emit("update:height",{height:e})}},{key:"updateHeight",value:function(t){var e=this.containerHeight,n=this.groups;this._height=e?t+(e-this.groupMap[n[n.length-1]].height):t,this._height+=6,this.background.update({d:Jn(0,0,215,this._height)})}},{key:"getOffset",value:function(t){for(var e=this.groups,n=e.indexOf(t),r=0,a=0;a<n;a++){var i=e[a];r+=this.groupMap[i].height}return r}},{key:"destroy",value:function(){this.cancelThemeListener&&this.cancelThemeListener(),_()(L()(n.prototype),"destroy",this).call(this)}}]),n}();function Qh(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qh(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qh(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Jh=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"onShapeSelect",(function(e){var n=e.shape,r=e.type,a=e.category,i=E()(t),o=i.diagram,c=i.line,l=i.sourceCell,s=c.target.connection,u=t.computeInheritedStyles(n,r),d=sc.find((function(t){return t.name===n})),h=t.adjustVertexPosition(s,n,l.stroke,d),f=b()(h,2),p=f[0],m=f[1],v={model:$h({shape:n,type:r,category:a,x:p,y:m},u),lineId:c.model.id,cellOptions:{}};o.hooks.decorateAddVertexModel.call(v.model);var y="AddVertex";["controlPoints","round"].forEach((function(t){null!=d&&d[t]&&!v.model[t]&&(v.model[t]=d[t])})),"stack"===r?(y="AddStackVertex",v.htmls=d.htmls,v.model.row=d.row):v.model.html=d.html||Ld,o.command.execute(y,v),t.closePanel()})),t}return y()(n,[{key:"initPanel",value:function(){var t=this.diagram.defs;this.filterId=Object(F.a)();var e=new Ga,n=new qa({dx:0,dy:0,stdDeviation:4,"flood-color":"rgba(0, 0, 0, 0.13)"});e.attr({id:this.filterId}),e.add(n),t.add(e)}},{key:"computeInheritedStyles",value:function(t,e){var n=this.sourceCell;if(n.type!==e)return{};var r=n.width,a=n.height,i={stroke:n.stroke,fill:n.fill};return n.shape===t&&(Object.assign(i,{width:r,height:a}),["controlPoints","round"].forEach((function(t){n[t]&&Object.assign(i,c()({},t,n[t]))}))),i}},{key:"closePanel",value:function(){var t=this.diagram,e=this.panel,n=t.frontRootGroup;e&&n.removeChild(e),t.signal.addVertexPanelVisibility=!1,this.direction=null,this.line=null,this.sourceCell=null}},{key:"adjustPanelPosition",value:function(t){var e=this.diagram,n=this.direction,r=this.panel,a=e.viewportContainer.getBoundingClientRect(),i=r.getBBox(),o=e.viewport.invertViewport([a.width-i.width-8,a.height-i.height-8]),c=Math.min(t[0]+8,o[0]),l=Math.min(t[1]+8,o[1]);return"N"===n?c<t[0]+8&&(c=t[0]-8-i.width):"E"===n?c<t[0]+8&&l<t[1]+8&&(l=t[1]-8-i.height):"S"===n?c<t[0]+8&&l<t[1]+8&&(c=t[0]-8-i.width):"W"===n&&l<t[1]+8&&(l=t[1]-8-i.height),[c,l]}},{key:"adjustVertexPosition",value:function(t,e,n,r){var a,i,o=this.direction,c=this.sourceCell,l=b()(t,2),s=l[0],u=l[1],d=(n.width||2)/2;switch(e===c.shape?(a=c.width,i=c.height):(a=r.width,i=r.height),o){case"N":s-=a/2,u-=i+d;break;case"E":s+=d,u-=i/2;break;case"S":u+=d,s-=a/2;break;case"W":s-=a+d,u-=i/2}return[s,u]}},{key:"getDirection",value:function(t){var e=Qn(t.d).slice(-2),n=e[0].slice(1),r=e[1].slice(1);return Xi({x:n[0],y:n[1]},{x:r[0],y:r[1]})}},{key:"updatePanel",value:function(t){var e=this.diagram,n=e.frontRootGroup,r=t.line,a=t.sourceCell,i=sc.find((function(t){return t.name===a.shape})),o=(null==i?void 0:i.category)||"basic",c=new Kh({groups:["latest",o]});c.css({filter:"url(#".concat(this.filterId,")")}),this.panel=c,this.panel.on("shape:select",this.onShapeSelect),n.add(this.panel),this.line=r,this.sourceCell=a,this.direction=this.getDirection(r);var l=r.target.connection,s=this.adjustPanelPosition(l),u=b()(s,2),d=u[0],h=u[1],f=1/e.viewport.zoom;this.panel.update({matrix:[f,0,0,0,f,0,d,h,1]}),e.signal.addVertexPanelVisibility=!0}},{key:"init",value:function(t){var e=this;this.diagram=t,this.line=null,this.sourceCell=null,this.direction=null,this.initPanel(),this.bind(t,"vertexcell:prompt",(function(t){return e.updatePanel(t)})),this.bind(t,"mousedown",(function(t){var n=e.panel;n&&!n.rendererElement.contains(t.target)&&e.closePanel()})),this.bind(t,"keyup",(function(t){!e.panel||"Esc"!==t.key&&"Escape"!==t.key||e.closePanel()}))}}]),n}();function tf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var ef=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"onMouseMove",(function(e){t.delegation||t.initDelegation();var n=E()(t).delegation,r=t.getPoint(e),a=b()(r,2),i=a[0],o=a[1];n.translate(i,o)})),c()(E()(t),"onClick",(function(e){t.clear();var n=E()(t).diagram,r=n.settings.image,a=r.insertFiles,i=r.insertModel,o=t.getPoint(e),c=b()(o,2),l=c[0],s=c[1];n.interaction.changeMode("edit"),n.emit("importimage",{files:a,x:l,y:s,from:"clickinsert",width:i.width,height:i.height})})),t}return y()(n,[{key:"getPoint",value:function(t){return this.diagram.viewport.invertClient([t.clientX,t.clientY])}},{key:"initDelegation",value:function(){var t=this.diagram,e=t.settings.image,n=t.add(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tf(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({type:"image",x:0,y:0},e.insertModel))[0];this.delegation=t.delegator.create([n]),this.cell=n,n.hide()}},{key:"init",value:function(t){var e=this;this.diagram=t,this.bind(t,"mousemove",this.onMouseMove),this.bind(t,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(e.clear(),t.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){t.canvas.rendererElement.contains(n.target)||(e.clear(),t.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var t=this.cell,e=this.delegation,n=this.diagram;t&&!t.destroyed&&n.remove(t.model.id),e&&e.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),_()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function nf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nf(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var af=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"line",void 0),c()(E()(t),"source",void 0),c()(E()(t),"target",void 0),c()(E()(t),"onMouseDown",(function(e){var n=E()(t).diagram,r=t.getPoint(e);t.source=n.connect.findEndPoint(r)})),c()(E()(t),"onMouseMove",(function(e){var n=E()(t),r=n.diagram,a=n.line,i=n.source,o=t.getPoint(e),c=r.connect.findEndPoint(o);if(a){var l=r.lineResizer.resize(e);r.update(a,{target:l})}else i&&function(t,e){return e.id!==t.id||(e.connection&&t.connection?lo(e.connection[0],e.connection[1],t.connection[0],t.connection[1])>8:void 0)}(i,c)&&t.beginInsertLine({source:i,target:c})})),c()(E()(t),"onMouseUp",(function(){var e=E()(t),n=e.diagram,r=e.line;t.clear(),n.interaction.changeMode("edit"),r&&n.command.execute("Add",{model:rf(rf({},r.model),{},{id:null})})})),t}return y()(n,[{key:"getPoint",value:function(t){return this.diagram.viewport.invertClient([t.clientX,t.clientY])}},{key:"beginInsertLine",value:function(t){var e=t.source,n=t.target,r=this.diagram;e.id&&(e.connection=null);var a=xt()({},r.settings.line,{type:"line",source:e,target:rf({},n)});r.hooks.decorateAddLineModel.call(a);var i=r.add(a)[0];this.line=i,r.lineResizer.init(i,"target")}},{key:"init",value:function(t){var e=this;this.diagram=t,this.bind(t,"begininsertline",(function(t){e.beginInsertLine(t)})),this.bind(t,"mousemove",this.onMouseMove),this.bind(t,"mousedown",this.onMouseDown),this.bind(t,"mouseup",this.onMouseUp),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(e.clear(),t.interaction.changeMode("edit"))}))}},{key:"clear",value:function(){var t=this.line,e=this.diagram;e&&(e.lineResizer.reset(),t&&e.remove(t),this.line=void 0,this.source=void 0)}},{key:"unbind",value:function(){this.clear(),_()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function of(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function cf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?of(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):of(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var lf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"delegation",void 0),c()(E()(t),"cell",void 0),c()(E()(t),"lastSwimlane",void 0),c()(E()(t),"onMouseMove",(function(e){t.delegation||t.initDelegation();var n=E()(t).diagram,r=E()(t).delegation,a=t.getPoint(e),i=b()(a,2),o=i[0],c=i[1];if(t.cell){var l;t.cell.matrix=[1,0,0,0,1,0,o,c,1];var s,u=null===(l=n.swimlane)||void 0===l?void 0:l.findSwimlane([t.cell]);if(u&&u!==t.lastSwimlane)null===(s=n.swimlane)||void 0===s||s.highlight(u);else if(!u){var d;null===(d=n.swimlane)||void 0===d||d.unhighlight()}t.lastSwimlane=u}null==r||r.translate(o,c)})),c()(E()(t),"onClick",(function(e){var n=E()(t).diagram;t.clear();var r=n.settings.vertex,a=t.getPoint(e),i=b()(a,2),o=i[0],c=i[1],l=Object(F.a)(),s=sc.find((function(t){return t.name===r.shape})),u={model:cf(cf({},r),{},{id:l,x:o,y:c})};null!=s&&s.controlPoints&&(u.model.controlPoints=s.controlPoints),null!=s&&s.round&&(u.model.round=s.round);var d="Add";if(n.interaction.changeMode("edit"),s)if("stack"===r.type)d="AddStack",u.model.row=s.row,u.htmls=s.htmls,delete u.model.html;else if("swimlane"===r.type)d="AddSwimlane",u.number=s.number,u.model.widths=s.widths,u.model.heights=s.heights,u.htmls=s.htmls,u.stencil=s,delete u.model.html;else if("dsl"===r.type){var h;d="AddDsl";var f=null===(h=s.parse)||void 0===h?void 0:h.call(s,s.htmls);u.models=null==f?void 0:f.models,delete u.model.html}n.hooks.decorateAddVertexModel.call(u.model),n.command.execute(d,u),delete r.fill,delete r.stroke,delete r.controlPoints,delete r.round})),t}return y()(n,[{key:"init",value:function(t){var e=this;this.diagram=t,this.bind(t,"mousemove",this.onMouseMove),this.bind(t,"click",this.onClick),this.bind(window,"keyup",(function(n){"Esc"!==n.key&&"Escape"!==n.key||(e.clear(),t.interaction.changeMode("edit"))})),this.bind(window,"mousedown",(function(n){t.canvas.rendererElement.contains(n.target)||(e.clear(),t.interaction.changeMode("edit"))}))}},{key:"getPoint",value:function(t){return this.diagram.viewport.invertClient([t.clientX,t.clientY])}},{key:"initDelegation",value:function(){var t=this.diagram,e=t.settings.vertex,n=sc[sc.findIndex((function(t){return t.name===e.shape}))],r={};"swimlane"===(null==n?void 0:n.type)&&(r.number=n.number,r.widths=n.widths,r.heights=n.heights,r.htmls=n.htmls);var a=cf(cf(cf({},e),r),{},{x:0,y:0});t.hooks.decorateAddVertexModel.call(a);var i=t.add(a)[0];this.delegation=t.delegator.create([i]),this.cell=i,i.hide()}},{key:"clear",value:function(){var t,e=this.cell,n=this.delegation,r=this.diagram;null==r||null===(t=r.swimlane)||void 0===t||t.unhighlight(),e&&!e.destroyed&&r.remove(e.model.id),n&&n.destroy(),this.cell=null,this.delegation=null}},{key:"unbind",value:function(){this.clear(),_()(L()(n.prototype),"unbind",this).call(this)}}]),n}();var sf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var t=this.diagram;this.bind(t,"dblclick",(function(e){var n=t.viewport.invertClient([e.clientX,e.clientY,1]),r=t.getCell(e.target);if(r&&r.isGroup){var a=t.groupManager.enter(r,{x:n[0],y:n[1]});a&&t.selector.select(a)}})),this.bind(t,"afterselect",(function(e){t.groupManager.group&&0===e.selections.length&&t.groupManager.exit()}))}}]),n}();var uf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e,n,r,a,i=!1;function o(){i=!1,e=0,n=0,r=0,a=0,t.input.style.display=""}this.bind(t,"dragstart",(function(o){var c=o.evt;i=!0,e=c.clientX,n=c.clientY,r=t.viewport.scrollLeft,a=t.viewport.scrollTop,t.input.style.display="none"})),this.bind(t,"drag",Bt()((function(o){var c=o.evt;if(i){var l=r-(c.clientX-e),s=a-(c.clientY-n);t.viewport.setScroll(l,s)}}),16)),this.bind(t,"dragend",(function(){o()})),this.bind(t,"mouseleave",(function(){o()}))}}]),n}();var df=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),t=e.call(this),c()(E()(t),"default",void 0),c()(E()(t),"diagram",void 0),c()(E()(t),"selectedCells",void 0),c()(E()(t),"dragCells",void 0),c()(E()(t),"startBox",void 0),c()(E()(t),"originModels",void 0),c()(E()(t),"dragClone",void 0),c()(E()(t),"dragCloneModels",void 0),c()(E()(t),"dx",0),c()(E()(t),"dy",0),c()(E()(t),"startClient",void 0),c()(E()(t),"startPoint",void 0),c()(E()(t),"onMouseMoveEvent",void 0),t.default={selectedCells:void 0,dragClone:void 0,dragCells:void 0,startPoint:void 0,startBox:void 0,originModels:void 0,startClient:void 0,onMouseMoveEvent:void 0,dx:0,dy:0},Object.assign(E()(t),t.default),t}return y()(n,[{key:"reset",value:function(){var t=this.diagram;this.dragCells&&this.dragCells.length>1&&t.highlight.show(),this.onMouseMoveEvent&&this.unbind(this.onMouseMoveEvent),t.signal.cellDragStart=!1,t.align.clear(),Object.assign(this,this.default)}},{key:"initDragData",value:function(){var t=this.diagram;if(!t.contentEditor.isBegin){var e=t.selector.selections;if(1!==e.length||!sr(e[0])||!e[0].isConnected()){var n,r=t.selector.selections.filter((function(t){return t}));if(t.signal.keydown.Alt){var a=r.sort((function(t,e){return t.getZIndex()-e.getZIndex()})).map((function(t){return s()(t.model)}));a.forEach((function(t){"swimlane"===t.type&&(t.contain=[])})),n=t.add(t.importer.clone(a)),this.dragClone=!0,this.dragCloneModels=a}else n=r;var i=n[0];1!==n.length||i.isLine?n.length>1&&t.align.updateToAlginPoints(n):t.align.updateToAlginPoints(i),1!==n.length||i.isLine?n.length>1&&(this.startBox=Er(n)):(this.startBox=i.getBBox(),n=n.filter((function(t){return!sr(t)||["source","target"].every((function(e){return!t[e].id}))})));var o=mh(n),c=o.stems,l=o.originModels;this.selectedCells=n,t.align.prepareForDistribute(n),this.dragCells=c,this.originModels=l}}}},{key:"getCurrentBox",value:function(){return{minX:this.startBox.minX+this.dx,maxX:this.startBox.maxX+this.dx,minY:this.startBox.minY+this.dy,maxY:this.startBox.maxY+this.dy}}},{key:"init",value:function(){var t,e,n=this,r=this.diagram,a=function(){return Id(n.originModels,n.dx,n.dy)},i=Bt()((function(i){if(r.signal.cellDragStart){var o,c=r.viewport.invertClient([i.clientX,i.clientY]);if(n.dx=c[0]-n.startPoint[0],n.dy=c[1]-n.startPoint[1],n.startBox){var l=r.align.alignByBox(n.getCurrentBox());n.dx+=l.dx,n.dy+=l.dy,l=r.align.alignDistribute(n.getCurrentBox()),n.dx+=l.dx,n.dy+=l.dy}var s,u=a();if(r.update(n.dragCells,u),(e=null===(o=r.swimlane)||void 0===o?void 0:o.findSwimlane(n.dragCells))&&t!==e)null===(s=r.swimlane)||void 0===s||s.highlight(e);else if(!e){var d;null===(d=r.swimlane)||void 0===d||d.unhighlight()}t=e}else{if(lo(n.startClient[0],n.startClient[1],i.clientX,i.clientY)<8)return;if(n.initDragData(),!n.dragCells)return;r.signal.cellDragStart=!0,r.emit("cell:dragstart"),n.dragCells.length>1&&r.highlight.hide(),1===n.dragCells.length&&r.contentEditor&&(r.contentEditor.unbind(),r.focus())}}),16),o=function(){var t,e,o=n.selectedCells,c=n.originModels,l=n.dragCloneModels,s=[],u=function(){var t=o.map((function(t){return t.model.id})).map((function(t){return r.find(t)})).filter((function(t){return t}));r.selector.select(t)};if(n.dragClone)r.remove(o),Td(l,n.dx,n.dy),s.push("Add",{model:l,select:u});else{var d,h=a(),f=null===(d=r.swimlane)||void 0===d?void 0:d.findSwimlane(n.dragCells);(n.dragCells.some((function(t){return t.swimlane}))||f)&&n.dragCells.every((function(t){return!yr(t)}))?s.push("InteractSwimlane",{id:n.dragCells,model:h,parent:f,select:u,originModels:c}):s.push("Update",{id:n.dragCells.map((function(t){return t.model.id})),model:h,select:u,originModels:c})}r.emit("cell:dragend",{cells:n.dragCells}),i.cancel(),n.reset(),(t=r.command).execute.apply(t,s),null===(e=r.swimlane)||void 0===e||e.unhighlight()},c=function(){var e;t=void 0,null===(e=r.swimlane)||void 0===e||e.unhighlight(),i.cancel(),n.reset()};this.bind(r,"mousedown",(function(t){if(!r.signal.lineTextMouseDown){var e=t.target,a=t.clientX,o=t.clientY,c=t.button,l=r.getCell(e);0===c&&l&&l.isStem&&(n.startClient=[a,o],n.startPoint=r.viewport.invertClient([a,o]),n.onMouseMoveEvent=n.bind(r,"mousemove",i))}})),this.bind(r,"mouseup",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?o():c()})),this.bind(r,"mouseleave",(function(){n.dragCells&&n.dragCells[0]&&r.signal.cellDragStart?o():c()}))}}]),n}();var hf=ha,ff=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"unbindMousemoveEvent",value:function(){this.mouseMoveEvent&&(this.unbind(this.mouseMoveEvent),this.mouseMoveEvent=void 0)}},{key:"init",value:function(t){var e,n,r,a=this;t.signal.mouseMultiSelecting=!1;var i=new hf({fill:"rgba(9, 109, 217, .05)",stroke:"#3384F5"});function o(a){if(e){t.signal.mouseMultiSelecting=!0,n=t.viewport.invertClient([a.clientX,a.clientY]);var o={minX:Math.min(e[0],n[0]),minY:Math.min(e[1],n[1]),width:Math.abs(n[0]-e[0]),height:Math.abs(n[1]-e[1])};o.maxX=o.minX+o.width,o.maxY=o.minY+o.height;var c=Jn(o.minX,o.minY,o.width,o.height);i.update({d:c}),cn(r=t.groupManager.getCells().filter((function(t){if(t.state.visible&&t.state.capture){var e=mr(t)?t.getKeyShapeBox():t.getBBox();if(oo(e,o)){if(yr(t))return io(o,e);if(gr(t))return!1;if(sr(t)){var n=t.d;if(!io(o,e)&&0===Xt()(c,n).length)return!1}return!0}}return!1})),t.selector.selections)||t.selector.select(r)}}i.dataset({testid:"mouse-drag-multi-select"}),this.selectBox=i,this.bind(t,"mousedown",(function(n){(function(e){return 0===e.button&&(e.target===t.canvas.rendererElement||void 0)})(n)&&(a.unbindMousemoveEvent(),a.mouseMoveEvent=a.bind(window,"mousemove",Bt()(o,16)),t.frontRootGroup.add(i),e=t.viewport.invertClient([n.clientX,n.clientY]))})),this.bind(window,"mouseup",(function(){e&&t.tryFocus(),t.signal.mouseMultiSelecting=!1,r&&r.length>0&&t.selector.select(r),r=void 0,e=void 0,n=void 0,a.unbindMousemoveEvent(),i.remove(),i.update({d:""})}))}},{key:"unbind",value:function(t){!t&&this.selectBox&&(this.selectBox.remove(),this.selectBox=void 0),_()(L()(n.prototype),"unbind",this).call(this,t)}}]),n}();var pf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"reset",value:function(){this.unbind()}},{key:"init",value:function(t){var e,n,r,a,i,o,c=this,l=!0;this.bind(t,"line:mousedown",(function(s){if(!t.contentEditor.isBegin&&sr(s.cell)&&s.target.closest("foreignObject")){t.selector.select([]),n=s.cell,t.signal.lineTextMouseDown=!0,i={textPosition:void 0===n.textPosition?.5:n.textPosition,textDirection:void 0===n.textDirection?"center":n.textDirection};var u=n.getKeyShape();e=c.bind(t,"mousemove",Bt()((function(e){if(n&&u)if(l){t.selector.select([]),l=!1;var i="curve"===n.shape?u.getTotalLength()/500:1.5;o=function(t,e){for(var n,r=t.getTotalLength(),a=[],i=[],o=0;o<=r;o+=e)n=t.getPointAtLength(o),a.push([n.x,n.y]),i.push(o/r);return{points:a,percentages:i}}(u,i)}else if(o){var c=t.viewport.invertClient([e.x,e.y]),s=u.getClosestPoint(n.canvas2Relative(c),o.points),d=o.points[s],h=lo(c[0],c[1],d[0],d[1]);r=o.percentages[s];var f=1;if(h<=20)a="center",f=1;else if(h<=60){var p=n.getTwoPointsByPercent(r),m=b()(p,2),v=m[0],y=m[1],g=n.canvas2Relative(c),x=Eo(g,v,y);a=x?"right":"left"}else r=void 0,f=.5;t.update(n,{textPosition:r,textDirection:a,opacity:f})}}),16))}}));var s=function(){t.signal.lineTextMouseDown=!1,e&&n&&(t.update(n,{opacity:1}),r&&n&&t.command.execute("Update",{id:n.model.id,model:{textPosition:r,textDirection:a},originModels:i}),c.unbind(e),e=void 0,n=void 0,i=void 0,l=!0,o=void 0,a=void 0,r=void 0)};this.bind(t,"mouseup",(function(){s()})),this.bind(t,"mouseleave",(function(){s()}))}}]),n}();var mf=r.FileUtils.isImage,vf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"dragover",(function(t){t.preventDefault()})),this.bind(t,"drop",(function(e){e.preventDefault();var n=Array.from(e.dataTransfer.files).filter((function(t){return mf(t)}));n[0]&&t.emit("importimage",{files:n,from:"drop"})}))}}]),n}();var yf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"groupcellrect:mouseenter",(function(t){t.cell.hover(!0)})),this.bind(t,"groupcellrect:mouseleave",(function(t){t.cell.hover(!1)}))}}]),n}();var gf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=this;this.bind(t,"mouseenter",(function(){t.signal.mouseenter=!0})),this.bind(t,"mouseleave",(function(){t.signal.mouseenter=!1})),this.bind(t,"mousedown",(function(){e.mousemovePrevent=e.bind(t,"mousemove",(function(e){t.signal.dragging||(t.signal.dragging=!0)}))})),this.bind(t,"mouseup",(function(){t.signal.dragging=!1,e.mousemovePrevent&&e.unbind(e.mousemovePrevent)}))}}]),n}();var bf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"beforecommandexecute",(function(e){var n=e.commandName,r=e.command;if("Add"===n&&"line"===r.model.type){var a={};xt()(a,t.settings.line,r.model),r.model=a}})),this.bind(t,"aftercommandexecute",(function(e){var n=e.command;if("Update"===e.commandName&&1===(null==n?void 0:n.id.length)&&n.id[0].isLine){var r,a,i=n.id[0];t.settings.line={shape:i.shape,stroke:i.stroke,target:{marker:null==i||null===(r=i.target)||void 0===r?void 0:r.marker},source:{marker:null==i||null===(a=i.source)||void 0===a?void 0:a.marker}}}}))}}]),n}();var xf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",new na),t}return y()(n,[{key:"init",value:function(t){var e=this,n=new Sa({fill:"#fff","dominant-baseline":"hanging"});n.css({fontFamily:"system-ui",fontSize:"".concat(12,"px")});var r=new ha({fill:"rgba(0,0,0,0.7)",stroke:"none"});this.group.add(r),this.group.add(n),this.group.hide(),t.frontRootGroup.add(this.group),this.bind(t,"cellrotate",(function(a){var i=a.cell,o="".concat(a.rotate,"°"),c=1/t.viewport.zoom,l=8*c,s=4*c,u=24*c,d=3*c,h=12*c,f=t.font.measureTextLength(o,{fontSize:"".concat(h,"px")})+l+s,p=16*c,m=i.x,v=i.y,y=i.width,g=i.height,b=i.rotate,x=new Ln({x:m,y:v,w:y,h:g,r:b}),k=x.center.x,w=Math.max(x.tl.y,x.tr.y,x.bl.y,x.br.y)+u,C=4*c,A=f/2,O=p/2,E=A<C?A:C,P=O<C?O:C;r.update({d:Jn(k-f/2,w,f,p,E,P)}),n.update({x:k-f/2+l,y:w+d,text:o}),n.css({fontSize:"".concat(h,"px")}),e.group.show()})),this.bind(t,"mouseup",(function(){e.group.hide()}))}},{key:"reset",value:function(){this.group.clear(),this.unbind()}}]),n}();var kf=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"manager",void 0),t}return y()(n,[{key:"init",value:function(t){if(pt.ua.mobile){var e=t.viewport,n=new Vt.a.Manager(t.canvasContainer);this.manager=n;var r=new Vt.a.Pan,a=new Vt.a.Pinch({enable:!0}),i=new Vt.a.Tap({event:"doubleTap",taps:2});n.add(a),n.add(i),n.add(r);var o=1,c=e.scrollLeft,l=e.scrollTop;n.on("panstart",(function(){c=e.scrollLeft,l=e.scrollTop})),n.on("panmove",(function(t){e.setScroll(c-t.deltaX,l-t.deltaY)})),n.on("pinchstart",(function(){o=e.zoom})),n.on("pinchmove",(function(t){e.setViewport(t.scale-1+o,[t.center.x,t.center.y])})),n.on("doubleTap",(function(){e.autoFit()}))}}},{key:"reset",value:function(){var t;null===(t=this.manager)||void 0===t||t.destroy()}}]),n}(),wf=function(){function t(e){m()(this,t),c()(this,"diagram",void 0),c()(this,"lineCache",void 0),this.diagram=e}return y()(t,[{key:"reset",value:function(){this.diagram.update(this.lineCache.map((function(t){return t.id})),this.lineCache)}},{key:"pin",value:function(){var t=this.diagram;this.lineCache.map((function(e){return t.find(e.id)})).filter((function(t){return t})).forEach((function(t){var e=t.source,n=t.target,r=t.diagram,a=Qn(t.wireElement.attr("d")),i={};if(r.find(e.id)||(i.source={id:null,connection:[a[0][1],a[0][2]]}),!r.find(n.id)){var o=a.length-1,c=a[o].length;i.target={id:null,connection:[a[o][c-2],a[o][c-1]]}}t.update(i)}))}},{key:"cache",value:function(t){var e=this.diagram,n=t.reduce((function(t,e){return"string"==typeof e?t[e]=!0:e.getAllCells().forEach((function(e){t[e.model.id]=!0})),t}),{});this.lineCache=e.getCells().filter((function(t){if(t.isLine){var e=t.model,r=e.target.id,a=e.source.id;return r&&n[r]||a&&n[a]}return!1})).map((function(t){var e=t.model,n={id:e.id,target:s()(e.target),source:s()(e.source)};return n.target.connection||(n.target.connection=null),n.source.connection||(n.source.connection=null),n}))}}]),t}();var Cf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).pinLine=new wf(t.diagram),r}return y()(n,[{key:"selectParent",value:function(){var t=this.diagram,e=this.changeArguments,n=t.find(e[0][0].id).parent;this.select(n&&n.model.id)}},{key:"findNearestCell",value:function(){var t=this.diagram,e=this.changeArguments,n=t.find(e[0][0].id),r=[];if(!mr(n))return r;var a=n.parent;if(e[0].length>1&&a)return r.push(a.model.id),r;if(1===e[0].length&&a){var i=a.getChildren().filter((function(t){return t.upSignX===n.upSignX&&t.upSignY===n.upSignY})),o=i.indexOf(n);if(a.model.children){var c=i[o-1];if(c)return r.push(c.model.id),r;var l=i[o+1];if(l)return r.push(l.model.id),r}return r.push(a.model.id),r}return r}},{key:"execute",value:function(){var t=this.diagram,e=this.id,n=this.pinLine,r=ir(e,{}),a=r[0].map((function(e){return t.find(e)}));a.forEach((function(e,n){r[0][n]=s()(e.model),r[1][n]=t.getCellOptions(e)})),this.changeArguments=r,n.cache(a),this.forward()}},{key:"forward",value:function(){var t=this.diagram,e=this.changeArguments,n=this.pinLine,r=this.findNearestCell();t.remove(e[0].map((function(t){return t.id}))),this.select(r),t.tryFocus(),n.pin()}},{key:"backward",value:function(){var t=this.diagram,e=this.changeArguments,n=this.pinLine,r=t.add.apply(t,D()(e));n.reset(),this.select(r),t.tryFocus()}}]),n}();function Af(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}c()(Cf,"className","Remove");var Of=function(t){S()(n,Cf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"diagram",void 0),c()(E()(r),"deletedCells",void 0),c()(E()(r),"records",void 0),r.diagram=t.diagram,r}return y()(n,[{key:"execute",value:function(){var t=this;this.cells||(this.cells=this.diagram.selector.selections);var e=this.cells;this.id=[],this.records=new Map,this.deletedCells=new Set,this.deletedSwimlanes=new Set,e.forEach((function(e){var n=t.diagram.find(e);n&&n.canDelete()&&(t.id.push(n.model.id),t.deletedCells.add(n.model.id))})),_()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var t=this,e=this.diagram,r=new Set;this.deletedCells.forEach((function(n){var a=e.find(n);if(a){var i=vi(a);if(yr(i))i.model.contain.forEach((function(n){if(!t.deletedCells.has(n)){var r=e.find(n);r&&(e.swimlane.unbind(r,i),t.records.set(r.model.id,i.model.id))}}));else if(t.deletedCells.has(i.model.id)&&!r.has(i.model.id)&&i.swimlane&&!t.deletedCells.has(i.swimlane)){var o=e.find(i.swimlane);o&&(r.add(o.model.id),e.swimlane.unbind(i,o),t.records.set(i.model.id,o.model.id))}}})),_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){_()(L()(n.prototype),"backward",this).call(this);var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Af(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Af(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(this.records.entries());try{for(e.s();!(t=e.n()).done;){var r=b()(t.value,2),a=r[0],i=r[1];this.diagram.swimlane.bind(a,i)}}catch(t){e.e(t)}finally{e.f()}}}]),n}();c()(Of,"className","Delete"),c()(Of,"enable",(function(t){return!0}));var Ef=function(t){S()(n,Of);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){Mc(this.e,this.diagram),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Ef,"className","Cut"),c()(Ef,"isModelChange",!0);var Pf=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this);var t=this.diagram,e=this.lineId,r=this.model,a=t.find(e);this.originTarget=["id","connection","marker"].reduce((function(t,e){var n=a.target[e];return t[e]=null==n?null:n,t}),{}),t.update(a,{target:{id:r.id,connection:null}})}},{key:"forward",value:function(){_()(L()(n.prototype),"forward",this).call(this);var t=this.diagram,e=this.lineId,r=this.model,a=t.find(e);a&&!a.destroyed&&t.update(a,{target:{id:r.id,connection:null}})}},{key:"backward",value:function(){var t=this.diagram,e=this.lineId,n=this.originTarget,r=this.model,a=t.find(e);t.remove(r.id),a&&!a.destroyed&&t.update(a.model.id,{target:n}),this.select()}}]),n}();function Sf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sf(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(Pf,"className","AddVertex");var jf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.attr,n=this.shape||"rect",r=sc[sc.findIndex((function(t){return t.name===n}))],a=r.type||"geometry",i=r.category,o=r.html||Ld,c=r.controlPoints||void 0,l=r.round||void 0;Object.assign(t.settings.vertex,Mf(Mf({},e),{},{type:a,html:o,shape:n,category:i,controlPoints:c,round:l})),t.selector.clear(),t.interaction.changeMode("beginInsertVertex")}}],[{key:"enable",value:function(){return!0}}]),n}();c()(jf,"className","BeginInsertGeometry"),c()(jf,"isModelChange",!1);var Rf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.model,n=this.files;t.settings.image.insertModel=e,t.settings.image.insertFiles=n,t.selector.clear(),t.interaction.changeMode("beginInsertImage")}}],[{key:"enable",value:function(){return!0}}]),n}();function Lf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Rf,"className","BeginInsertImage"),c()(Rf,"isModelChange",!1);var Bf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lf(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({html:Mr("文本")},t))).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.html,n=this.stroke;Object.assign(t.settings.vertex,{type:"text",html:e,stroke:n,shape:"text"}),t.selector.clear(),t.interaction.changeMode("beginInsertVertex")}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Bf,"className","BeginInsertText"),c()(Bf,"isModelChange",!1);var Df=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"arrange",value:function(){}},{key:"getArrangeTstem",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=[],r=[];return t.forEach((function(t,a){var i=mh([t]),o=i.stems,c=i.originModels,l=e(a,t),s=l.dx,u=l.dy;r.push.apply(r,D()(o)),n.push.apply(n,D()(Id(c,s,u)))})),{tStems:r,models:n}}},{key:"execute",value:function(){var t=this.diagram.selector.selections.concat([]),e=this.arrange(),r=e.tStems,a=e.models;this.id=r,this.model=a,this.selectedIds=t.map((function(t){return t.model.id})),_()(L()(n.prototype),"execute",this).call(this)}},{key:"select",value:function(){_()(L()(n.prototype),"select",this).call(this,this.selectedIds)}}]),n}();c()(Df,"className","Arrange");var Nf=function(t){S()(n,Df);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"_getAlignCells",value:function(t){return t.filter((function(t){return t.canArrange()}))}},{key:"_getAlignCellPoints",value:function(t){var e=[];return t.forEach((function(t){var n=[],r=t.getAlignBBox();n.push([r.minX,r.minY]),n.push([r.maxX,r.maxY]),n.push([(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]),e.push(n)})),e}},{key:"arrange",value:function(){var t=this.diagram.selector.selections.concat([]),e=this._getAlignCells(t),n=this._getAlignCellPoints(e);return this.align(e,n)}},{key:"align",value:function(){}}]),n}();c()(Nf,"className","AlignBase"),c()(Nf,"enable",(function(t){return t.selector.selections.filter((function(t){return t.canArrange()})).length>1}));var _f=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n=e.reduce((function(t,e){return t.concat(e)}),[]),r=Math.max.apply(Math,D()(n.map((function(t){return t[1]}))));return this.getArrangeTstem(t,(function(t,n){var a=e[t];return{dx:0,dy:n.isLine?r-Math.max.apply(Math,D()(a.map((function(t){return t[1]})))):r-a[1][1]}}))}}]),n}();c()(_f,"className","AlignBottom");var If=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n,r=t.map((function(t){return t.getAlignBBox()})),a=tn(r,"width");if(r.every((function(t){return t.minX>=a.minX&&t.maxX<=a.maxX})))n=a.x+a.width/2;else{var i=e.reduce((function(t,e){return t.concat([e[2]])}),[]).map((function(t){return t[0]}));n=(Math.max.apply(Math,D()(i))+Math.min.apply(Math,D()(i)))/2}return this.getArrangeTstem(t,(function(t,r){var a=e[t];return{dx:(r.isLine,n-a[2][0]),dy:0}}))}}]),n}();c()(If,"className","AlignHCenter");var Tf=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n=e.reduce((function(t,e){return t.concat(e)}),[]),r=Math.min.apply(Math,D()(n.map((function(t){return t[0]}))));return this.getArrangeTstem(t,(function(t,n){var a=e[t];return{dx:n.isLine?r-Math.min.apply(Math,D()(a.map((function(t){return t[0]})))):r-a[0][0],dy:0}}))}}]),n}();c()(Tf,"className","AlignLeft");var Ff=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n=e.reduce((function(t,e){return t.concat(e)}),[]),r=Math.max.apply(Math,D()(n.map((function(t){return t[0]}))));return this.getArrangeTstem(t,(function(t,n){var a=e[t];return{dx:n.isLine?r-Math.max.apply(Math,D()(a.map((function(t){return t[0]})))):r-a[1][0],dy:0}}))}}]),n}();c()(Ff,"className","AlignRight");var zf=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n=e.reduce((function(t,e){return t.concat(e)}),[]),r=Math.min.apply(Math,D()(n.map((function(t){return t[1]}))));return this.getArrangeTstem(t,(function(t,n){var a=e[t];return{dx:0,dy:n.isLine?r-Math.min.apply(Math,D()(a.map((function(t){return t[1]})))):r-a[0][1]}}))}}]),n}();c()(zf,"className","AlignTop");var qf=function(t){S()(n,Nf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"align",value:function(t,e){var n,r=t.map((function(t){return t.getAlignBBox()})),a=tn(r,"height");if(r.every((function(t){return t.minY>=a.minY&&t.maxY<=a.maxY})))n=a.y+a.height/2;else{var i=e.reduce((function(t,e){return t.concat([e[2]])}),[]).map((function(t){return t[1]}));n=(Math.max.apply(Math,D()(i))+Math.min.apply(Math,D()(i)))/2}return this.getArrangeTstem(t,(function(t,r){var a=e[t];return{dx:0,dy:(r.isLine,n-a[2][1])}}))}}]),n}();c()(qf,"className","AlignVCenter");var Yf=function(t){S()(n,Df);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"distribute",value:function(){}},{key:"arrange",value:function(){var t=this.diagram.selector.selections.filter((function(t){return t.canArrange()}));return this.distribute(t)}}]),n}();c()(Yf,"enable",(function(t){return t.selector.selections.filter((function(t){return t.canArrange()})).length>2}));var Hf=function(t){S()(n,Yf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"distribute",value:function(t){var e=t.length,n=t.map((function(t){return{cell:t,box:t.getAlignBBox()}}));n=n.sort((function(t,e){return t.box.minX-e.box.minX}));var r=Math.min.apply(Math,D()(n.map((function(t){return t.box.minX})))),a=(Math.max.apply(Math,D()(n.map((function(t){return t.box.maxX}))))-r-n.reduce((function(t,e){return t+e.box.width}),0))/(e-1),i=n[0].box;t=n.map((function(t){return t.cell}));var o=0;return this.getArrangeTstem(t,(function(t){var e=0;if(t>0){var r=n[t-1],c=n[t];o=o+a+r.box.width,e=i.minX+o-c.box.minX}return{dx:e,dy:0}}))}}]),n}();c()(Hf,"className","DistributeHorizontally");var Gf=function(t){S()(n,Yf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"distribute",value:function(t){var e=t.length,n=t.map((function(t){return{cell:t,box:t.getAlignBBox()}}));n=n.sort((function(t,e){return t.box.minY-e.box.minY}));var r=Math.min.apply(Math,D()(n.map((function(t){return t.box.minY})))),a=(Math.max.apply(Math,D()(n.map((function(t){return t.box.maxY}))))-r-n.reduce((function(t,e){return t+e.box.height}),0))/(e-1),i=n[0].box;t=n.map((function(t){return t.cell}));var o=0;return this.getArrangeTstem(t,(function(t){var e=0;if(t>0){var r=n[t-1],c=n[t];o=o+a+r.box.height,e=i.minY+o-c.box.minY}return{dx:0,dy:e}}))}}]),n}();c()(Gf,"className","DistributeVertically");var Xf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=this.diagram,r=n.selector.selections.filter((function(t){return t.isStem}));r.sort(e);var a=r.map((function(t){return t.model.id})),i=r.map((function(t){return n.getCellOptions(t)}));r.forEach((function(e){e[t]()}));var o=r.map((function(t){return n.getCellOptions(t)}));this.beforeCellOptions=i,this.afterCellOptions=o,this.id=a,this.select(a)}},{key:"backward",value:function(){var t=this.diagram,e=this.id,n=this.beforeCellOptions;t.update(e,{},n),this.select(e)}},{key:"forward",value:function(){var t=this.diagram,e=this.id,n=this.afterCellOptions;t.update(e,{},n),this.select(e)}}]),n}();c()(Xf,"className","ZIndex");var Wf=function(t){S()(n,Xf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"backward",(function(t,e){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(Wf,"className","Backward");var Vf=function(t){S()(n,Xf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"forward",(function(t,e){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(Vf,"className","Forward");var Zf=function(t){S()(n,Xf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"toBack",(function(t,e){return e.getZIndex()-t.getZIndex()}))}}]),n}();c()(Zf,"className","ToBack");var Uf=function(t){S()(n,Xf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,"toFront",(function(t,e){return t.getZIndex()-e.getZIndex()}))}}]),n}();c()(Uf,"className","ToFront");var Kf=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.x,e=this.y;this.model={type:"geometry",html:Ld,shape:"rect",x:t,y:e},_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Kf,"className","InsertGeometry"),c()(Kf,"enable",(function(t){return"edit"===t.interaction.currentMode}));var Qf=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.x,e=this.y,r=this.image,a=this.diagram,i=r.naturalWidth/r.naturalHeight,o=this.width||Math.min(r.naturalWidth,1e3,1e3*i),c=this.height||o/i,l=a.viewport.getCenter();this.model={type:"image",image:r,width:o,height:c,x:null==t?l[0]:t,y:null==e?l[1]:e,constraints:{proportion:!0}},_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Qf,"className","InsertImage"),c()(Qf,"enable",(function(t){return"read"!==t.interaction.currentMode}));var $f=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.x,e=this.y;this.model={type:"text",html:Mr("文本"),x:t,y:e},_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()($f,"className","InsertText"),c()($f,"enable",(function(t){return"edit"===t.interaction.currentMode}));var Jf=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){this.diagram.contentEditor.execCommand("createLink",Mr("链接"))}}]),n}();c()(Jf,"className","AttachLink"),c()(Jf,"enable",(function(t){var e=t.getCell(t.contentEditor.dom);return t.contentEditor.getRange()&&e}));var tp=r.FileUtils.isImage;function ep(t){var e=t.model,n=t.offset;e.x=(e.x||0)+n[0],e.y=(e.y||0)+n[1]}var np={text:{lake:ep,text:function(t){var e=t.text,n=t.focusPoint;return[{type:"text",html:e,x:n[0],y:n[1]}]},textIndex:1},geometry:{lake:ep},stack:{lake:ep},image:{lake:ep},dsl:{lake:ep},group:{lake:function(t){var e=t.model,n=t.offset;Td([e],n[0],n[1])}},line:{lake:function(t){var e=t.extraInformation,n=t.extraInformations,r=t.offset,a=t.model,i=e.points;["source","target"].forEach((function(t){var e=a[t];if(!e.id&&e.connection&&(e.connection[0]+=r[0],e.connection[1]+=r[1]),e.id&&!n[e.id]){var o="source"===t?i[0]:i[i.length-1];e.connection=[o.x+r[0],o.y+r[1]],delete e.id}})),a.controlPoints&&a.controlPoints.forEach((function(t){t[0]+=r[0],t[1]+=r[1]}))}},freehand:{lake:function(t){var e=t.model,n=t.offset;e.points.forEach((function(t){t[0]+=n[0],t[1]+=n[1]}))}},pen:{lake:function(t){var e=t.model,n=t.offset;e.points.forEach((function(t){t[0]+=n[0],t[1]+=n[1]}))}}},rp=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"_getOptions",value:function(t,e){var n=this.diagram.groupManager.group;return t.map((function(t,r){var a=Object.assign(t.options||{},e[r]);return delete t.options,n&&!a.parent&&(a.parent=n.model.id),Object.assign(e[r],a)}))}},{key:"execute",value:function(){var t,e=this.diagram,n=this.e,r=n.clipboardData.getData("text/html"),a=n.clipboardData.getData("text/plain"),i=this.focusPoint,o=bl(r);if(i=i||e.viewport.getFocus(),o){var c=o.body,l=o.extraInformations,s=function(t,e,n){var r=[[],[]];return t.forEach((function(t){Ve(t,(function(t){var e=t.id,a=t.x,i=t.y,o=t.type,c=n[e];"line"===o?["source","target"].forEach((function(e){var n=t[e];if(null!=n&&n.id){var a=c.points,i="source"===e?a[0]:a[a.length-1];r[0].push(i.x),r[1].push(i.y)}else null!=n&&n.id||null==n||!n.connection||(r[0].push(n.connection[0]),r[1].push(n.connection[1]))})):"freehand"===o||"pen"===o?(r[0].push(c.topLeft[0]),r[1].push(c.topLeft[1])):(a=null==a?null==c?void 0:c.x:a,i=null==i?null==c?void 0:c.y:i,null!=a&&null!=i&&(r[0].push(a),r[1].push(i)))}))})),r[0]=[r[0].length>0&&Math.min.apply(Math,D()(r[0]))||0],r[1]=[r[1].length>0&&Math.min.apply(Math,D()(r[1]))||0],[e[0]-r[0][0],e[1]-r[1][0]]}(c,i,l);!function(t,e){var n=function(t){return"mindmap"===e[t.id].rootType},r=t.filter((function(t){return n(t)}));t.sort((function(t,e){return t.zIndex-e.zIndex})),t.forEach((function(t){Ve(t,(function(t){var e=t.children;e&&"group"===t.type&&e.sort((function(t,e){return t.zIndex-e.zIndex}))}))}));var a=0;t.forEach((function(e,i){n(e)&&(t[i]=r[a],a++)}))}(c,l);var u=gi(c,l);e.hooks.forceDecorateImportModels.call(c),c.forEach((function(t){hu(t);var n=l[t.id];t.type||(t.type=n.rootType||"text"),t.options={},Ve(t,(function(t){t.zIndex&&delete t.zIndex,"swimlane"===t.type&&(t.contain=t.contain.map((function(t){return u[t]})).filter((function(t){return t})))}));var r=np[t.type];r&&r.lake&&r.lake({model:t,extraInformation:n,extraInformations:l,offset:s,diagram:e})}));var d={body:c,options:c.map((function(){return{}})),extraInfomations:l,offset:s};return e.emit("beforepaste:lake",d),void e.command.execute("Add",{model:d.body,cellOptions:this._getOptions(d.body,d.options)})}if(n.clipboardData.files.length>0&&(""===r&&/^.+\.\w+$/.test(a)||""===a&&/^(<meta.+?>)?<img.+?>$/.test(r)||!a||!r)&&(t=Array.from(n.clipboardData.files)),t){var h=Array.from(t).filter((function(t){return tp(t)}));h[0]&&e.emit("importimage",{files:h,from:"clipboard",x:i[0],y:i[1]})}else if(a){var f,p=Object.keys(np),m=[];p.forEach((function(t){var e,n=np[t].text;n&&m.push({textProcessor:n,textIndex:null!==(e=np[t].textIndex)&&void 0!==e?e:0})})),m.sort((function(t,e){return e.textIndex-t.textIndex})),m=m.map((function(t){return t.textProcessor}));for(var v=0;v<m.length&&!(f=(0,m[v])({text:a,focusPoint:i,diagram:e}));v++);e.hooks.forceDecorateImportModels.call(f);var y={body:f,options:f.map((function(){return{}}))};e.emit("beforepaste:text",y),e.command.execute("Add",{model:y.body,cellOptions:this._getOptions(y.body,y.body.map((function(t){return{}})))}),e.emit("afterpasteplaintext",{body:f,focusPoint:i})}}}],[{key:"registerClipboardProcessor",value:function(t,e){np[t]=e}}]),n}();c()(rp,"className","Paste");var ap=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram.selector.selections,e=t.map((function(t){return{target:{marker:t.source.marker||"none"},source:{marker:t.target.marker||"none"}}}));this.model=e,this.id=t.map((function(t){return t.model.id})),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();function ip(t){return t.isStem}c()(ap,"className","LineSwapEndpoint"),c()(ap,"enable",(function(t){return t.selector.selections.every((function(t){return sr(t)}))}));var op=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.groupManager.group,n=t.selector.selections.filter(ip),r={},a=Object(F.a)();e&&(r.parent=e.model.id),n.sort((function(t,e){return t.getZIndex()-e.getZIndex()}));var i={id:a,type:"group"},o={parent:a};this.beforeZIndexCache=t.getCellsByZIndex().map((function(t){return t.model.id})),this.newGroupModel=i,this.newGroupOption=r,this.selectionIds=n.map((function(t){return t.model.id})),this.updateModel={},this.updateOption=o,this.forward()}},{key:"forward",value:function(){var t=this.diagram,e=this.newGroupModel,n=this.selectionIds,r=this.newGroupOption,a=this.updateModel,i=this.updateOption,o=t.rootGroup,c=n.map((function(e){return t.find(e)})),l=e.id,s=c[c.length-1].getAllCellsByZIndex(),u=s[s.length-1];t.add(e,r),t.update(c,a,i);var d=t.find(l);o.insertBefore(d.graphicGroup,u.graphicGroup);for(var h=0;h<c.length;h++)c[h].getAllCellsByZIndex().forEach((function(t){o.insertBefore(t.graphicGroup,d.graphicGroup)}));t.selector.select(l)}},{key:"backward",value:function(){var t=this.diagram,e=this.selectionIds,n=this.newGroupModel,r=this.newGroupOption,a=this.beforeZIndexCache,i=n.id,o=t.rootGroup,c=e.map((function(e){return t.find(e)}));r.parent?t.update(c,{parent:r.parent}):t.update(c,{},{parent:null}),t.groupManager.exit(),t.remove(i);for(var l=0;l<a.length;l++){var s=t.find(a[l]);o.append(s.graphicGroup)}t.selector.select(e)}}]),n}();c()(op,"className","MakeGroup"),c()(op,"enable",(function(t){var e=t.selector.selections;return(e=e.filter(ip)).length>1}));var cp=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.selector.selections,n=e.map((function(t){return t.model.id})),r={};e.forEach((function(t){t.getChildren().forEach((function(e){r[e.model.id]=t.model.id}))})),this.beforeZIndexCache=t.getCellsByZIndex().map((function(t){return t.model.id})),this.selectionIds=n,this.groupMap=r,this.forward()}},{key:"forward",value:function(){var t=this.diagram,e=this.selectionIds.map((function(e){return t.find(e)})),n=[];e.forEach((function(e){var r=e.parent&&e.parent.model.id||null;e.getChildren().forEach((function(e){n.push(e),t.update(e,{},{parent:r})}))})),t.groupManager.exit(),t.remove(e),t.selector.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.groupMap,n=this.selectionIds,r=this.beforeZIndexCache,a=t.rootGroup;t.add(n.map((function(t){return{id:t,type:"group"}}))),Object.keys(e).forEach((function(n){t.update(n,{},{parent:e[n]})}));for(var i=0;i<r.length;i++){var o=t.find(r[i]);a.append(o.graphicGroup)}t.selector.select(n)}}]),n}();c()(cp,"className","Ungroup"),c()(cp,"enable",(function(t){return t.selector.selections.every((function(t){return t.isGroup}))}));var lp={Extends:[dd,Sd,Od,yd,Ad,rh,Ed,pd,Md,jd,Rd,vd,qd,zd,Yd,ah],Cells:[sd,ld,ju,Au,Pu],Commands:[Cf,Of,Ef,op,cp,rp,Pf,jf,Bf,Rf,_f,If,Tf,Ff,zf,qf,Hf,Gf,Zf,Uf,Wf,Vf,$f,Kf,Qf,Jf,ap],defaultCursors:{edit:"default",read:"grab",dragCanvas:"grab",beginInsertLine:"crosshair"},settings:{line:{shape:"elbow",target:{marker:"arrow"}},image:{},vertex:{},freehand:{}},dataProcessor:function(t){if(t&&t.body){var e=[],n=[],r=[],a={};t.body.forEach((function(t){Ve(t,(function(t,e){t.id||(t.id=Object(F.a)()),a[t.id]={model:t,parent:e},t.type&&n.push(t)})),t.type?e.push(t):r.push(t.id)})),e.forEach((function(t){hu(t)})),n.forEach((function(t){!function(t){if(function(t){return!!t.type&&"image"===t.type}(t)){var e,n,r=t.width,a=t.height,i=null==t||null===(e=t.image)||void 0===e?void 0:e.naturalWidth,o=null==t||null===(n=t.image)||void 0===n?void 0:n.naturalHeight;if(null==a&&"number"==typeof r&&"number"==typeof i&&"number"==typeof o){var c=o/i;t.height=r*c}}}(t),function(t){"line"===t.type&&t.controlPoints&&(t.controlPoints=t.controlPoints.filter((function(t){return t&&t[0]&&t[1]})))}(t),!1===function(t){if(Uo(t)){var e=sc.find((function(e){return e.name===t.shape}));if(!e)return!1;e.controlPoints&&!t.controlPoints&&(t.controlPoints=e.controlPoints),e.round&&!t.round&&(t.round=e.round)}}(t)&&r.push(t.id),!1===function(t,e){if(Wo(t))for(var n=["target","source"],r=0;r<n.length;r++){var a=t[n[r]];if(a&&a.id&&!e[a.id])return!1}}(t,a)&&r.push(t.id)})),r.forEach((function(e){var n=a[e],r=n.model,i=n.parent;sn(i?i.children:t.body,r)})),function(t){t.body.forEach((function(t){Ve(t,(function(t){"mindmap"===t.type&&(delete t.abstract,delete t.start,delete t.end,Ve(t,(function(t,e){var n=su.modelIsTwoQuadrantLayout(t),r=t.children;if(r&&0!==r.length){for(var a=n?2:1,i=r.length,o=[1/0,1/0],c=[void 0,void 0],l=r.length-1;l>=0;l--){var s=r[l];if(!s.abstract||void 0===s.start||void 0===s.end){i=l+1;break}var u=s.start,d=s.end,h=s.layout,f=(void 0===h?{}:h).quadrant,p=void 0===f?1:f;if(p>a){if(n){i=l+1;break}s.layout=du(du({},s.layout),{},{quadrant:1})}if(p<a&&(a=p),d>=o[a-1]){var m=o[a-1]-1;if(m<0){i=l+1;break}s.end=m}if(u>d||u>o[a-1]||d<0){i=l+1;break}u<0&&(s.start=0),o[a-1]=s.start,s.end,void 0===c[a-1]&&(c[a-1]=l),void 0!==s.border&&void 0!==s.border.shape&&"line"!==s.border.shape||(s.border=du(du({},s.border),{},{shape:"rect"}))}var v=function(t,e){var n=r[t],a=n.abstract,i=n.start,o=void 0===i?0:i,c=n.end;return!a||o>=e||((void 0===c?0:c)>=e&&(r[t].end=e-1),!1)},y=!1;if(n){var g=[[],[]],b=[[],[]];r.forEach((function(t,e){var n=t.layout,r=(void 0===n?{}:n).quadrant,a=void 0===r?1:r,o=Math.min(2,Math.max(1,a));e<i?g[o-1].push(e):b[o-1].push(e)})),y=b.some((function(t,e){if(t.length>0){var n=t[t.length-1],r=g[e].length;return v(n,r)}return!1}))}else r[r.length-1].abstract&&(y=v(r.length-1,i));y&&(i=r.length);for(var x=0;x<i;x++)delete r[x].abstract,delete r[x].start,delete r[x].end}})))}))}))}(t)}},modes:[{mode:"edit",Behaviours:[ch,oh,uh,dh,hh,fh,lh,ih,ph,pf,ff,df,Dh,Jh,vf,sf,gf,yf,Eh,Ph,bh,gh,xh,yh,jh,kh,Ch,Sh,Mh,Rh,bf,xf]},{mode:"read",Behaviours:[uf,kf]},{mode:"dragCanvas",Behaviours:[]},{mode:"beginInsertLine",Behaviours:[af,Rh]},{mode:"beginInsertVertex",Behaviours:[lf]},{mode:"beginInsertImage",Behaviours:[ef]}]};function sp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var up=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"element",new ha),c()(E()(r),"isPoints",!0),c()(E()(r),"points",void 0),r}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.updateModel(this.model),this.graphicGroup.add(this.element)}},{key:"canConnect",value:function(){return!1}},{key:"canUpdateText",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){return this.element}},{key:"getKeyShapeBox",value:function(){var t=this.getKeyShape().getBBox(),e=t.x,n=t.y,r=t.width,a=t.height;return{x:e,y:n,width:r,height:a,minX:e,minY:n,maxX:e+r,maxY:n+a}}},{key:"getBBox",value:function(){return this.getPointBox()}},{key:"getPointBox",value:function(){var t=1/0,e=1/0,n=-1/0,r=-1/0;return this.points.forEach((function(a){t=Math.min(t,a[0]),e=Math.min(e,a[1]),n=Math.max(n,a[0]),r=Math.max(r,a[1])})),{x:t,y:e,width:n-t,height:r-e,minX:t,minY:e,maxX:n,maxY:r}}},{key:"canvas2Relative",value:function(t){t=zi(t);var e=this.getKeyShapeBox();return{x:t.x-e.x,y:t.y-e.y}}},{key:"canvas2percentage",value:function(t){return this.relative2Percentage(this.canvas2Relative(t))}},{key:"relative2Percentage",value:function(t){t=zi(t);var e=this.getKeyShapeBox();return[t.x/e.width,t.y/e.height]}},{key:"relative2Canvas",value:function(t){t=zi(t);var e=this.getKeyShapeBox();return{x:e.x+t.x,y:e.y+t.y}}},{key:"percentage2Canvas",value:function(t){t=zi(t);var e=this.getKeyShapeBox();return{x:e.x+e.width*t.x,y:e.y+e.height*t.y}}},{key:"percentage2Relative",value:function(t){t=zi(t);var e=this.getKeyShapeBox();return[e.width*t.x,t.y*e.height]}},{key:"isPointInFill",value:function(t){return this.getKeyShape().isPointInFill(Yi(t))}},{key:"isPointInStroke",value:function(t){return this.getKeyShape().isPointInStroke(Yi(t))}},{key:"updateModel",value:function(t){var e;null===(e=t.points)||void 0===e||e.forEach((function(t){var e=$d([t[0],t[1]]);t[0]=e[0],t[1]=e[1]})),_()(L()(n.prototype),"updateModel",this).call(this,t),this.afterUpdateModel()}},{key:"getIntersectionPoint",value:function(t){var e=this.getKeyShapeBox(),n={x:e.x+e.width/2,y:e.y+e.height/2},r=n.x,a=n.y;return this.getKeyShape().getIntersectionPoint(t.x,t.y,r,a)}},{key:"isPointInShape",value:function(t){var e=Yi(t),n=this.getKeyShape();return n.isPointInFill(e)||n.isPointInStroke(e)}},{key:"updateGeometryProperties",value:function(){var t=this.getPointBox();this.height=t.height,this.width=t.width,this.x=t.x,this.y=t.y}},{key:"afterUpdateModel",value:function(){this.updateGeometryProperties()}},{key:"draw",value:function(){this.updateCache()}},{key:"updateCache",value:function(){var t=this,e=this.cache;["points","stroke"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity"],points:[]})}}]),n}();function dp(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return{didIntersect:n.length>0,message:t,points:n}}function hp(t,e,n,r){var a=Zd(t,n),i=Zd(r,n),o=Zd(e,t),c=i[0]*a[1]-i[1]*a[0],l=o[0]*a[1]-o[1]*a[0],s=i[1]*o[0]-i[0]*o[1];if(0===c||0===l)return dp("coincident");if(0===s)return dp("parallel");if(0!==s){var u=c/s,d=l/s;if(u>=0&&u<=1&&d>=0&&d<=1)return dp("intersection",Vd(t,Ud(o,u)))}return dp("no intersection")}function fp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(up,"className","Freehand");var pp=function(t){S()(n,up);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"element",new ha),c()(E()(r),"isFreeHand",!0),c()(E()(r),"opacity",void 0),c()(E()(r),"points",void 0),r}return y()(n,[{key:"draw",value:function(){var t={};"mark-pencil"===this.shape&&(t.start={taper:0,cap:!1},t.end={taper:0,cap:!1},t.simulatePressure=!1),t.size=3*this.stroke.width;var e=Gi(de(this.points,t));this.element.update({d:e,fill:this.stroke.color,opacity:this.opacity}),_()(L()(n.prototype),"draw",this).call(this)}},{key:"isIntersectLineSegment",value:function(t){var e,n,r,a=this.points,i=this.getKeyShapeBox(),o=b()(t,2),c=o[0],l=o[1];if(i.width<8&&i.height<8)return function(t,e,n){return function(t,e){return Math.hypot(t[1]-e[1],t[0]-e[0])}(n,Jd(t,e,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]))}(c,l,function(t){return[t.minX+t.width/2,t.minY+t.height/2]}(i))<5;if(n=c,r=l,function(t,e,n,r){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[t[0]+e[0]/2,t[1]+e[1]/2],a=Qd(t,r,n),i=Qd(Vd(t,[e[0],0]),r,n),o=Qd(Vd(t,e),r,n),c=Qd(Vd(t,[0,e[1]]),r,n);return[["top",[a,i]],["right",[i,o]],["bottom",[o,c]],["left",[c,a]]]}(t,e).reduce((function(t,e){var a=b()(e,2),i=a[0],o=b()(a[1],2),c=o[0],l=o[1],s=hp(n,r,c,l);return s&&t.push(dp.apply(void 0,[i].concat(D()(s.points)))),t}),[]).filter((function(t){return t.didIntersect}))}([(e=i).minX,e.minY],[e.width,e.height],n,r))for(var s=1;s<a.length;s++)if(hp(a[s-1],a[s],c,l).didIntersect)return!0;return!1}},{key:"getIntersectionPoint",value:function(t){var e=this.getKeyShapeBox(),n=[e.x,e.y+e.height/2],r=[e.maxX,e.y+e.height/2],a=[e.x+e.width/2,e.minY],i=[e.x+e.width/2,e.maxY],o=1/0,c=n;return[n,r,a,i].forEach((function(e){var n=lo(t,e);n<o&&(o=n,c=e)})),zi(c)}},{key:"isPointInFill",value:function(t){return Po(t,function(t){return{x:t.x,y:t.y,w:t.width,h:t.height,r:0}}(this.getKeyShapeBox()))}},{key:"updateCache",value:function(){var t=this,e=this.cache;["points","stroke","fill"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},rotate:0,penetratedKeys:["points","stroke","opacity","shape"],Subcells:[],points:[]})}}]),n}();function mp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(pp,"className","Freehand");var yp=function(t){S()(n,up);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"isPen",!0),c()(E()(r),"fill",void 0),c()(E()(r),"isClosed",void 0),c()(E()(r),"points",void 0),r}return y()(n,[{key:"createRendererElement",value:function(){if(!this.element||this.isCacheStale("roughFillStyle")){var t=this.getRoughGraphicOptions(),e=new(t?ti:ha)(vp({},t));this.element&&this.element.remove(),this.element=e,this.graphicGroup.add(this.element)}}},{key:"canRough",value:function(){return!0}},{key:"draw",value:function(){this.createRendererElement();var t=this.points.reduce((function(t,e,n){return t+(0===n?"M ".concat(e[0],",").concat(e[1]):"L ".concat(e[0],",").concat(e[1]))}),"");this.isClosed&&(t+="Z"),this.element.update(vp({d:t,fill:this.fill.color,stroke:this.stroke.color,"stroke-width":this.stroke.width},this.convertStrokeStyle())),_()(L()(n.prototype),"draw",this).call(this)}},{key:"convertStrokeStyle",value:function(){if("dash"===this.stroke.style){var t=this.stroke.width||1;return{"stroke-dasharray":"".concat(2*t)}}return{"stroke-dasharray":"none"}}},{key:"updateCache",value:function(){var t=this,e=this.cache;["points","stroke","fill","isClosed","roughFillStyle"].forEach((function(n){var r=t[n];e[n]=d()(r)?vp({},r):r}))}},{key:"getIntersectionPoint",value:function(t){var e=this.getKeyShapeBox(),n=[e.x,e.y+e.height/2],r=[e.maxX,e.y+e.height/2],a=[e.x+e.width/2,e.minY],i=[e.x+e.width/2,e.maxY],o=1/0,c=n;return[n,r,a,i].forEach((function(e){var n=lo(t,e);n<o&&(o=n,c=e)})),zi(c)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stroke:{color:"#595959",width:2},fill:{color:"transparent"},rotate:0,penetratedKeys:["points","stroke","fill","isClosed"],Subcells:[],points:[],isClosed:!1})}}]),n}();c()(yp,"className","Pen");var gp=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this)).diagram=t,r._initEvent(),r}return y()(n,[{key:"_initEvent",value:function(){var t,e,n=this,r=this.diagram,a=[],i=[1/0,1/0,0];this.bind(r,"pointerdown",(function(o){var c,l,s,u,d,h,f;if(2!==o.button&&n.isEnable){var p=null===(c=r.settings)||void 0===c||null===(l=c.freehand)||void 0===l?void 0:l.strokeWidth,m=null===(s=r.settings)||void 0===s||null===(u=s.freehand)||void 0===u?void 0:u.stroke,v=null!==(d=null===(h=r.settings)||void 0===h||null===(f=h.freehand)||void 0===f?void 0:f.shape)&&void 0!==d?d:"pencil";a=[];var y=n.client2draw(o);a.push(y),t=r.add({shape:v,type:"freehand",points:a,stroke:{width:p,color:m},opacity:"pencil"===v?1:.5})[0],e=n.bind(window,"pointermove",Bt()((function(e){if(n.isEnable&&t){var o=n.client2draw(e);Ft()(i,o)||(i=o,a.push(o),r.update(t,{points:a}))}}),16))}})),this.bind(window,"pointerup",(function(o){if(t){var c=s()(t.model);n.count(c),delete c.id,r.remove(t),r.command.execute("Add",{model:c,autoSelect:!1}),n.unbind(e),a=[],t=void 0,i=[1/0,1/0,0]}}))}},{key:"count",value:function(t){var e,n=this.diagram;null!==(e=n.spm)&&void 0!==e&&e.click&&("pencil"===t.shape?n.spm.click("a385.b4693.c121188.d251467",{shape:t.shape}):"mark-pencil"===t.shape&&n.spm.click("a385.b4693.c121188.d251468",{shape:t.shape}))}},{key:"client2draw",value:function(t){var e=$d(this.diagram.viewport.invertClient([t.clientX,t.clientY]));return e.push(t.pressure),e}},{key:"isEnable",get:function(){return"free-hand"===this.diagram.interaction.currentMode}},{key:"reset",value:function(){this.unbind()}}]),n}();function bp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(gp,"className","FreehandDraw");var kp="url('https://gw.alipayobjects.com/zos/bmw-prod/b0d18072-618f-49fe-8523-923c08d19764.svg') 14.72 8, auto",wp="url(https://gw.alipayobjects.com/zos/bmw-prod/87c9f5e3-90b6-46b6-b051-44b013e1dce7.svg) 9 9, auto",Cp=function(t){S()(n,hl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n),(r=e.call(this)).diagram=t,c()(E()(r),"lineElement",mu({stroke:"#aaa","stroke-width":2})),c()(E()(r),"group",new na),c()(E()(r),"drawGroup",new na),c()(E()(r),"interactGroup",new na),c()(E()(r),"pen",void 0),c()(E()(r),"lastPen",void 0),c()(E()(r),"controlPointButtons",[]),c()(E()(r),"controlPoints",[]),c()(E()(r),"activeIndex",0),c()(E()(r),"activeIndexes",[]),c()(E()(r),"drawEvents",[]),c()(E()(r),"interactEvents",[]),c()(E()(r),"uiControlPointButton",Ni(1,!0)),c()(E()(r),"_closeToControlPoints",!1),c()(E()(r),"start",!0),c()(E()(r),"startpoint",[1/0,1/0]),c()(E()(r),"interact",!1),r.initEvent(),r.initInteractEvent(),r.group.add(r.drawGroup),r.group.add(r.interactGroup),r.uiControlPointButton.group.hide(),r.group.add(r.uiControlPointButton.group),r.drawGroup.add(r.lineElement),r.diagram.frontRootGroup.prepend(r.group),r.bind(t,"aftermodechange",(function(){var e;if("pen"===t.interaction.currentMode){if(r.start=!0,!r.pen){var n=t.find(r.lastPen);n&&(r.pen=n),r.pen&&(r.start=!1,r.initControlPoints())}}else r.lastPen=null===(e=r.pen)||void 0===e?void 0:e.model.id,r.reset()}));var a=t.viewport.zoom;return r.bind(t,"afterviewportchange",Bt()((function(){a!==t.viewport.zoom&&(r.updateControlPoints(),a=t.viewport.zoom)}))),r}return y()(n,[{key:"createElements",value:function(){var t=this;if(this.pen){var e=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){var a=Ni(r,!1);a.group.update(xp(xp({},zi(n)),{},{scale:e})),t.controlPointButtons.push(a),t.controlPoints.push(D()(n)),t.interactGroup.add(a.group)})),this.updateActiveButton(this.pen.points.length-1,!0)}}},{key:"closeToControlPoints",value:function(){this._closeToControlPoints=!0,this.diagram.align.clear(),this.lineElement.hide()}},{key:"notCloseToControlPoints",value:function(){this.updateAlignPoints(),this._closeToControlPoints=!1}},{key:"enable",get:function(){return"pen"===this.diagram.interaction.currentMode}},{key:"setCursor",value:function(t){var e=this.diagram;"pen"===e.interaction.currentMode&&e.setCursor(t)}},{key:"finishDraw",value:function(){var t=this;this._closeToControlPoints=!1,this.start=!0,this.lineElement.hide();var e=this.pen;this.reset(),setTimeout((function(){t.diagram.interaction.changeMode("edit"),e&&t.diagram.selector.select([e])}))}},{key:"initEvent",value:function(){var t,e=this,n=this.diagram;this.drawEvents.push(this.bind(n,"aftercommandforward",(function(){e.initControlPoints()}))),this.drawEvents.push(this.bind(n,"aftercommandbackward",(function(){e.initControlPoints()}))),this.drawEvents.push(this.bind(n,"mousedown",(function(r){var a;if(2!==r.button&&e.enable&&!(e._closeToControlPoints||null!==(a=e.pen)&&void 0!==a&&a.isClosed)){var i=e.client2draw(r);if(e.start){var o;e.start=!1,e.startpoint=i;var c=Object(F.a)(),l={id:c,type:"pen",points:[e.startpoint]};n.hooks.decorateAddPenModel.call(l),n.command.execute("Add",{model:l}),null===(o=n.spm)||void 0===o||o.click("a385.b4693.c124035"),e.pen=n.find(c)}else if(e.pen){if(e.activeIndex!==e.pen.points.length-1)return;if(lo(i,e.pen.points[0])<=6)return n.command.execute("Update",{id:e.pen,model:{isClosed:!0}}),void e.finishDraw();var u=s()(e.pen.points);u.push(t||i),n.command.execute("Update",{id:e.pen,model:{points:u}}),t=void 0}e.updateAlignPoints(),e.initControlPoints(),e.lineElement.update({d:""})}}))),this.drawEvents.push(this.bind(n,"mousemove",Bt()((function(n){if(e.enable&&e.pen&&!e.pen.isClosed&&!e.start&&e.isSelectedLast()&&!e.interact){var r=e.client2draw(n);e.align(r),lo(r,e.startpoint)<=6&&(r=e.startpoint),t=r;var a=["M",e.pen.points[e.pen.points.length-1],"L",r].join(" ");e.lineElement.show(),e.lineElement.update({d:a})}}),16))),this.drawEvents.push(this.bind(n,"keyup",(function(t){"Escape"!==t.key&&"Enter"!==t.key||!e.pen||e.finishDraw()})))}},{key:"isSelectedLast",value:function(){return!!this.pen&&this.activeIndex===this.pen.points.length-1}},{key:"cleanInteract",value:function(){var t=this;this.interactGroup.clear(),this.interactEvents.forEach((function(e){t.unbind(e)})),this.controlPointButtons=[],this.controlPoints=[]}},{key:"initControlPoints",value:function(){this.updateAlignPoints(),this.cleanInteract(),this.createElements(),this.initInteractEvent()}},{key:"updateControlPoints",value:function(){var t=this;if(this.pen){this.controlPoints=[];var e=1/this.diagram.viewport.zoom;this.pen.points.forEach((function(n,r){t.controlPointButtons[r].group.update(xp(xp({},zi(n)),{},{scale:e})),t.controlPoints.push(D()(n))}))}}},{key:"align",value:function(t){var e=this.diagram.align.alignByPoint(xp(xp({},zi(t)),{},{weight:1,box:this.p2b(t)}));t[0]+=e.dx,t[1]+=e.dy}},{key:"selectActiveButton",value:function(t){this.updateActiveButton(t)}},{key:"updateActiveButton",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.diagram,a=s()(this.activeIndexes);if(Array.isArray(t))this.activeIndexes=t;else if(r.signal.keydown.Shift&&!n){var i=this.activeIndexes.indexOf(t);i>=0?this.activeIndexes.splice(i,1):this.activeIndexes.push(t)}else this.activeIndexes=[t];a.forEach((function(t){var n;null===(n=e.controlPointButtons[t])||void 0===n||n.shape.update({stroke:Gr,fill:"#FFFFFF"})})),this.activeIndexes.forEach((function(t){var n;null===(n=e.controlPointButtons[t])||void 0===n||n.shape.update({stroke:"#3384F5","stroke-width":1,fill:"#C0D9FC"})})),1===this.activeIndexes.length?this.activeIndex=this.activeIndexes[0]:this.activeIndex=-1,this.activeIndex===this.controlPointButtons.length-1?(this.lineElement.update({d:""}),this.lineElement.show()):this.lineElement.hide()}},{key:"initInteractEvent",value:function(){var t=this,e=this.diagram,n=this.pen;if(n){var r,a,i=-1,o=!1,c=!1;this.interactEvents.push(this.bind(e,"mousedown",(function(e){var r,l,u=null===(r=e.target)||void 0===r?void 0:r.dataset;null!==(l=u.test_id)&&void 0!==l&&l.startsWith("line-control-point")&&(i=Number(u.index),a={points:s()(n.points)},t.updateActiveButton(i),qt()(i)&&(c=!0,t.updateAlignPoints(),t.interact=!0,t.lineElement.hide()),"true"===u.isUIPoints?o=!0:"false"===u.isUIPoints&&(o=!1))}))),this.interactEvents.push(this.bind(this.diagram,"mousemove",Bt()((function(e){var a=t.diagram,l=t.client2draw(e);c&&t.align(l);for(var u=!1,d=t.controlPoints,h=0;h<d.length;++h){var f=d[h];if(0===h&&lo(l,f)<=6)return t.notCloseToControlPoints(),t.uiControlPointButton.group.hide(),void(t.isSelectedLast()?t.setCursor("url(https://gw.alipayobjects.com/zos/bmw-prod/eaa8e58e-4b6a-41a2-a17a-c2ac014ca278.svg) 14.72 8, auto"):t.setCursor(wp));if(lo(l,f)<=6&&!c){t.closeToControlPoints(),t.uiControlPointButton.group.hide(),u=!0,t.setCursor(wp);break}}if(!u&&!c){i<0&&t.setCursor(kp);var p=n.getKeyShape().getClosestPoint(l[0],l[1]);if(lo(l,p.point)<=6){t.uiControlPointButton.group.show(),t.uiControlPointButton.group.update(xp(xp({},zi(p.point)),{},{scale:1/a.viewport.zoom}));for(var m=[],v=0,y=0;y<t.controlPoints.length;y++){var g=void 0;if(y===t.controlPoints.length-1){if(!n.isClosed)break;g=lo(t.controlPoints[y],t.controlPoints[0])}else g=lo(t.controlPoints[y],t.controlPoints[y+1]);m.push(g),v+=g}var b=0,x=0;m.reduce((function(t,e,n){var r=(t+e)/v;return x<=p.percentage&&p.percentage<=r&&(b=n+1),x=r,t+e}),0),t.uiControlPointButton.group.dataset({index:b+""}),t.uiControlPointButton.shape.dataset({index:b+""}),c||t.closeToControlPoints(),t.lineElement.hide(),u=!0}else t.uiControlPointButton.group.hide()}!u&&i<0&&t.notCloseToControlPoints(),i<0||(c||t.closeToControlPoints(),r=s()(n.points),t.interactGroup.hide(),t.uiControlPointButton.group.hide(),o?(r.splice(i,0,l),o=!1):r[i]=l,a.update(n,{points:r}))}),16))),this.interactEvents.push(this.bind(this.diagram,"mouseup",(function(o){t.interactGroup.show(),r&&(e.command.execute("Update",{id:n.model.id,model:{points:r},originModels:a}),t.initControlPoints(),t.updateActiveButton(i),t.lineElement.hide(),t._closeToControlPoints=!1,r=void 0),i<0&&(!t.isSelectedLast()||n.isClosed)&&t.finishDraw(),e.align.reset(),i=-1,c=!1,t.interact=!1}))),this.interactEvents.push(this.bind(e,"keydown",(function(r){if(n){r.preventDefault();var a=s()(n.points),i={points:s()(n.points)};if("Backspace"===r.key)t.activeIndexes.length>=0&&(a.length===t.activeIndexes.length?(e.command.execute("Delete",{cells:[n.model.id],originModels:i}),t.start=!0,t.reset()):(un(a,t.activeIndexes),e.command.execute("Update",{id:n.model.id,model:{points:a},originModels:i}),t.initControlPoints()));else if("a"===r.key&&Si(r))t.updateActiveButton(n.points.map((function(t,e){return e})));else{var o=0,c=0;switch(r.key){case"Left":case"ArrowLeft":o=-1;break;case"Right":case"ArrowRight":o=1;break;case"Up":case"ArrowUp":c=-1;break;case"Down":case"ArrowDown":c=1;break;default:return}if(t.activeIndexes.length>0){t.activeIndexes.forEach((function(t){a[t][0]+=o,a[t][1]+=c})),e.command.execute("Update",{id:n.model.id,model:{points:a},originModels:i});var l=s()(t.activeIndexes);t.initControlPoints(),t.updateActiveButton(l)}}}})))}}},{key:"init",value:function(t){this.pen=t,this.initControlPoints(),this.start=!1,this.startpoint=s()(t.points[0])}},{key:"client2draw",value:function(t){var e=this.diagram.viewport.invertClient([t.clientX,t.clientY]);return $d([e[0],e[1]])}},{key:"updateAlignPoints",value:function(){var t=this,e=this.pen;if(e){var n=[],r=e.getBBox(),a=[r.x+r.width/2,r.y+r.height/2];n.push([xp(xp({},zi(a)),{},{weight:1,box:r})]),e.points.forEach((function(e){n.push([xp(xp({},zi(e)),{},{weight:1,box:t.p2b(e)})])})),this.diagram.align.updateToAlignPointSet(n)}}},{key:"p2b",value:function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}}},{key:"reset",value:function(){this.start=!0,this.pen=void 0,this.activeIndexes=[],this.lineElement.hide(),this.uiControlPointButton.group.hide(),this._closeToControlPoints=!1,this.cleanInteract(),this.diagram.align.reset()}},{key:"clearCache",value:function(){this.lastPen=void 0}},{key:"destory",value:function(){this.unbind(),this.group.clear()}}]),n}();c()(Cp,"className","PenDrawInteract");var Ap=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"pen",void 0),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram,n=function(n){t.pen=n,e.interaction.changeMode("pen"),e.penDrawInteract.init(n)};this.bind(e,"dblclick",(function(t){var r=e.getCell(t.target);r&&wr(r)&&n(r)})),this.bind(e,"keyup",(function(t){var r=e.selector.selections;1===r.length&&wr(r[0])&&"Enter"===t.key&&n(r[0])}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Op=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"pen",void 0),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this.diagram;this.bind(t,"aftermodechange",(function(){"pen"===t.interaction.currentMode&&t.vertexRotateResize.end()}))}},{key:"reset",value:function(){this.unbind()}}]),n}();var Ep=function(t){S()(n,Ql);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.bind(t,"aftercommandbackward",(function(t){var n=t.command;n instanceof hc?e.reDraw():n instanceof Cf&&e.reEnter(n.cells[0])})),this.bind(t,"aftercommandforward",(function(t){var n=t.command;n instanceof hc?e.reEnter(n.model.id):n instanceof Cf&&e.reDraw()}))}},{key:"reDraw",value:function(){this.diagram.penDrawInteract.reset()}},{key:"reEnter",value:function(t){var e=this.diagram,n=e.find(t);n&&wr(n)&&e.penDrawInteract.init(n)}}]),n}();var Pp=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"group",new na),c()(E()(t),"eraserPoints",[]),c()(E()(t),"prevPoint",void 0),c()(E()(t),"prevEraserPoint",void 0),c()(E()(t),"timestamp",0),c()(E()(t),"interval",void 0),c()(E()(t),"eraserPath",new ha),c()(E()(t),"loop",(function(){var e=Date.now(),n=e-t.timestamp,r=!1;if(t.prevEraserPoint!==t.prevPoint&&(r=!0,t.eraserPoints.push(t.prevPoint),t.prevEraserPoint=t.prevPoint),n>32&&t.eraserPoints.length>1&&(r=!0,t.eraserPoints.splice(0,Math.ceil(.1*t.eraserPoints.length)),t.timestamp=e),r){var a=t.diagram.viewport.zoom,i=Gi(de(t.eraserPoints,{size:16/a,start:{taper:!0}}));t.eraserPath.update({d:i})}t.interval=requestAnimationFrame(t.loop)})),c()(E()(t),"cancel",(function(){t.eraserPath.update({d:""}),t.eraserPoints=[],cancelAnimationFrame(t.interval)})),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.preparePath(),this._initEvent()}},{key:"preparePath",value:function(){this.eraserPath.css({id:"eraser"}),this.eraserPath.update({fill:"#aaa",opacity:.33}),this.group.add(this.eraserPath),this.diagram.frontRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var t=this,e=this.diagram,n=[],r=new Set,a=0,i=!1,o=function(){var t=[];return r.forEach((function(e){return t.push(e)})),t};this.bind(e,"pointerdown",(function(r){n=e.getFreehands(),i=!0;var a=t.client2draw(r);t.eraserPoints=[a],t.prevPoint=a,t.loop()})),this.bind(window,"pointermove",Bt()((function(c){if(i){var l=t.client2draw(c);if(n.forEach((function(e){r.has(e.model.id)||e.isIntersectLineSegment([t.prevPoint,l])&&r.add(e.model.id)})),t.prevPoint=l,r.size!==a){a=r.size;var s=o();e.update(s,{opacity:.3})}}}),16)),this.bind(window,"pointerup",(function(n){if(i=!1,cancelAnimationFrame(t.interval),t.eraserPath.update({d:""}),r.size>0){var a=o(),c=[];a.forEach((function(t){var n=e.find(t);"pencil"===(null==n?void 0:n.shape)?c.push({opacity:1}):c.push({opacity:.5})})),e.update(a,c),e.command.execute("Delete",{cells:a}),r.clear()}}))}},{key:"client2draw",value:function(t){return $d(this.diagram.viewport.invertClient([t.clientX,t.clientY]))}},{key:"reset",value:function(){this.unbind(),this.cancel(),this.group.clear()}}]),n}();function Sp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var jp={lake_prevent_click_unselect:"true",draw_base_resize_controller:"true"},Rp=function(t){S()(n,rh);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"cell",void 0),c()(E()(r),"drawbaseGroup",new na),c()(E()(r),"p0",fi("start",jp)),c()(E()(r),"p1",fi("end",jp)),r.drawbaseGroup.add(r.p0.group),r.drawbaseGroup.add(r.p1.group),r.drawbaseGroup.hide(),t.frontRootGroup.add(r.drawbaseGroup),r}return y()(n,[{key:"init",value:function(t){this.cell=t,this.lowMode()?this._init():_()(L()(n.prototype),"init",this).call(this,t)}},{key:"_init",value:function(){this.bindEvent()}},{key:"update",value:function(){var t=this.p0,e=this.p1,r=this.cell;if(r){var a=1/this.diagram.viewport.zoom;this.lowMode()?(r.points.forEach((function(n,r){n&&(0===r?t:e).group.update(Mp(Mp({},zi(n)),{},{scale:a}))})),1===r.points.length&&e.group.hide()):_()(L()(n.prototype),"update",this).call(this)}}},{key:"bindEvent",value:function(){var t,e,r,a=this,i=this.eventHelper,o=this.p0,c=this.p1,l=this.cell,u=!1;this.lowMode()?([o,c].forEach((function(n){var r=n.shape,a=n.name;i.bind(r,"mousedown",(function(n){u=!0,e=a,t={points:s()(l.points)}}))})),i.bind(this.diagram,"mousemove",(function(t){if(u){a.hide();var n,i=a.client2draw(t),o=s()(l.points),c=o[n="start"===e?0:1];o[n]=D()(i),kr(l)&&(o[n][2]=c[2]),r={points:o},a.diagram.update(l,r)}})),i.bind(this.diagram,"mouseup",(function(){e&&(u=!1,e="",a.update(),a.show(),a.diagram.command.execute("Update",{id:l,model:r,originModels:t}))}))):_()(L()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.lowMode()?(this.update(),this.show(),_()(L()(n.prototype),"hide",this).call(this)):(this.hide(),_()(L()(n.prototype),"begin",this).call(this))}},{key:"show",value:function(){this.lowMode()?(this.drawbaseGroup.show(),this.p1.group.show()):_()(L()(n.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.lowMode()?(this.drawbaseGroup.hide(),this.p1.group.hide()):_()(L()(n.prototype),"hide",this).call(this)}},{key:"end",value:function(){this.eventHelper.unbind(),this.drawbaseGroup.hide(),this.p1.group.hide(),_()(L()(n.prototype),"end",this).call(this)}},{key:"lowMode",value:function(){return this.cell.points.length<=2}},{key:"client2draw",value:function(t){var e=this.diagram.viewport.invertClient([t.clientX,t.clientY]);return $d([e[0],e[1]])}}]),n}();c()(Rp,"className","DrawBaseResizer");var Lp,Bp=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){Si(e)&&"a"===e.key&&(t.interaction.changeMode("edit"),e.preventDefault(),e.stopPropagation(),t.command.execute("SelectAll"),t.tryFocus())}))}}]),n}(),Dp={Cells:[yp,pp],Extends:[Cp,gp,Rp],defaultCursors:(Lp={},c()(Lp,"pen",kp),c()(Lp,"free-hand","url(https://gw.alipayobjects.com/zos/bmw-prod/f16b8ea8-336e-4ea8-a900-70e59408ec3e.svg) 10.61 21.32, auto"),c()(Lp,"eraser","url(https://gw.alipayobjects.com/zos/bmw-prod/16f33e84-9723-4005-b6ad-4a0d3e37c06b.svg) 14.73 20.61,auto"),Lp),modes:[{mode:"edit",Behaviours:[Ap]},{mode:"pen",Behaviours:[Op,Ep]},{mode:"free-hand",Behaviours:[Ql,Bp]},{mode:"eraser",Behaviours:[Pp,Ql]}],Commands:[]};rp.registerClipboardProcessor("mindmap",{text:function(t){var e=t.text,n=t.diagram,r=n.selector.selections,a=r[0];if(1===r.length&&a.isMindmap){var i=kl(e);if(i){a.collapsed&&n.update(a,{collapsed:null});var o=a.model.children.filter((function(t){return!t.abstract})).length;return i.forEach((function(t,e){t.options={parent:a.model.id,nth:o+e}})),i}}return!1},textIndex:2}),uh.registerContentEditorOptions("mindmap",{insertParagraphKey:function(t){return(t.metaKey||t.ctrlKey||t.altKey)&&"Enter"===t.key},cancelKey:function(t){return"Tab"===t.key||"Tag"===t.key||"Enter"===t.key||"Escape"===t.key}}),yh.filterCell((function(t){return!t.isMindmap}));var Np=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).className="MindmapCollapseButton",r.configName="mindmapCollapseButton",r.current="none",r.zIndex=1,r.radius=8,r.outer=12,r}return y()(n,[{key:"render",value:function(){var t=this.cell,e=t.graphicGroup,n=new na;this.group=n,t.collapsedButtonElement=n,e.add(n),this.delegateEvent()}},{key:"delegateEvent",value:function(){var t=this.group;this.cell.delegateEvent(t,"click","collapsedbutton:click")}},{key:"drawPosition",value:function(){this.draw()}},{key:"updateState",value:function(){this.drawButton()}},{key:"_getCurrent",value:function(t){var e=this.cell,n=e.computedProps.treeEdge,r=e.x,a=e.y,i=e.width,o=e.height;return t+r+a+n.stroke+i+o}},{key:"_setDirection",value:function(){var t=this.cell,e=t.downLayoutType,n=t.downDirection;"standard"===e?0===n[0]?Math.sign(-1===n[1])?this.direction="top":this.direction="bottom":Math.sign(-1===n[0])?this.direction="left":this.direction="right":"indent"===e?-1===Math.sign(n[1])?this.direction="top":this.direction="bottom":"timeline"===e&&-1===Math.sign(n[0])?this.direction="left":this.direction="right"}},{key:"_updatePosition",value:function(t){var e,n,r=this.cell,a=this.direction,i=this.bbox,o=r.border,c=i.width,l=i.height;switch(a){case"top":e=r.width/2-c/2,n=-l;break;case"bottom":e=r.width/2-c/2,n=r.height+8;break;case"left":n="line"===o.shape?r.height-l/2:r.height/2-l/2,e=-c;break;default:n="line"===o.shape?r.height-l/2:r.height/2-l/2,e=r.width+8}var s=[1,0,0,0,1,0,e,n,1];t.update({matrix:s})}},{key:"_setBBox",value:function(){var t,e,n=this.direction,r=2*this.radius,a=2*this.radius;switch(n){case"top":case"bottom":t=r,e=a+8;break;default:e=a,t=r+8}this.bbox={width:t,height:e}}},{key:"_drawCollapseButtonHotspot",value:function(){var t=this.bbox,e=this.group,n=this.outer,r=new ha,a=2*n;e.clear(),r.update({fill:"transparent",d:Jn(-n,-n,t.width+.8*a,t.height+a)}),e.add(r),r.toBack(),this._updatePosition(e)}},{key:"_drawCollapseButton",value:function(){var t,e=this.cell,n=this.group,r=this.direction,a=this.radius,i=e.computedProps,o=e.diagram.viewport.zoom,c=2*a;switch(r){case"top":t=-Math.PI/2;break;case"bottom":t=Math.PI/2;break;case"left":t=Math.PI;break;default:t=0}var l=["border-radius: 16px","width: ".concat(c,"px"),"height: ".concat(c,"px"),"cursor: pointer","background: white","border: 3px solid ".concat(i.treeEdge.stroke),"display: inline-block"],s=[1,0,0,0,1,0,0,0,1];w.mat3.translate(s,s,[a,a,1]),w.mat3.rotate(s,s,t),w.mat3.translate(s,s,[-a,-a,1]);var u=new ya({html:'<span style="'.concat(l.join(";"),'" data-diagram-collapsed-button=true data-testid="diagram-collapsed-button"></span>'),x:0,y:0,width:0,height:0,matrix:s});u.css({"line-height":"normal"}),n.add(u);var d=u.htmlContainer.querySelector("span"),h=d.getBoundingClientRect(),f=h.width/o,p=h.height/o;u.update({width:f,height:p}),d.style.background=i.treeEdge.stroke,d.style.setProperty("background-repeat","no-repeat"),d.style.setProperty("background-position","1px 1px"),d.style.setProperty("background-image","url(".concat("https://gw.alipayobjects.com/zos/bmw-prod/c8f8bbfd-df13-421d-85f1-e310d67c89fc.svg",")"))}},{key:"_drawExpandButton",value:function(){var t=this.cell,e=this.group,n=this.radius,r=t.computedProps,a=t.diagram,i=r.treeEdge.stroke;e.clear();var o=-1;t.deepEach((function(){o++}));var c=a.font.measureTextLength(String(o))+8,l=yi(i),s=new Sa({x:4,y:3,text:"".concat(o),fill:l,"dominant-baseline":"hanging"});s.dataset({diagramCollapsedButton:"true"}),s.css({fontFamily:"system-ui",fontSize:"12px",cursor:"pointer"});var u=new Oa({x:0,y:0,rx:n,width:c,height:2*n,fill:"".concat(i)});e.add(s),s.before(u),this._drawTail(),this._updatePosition(e)}},{key:"_drawTail",value:function(){var t,e=this.group,n=this.direction,r=this.cell,a=r.computedProps,i=2*this.radius,o=2*this.radius,c={x:i/2,y:o/2};switch(n){case"top":t="M".concat(c.x," ").concat(o," L").concat(c.x," ").concat(o+8);break;case"bottom":t="M".concat(c.x," 0 L").concat(c.x," -").concat(8);break;case"left":t="M".concat(i," ").concat(c.y," L").concat(i+8," ").concat(c.y);break;default:t="M0 ".concat(c.y," L-").concat(8," ").concat(c.y)}e.add(new ha({d:t,stroke:a.treeEdge.stroke,"stroke-width":r.getTreeEdgeStrokeWidth()}))}},{key:"draw",value:function(){var t=this.cell,e=this.current,n=t.state;this._setDirection(),this._setBBox(),t.canExpand()?(e!==this._getCurrent("expandButton")&&this._drawExpandButton(),this.current=this._getCurrent("expandButton")):t.canCollapse()&&(this._drawCollapseButtonHotspot(),n.collapsedButtonVisible&&this._drawCollapseButton())}},{key:"drawButton",value:function(){var t=this.cell,e=this.current,n=t.state;this._setDirection(),this._setBBox(),t.canExpand()?e!==this._getCurrent("expandButton")&&(this._drawExpandButton(),this.current=this._getCurrent("expandButton")):t.canCollapse()&&n.collapsedButtonVisible?e!==this._getCurrent("collapseButton")&&(this._drawCollapseButton(),this.current=this._getCurrent("collapseButton")):("none"!==e&&this.draw(),this.current="none")}},{key:"destroy",value:function(){this.group.destroy()}}]),n}();function _p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Ip=ha,Tp=Ta,Fp=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"createRendererElement",value:function(){var t=this.cell,e=t.graphicGroup,n=t.parent;if(!this.element||t.isCacheStale("roughFillStyle")){var r=t.getRoughGraphicOptions(),a=new(r?ti:Ip)(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_p(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},r));a.capture(!1),e.add(a),this.element&&this.element.remove(),this.element=a,t.treeEdgeElement=a,t.cache.treeEdgeStyle={},t.cache.treeEdgePath=null,n&&n.isStem&&!t.isAbstract&&this._createClipPath()}}},{key:"_createClipPath",value:function(){var t=this.cell,e=this.element,n=t.parent,r=t.diagram;if(n){var a=r.defs,i=Object(F.a)(),o=new Tp({id:i}),c=new Ip({"fill-rule":"nonzero"});o.add(c),a.add(o),this.clipPath&&this.clipPath.remove(),this.treeEdgeClipPath=c,this.clipPath=o,e.update({"clip-path":"url(#".concat(i,")")})}}},{key:"VH",value:function(t,e){return"M".concat(t[0],",").concat(t[1]," L").concat(t[0],",").concat(e[1]," L").concat(e[0],",").concat(e[1])}},{key:"curveHVH",value:function(){var t,e,n,r,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=this.cell,l=c.parent,s=.5,u="";return c.x>l.x?(e=l.isStem?[l.x-c.x+l.width-36,l.y-c.y+l.height/2]:[l.x-c.x+l.width,l.y-c.y+l.height/2+i],(n=[0,c.height/2])[1]+=o,r=[e[0]+4,e[1]],t=(a=[n[0]-4,n[1]])[0]-r[0],u+="M".concat(e[0]," ").concat(e[1]," "),u+="L".concat(r[0]," ").concat(r[1]," "),u+="C".concat(r[0]+.5*t," ").concat(r[1],", ").concat(a[0]-t*s," ").concat(a[1],", ").concat(a[0]," ").concat(a[1]," "),u+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(u+="L".concat(n[0]+c.width," ").concat(n[1]))):(e=l.isStem?[l.x-c.x+36,l.y-c.y+l.height/2]:[l.x-c.x,l.y-c.y+l.height/2+i],(n=[c.width,c.height/2])[1]+=o,r=[e[0]-4,e[1]],a=[n[0]+4,n[1]],t=r[0]-a[0],u+="M".concat(e[0]," ").concat(e[1]," "),u+="L".concat(r[0]," ").concat(r[1]," "),u+="C".concat(r[0]-.5*t," ").concat(r[1],", ").concat(a[0]+t*s," ").concat(a[1],", ").concat(a[0]," ").concat(a[1]," "),u+="L".concat(n[0]," ").concat(n[1]),"line"===c.border.shape&&(u+="L".concat(n[0]-c.width," ").concat(n[1]))),u}},{key:"VHV",value:function(){var t,e,n=this.cell,r=n.parent,a={x:r.x-n.x,y:r.y-n.y},i="";n.y<r.y?(t=[a.x+r.width/2,a.y],e=[n.width/2,n.height]):(t=[a.x+r.width/2,a.y+r.height],e=[n.width/2,0]);var o=(t[1]+e[1])/2;return i+="M".concat(t[0]," ").concat(t[1]," "),i+="L".concat(t[0]," ").concat(o," "),(i+="L".concat(e[0]," ").concat(o," "))+"L".concat(e[0]," ").concat(e[1])}},{key:"HVH",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.cell,o=i.parent,c="";return i.x>o.x?(t=o.isStem?[o.x-i.x+o.width,o.y-i.y+o.height/2]:[o.x-i.x+o.width,o.y-i.y+o.height/2+r],(e=[0,i.height/2])[1]+=a,n=(o.x-i.x+o.width)/2,"line"===i.border.shape&&(e[0]+=i.width)):(t=1===i.depth?[o.x-i.x,o.y-i.y+o.height/2]:[o.x-i.x,o.y-i.y+o.height/2+r],(e=[i.width,i.height/2])[1]+=a,n=(o.x-i.x+i.width)/2,"line"===i.border.shape&&(e[0]-=i.width)),c+="M".concat(t[0]," ").concat(t[1]," "),c+="L".concat(n," ").concat(t[1]," "),(c+="L".concat(n," ").concat(e[1]," "))+"L".concat(e[0]," ").concat(e[1])}},{key:"curveVHV",value:function(){var t,e,n,r,a,i=this.cell,o=i.parent,c={x:o.x-i.x,y:o.y-i.y},l="",s=1===i.depth?0:8;return i.y<o.y?(e=[c.x+o.width/2,c.y],n=[i.width/2,i.height],r=[e[0],e[1]-s],a=[n[0],n[1]+0],t=r[1]-a[1]):(e=[c.x+o.width/2,c.y+o.height],n=[i.width/2,0],r=[e[0],e[1]+s],a=[n[0],n[1]-0],t=r[1]-a[1]),l+="M".concat(e[0]," ").concat(e[1]," "),l+="L".concat(r[0]," ").concat(r[1]," "),(l+="C".concat(r[0]," ").concat(r[1]-.5*t,", ").concat(a[0]," ").concat(a[1]+.5*t,", ").concat(a[0]," ").concat(a[1]," "))+"L".concat(n[0]," ").concat(n[1])}},{key:"getStandardLayoutPath",value:function(){var t=this.cell,e=t.parent,n=t.computedProps,r=t.upDirection,a=n.treeEdge.shape;if(0===r[0])return"polyline"===a?this.VHV():this.curveVHV();var i=0,o=0;return"line"===e.border.shape&&(i=e.height/2),"line"===t.border.shape&&(o=t.height/2),"polyline"===a?this.HVH(i,o):this.curveHVH(i,o)}},{key:"getIndentLayoutPath",value:function(){var t,e,n=this.cell,r=n.computedProps,a=n.border,i=n.parent,o=r.treeEdge.shape,c={x:i.x-n.x,y:i.y-n.y},l=i.x+i.width/2-(n.x+n.width)>0,s=i.y-n.y-n.height>0,u="";if(s?(t=[c.x+i.width/2,c.y],e=l?"line"===a.shape?[0,n.height]:[n.width,n.height/2]:"line"===a.shape?[n.width,n.height]:[0,n.height/2]):(t=[c.x+i.width/2,c.y+i.height],e=l?"line"===a.shape?[0,n.height]:[n.width,n.height/2]:"line"===a.shape?[n.width,n.height]:[0,n.height/2]),"polyline"===o)u+="M".concat(t[0],",").concat(t[1]),u+="L".concat(t[0],",").concat(e[1]),u+="L".concat(e[0],",").concat(e[1]);else{var d=16;if(u+="M".concat(t[0],",").concat(t[1]),s){var h=Math.abs(e[1]-t[1]);h<=d&&(d=h),l?(u+="L".concat(t[0],",").concat(e[1]+d),u+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(t[0]-d,", ").concat(e[1]),u+="L".concat(e[0],",").concat(e[1])):(u+="L".concat(t[0],",").concat(e[1]+d),u+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(t[0]+d,", ").concat(e[1]),u+="L".concat(e[0],",").concat(e[1]))}else l?(u+="L".concat(t[0],",").concat(e[1]-d),u+="A ".concat(d," ").concat(d,", 0, 0, 1, ").concat(t[0]-d,", ").concat(e[1]),u+="L".concat(e[0],",").concat(e[1])):(u+="L".concat(t[0],",").concat(e[1]-d),u+="A ".concat(d," ").concat(d,", 0, 0, 0, ").concat(t[0]+d,", ").concat(e[1]),u+="L".concat(e[0],",").concat(e[1]))}return u}},{key:"getTimelineLayoutPath",value:function(){var t,e=this.cell,n=e.upSignX,r=e.getTimelineLayoutAlign(),a=e.getTimelineLayoutSourceCell(),i={x:a.x-e.x,y:a.y-e.y},o=[0,0];return 1===n?(t="b"===r[0]?[i.x+a.width,i.y+a.height]:[i.x+a.width,i.y+a.height/2],o="b"===r[1]?[e.width,e.height]:[0,e.height/2]):-1===n&&(t="b"===r[0]?[i.x,i.y+a.height]:[i.x,i.y+a.height/2],o="b"===r[1]?[0,e.height]:[e.width,e.height/2]),t&&"M".concat(t[0],",").concat(t[1]," L").concat(o[0],",").concat(o[1])}},{key:"getAbstractLayoutPath",value:function(){var t=this.cell,e=t.al,n=void 0===e?10:e,r=t.ad,a=void 0===r?"x":r,i=t.ap,o=void 0===i?1:i,c=t.width,l=void 0===c?2:c,s=t.height,u=void 0===s?2:s,d=t.computedProps.treeEdge.shape,h=[0,0],f=[0,0],p=[0,0];"x"===a?(h[0]+=.5*l,h[1]+=(1-(o+1)/2)*u,f[0]=h[0]-n/2,p[0]=h[0]+n/2,f[1]=p[1]=h[1]-48*o):(h[0]+=(1-(o+1)/2)*l,h[1]+=.5*u,f[1]=h[1]-n/2,p[1]=h[1]+n/2,f[0]=p[0]=h[0]-48*o);var m="y"===a?[f[0]+12*o,f[1]]:[f[0],f[1]+12*o],v="y"===a?[p[0]+12*o,p[1]]:[p[0],p[1]+12*o],y="y"===a?[h[0]-0*o,h[1]]:[h[0],h[1]-0*o],g="y"===a?[y[0]-16*o,y[1]]:[y[0],y[1]-16*o];return"polyline"===d?"y"===a?"M".concat(m[0],",").concat(m[1]," L").concat(g[0],",").concat(m[1]," L").concat(g[0],",").concat(v[1]," L").concat(v[0],",").concat(v[1]," M").concat(g[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1]):"M".concat(m[0],",").concat(m[1]," L").concat(m[0],",").concat(g[1]," L").concat(v[0],",").concat(g[1]," L").concat(v[0],",").concat(v[1]," M").concat(g[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1]):"y"===a?"M".concat(m[0],",").concat(m[1]," Q").concat(g[0],",").concat(m[1]," ").concat(g[0],",").concat(g[1]," Q").concat(g[0],",").concat(v[1]," ").concat(v[0],",").concat(v[1]," M").concat(g[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1]):"M".concat(m[0],",").concat(m[1]," Q").concat(m[0],",").concat(g[1]," ").concat(g[0],",").concat(g[1]," Q").concat(v[0],",").concat(g[1]," ").concat(v[0],",").concat(v[1]," M").concat(g[0],",").concat(g[1]," L").concat(y[0],",").concat(y[1])}},{key:"getPath",value:function(){var t=this.cell,e=t.upLayoutType,n=t.isAbstract;return e||n?n?this.getAbstractLayoutPath():"indent"===e?this.getIndentLayoutPath():"timeline"===e?this.getTimelineLayoutPath():this.getStandardLayoutPath():""}},{key:"getSytle",value:function(){var t=this.cell;return{stroke:t.computedProps.treeEdge.stroke,"stroke-width":t.getTreeEdgeStrokeWidth()}}},{key:"drawClipPath",value:function(){var t=this.cell,e=this.treeEdgeClipPath;if(e){var n=t.parent,r={x:n.x-t.x,y:n.y-t.y},a=n.getPadding(),i=[r.x+a[3],r.y+a[0]],o=[r.x+n.width-a[1],r.y+n.height-a[2]],c=[Math.min(0,r.x)-50,Math.min(0,r.y)-50],l=[Math.max(t.width,r.x+n.width)+50,Math.max(t.height,r.y+n.height)+50];e.update({d:Wn(c[0],c[1],l[0],l[1],i[0],i[1],o[0],o[1])})}}},{key:"_drawPath",value:function(){var t=this.cell,e=this.element,n=t.cache,r=this.getPath();n.treeEdgePath!==r&&(e.update({d:r}),n.treeEdgePath=r,this.drawClipPath())}},{key:"drawPosition",value:function(){this._drawPath()}},{key:"drawInherit",value:function(){this.draw()}},{key:"draw",value:function(){this.createRendererElement();var t=this.cell,e=this.element,n=t.cache,r=this.getSytle(),a=yn(r,n.treeEdgeStyle,["stroke","stroke-width"]);this._drawPath(),Object.keys(a).length>0&&(e.update(a),n.treeEdgeStyle=s()(r))}},{key:"destroy",value:function(){this.element.destroy(),this.clipPath&&this.clipPath.destroy()}}]),n}();function zp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Fp,"className","TreeEdge"),c()(Fp,"configName","treeEdge"),c()(Fp,"zIndex",1);var qp=function(t){S()(n,su);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e=1===t.depth?400:"normal",r=1===t.depth?'PingFangSC-Medium, "PingFang SC"':'PingFangSC-Regular, "PingFang SC"';_()(L()(n.prototype),"init",this).call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"0.1px","font-size":"".concat(14,"px"),"font-weight":"".concat(e),"line-height":"1.74","word-break":"break-word"}}],defaultFontFamily:r},t))}},{key:"_calculateCapsulePadding",value:function(){var t=this.width,e=this.height;return t&&e?Math.min(t,e)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"getPadding",value:function(){var t,e=this.model;if(1===this.depth)if("line"===this.border.shape)t=[2,8,2,8];else if("rect"===this.border.shape)t=[6,12,6,12];else{var r=this._calculateCapsulePadding();t=new Array(4).fill(r)}else if(this.depth>1)if("line"===this.border.shape)t=[2,8,2,8];else if("rect"===this.border.shape)t=[6,8,6,8];else{var a=this._calculateCapsulePadding();t=new Array(4).fill(a)}else t=_()(L()(n.prototype),"getPadding",this).call(this);return e.note&&(t[1]/=2),t}},{key:"isAbstract",get:function(){return this.model.abstract}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{mindmapCollapseButton:{},border:{outer:0,radius:3,shape:"line",fill:"transparent"},treeEdge:{},Subcells:[Fp,Np]})}}]),n}();c()(qp,"className","MindmapCell");var Yp=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};m()(this,t),c()(this,"zNodes",[]),c()(this,"options",{}),this.options=e,Object.assign(this,e)}return y()(t,[{key:"getHGap",value:function(t){return 20}},{key:"getVGap",value:function(t){return 20}},{key:"getAGap",value:function(t){return 48}},{key:"beforeInsert",value:function(t){var e=this.zNodes;t.isSubTree?e.unshift.apply(e,D()(t.zNodes)):e.unshift(t)}},{key:"getAxisNorm",value:function(t,e,n){var r=t.isSubTree?"t":"";return{axis:r+e,norm:r+n}}},{key:"getAxisNormValue",value:function(t,e,n){var r=t.isSubTree?"t":"",a=r+e,i=r+n;return{coord:null==t[a]?t[e]:t[a],normValue:null==t[i]?t[n]:t[i]}}},{key:"getPureAxisNormValue",value:function(t,e,n){return{coord:t[e],normValue:t[n]}}},{key:"updateParentMaxDepth",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.parent;r;)r.maxDepth=n?Math.max(r.maxDepth,e):Math.min(r.maxDepth,e),r=r.parent}},{key:"setNodeCoord",value:function(t,e,n){if(t.isSubTree){var r="t"+e,a=t[r]-n;Ve(t,(function(t){t.isSubTree&&(t[r]-=a),t[e]-=a}))}else t[e]=n}},{key:"preOrder",value:function(t,e,n){var r=this,a=t.children,i=void 0===a?[]:a;e(t,n),!i||t.isSubTree&&n||t.collapsed||i.forEach((function(n){r.preOrder(n,e,t)}))}},{key:"preOrderWithOutSelf",value:function(t,e,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=t.children,l=void 0===c?[]:c;if(l&&(!t.isSubTree||!n)&&!t.collapsed){var s=o.concat(l.filter((function(t){return!t.abstract})).length);l.forEach((function(n,o){var c=i.concat(o);e(n,t,o,l,a,c,s),r.preOrderWithOutSelf(n,e,t,a+1,c,s)}))}}},{key:"postOrder",value:function(t,e,n){var r=this,a=t.children,i=void 0===a?[]:a;!i||t.isSubTree&&n||t.collapsed||i.forEach((function(n){r.postOrder(n,e,t)})),e(t,n)}},{key:"postOrderWithOutSelf",value:function(t,e,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=t.children,l=void 0===c?[]:c;if(l&&(!t.isSubTree||!n)&&!t.collapsed){var s=o.concat(l.filter((function(t){return!t.abstract})).length);l.forEach((function(n,o){var c=i.concat(o);r.postOrderWithOutSelf(n,e,t,a+1,c,s),e(n,t,o,l,a,c,s)}))}}},{key:"orderByGroupWithoutSelf",value:function(t,e,n){var r=this,a=new Map,i=n.initInfo,o=n.enterGroup,c=n.exitGroup,l=n.beforecallback,s=n.callback,u=n.aftercallback;return t.call(this,e,(function(t,e,n,d,h,f,p){if(0===n){var m=d.filter((function(t){return t.abstract})),v=m.length,y=d.length-v,g=[];m.forEach((function(t){var e=r.getAbstractLocateString(t,y);g.push(e)}));var b={areasQueue:g,nowGroup:null,groupIndex:-1,childrenLength:y,abstractLength:v,nowGroupData:void 0};a.set(e,Object.assign(b,i(b,t,e,n,d,h,f,p)))}var x=a.get(e);if(l&&n<x.childrenLength&&l(x,t,e,n,d,h,f,p),!x.nowGroup){var k=x.areasQueue[0]?r.parseAbstractLocateString(x.areasQueue[0]):void 0;k&&n===k[0]&&(x.nowGroup=k,x.areasQueue.shift(),x.groupIndex++,o&&(x.nowGroupData=o(x,t,e,n,d,h,f,p)))}s&&n<x.childrenLength&&s(x,t,e,n,d,h,f,p),!x.nowGroup||n!==x.nowGroup[0]+x.nowGroup[1]-1&&n!==x.childrenLength-1||(c&&c(x,t,e,n,d,h,f,p),x.nowGroup=null,x.nowGroupData=void 0),u&&n<x.childrenLength&&u(x,t,e,n,d,h,f,p)})),a}},{key:"postOrderByGroupWithoutSelf",value:function(t,e){return this.orderByGroupWithoutSelf(this.postOrderWithOutSelf,t,e)}},{key:"preOrderByGroupWithoutSelf",value:function(t,e){return this.orderByGroupWithoutSelf(this.preOrderWithOutSelf,t,e)}},{key:"deeperAllLast",value:function(t,e,n){for(var r=t+1;r<e.length;r++)if(e[r]!==n[r]-1)return!1;return!0}},{key:"makeAbstractBreadthOffset",value:function(t,e,n,r,a,i,o,c){var l="x"===t?"x":"y",s="x"===t?"w":"h",u=this.getAxisNorm(i,l,s),d=u.norm,h=u.axis,f=i[d],p=Math.abs(c-o),m=(c+o)/2,v=i[s]/2+i[l]-i[h],y=f-v,g=e?Math.max(v-p/2,0):Math.min(p/2-y,0),b=m+g-v;if(this.setNodeCoord(i,l,b),0!==g)for(var x=r[0];x<r[0]+r[1];x++){var k=a[x];"x"===l?this.move(k,g,0):this.move(k,0,g)}var w=e?Math.max(c+g,i[d]+i[h]):Math.min(c+g,i[h]),C=Math.abs(w-o);return i.al=p,i.ad=l,i.ap=n?1:-1,i.breadthPositive=e?1:-1,[g,C,w]}},{key:"move",value:function(t,e,n){Ve(t,(function(t){t.x+=e,t.y+=n,t.isSubTree&&(t.tx+=e,t.ty+=n)}))}},{key:"moveX",value:function(t,e){Ve(t,(function(t){t.x+=e,t.isSubTree&&(t.tx+=e)}))}},{key:"moveY",value:function(t,e){Ve(t,(function(t){t.y+=e,t.isSubTree&&(t.ty+=e)}))}},{key:"layout",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.constructor.VAILD_DIRECTION_ANGLES,r=t.directionAngle;this.zNodes=e,n.some((function(t){return ro(t,r)}))?(this.setKeys(t),this.normalize(t),this.setCoord(t),this.setZIndex(t)):console.warn("The layout does not support the direction")}},{key:"getAbstractLocateString",value:function(t,e){var n=t.start,r=void 0===n?0:n,a=t.end,i=void 0===a?0:a,o=Math.max(0,r);return o+":"+(Math.min(e,i)-o+1)}},{key:"parseAbstractLocateString",value:function(t){return t.split(":").map((function(t){return parseInt(t)}))}},{key:"setKeys",value:function(t){}},{key:"normalize",value:function(t){}},{key:"setCoord",value:function(t){}},{key:"setZIndex",value:function(t){}}]),t}();c()(Yp,"VAILD_DIRECTION_ANGLES",[]),c()(Yp,"QUADRANTS",4);var Hp=function(t){S()(n,Yp);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"breadthAxis","y"),c()(E()(t),"depthAxis","x"),c()(E()(t),"breadthNorm","h"),c()(E()(t),"depthNorm","w"),c()(E()(t),"mainGap","vgap"),c()(E()(t),"secondaryGap","hgap"),c()(E()(t),"isMainPositive",!1),c()(E()(t),"isPositive",!1),t}return y()(n,[{key:"setKeys",value:function(t){var e=t.directionAngle,n=this.constructor.MAIN_AXIS,r=!1,a=!1;ro(e,Math.PI/4)?(r=!0,a=!0):ro(e,3*Math.PI/4)?(r=!1,a=!0):ro(e,5*Math.PI/4)?(r=!1,a=!1):ro(e,7*Math.PI/4)&&(r=!0,a=!1),"x"===n?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.isMainPositive=r,this.isPositive=a):(this.breadthAxis="y",this.depthAxis="x",this.breadthNorm="h",this.depthNorm="w",this.mainGap="vgap",this.secondaryGap="hgap",this.isMainPositive=a,this.isPositive=r)}},{key:"normalize",value:function(t){var e=this;this.preOrder(t,(function(t){var n={node:t};t.vgap=e.getVGap(n),t.hgap=e.getHGap(n)}))}},{key:"setCoord",value:function(t){this._setMainCoord(t),this._setSecondaryCoord(t)}},{key:"_setMainCoord",value:function(t){var e=this,n=this.breadthAxis,r=this.breadthNorm,a=this.mainGap,i=this.isMainPositive,o=this.isPositive,c=t[n],l=t[r],s=[];this.preOrderByGroupWithoutSelf(t,{initInfo:function(){return{smin:0}},beforecallback:function(t,o){var s,u=e.getAxisNorm(o,n,r).norm,d=o[a],h=o[u];c=s=i?c+l+d:c-h-d,l=h,e.setNodeCoord(o,n,s)},enterGroup:function(t){t.smin=i?c:c+l},exitGroup:function(t,e,n,r,a,i){var o=t.nowGroup,c=a[t.childrenLength+t.groupIndex];s.unshift({smin:t.smin,depth:i,siblings:a,nowGroup:o,abstractNode:c})},aftercallback:function(t,r,a,u,d,h,f,p){if(!r.children||0===r.children.length||r.isSubTree)for(;s.length>0;){var m=s[0],v=m.nowGroup,y=m.siblings,g=m.smin,x=m.depth,k=m.abstractNode;if(!e.deeperAllLast(x,f,p))break;s.shift();var w=i?c+l:c,C=e.makeAbstractBreadthOffset(n,i,o,v,y,k,g,w),A=b()(C,3);A[0];var O=A[1],E=A[2];c=i?g:E,l=O}}})}},{key:"_setSecondaryCoord",value:function(t){var e=this,n=this.depthAxis,r=this.depthNorm,a=this.secondaryGap,i=this.isPositive,o=i?1:-1;this.preOrderWithOutSelf(t,(function(t,c){var l,s=e.getAxisNorm(t,n,r).norm,u=t[a];if(!t.abstract){var d=(l=i?c[n]+c[r]/2+u:c[n]+c[r]/2-t[s]-u)+(o+1)/2*t[s];t.maxDepth=d,e.updateParentMaxDepth(t,d,i),e.setNodeCoord(t,n,l)}})),this.postOrderByGroupWithoutSelf(t,{initInfo:function(){return{maxDepth:void 0}},callback:function(t,e){var n=e.maxDepth,r=void 0===n?0:n,a=t.nowGroupData;t.nowGroup&&(t.nowGroupData=a?i?Math.max(a,r):Math.min(a,r):r)},exitGroup:function(t,a,c,l,s){var u=t.childrenLength,d=t.groupIndex,h=t.nowGroupData,f=void 0===h?0:h,p=s[u+d],m=e.getAxisNorm(p,n,r).norm,v=i?f+o*e.getAGap():f+o*e.getAGap()-p[m];e.setNodeCoord(p,n,v);var y=v+(o+1)/2*p[m];e.updateParentMaxDepth(p,y,i)}})}},{key:"setZIndex",value:function(t){var e=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(t,(function(a){var i=a.children;if(t!==a&&e.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(t,e){return Math.abs(t[n]+t[r]-o)-Math.abs(e[n]+e[r]-o)}))}}))}},{key:"getHGap",value:function(t){return 16}},{key:"getVGap",value:function(t){var e=t.node,n=e.parent;return n&&e===n.children[0]&&-1===e.upSignY?24:8}}]),n}();c()(Hp,"className","Indent"),c()(Hp,"VAILD_DIRECTION_ANGLES",[Math.PI/4,3*Math.PI/4,5*Math.PI/4,7*Math.PI/4]),c()(Hp,"QUADRANTS",4),c()(Hp,"MAIN_AXIS","y");var Gp=function(t){S()(n,Yp);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"depthAxis",void 0),c()(E()(t),"depthNorm",void 0),c()(E()(t),"breadthGap",void 0),c()(E()(t),"depthGap",void 0),c()(E()(t),"breadthAxis",void 0),c()(E()(t),"breadthNorm",void 0),c()(E()(t),"isVertical",!1),c()(E()(t),"isPositive",void 0),t}return y()(n,[{key:"setKeys",value:function(t){var e=t.directionAngle,n=ro(e,Math.PI/2)||ro(e,3*Math.PI/2);n?(this.breadthAxis="x",this.breadthNorm="w",this.breadthGap="hgap",this.depthAxis="y",this.depthNorm="h",this.depthGap="vgap"):(this.breadthAxis="y",this.breadthNorm="h",this.breadthGap="vgap",this.depthAxis="x",this.depthNorm="w",this.depthGap="hgap"),ro(e,0)||ro(e,Math.PI/2)?this.isPositive=!0:this.isPositive=!1,this.isVertical=n}},{key:"normalize",value:function(t){var e=this,n=this.isVertical;this.preOrderWithOutSelf(t,(function(t,e){t.ancestors=[e].concat(e.ancestors||[])})),this.preOrder(t,(function(t){var r={node:t,isVertical:n};t.vgap=e.getVGap(r),t.hgap=e.getHGap(r)}))}},{key:"setCoord",value:function(t){this._setDepth(t),this._setBreadth(t)}},{key:"_setDepth",value:function(t){var e=this,n=this.depthAxis,r=this.depthNorm,a=this.depthGap,i=this.isPositive,o=i?1:-1;this.preOrderWithOutSelf(t,(function(t,c){var l=e.getAxisNorm(t,n,r).norm;if(!t.abstract){var s,u=t[a],d=(s=i?c[n]+c[r]+u:c[n]-t[l]-u)+(o+1)/2*t[l];t.maxDepth=d,e.updateParentMaxDepth(t,d,i),e.setNodeCoord(t,n,s)}})),this.postOrderByGroupWithoutSelf(t,{initInfo:function(){return{maxDepth:void 0}},callback:function(t,e){var n=e.maxDepth,r=void 0===n?0:n,a=t.nowGroupData;t.nowGroup&&(t.nowGroupData=a?i?Math.max(a,r):Math.min(a,r):r)},exitGroup:function(t,a,c,l,s){var u=t.childrenLength,d=t.groupIndex,h=t.nowGroupData,f=void 0===h?0:h,p=s[u+d],m=e.getAxisNorm(p,n,r).norm,v=i?f+o*e.getAGap():f+o*e.getAGap()-p[m];e.setNodeCoord(p,n,v);var y=v+(o+1)/2*p[m];e.updateParentMaxDepth(p,y,i)}})}},{key:"_setBreadth",value:function(t){var e,n=this,r=this.breadthAxis,a=this.breadthNorm,i=this.breadthGap,o=this.isVertical,c=this.isPositive,l=t.x,s=t.y;this.postOrderByGroupWithoutSelf(t,{initInfo:function(t,e,n,r,a){return{smin:0,emax:0}},beforecallback:function(t,c,l,s,u){var d,h,f,p=n.getAxisNorm(c,r,a),m=p.axis,v=p.norm,y=c.children,g=void 0===y?[]:y,b=c.abstract;if(void 0===e)h=0;else if(0===g.length||c.collapsed||c.isSubTree){if(b)return;var x=n.getBreadthGap(c,e);h=e.maxBreadth+x}else{h=n.getBreadthByChildren({children:g.filter((function(t){return!t.abstract})),breadthAxis:r,node:c,breadthNorm:a,norm:v,isVertical:null!=o&&o}),c.minBreadth=Math.min(c.minBreadth,h);var k=l.children[l.children.indexOf(c)-1];if(k){var w=k.maxBreadth+k[i]-c.minBreadth;w>0&&(f=w)}}n.setNodeCoord(c,r,h),f&&(o?n.move(c,f,0):n.move(c,0,f),c.maxBreadth+=f);var C=c[m]+c[v];c.maxBreadth=Math.max(C,c.maxBreadth||0);var A,O=c[m];c.minBreadth=Math.min(O,null!==(d=c.minBreadth)&&void 0!==d?d:1/0),0===s&&(l.minBreadth=Math.min(O,c.minBreadth,null!==(A=l.minBreadth)&&void 0!==A?A:1/0))},enterGroup:function(t,e,n,r,a){t.smin=e.minBreadth},exitGroup:function(t,e,a,i,o){t.emax=e.maxBreadth;var l=t.childrenLength,s=t.groupIndex,u=t.smin,d=t.emax,h=t.nowGroup,f=o[l+s],p=n.makeAbstractBreadthOffset(r,!0,c,h,o,f,u,d),m=b()(p,3);m[0],m[1];var v=m[2];e.maxBreadth=v},aftercallback:function(t,n,r,a,i){var o;e=n,a===t.childrenLength-1&&(r.maxBreadth=r.maxBreadth=Math.max(e.maxBreadth,null!==(o=r.maxBreadth)&&void 0!==o?o:-1/0))}}),t[r]=this.getBreadthByChildren({children:t.children.filter((function(t){return!t.abstract})),breadthAxis:r,node:t,breadthNorm:a,norm:a,isVertical:o}),o?this.move(t,l-t.x,0):this.move(t,0,s-t.y)}},{key:"getBreadthGap",value:function(t,e){var n,r,a=this.breadthGap;if(t.parent===e.parent)return e[a];t.depth<e.depth?(n=e,r=t):(n=t,r=e);for(var i=n.depth-r.depth,o=0;o<r.ancestors.length;o++){var c=o+i;if(r.ancestors[o]===n.ancestors[c])return n.ancestors[c-1][a]}}},{key:"getBreadthByChildren",value:function(t){var e=t.children,n=t.breadthAxis,r=t.node,a=t.breadthNorm,i=t.isVertical,o=e.length,c=this.getPureAxisNormValue(e[0],n,a),l=this.getPureAxisNormValue(e[o-1],n,a),s=this.getPureAxisNormValue(r,n,a);if(!i&&e[0].border&&r.border){if("line"===e[0].border.shape&&"line"===r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue)/2-s.normValue;if("line"===e[0].border.shape&&"line"!==r.border.shape)return(c.coord+c.normValue+l.coord+l.normValue-s.normValue)/2;if("line"!==e[0].border.shape&&"line"===r.border.shape&&e[0]===e[o-1])return c.coord+c.normValue/2-s.normValue}return(c.coord+l.coord+l.normValue-s.normValue)/2}},{key:"setZIndex",value:function(t){var e=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(t,(function(a){var i=a.children;if(t!==a&&e.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(t,e){return Math.abs(t[n]+t[r]-o)-Math.abs(e[n]+e[r]-o)}))}}))}},{key:"getHGap",value:function(t){var e=t.isVertical,n=t.node.depth;return e?1===n?48:24:n>1?48:64}},{key:"getVGap",value:function(t){var e,r=t.isVertical,a=t.node,i=a.depth,o=a.border;return o?(r?e=64:1===i?e=24:(e=2===i?10:8,"line"!==o.shape&&(e*=2)),e):_()(L()(n.prototype),"getVGap",this).call(this)}}]),n}();function Xp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Gp,"className","Standard"),c()(Gp,"VAILD_DIRECTION_ANGLES",[0,Math.PI/2,Math.PI,3*Math.PI/2]),c()(Gp,"QUADRANTS",2);var Wp=function(t){S()(n,Yp);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m()(this,n),t=e.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r)),c()(E()(t),"breadthAxis","x"),c()(E()(t),"depthAxis","y"),c()(E()(t),"breadthNorm","w"),c()(E()(t),"depthNorm","h"),c()(E()(t),"mainGap","hgap"),c()(E()(t),"secondaryGap","vgap"),c()(E()(t),"secondaryDownSign","downSignY"),c()(E()(t),"isMainPositive",!0),c()(E()(t),"hgap1",40),c()(E()(t),"hgap2",32),c()(E()(t),"vgap1",0),c()(E()(t),"vgap2",0),c()(E()(t),"compact",!1),t}return y()(n,[{key:"getAlign",value:function(t){return t.node.cell.getTimelineLayoutAlign()}},{key:"normalize",value:function(t){var e=this;this.preOrder(t,(function(t){var n={node:t};t.align=e.getAlign(n)}))}},{key:"setKeys",value:function(t){var e=t.directionAngle;ro(e,0)?(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!0):ro(e,Math.PI)&&(this.breadthAxis="x",this.depthAxis="y",this.breadthNorm="w",this.depthNorm="h",this.mainGap="hgap",this.secondaryGap="vgap",this.secondaryDownSign="downSignY",this.isMainPositive=!1)}},{key:"setCoord",value:function(t){this._setMainCoord(t),this._setSecondaryCoord(t)}},{key:"_setMainCoord",value:function(t){var e=this,n=this.secondaryDownSign,r=this.breadthAxis,a=this.breadthNorm,i=this.mainGap,o=this.isMainPositive,c=this.compact,l="".concat(i,"1"),s="".concat(i,"2"),u=o?1:-1,d=t[r];o&&(d+=t[a]);var h=d,f=d,p=d,m=[];this.preOrderByGroupWithoutSelf(t,{initInfo:function(t,e,n,r,a,i,o,c){return{smin:0}},beforecallback:function(t,i,m,v,y,g,b,x){var k,w=e.getAxisNorm(i,r,a).norm,C=p-h,A=p-f;-1===i[n]&&c?(u*C>0?(k=e[l],d=p):(k=e[s],d=h),o?(h=(d+=k)+i[w],p=d+i[a]):(d=d-k-i[w],h=d,p=d+(i[w]-i[a]))):(u*A>0?(k=e[l],d=p):(k=e[s],d=f),o?(f=(d+=k)+i[w],p=d+i[a]):(d=d-k-i[w],f=d,p=d+(i[w]-i[a]))),e.setNodeCoord(i,r,d)},enterGroup:function(t,n){var i=e.getAxisNorm(n,r,a).norm;t.smin=o?d:d+n[i]},exitGroup:function(t,e,n,r,a,i){var o=t.nowGroup,c=a[t.childrenLength+t.groupIndex];m.unshift({smin:t.smin,depth:i,siblings:a,nowGroup:o,abstractNode:c})},aftercallback:function(t,n,a,i,c,l,s,u){if(!n.children||0===n.children.length||n.isSubTree)for(;m.length>0;){var d=m[0],h=d.nowGroup,v=d.siblings,y=d.smin,g=d.depth,x=d.abstractNode;if(!e.deeperAllLast(g,s,u))break;m.shift();var k=x.downDirection,w=(void 0===k?[0,1]:k)[1]>=0,C=f,A=e.makeAbstractBreadthOffset(r,o,w,h,v,x,y,C),O=b()(A,3),E=O[0];O[1];var P=O[2];f=P,p+=E}}})}},{key:"_setSecondaryCoord",value:function(t){var e,n,r=this,a=this.depthAxis,i=this.depthNorm,o=t.children,c=void 0===o?[]:o,l=a.toUpperCase(),s=this["move".concat(l)].bind(this);c.forEach((function(r,o){var l=0===o?t:c[o-1],u=r.align;if(!r.abstract){"b"===u[0]?e=l[a]+l[i]:"c"===u[0]&&(e=l[a]+l[i]/2),"c"===u[1]?n=function(t){return e-t[i]/2}:"b"===u[1]&&(n=function(t){return e-t[i]});var d=n(r)-r[a];s(r,d)}})),this.preOrderByGroupWithoutSelf(t,{initInfo:function(){return{}},callback:function(t,e,n,o,c){var l=t.nowGroupData,s=t.nowGroup,u=c[t.childrenLength+t.groupIndex].downDirection,d=(void 0===u?[0,1]:u)[1]>=0,h=r.getAxisNorm(e,a,i),f=h.norm,p=h.axis;if(s){var m=d?e[p]+e[f]:e[p];t.nowGroupData=l?d?Math.max(l,m):Math.min(l,m):m}},exitGroup:function(t,e,n,o,c){var l=t.childrenLength,s=t.groupIndex,u=t.nowGroupData,d=void 0===u?0:u,h=c[l+s],f=h.downDirection,p=(void 0===f?[0,1]:f)[1]>=0,m=p?1:-1,v=r.getAxisNorm(h,a,i).norm,y=p?d+m*r.getAGap():d+m*r.getAGap()-h[v];r.setNodeCoord(h,a,y)}})}},{key:"setZIndex",value:function(t){var e=this,n=this.breadthAxis,r=this.breadthNorm;this.preOrder(t,(function(a){var i=a.children;if(t!==a&&e.beforeInsert(a),i&&!a.collapsed){var o=a[n]+a[r]/2;i.sort((function(t,e){return Math.abs(t[n]+t[r]-o)-Math.abs(e[n]+e[r]-o)}))}}))}}]),n}();function Vp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(Wp,"className","Timeline"),c()(Wp,"VAILD_DIRECTION_ANGLES",[0,Math.PI]),c()(Wp,"QUADRANTS",2);var Zp=function(t){S()(n,su);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vp(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({textareaContentStyleSheets:[{query:"self",css:{"letter-spacing":"normal","font-size":"18px","line-height":"1.74","word-break":"break-word",outline:"none",color:"white"}}],defaultFontFamily:'PingFangSC-Medium, "PingFang SC"'},t)),this.initLayoutEngine()}},{key:"minContentWidth",get:function(){return 52}},{key:"canCollapse",value:function(){return!1}},{key:"getPadding",value:function(){var t,e=this.model;if("capsule"===this.border.shape){var n=this._calculateCapsulePadding();t=new Array(4).fill(n)}else t=[6,16,6,16];return e.note&&(t[1]/=2),t}},{key:"_calculateCapsulePadding",value:function(){var t=this.width,e=this.height;return t&&e?Math.min(t,e)*(1-Math.sin(Math.PI/4))/2:this.minHeight*(1-Math.sin(Math.PI/4))/2}},{key:"_createLayoutModel",value:function(){var t=this.cellMap,e=this.model,n=[],r=en(e,(function(e){var r,a,i,o,c,l,s=t[e.id],u={x:s.x,y:s.y,w:null!==(r=s.width)&&void 0!==r?r:10,h:null!==(a=s.height)&&void 0!==a?a:10,layout:s.layout.type,direction:null!==(i=s.layout.direction)&&void 0!==i?i:[1,0],quadrantConstraint:s.layout.quadrantConstraint,quadrant:null!==(o=s.layout.quadrant)&&void 0!==o?o:1,collapsed:null!==(c=s.collapsed)&&void 0!==c&&c,border:{shape:s.border.shape},cell:s,abstract:null!==(l=s.isAbstract)&&void 0!==l&&l};return e.abstract&&(u.abstract=!0,u.start=e.start,u.end=e.end,u.layout="standard",u.direction=[1,0],u.quadrantConstraint=[1]),"timeline"===u.layout&&n.push(u),u}));return n.forEach((function(t){t.children.forEach((function(e,n){e.abstract||(e.layout&&!Di("timeline",e.layout)||(e.layout="indent",e.direction=[1,1],0===t.direction[1]?e.quadrantConstraint=n%2==0?[4]:[1]:e.quadrantConstraint=n%2==0?[1]:[2]),e.children&&e.children.forEach((function(e){e.layout||(e.layout="standard",e.direction=[1,0],-1===t.direction[0]?e.quadrantConstraint=[2]:e.quadrantConstraint=[1])})))}))})),r}},{key:"canRough",value:function(){return!0}},{key:"initLayoutEngine",value:function(){this.layoutHelper=new Ku({beforeLayoutAdjust:function(t){t.needAfterAdjustedNodes=[],Ze(t,(function(e){"timeline"!==e.parent.layout&&e.collapsed&&(1===e.downSignY?e.h+=24:-1===e.downSignY?(e.h+=24,t.needAfterAdjustedNodes.push({node:e,key:"y",value:24})):1===e.downSignX?e.w+=24:-1===e.downSignX&&(e.w+=24,t.needAfterAdjustedNodes.push({node:e,key:"x",value:24})))}))},afterLayoutAdjust:function(t){t.needAfterAdjustedNodes.forEach((function(t){var e=t.node,n=t.key,r=t.value;e[n]+=r}))},algorithms:{timeline:new Wp,standard:new Gp,indent:new Hp}})}},{key:"_layoutPosition",value:function(t){t.forEach((function(t){var e=t.cell;e.x=t.x||0,e.y=t.y||0}))}},{key:"_layoutZIndex",value:function(t){var e=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||t.forEach((function(t,n){var a=t.cell;a.zIndex=n,a!==e&&r.insertBefore(a.graphicGroup,e.graphicGroup)}))}},{key:"_layoutdrectionAngle",value:function(t){t.forEach((function(t){t.cell.upDirection=t.upDirection,t.cell.downDirection=t.downDirection,t.cell.upLayoutType=t.upLayoutType,t.cell.downLayoutType=t.downLayoutType,t.cell.layoutQuadrantConstraint=t.quadrantConstraint||[1],t.cell.downSignX=t.downSignX,t.cell.downSignY=t.downSignY,t.cell.upSignX=t.upSignX,t.cell.upSignY=t.upSignY,t.cell.breadthPositive=t.breadthPositive,t.cell.ad=t.ad,t.cell.ap=t.ap,t.cell.al=t.al}))}},{key:"executeLayout",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],e=this.layoutHelper,n=this._createLayoutModel();e.model=n,e.execute();var r=[],a=e.tree;Ve(a,(function(t){r.push(t)})),this._layoutPosition(r,t),this._layoutZIndex(a.zNodes),this._layoutdrectionAngle(r)}},{key:"drawInner",value:function(){this.subcells.forEach((function(t){t.draw()})),this.drawCollapse(),this.drawPosition()}},{key:"destroy",value:function(){this.layoutHelper.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{border:{outer:0,radius:4,shape:"rect",fill:"#596086","stroke-width":2,stroke:"transparent"},textarea:{className:"lake-diagram-mindmap-root"},layout:{type:"standard",direction:[1,0]},treeEdge:{stroke:"#959EA6"},tapered:!1,rainbow:!0,note:{width:20,height:20,padding:[0,8,0,0]}})}}]),n}();c()(Zp,"className","MindmapStem");var Up={treeEdge:!0,layout:!0,roughFillStyle:!0},Kp=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"beforedraw",(function(e){e&&"remove"!==e.action&&(function(t,e){var n=t.stems.filter((function(t){return t.isMindmap}));n.length>0&&(e.inherit(Up,n),n.forEach((function(t){t.deepEach((function(e){e!==t&&e.drawInherit()}))})))}(e,t),function(t,e){if("update"===t.action){var n=t.models.filter((function(t){var n=e.find(t.id);return n&&n.isMindmap&&n.isStem}));n.length>0&&n.forEach((function(t){if(void 0!==t.tapered||void 0!==t.rainbow){var n=e.find(t.id);void 0!==t.rainbow&&(!1===t.rainbow?n.forEach((function(t){t.isAbstract||t.updateModel({treeEdge:{stroke:"#959EA6"}})})):n.forEach((function(t,e){t.isAbstract||t.updateModel({treeEdge:{stroke:jr[e%7]}})})),e.inherit(Up,[n])),n.deepEachWithoutSelf((function(t){t.drawInner()}))}}))}}(e,t))}))}}]),n}();var Qp=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"afterselect",(function(){var e=t.selector.selections;if(1===e.length&&e[0].isMindmap){var n=e[0];t.viewport.scrollIntoView(n)}}))}}]),n}();var $p=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e,n=Nt()((function(){var n=t.selector.selections;1===n.length&&n[0].isMindmap&&n[0].canCollapse()&&!(e=n[0]).model.isPlaceholder&&e.showCollapsedButton()}),16);this.bind(t,"afterselect",(function(){e&&e.hideCollapsedButton(),e=void 0,n()}))}}]),n}();var Jp=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"mindmapcell:mouseenter",(function(t){var e=t.cell;e.isMindmap&&!e.model.isPlaceholder&&e.highlight()})),this.bind(t,"mindmapcell:mouseleave",(function(t){var e=t.cell;e&&e.isMindmap&&e.unHighlight()}))}}]),n}();var tm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e;function n(){e&&e.hideCollapsedButton(),e=void 0}this.bind(t,"mindmapcell:mouseenter",(function(n){var r=n.cell;t.signal.dragging||t.signal.buttonDragCanvas||t.signal.vertexResizing||r.isMindmap&&!r.model.isPlaceholder&&r.canCollapse()&&(r.showCollapsedButton(),e=r)})),this.bind(t,"mindmapcell:mouseleave",(function(r){var a=r.cell,i=r.nativeEvent;if(!(t.signal.dragging||t.signal.buttonDragCanvas||t.signal.vertexResizing)){var o=t.selector.selections;!a||!a.isMindmap||1===o.length&&(1!==o.length||a.model.id===o[0].model.id)||i.relatedTarget&&i.relatedTarget.closest('[data-lake_mindmap_add_button="true"]')?a&&a.isMindmap&&1===o.length&&a.model.id===o[0].model.id&&(e=void 0):n()}})),this.bind(t,"addbutton:mouseleave",(function(){t.signal.dragging||t.signal.buttonDragCanvas||t.signal.vertexResizing||n()})),this.bind(t,"aftercommandexecute",(function(t){"Expand"===t.commandName&&n()}))}}]),n}();function em(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var nm=function(){function t(){m()(this,t)}return y()(t,[{key:"createHotArea",value:function(t,e){var n=t.stem;return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?em(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):em(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({child:t.child,stem:n},e)}},{key:"stem",value:function(){}},{key:"child",value:function(){}},{key:"prevSibling",value:function(){}},{key:"nextSibling",value:function(){}},{key:"betweenSibling",value:function(){}}]),t}();var rm=function(t){S()(n,nm);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"stem",value:function(t){var e=t.child,n=t.hotAreas,r=t.postFix,a=e.upDirection,i=Math.sign(a[0]),o=e.children.filter((function(t){return!t.abstract})).length;0===i?(n.push(this.createHotArea(t,{minX:e.minX-50,minY:e.minY-60,maxX:e.maxX+50,maxY:(e.minY+e.maxY)/2,parent:e.id,id:e.id+"2"+r,nth:o,quadrant:2,color:"orange"})),n.push(this.createHotArea(t,{minX:e.minX-50,minY:(e.minY+e.maxY)/2,maxX:e.maxX+50,maxY:e.maxY+60,parent:e.id,id:e.id+"1"+r,nth:o,quadrant:1,color:"pink"}))):(n.push(this.createHotArea(t,{minX:e.minX-50,minY:e.minY-60,maxX:(e.minX+e.maxX)/2,maxY:e.maxY+60,parent:e.id,id:e.id+"2"+r,nth:o,quadrant:2,color:"orange"})),n.push(this.createHotArea(t,{minX:(e.minX+e.maxX)/2,minY:e.minY-60,maxX:e.maxX+50,maxY:e.maxY+60,parent:e.id,id:e.id+"1"+r,nth:o,quadrant:1,color:"pink"})))}},{key:"child",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.postFix,i=t.stem,o=n.upDirection,c=Math.sign(o[0]),l=this.createHotArea(t,{parent:n.id,id:NaN+n.id+a,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push",stem:i});0===c?n.minY>r.minY?Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.maxY,maxY:n.maxY+60}):Object.assign(l,{minX:n.minX,maxX:n.maxX,minY:n.minY-60,maxY:n.minY}):n.minX>r.minX?Object.assign(l,{minX:n.maxX,minY:n.minY-0,maxX:n.maxX+100,maxY:n.maxY+0}):Object.assign(l,{minX:n.minX-100,minY:n.minY-0,maxX:n.minX,maxY:n.maxY+0}),e.push(l)}},{key:"prevSibling",value:function(t){var e,n,r=t.hotAreas,a=t.child,i=t.parent,o=t.index,c=t.postFix,l=a.upDirection,s=Math.sign(l[0]),u=this.createHotArea(t,{parent:i.id,id:void 0+a.id+i.id+c,quadrant:a.layout.quadrant,color:"yellow",nth:o});if(0===s){var d=1===a.depth&&1===a.layout.quadrant,h=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:(n=a.minX-16,h||d?n-50:n),minY:d?a.minY-50:a.minY,maxX:(a.minX+a.maxX)/2,maxY:h?a.maxY+50:a.maxY})}else{var f=1===a.depth&&1===a.layout.quadrant,p=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:f?a.minX-50:a.minX,minY:(e=a.minY-16,p||f?e-50:e),maxX:p?a.maxX+50:a.maxX,maxY:(a.minY+a.maxY)/2})}r.push(u)}},{key:"nextSibling",value:function(t){var e,n,r=t.hotAreas,a=t.child,i=t.parent,o=t.index,c=t.postFix,l=a.upDirection,s=Math.sign(l[0]),u=this.createHotArea(t,{parent:i.id,id:a.id+void 0+i.id+c,color:"red",nth:o+1,addOrder:"push",quadrant:a.layout.quadrant});if(0===s){var d=1===a.depth&&1===a.layout.quadrant,h=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:(a.minX+a.maxX)/2,minY:d?a.minY-50:a.minY,maxX:(n=a.maxX+16,h||d?n+50:n),maxY:h?a.maxY+50:a.maxY})}else{var f=1===a.depth&&1===a.layout.quadrant,p=1===a.depth&&2===a.layout.quadrant;Object.assign(u,{minX:f?a.minX-50:a.minX,minY:(a.minY+a.maxY)/2,maxX:p?a.maxX+50:a.maxX,maxY:(e=a.maxY+16,p||f?e+50:e)})}r.push(u)}},{key:"betweenSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.next,o=t.postFix,c=n.upDirection,l=Math.sign(c[0]),s=this.createHotArea(t,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,quadrant:n.layout.quadrant,color:"blue",nth:a+1});if(0===l){var u=1===n.depth&&1===n.layout.quadrant,d=1===n.depth&&2===n.layout.quadrant;Object.assign(s,{minX:(n.minX+n.maxX)/2,minY:2===n.layout.quadrant?Math.max(n.minY,i.minY):u?n.minY-50:n.minY,maxX:(i.minX+i.maxX)/2,maxY:1===n.layout.quadrant?Math.min(n.maxY,i.maxY):d?n.maxY+50:n.maxY})}else Object.assign(s,{minX:2===n.layout.quadrant?n.minX:1===n.depth?n.minX-50:n.minX,minY:(n.minY+n.maxY)/2,maxX:1===n.layout.quadrant?n.maxX:1===n.depth?n.maxX+50:n.maxX,maxY:(i.minY+i.maxY)/2});e.push(s)}}]),n}();var am=function(t){S()(n,nm);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"stem",value:function(t){var e=t.child,n=t.hotAreas,r=t.postFix,a=e.upDirection,i=Math.sign(a[0]),o=Math.sign(a[1]),c=this.createHotArea(t,{parent:e.id,id:e.id+"1"+r,nth:0,quadrant:1,color:"pink"});1===i&&1===o?Object.assign(c,{minX:(e.minX+e.maxX)/2,minY:(e.minY+e.maxY)/2,maxX:e.maxX+50,maxY:e.maxY+30}):-1===i&&1===o?Object.assign(c,{minX:e.minX-50,minY:(e.minY+e.maxY)/2,maxX:(e.minX+e.maxX)/2,maxY:e.maxY+30}):-1===i&&-1===o?Object.assign(c,{minX:e.minX-50,minY:e.minY-30,maxX:(e.minX+e.maxX)/2,maxY:(e.minY+e.maxY)/2}):1===i&&-1===o&&Object.assign(c,{minX:(e.minX+e.maxX)/2,minY:e.minY-30,maxX:e.maxX+50,maxY:(e.minY+e.maxY)/2}),n.push(c)}},{key:"child",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.postFix,i=this.createHotArea(t,{parent:n.id,id:NaN+n.id+a,nth:0,color:"green",quadrant:n.layout.quadrant,addOrder:"push"}),o=n.downDirection,c=1===Math.sign(o[1])?32:-32;n.minX>r.minX?Object.assign(i,{minX:n.maxX,minY:n.minY-0+c,maxX:n.maxX+50,maxY:n.maxY+0+c}):Object.assign(i,{minX:n.minX-50,minY:n.minY-0+c,maxX:n.minX,maxY:n.maxY+0+c}),e.push(i)}},{key:"prevSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.postFix,o=n.upDirection,c=Math.sign(o[1]),l=this.createHotArea(t,{parent:r.id,id:void 0+n.id+r.id+i,quadrant:n.layout.quadrant,color:"yellow",nth:a});1===c?Object.assign(l,{minX:n.minX,minY:n.minY-4,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}):Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+4}),e.push(l)}},{key:"nextSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.postFix;if(!(n.children.length>1)||n.collapsed){var o=n.upDirection,c=Math.sign(o[1]),l=this.createHotArea(t,{parent:r.id,id:n.id+void 0+r.id+i,color:"red",nth:a+1,addOrder:"push",quadrant:n.layout.quadrant});1===c?Object.assign(l,{minX:n.minX,minY:(n.minY+n.maxY)/2,maxX:n.maxX,maxY:n.maxY+16}):Object.assign(l,{minX:n.minX,minY:n.minY-16,maxX:n.maxX,maxY:(n.minY+n.maxY)/2}),e.push(l)}}},{key:"betweenSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.next,o=t.postFix,c=t.stem,l=this.createHotArea(t,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,color:"blue",nth:a+1,stem:c}),s=(n.minY+n.maxY)/2,u=(i.minY+i.maxY)/2;Object.assign(l,{minX:n.minX,minY:Math.min(s,u),maxX:n.maxX,maxY:Math.max(s,u)}),e.push(l)}}]),n}();var im=function(t){S()(n,nm);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"prevSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.postFix,o=n.upDirection,c=Math.sign(o[0]),l=this.createHotArea(t,{parent:r.id,id:void 0+n.id+r.id+i,quadrant:n.layout.quadrant,color:"yellow",nth:a});1===c?Object.assign(l,{minX:r.maxX,minY:r.minY,maxX:n.minX,maxY:r.maxY}):Object.assign(l,{minX:n.maxX,minY:r.minY,maxX:r.minX,maxY:r.maxY}),e.push(l)}},{key:"betweenSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.next,o=t.postFix,c=t.stem;if(i){var l=n.upDirection,s=Math.sign(l[0]),u=this.createHotArea(t,{parent:r.id,id:n.id+(i?i.id:void 0)+r.id+o,color:"blue",nth:a+1,stem:c});1===s?Object.assign(u,{minX:n.maxX,minY:n.minY,maxX:i.minX,maxY:n.maxY}):Object.assign(u,{minX:i.maxX,minY:n.minY,maxX:n.minX,maxY:n.maxY}),e.push(u)}}},{key:"nextSibling",value:function(t){var e=t.hotAreas,n=t.child,r=t.parent,a=t.index,i=t.postFix,o=t.root,c=n.upDirection,l=Math.sign(c[0]),s=this.createHotArea(t,{parent:r.id,id:n.id+void 0+r.id+i,color:"red",nth:a+1,addOrder:"push",quadrant:n.layout.quadrant,root:o});1===l?Object.assign(s,{minX:n.maxX,minY:n.minY,maxX:n.maxX+32,maxY:n.maxY}):Object.assign(s,{minX:n.minX-32,minY:n.minY,maxX:n.minX,maxY:n.maxY}),e.push(s)}}]),n}(),om=ha,cm={standard:new rm,indent:new am,timeline:new im},lm=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];m()(this,t),c()(this,"diagram",void 0),c()(this,"drawHotArea",void 0),c()(this,"eventHelper",void 0),c()(this,"hotAreas",void 0),c()(this,"activated",void 0),c()(this,"maxWidth",void 0),c()(this,"maxHeight",void 0),this.diagram=e,this.drawHotArea=n,this.eventHelper=new hl,this.hotAreas=[],this.activated=!1,this._bindEvent()}return y()(t,[{key:"turnOn",value:function(){this.update(),this.activated=!0}},{key:"turnOff",value:function(){this.activated=!1}},{key:"_bindEvent",value:function(){var t=this,e=this.diagram,n=this.drawHotArea,r=this.eventHelper,a=this.activated;r.bind(e,"afterstemcelllayout",(function(e){var n=e.stem;a&&t.update(n)})),n&&r.bind(e,"afterviewportchange",(function(){t.draw()}))}},{key:"update",value:function(t){var e,n=this.diagram,r=this.drawHotArea;if(e=t?[t]:n.getCells().filter((function(t){return t.isStem&&t.isMindmap})),0!==e.length){var a=[],i=e.map((function(t){return s()(t.model)}));i.forEach((function(t){Ve(t,(function(t){var e=n.find(t.id);t.minX=e.x,t.minY=e.y,t.maxX=e.x+e.width,t.maxY=e.y+e.height,t.depth=e.depth,t.layout=e.computedProps.layout,t.visible=e.state.visible,t.collapsed=e.collapsed,t.isStem=e.isStem,t.stem=e.stem.model.id,t.upLayoutType=e.upLayoutType,t.downLayoutType=e.downLayoutType,t.upDirection=e.upDirection,t.downDirection=e.downDirection,t.zIndex=e.zIndex,t.children=t.children&&t.children.filter((function(t){return!t.isPlaceholder}))||[]}))})),i.forEach((function(t){Ve(t,(function(t,e,n){if(!t.isPlaceholder&&t.visible){var r=t.upLayoutType,i=t.downLayoutType,o=t.children,c=e?function(t,e,n){var r=n.children,a=t;if(!n.parent)for(;r[a]&&!ao(r[a].upDirection,e.upDirection);)a++;if(r[a]&&!r[a].abstract&&ao(r[a].upDirection,e.upDirection))return r[a]}(n+1,t,e):null,l=e?function(t,e,n){var r=n.children,a=t;if(!n.parent)for(;r[a]&&!ao(r[a].upDirection,e.upDirection);)a--;if(r[a]&&!r[a].abstract&&ao(r[a].upDirection,e.upDirection))return r[a]}(n-1,t,e):null,s=cm[i],u=cm[r],d={hotAreas:a,child:t,parent:e,next:c,prev:l,index:n,stem:t.stem,postFix:"placeholder"};t.isStem?s.stem(d):(0===o.length&&s.child(d),t.abstract||(l||u.prevSibling(d),c||u.nextSibling(d),c&&u.betweenSibling(d)))}}))})),this.hotAreas=a,this.buildQuadtree(),r&&this.draw()}}},{key:"buildQuadtree",value:function(){var t=ve(),e=this.hotAreas.map((function(t){return[t.minX,t.minY,t.maxX-t.minX,t.maxY-t.minY,t]}));t.addAll(e),this.quadtree=t,this.maxWidth=$e(e,(function(t){return t[2]})),this.maxHeight=$e(e,(function(t){return t[3]}))}},{key:"_search",value:function(t,e){var n=this.quadtree,r=this.maxWidth,a=this.maxHeight,i=[];return n.visit((function(n,o,c,l,s){var u=n.data;return u&&u[0]+u[2]>=t&&u[0]<t&&u[1]+u[3]>=e&&u[1]<e&&i.push(u[4]),o>=t||c>=e||l+r<t||s+a<e})),i.sort((function(t,e){return t.child.zIndex-e.child.zIndex})),i}},{key:"hit",value:function(t){return this._search(t[0],t[1])[0]}},{key:"draw",value:function(){var t=this.diagram.frontRootGroup;t.clear(),this.hotAreas.forEach((function(e){var n=e.minX,r=e.minY,a=e.maxX,i=e.maxY,o=e.color,c=new om({d:Jn(n,r,a-n,i-r),fill:o,opacity:.5,"pointer-events":"none"});t.add(c)}))}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.diagram=void 0,this.drawHotArea=void 0,this.eventHelper=void 0}}]),t}();function sm(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return um(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?um(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function um(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var dm=function(t,e,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=e.children,c=void 0===o?[]:o,l=[],s=[],u=[],d=c.length-1;d>=0;d--){var h=c[d],f=h.start,p=void 0===f?0:f,m=h.end,v=void 0===m?0:m,y=h.abstract,g=h.id,x=(c[d].layout||{}).quadrant,k=void 0===x?1:x;if(!y)break;if((void 0===r||r===k)&&!a.includes(g)){var w,C=!1,A=p,O=v,E=0,P=0,S=sm(n);try{for(S.s();!(w=S.n()).done;){var M=b()(w.value,2),j=M[0],R=M[1];A=A>=j&&A<j-R?j-R:A,O=O>=j&&O<j-R?j-1:O,("prev"===i?A>j:A>=j)&&(E+=R),("next"===i?O>=j-1:O>=j)&&(P+=R)}}catch(t){S.e(t)}finally{S.f()}if(O>=A){c[d].start=A+E,c[d].end=O+P;var L={start:c[d].start,end:c[d].end};s.push(g),u.push(L)}else C=!0;var B={start:p,end:v,id:g,newStart:c[d].start,newEnd:c[d].end,deleted:C,q:r,index:d};l.push(B)}}return t.update(s,u),l},hm=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=n?-1:1,i=Sl(t,e),o={},c=0,l=Object.keys(i);c<l.length;c++){var s,u=l[c],d=u.split(":"),h=b()(d,2),f=h[0],p=h[1],m=void 0===p?void 0:parseInt(p),v=i[u],y=v.indexes,g=v.abstracts,x=null===(s=t.find(f))||void 0===s?void 0:s.model;if(0!==y.length){y.sort();var k,w=[],C=void 0,A=sm(y);try{for(A.s();!(k=A.n()).done;){var O=k.value;if(C){var E=C,P=b()(E,2);O===P[0]+a*P[1]?C[1]+=a:(w.push(C),C=[O,a])}else C=[O,a]}}catch(t){A.e(t)}finally{A.f()}C&&w.push(C);var S=g.map((function(t){return t.id}));o[u]=dm(t,x,w,m,S,r)}else o[u]=[]}return n&&Object.keys(o).forEach((function(n){o[n].forEach((function(n){var r=n.id;n.deleted&&-1===e.indexOf(r)&&t.find(r)&&e.push(r)}))})),o},fm=function(t,e){Object.keys(e).forEach((function(n){var r=n.split(":"),a=b()(r,2),i=a[0];a[1];var o=e[n];t.find(i),function(t,e,n){var r=[],a=[];n.forEach((function(t){var e=t.start,n=t.end,i=t.id,o={start:e,end:n};r.push(i),a.push(o)})),t.update(r,a)}(t,0,o)}))},pm=function(t,e){Object.keys(e).forEach((function(n){var r=n.split(":"),a=b()(r,2),i=a[0];a[1];var o=e[n],c=t.find(i);!function(t,e,n){var r=e.model.children,a=[],i=[];n.forEach((function(t){var e=t.newStart,n=t.newEnd,o=t.index,c=t.id,l=r[o];l.start=e,l.end=n;var s={start:e,end:n};a.push(c),i.push(s)})),t.update(a,i)}(t,c,o)}))},mm=function(t,e){var n=e.map((function(e){return t.find(e)}));if(n.some((function(t){return!t})))throw new Error("can not find the cell");return n},vm=function(t,e,n){var r=t.add(e,n),a=hm(t,e.map((function(t){return t.id})).filter((function(t){return t})));return[r,e,n,a]},ym=function(t,e,n,r,a){fm(t,a),t.remove(n.map((function(t){return t.id})))},gm=function(t,e,n,r,a){return t.add(n,r),pm(t,a),n.map((function(t){return t.id}))},bm=function(t,e){e=e.concat([]);var n=hm(t,e,!0);return[t.remove(e),n]},xm=function(t,e,n){var r=e.deletedModelsInfo,a=[],i=[];return Object.keys(r).forEach((function(t){var e=r[t];"root"!==t&&e.sort((function(t,e){return t.nth-e.nth})),e.forEach((function(e){var n=e.nth,r=e.model,o=-1===n?{}:{nth:n,parent:t};a.push(r),i.push(o)}))})),t.add(a,i),fm(t,n),a.map((function(t){return t.id}))},km=function(t,e,n){pm(t,n),t.remove(e.eventObj.models.map((function(t){return t.id})))},wm=function(t,e,n,r){for(var a=mm(t,e),i=a.map((function(t,e){var r=n[e];return Object.keys(r).reduce((function(t,n){if("children"===n)return t;var i=r[n],o=a[e].model[n];return d()(i)?t[n]=Object.keys(i).reduce((function(t,e){var n=o&&o[e];return t[e]=null==n?null:n,t}),{}):t[n]=null==o?null:o,t}),{})})),o=a.map((function(e){return t.getCellOptions(e)})),c=0;c<n.length;c++)gn(i[c],n[c]);return t.update(a,n,r),[e,n,r,i,o]},Cm=function(t,e,n,r,a,i){var o=mm(t,e);return t.update(o,a,i),o},Am=function(t,e,n,r,a,i){var o=mm(t,e);return t.update(o,n,r),o};function Om(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Em(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Om(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Om(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Pm=Oa,Sm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e,n,r,a,i,o,c,l,u,d,h,f,p,m,v,y=new lm(t);function g(){if(t.viewport.preventDefault(!1),n&&ym.apply(void 0,[t].concat(D()(v))),n){var d=s()(r);d.forEach((function(t){Ve(t,(function(t){delete t.zIndex}))})),n.parent===n.stem&&d.forEach((function(t){var e=n.quadrant||null;t.layout?t.layout.quadrant=e:t.layout={quadrant:e}}));var h=e.map((function(t,e){return{parent:n.parent,nth:n.nth+e}})),g={parent:n.parent,nth:n.nth,quadrant:n.quadrant||1},b=t.find(n.parent);e.forEach((function(t,e){var n=d[e];1===t.depth&&b.depth>0&&n&&n.treeEdge&&n.treeEdge.stroke&&delete n.treeEdge.stroke})),b.isStem&&d.forEach((function(e,n){var r=t.query.appendChildModel(b,n);e.treeEdge?e.treeEdge.stroke||(e.treeEdge.stroke=r.treeEdge.stroke):e.treeEdge={stroke:r.treeEdge.stroke}})),t.command.execute("MindmapMoveNode",{dragCells:e,dragCellModels:r,movedCellsInfo:p,addCellModels:d,addOption:g,addOptions:h,dragCellOptions:l,movedCellsBatch:m})}else r&&xm.apply(void 0,[t].concat(D()(p)));u&&t.delegator.remove(u),u=void 0,e=void 0,r=void 0,n=void 0,a=void 0,i=void 0,l=void 0,o=void 0,c=void 0,f=void 0,t.signal.draggingMindmapCell=!1,y.turnOff()}this.mindmapHotAreaHelper=y,this.bind(t,"mousedown",(function(n){var r=n.target,o=n.clientX,c=n.clientY,l=n.button,s=t.getCell(r);!s||!s.isMindmap||s.isStem||0!==l||s.model.abstract||t.signal.contentEditing||(a=o,i=c,t.selector.selections.length>1&&t.selector.selections.includes(s)?(e=(e=t.selector.selections.concat([])).filter((function(t){return!t.isStem})),(e=t.deduplicate(e)).sort((function(t,e){return t.getNth()-e.getNth()})),f=!0):e=[s])})),this.bind(t,"mousemove",(function(g){if(e&&0!==e.length){if(!r&&Math.abs(a-g.clientX)+Math.abs(i-g.clientY)>10&&!t.signal.contentEditing){t.selector.clear(),r=e.map((function(t){return s()(t.model)})),l=e.map((function(e){return t.getCellOptions(e)}));var x=t.viewport.invertClient([g.clientX,g.clientY]);u=t.delegator.create((function(t){!function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=new Pm({x:e-24.5-r,y:n-11+r,height:22,width:49,rx:4,ry:4,fill:"rgba(52, 155, 249, .2)"}),i=new Pm({x:e-24.5+r,y:n-11-r,height:22,width:49,rx:4,ry:4,fill:"rgba(52, 155, 249, .2)"});t.add(a),t.add(i)}(t,x[0],x[1],f?3:0)})),m=Ll(t,e),p=bm(t,e),t.signal.draggingMindmapCell=!0,y.turnOn(),t.viewport.preventDefault(),o=g.clientX,c=g.clientY,t.emit("mindmap:afterdragchildcellstart")}if(u){var k=t.viewport.zoom;d=(g.clientX-o)/k,h=(g.clientY-c)/k,u.translate(d,h)}if(r){var w=t.viewport.invertClient([g.clientX,g.clientY]),C=y.hit(w);n&&(C?n.id!==C.id&&ym.apply(void 0,[t].concat(D()(v))):ym.apply(void 0,[t].concat(D()(v)))),C&&(t.find(C.id)||(v=vm(t,[Em({isPlaceholder:!0,width:32,height:10,border:{shape:"rect",fill:"#C5E3FF"},treeEdge:{stroke:"#C5E3FF"},layout:{quadrant:C.quadrant}},C)],[{parent:C.parent,nth:C.nth}]),b()(v[0],1)[0].toBack())),n=C}}})),this.bind(t,"keydown",(function(t){"Escape"===t.key&&g()})),this.bind(t,"mouseup",(function(){g()})),this.bind(t,"mouseleave",(function(t){var e;null!==(e=t.relatedTarget)&&void 0!==e&&e.closest(".lake-diagram-board-contextual-toolbar-popover")||g()}))}},{key:"unbind",value:function(){this.mindmapHotAreaHelper&&(this.mindmapHotAreaHelper.destroy(),this.mindmapHotAreaHelper=void 0),_()(L()(n.prototype),"unbind",this).call(this)}}]),n}();function Mm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mm(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Rm(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add_button",e=new na,n=new ha({fill:"transparent"}),r=new ba({href:Ir,width:18,height:18}),a=new Wa,i=new ha({fill:"url(#".concat(a.id,")")});return e.dataset({lake_prevent_click_unselect:!0,lake_mindmap_add_button:!0,testid:t}),n.css({cursor:"default"}),r.css({cursor:"pointer"}),e.add(n),e.add(r),{group:e,background:n,btn:r,tail:i,gradient:a}}function Lm(t){var e=t.x,n=t.y,r=t.width,a=t.height,i=t.collapsedButtonWidth,o=t.group,c=t.background,l=t.btn,s=t.tail,u=t.gradient,d=t.zoom,h=t.verticalAlign,f=void 0===h?"center":h,p=t.tailConfig,m=9/d,v={x:e+r/2,y:n+a/2},y=0,g=a;"bottom"===f&&(y=a/2,g+=m),c.update({d:Jn(e,n,r,g)});var b=v.x,x=v.y+y,k=[1/d,0,0,0,1/d,0,0,0,1];if(w.mat3.translate(k,k,[(b-m)*d,(x-m)*d,1]),l.update({matrix:k,href:Ir}),p){var C=p.stroke,A=p.position,O=(10+i/2)/d,E="rgba(255,255,255,0)";o.add(s),"right"===A?(u.update("l(0) 0:".concat(C," 1:").concat(E)),s.update({d:Jn(b+m,x-p["stroke-width"]/2,O,p["stroke-width"])})):"left"===A?(u.update("l(0) 0:".concat(E," 1:").concat(C)),s.update({d:Jn(b-O-m,x-p["stroke-width"]/2,O,p["stroke-width"])})):"bottom"===A?(u.update("l(270) 0:".concat(E," 1:").concat(C)),s.update({d:Jn(b-p["stroke-width"]/2,x+m,p["stroke-width"],O)})):"top"===A&&(u.update("l(270) 0:".concat(C," 1:").concat(E)),s.update({d:Jn(b-p["stroke-width"]/2,x-O-m,p["stroke-width"],O)}))}else s.remove()}var Bm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),(t=e.call(this)).horizontalElements=Rm(),t.verticalElements=Rm(),t}return y()(n,[{key:"init",value:function(t){var e,n=this,r=t.frontRootGroup,a=t.defs,i=this.horizontalElements,o=this.verticalElements,c=function(){},l=function(){};function s(){i.group.remove(),o.group.remove(),c=function(){},l=function(){},e=void 0}function u(t){return i.group.rendererElement.contains(t)||o.group.rendererElement.contains(t)}a.add(i.gradient),a.add(o.gradient),this.horizontalElements=i,this.verticalElements=o,this.bind(i.btn,"click",(function(n){n.stopPropagation(),t.selector.select([e]),c(),s()})),this.bind(o.btn,"click",(function(n){n.stopPropagation(),t.selector.select([e]),l(),s()})),this.bind(t,"cell:dragstart",(function(){s()})),[i,o].forEach((function(r){var a=r.group,i=r.btn;n.bind(a,"mouseenter",(function(t){t.stopPropagation(),i.update({href:Tr})})),n.bind(a,"mouseleave",(function(n){n.stopPropagation(),i.update({href:Ir}),e&&e.graphicGroup.rendererElement.contains(n.relatedTarget)||u(n.relatedTarget)||(t.emit("addbutton:mouseleave"),s())}))})),this.bind(t,"afterchange",Nt()((function(){!e||t.find(e.model.id)&&!e.collapsed||s()}),16)),this.bind(t,"mindmapcell:mouseenter",(function(n){var a=n.cell;if(!(t.signal.buttonDragCanvas||t.signal.dragging||t.signal.vertexResizing||!a.isMindmap||a.collapsed)){var s=a.downSignX,u=a.downSignY,d=0!==u,h=t.viewport.zoom,f=38/h,p=a.canCollapse()?8:0,m=a.canCollapse()?-18:2,v=(d||"line"!==a.border.shape?-1:0)/h+m-p,y={x:a.x+a.width-v,y:a.y,width:f,height:a.height,collapsedButtonWidth:p},g={x:a.x+(a.width-f)/2,y:a.y+a.height-v,width:f,height:f,collapsedButtonWidth:p};e=a,i.group.remove(),o.group.remove(),d?(-1===u&&(g.y=a.y-f+v),y.x-=v,g.tailConfig=jm({position:1===u?"top":"bottom"},t.query.appendChildAddButtonTail(a).treeEdge),l=function(){t.command.execute("MindmapAppendChild")}):(-1===s&&(y.x=a.x-f+v),g.height-=4*v,"line"===a.border.shape&&(y.verticalAlign="bottom"),y.tailConfig=jm({position:1===s?"left":"right"},t.query.appendChildAddButtonTail(a).treeEdge),c=function(){t.command.execute("MindmapAppendChild")}),d?(r.add(o.group),Lm(jm(jm({},g),{},{zoom:h},o))):(r.add(i.group),Lm(jm(jm({},y),{},{zoom:h},i)))}})),this.bind(t,"mindmapcell:mouseleave",(function(e){var n=e.nativeEvent;t.signal.buttonDragCanvas||t.signal.dragging||t.signal.vertexResizing||u(n.relatedTarget)||t.elementMap.fullScreenBtn.contains(n.relatedTarget)||s()})),this.bind(t.contentEditor,"beginedit",(function(){s()})),this.bind(t.contentEditor,"change",(function(){s()})),this.bind(t,"afterselect",(function(){(t.selector.selections.length>1||1===t.selector.selections.length&&t.selector.selections[0]!==e)&&s()}))}}]),n}();var Dm=ha,Nm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;return m()(this,n),(t=e.call(this)).mask=new Dm({"stroke-width":1,stroke:"#1890FF",fill:"rgba(24, 144, 255, 0.15)"}),t.mask.css({"pointer-events":"none"}),t}return y()(n,[{key:"init",value:function(t){var e=this.mask;e.dataset({lake_prevent_click_unselect:!0});var n=null,r=!0;this.bind(t,"keyup",(function(r){if(n)switch(r.key){case"Delete":case"Backspace":t.command.execute("Update",{id:n,model:{width:null,height:null,image:null}}),e.remove()}})),this.bind(t,"mousedown",(function(e){var n=e.target.closest("image"),a=n&&t.getCell(n);r=!(a&&a.isMindmap&&a.state.selected)})),this.bind(t,"click",(function(a){var i=a.target.closest("image"),o=i&&t.getCell(i);o&&!r?(a.stopPropagation(),o.endEditContent(),t.selector.select([o],!1),function(t,n){var r=["x","y","width","height"].reduce((function(t,e){return t[e]=parseFloat(n.getAttribute(e)),t}),{});e.update({d:Jn(t.x+r.x-1,t.y+r.y-1,r.width+2,r.height+2,1)})}(o,i),t.frontRootGroup.add(e),n=o.model.id,t.tryFocus(),r=!0):a.target!==e.rendererElement&&(n=null,e.remove())})),this.bind(t,"afterselectionchange",(function(){n&&(n=null,e.remove())})),this.bind(t,"mindmap:afterdragchildcellstart",(function(){n&&(n=null,e.remove())}))}}]),n}();function _m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Im(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_m(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Tm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){var e,n,r,a,i,o,c,l=!1;function s(){l?e&&t.remove(e):(c=Object(F.a)(),t.remove(e),t.command.execute("Add",{model:Im({id:c,x:e.x+i,y:e.y+o},t.query.insertStemModel())})),n&&n.destroy(),e=void 0,r=void 0,a=void 0,i=void 0,o=void 0,l=!1,n=void 0,t.interaction.changeMode("edit"),c&&(t.selector.clear(),t.selector.select([c]),c=void 0)}this.bind(t,"mousemove",(function(c){if(!n){var l=t.viewport.invertClient([c.clientX,c.clientY]);e=t.add(Im({x:l[0],y:l[1]},t.query.insertStemModel()))[0],n=t.delegator.create([e]),r=c.clientX,a=c.clientY,e.hide()}n&&(i=(c.clientX-r)/t.viewport.zoom,o=(c.clientY-a)/t.viewport.zoom,n.translate(i,o))})),this.bind(window,"mouseleave",(function(){l=!0,s()})),this.bind(window,"mouseup",(function(e){n&&(t.viewportContainer.contains(e.target)||(l=!0),s())})),this.bind(t,"keydown",(function(t){"Escape"===t.key&&(l=!0,s())}))}}]),n}();var Fm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n),t=e.call(this);var a=document.createElement("div"),i=document.createElement("span");return i.classList.add("lake-icon"),i.classList.add("lake-icon-full-screen"),i.classList.add("lake-prevent-card-activated"),a.appendChild(i),a.style["z-index"]="1033",a.style["border-radius"]="4px",a.style.position="absolute",a.style.width="".concat(20,"px"),a.style.height="".concat(20,"px"),a.style.color="#fff",a.style.cursor="pointer",a.style["box-shadow"]="0px 2px 8px 0px rgba(0, 0, 0, 0.08)",a.style["background-color"]="rgba(0, 0, 0, 0.65)",a.style["text-align"]="center",t.fullScreenBtn=a,t.imageBrowser=Object(r.getImageBrowser)(),t}return y()(n,[{key:"init",value:function(t){var e,n,r=this,a=this.fullScreenBtn,i=this.imageBrowser;t.elementMap.fullScreenBtn=a;var o=function(){a.remove(),n&&r.unbind(n),e=void 0,n=void 0};this.bind(a,"click",(function(){if(e){var t=e.image,n=e.imageElement.rendererElement;i.open([{src:n.getAttribute("data-raw_src"),msrc:n.getAttribute("href"),w:t.naturalWidth,h:t.naturalHeight}],0)}})),this.bind(a,"mouseleave",(function(t){e.imageElement.rendererElement.contains(t.relatedTarget)||o()})),this.bind(t,"mindmapcellimage:mouseenter",(function(i){var c=i.cell;if(!t.signal.cellDragStart){document.body.appendChild(a);var l=c.imageElement.getBoundingClientRect(),s=c.image;e=c,s.width>30&&s.height>30?(a.style.top="".concat(l.top+window.pageYOffset+6,"px"),a.style.left="".concat(l.right+window.pageXOffset-26,"px")):(a.style.top="".concat(l.top+window.pageYOffset-20,"px"),a.style.left="".concat(l.left+window.pageXOffset,"px")),n=r.bind(t,"afterviewportchange",(function(){o()}))}})),this.bind(t,"mindmapcellimage:mouseleave",(function(t){var e=t.nativeEvent;a.contains(e.relatedTarget)||o()})),this.bind(t,"mindmap:afterdragchildcellstart",(function(){o()})),this.bind(t,"cell:dragstart",(function(){o()}))}}]),n}();var zm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(window,"click",(function(e){e.target.closest(".lake-diagram-note")&&t.command.execute("MindmapAttachNote")}))}}]),n}();var qm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){var n=t.selector.selections[0],r=e.key,a=["Tab","Insert"],i=["Enter"];if(n&&("timeline"===n.upLayoutType||"standard"===n.upLayoutType&&0===n.upSignX)){var o=a;a=i,i=o}a.includes(r)?(e.preventDefault(),e.altKey?t.command.execute("MindmapAppendParent"):t.command.execute("MindmapAppendChild")):i.includes(r)&&(e.preventDefault(),e.shiftKey?t.command.execute("MindmapInsertStem"):n&&n.isStem?t.command.execute("MindmapAppendChild"):e.altKey?t.command.execute("MindmapPrependSibling"):t.command.execute("MindmapAppendSibling"))}))}}]),n}();var Ym=[["Left","ArrowLeft"],["Right","ArrowRight"],["Up","ArrowUp"],["Down","ArrowDown"]],Hm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){if(Ym.reduce((function(t,e){return t.push.apply(t,D()(e)),t}),[]).includes(e.key)){e.preventDefault();var n=t.selector,r=n.selections;if(1===r.length&&r[0].isMindmap){var a,i,o,c,l=(r=r.filter((function(t){return t.isMindmap})))[r.length-1],s=t.getCells().filter((function(t){return t.state.visible&&t.isMindmap})),u=(a=l.upDirection,"0,1"===(a=String(a))||"0,-1"===a),d=!l.isStem&&"timeline"!==l.upLayoutType;if(Ym[1].includes(e.key)){if(d&&l.x<l.parent.x&&!u)return void n.select([l.parent]);o="x",c=!0}else if(Ym[0].includes(e.key)){if(d&&l.x>l.parent.x&&!u)return void n.select([l.parent]);o="x",c=!1}else if(Ym[2].includes(e.key)){if(d&&l.y>l.parent.y&&u)return void n.select([l.parent]);o="y",c=!1}else if(Ym[3].includes(e.key)){if(d&&l.y<l.parent.y&&u)return void n.select([l.parent]);o="y",c=!0}var h="x"===o?"width":"height",f="x"===o?"y":"x",p="x"===o?"height":"width",m=l[f]+l[p]/2,v=l[f]+l[p];(i=(i=(i=c?s.filter((function(t){return l[o]+l[h]<t[o]})):s.filter((function(t){return t[o]+t[h]<l[o]}))).filter((function(t){var e=t[f]+t[p],n=e<l[f],r=t[f]>v,a=t[f]<=l[f]&&e>=v;return!(n||r)||a}))).sort((function(t,e){if(c){if(t[o]!==e[o])return t[o]-e[o]}else if(t[o]+t[h]!==e[o]+e[h])return e[o]+e[h]-(t[o]+t[h]);return Math.min(Math.abs(m-t[f]),Math.abs(m-(t[f]+t[p])))-Math.min(Math.abs(m-e[f]),Math.abs(m-(e[f]+e[p])))})))[0]&&n.select([i[0]])}}}))}}]),n}();var Gm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){Si(e)&&["Backspace","Delete"].includes(e.key)&&t.command.execute("MindmapRemoveSingleNode")}))}}]),n}();var Xm=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"keydown",(function(e){0!==t.selector.selections.length||"m"!==e.key||Si(e)||(e.preventDefault(),t.command.execute("MindmapBeginInsertStem"))}))}}]),n}();var Wm=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.selector.selections,r=e[e.length-1];r.model.collapsed&&(t.update(r,{collapsed:!1}),this.originSelectedCollapsed=!0);var a=r.model.children?r.model.children.filter((function(t){return!t.abstract})).length:0,i={model:{},cellOptions:{parent:r.model.id,nth:a}};xt()(i.model,t.query.appendChildModel(r)),i.model.id=this.id,Object.assign(this,i),this.selectedCellId=r.model.id,r.state.collapsedButtonVisible=!1,_()(L()(n.prototype),"execute",this).call(this),t.contentEditor.beginEdit()}},{key:"forward",value:function(){var t=this.selectedCellId,e=this.diagram;this.originSelectedCollapsed&&e.update(t,{collapsed:!1}),_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var t=this.selectedCellId,e=this.diagram;this.originSelectedCollapsed&&e.update(t,{collapsed:!0}),_()(L()(n.prototype),"backward",this).call(this),e.selector.select([t])}}]),n}();c()(Wm,"className","MindmapAppendChild"),c()(Wm,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return t.isMindmap}))}));var Vm=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.diagram,r=this.addType,a=e.selector.selections,i=a[a.length-1],o=i.parent,c={model:{html:"".concat(Mr(""))},cellOptions:{parent:o.model.id,nth:r&&"prepend"===r?i.getNth():i.getNth()+t}};o.isStem&&(c.model.layout={quadrant:i.computedProps.layout.quadrant}),xt()(c.model,e.query.appendChildModel(o)),c.model.id=this.id,Object.assign(this,c),this.selectedCellId=i.model.id,_()(L()(n.prototype),"execute",this).call(this),e.contentEditor.beginEdit()}},{key:"backward",value:function(){var t=this.selectedCellId,e=this.diagram;_()(L()(n.prototype),"backward",this).call(this),e.selector.select([t])}}]),n}();c()(Vm,"className","MindmapAddSibling"),c()(Vm,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return!t.isStem&&t.isMindmap&&!t.isAbstract}))}));var Zm=function(t){S()(n,Vm);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n)}();c()(Zm,"className","MindmapAppendSibling");var Um=function(t){S()(n,Vm);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){_()(L()(n.prototype),"execute",this).call(this,0)}}]),n}();c()(Um,"className","MindmapPrependSibling");var Km=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"addMovedModelsInfo",void 0),c()(E()(t),"addInfo",void 0),c()(E()(t),"pinLine",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this.addOption,e=t.parent,n=t.quadrant,r=t.nth,a=this.diagram,i=this.movedCellsBatch,o=a.find(e),c=o&&o.isStem&&o.isTwoQuadrantLayout?o.getNewQuadIndexByNewRealIndex(r,n):r,l=Bl(i[1],o,n,c),s=b()(l,3),u=s[0],d=s[1],h=s[2];this.pinLine=new wf(a),this.pinLine.cache(h),this.pinLine.pin(),this.addInfo=vm(a,u,d),this.select(this.addInfo[0])}},{key:"forward",value:function(){var t=this.diagram,e=this.movedCellsInfo;km.apply(void 0,[t].concat(D()(e))),this.pinLine.pin();var n=gm.apply(void 0,[t].concat(D()(this.addInfo)));this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.movedCellsInfo;ym.apply(void 0,[t].concat(D()(this.addInfo))),this.pinLine.reset();var n=xm.apply(void 0,[t].concat(D()(e)));this.select(n)}}]),n}();c()(Km,"className","MindmapMoveNode");var Qm=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.image,r=t.selector.selections,a=r[r.length-1],i=a.model;this.id=i.id,this.model={image:cu(e),width:null,height:null},t.signal.preventUpdateCellContent=!0,a.textareaElement.htmlContainer===t.contentEditor.dom&&(t.contentEditor.execCommand("justifyCenter"),t.contentEditor.updateStartContent(),this.model.html=t.contentEditor.dom.innerHTML),t.signal.preventUpdateCellContent=!1,_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Qm,"className","MindmapAttachImage"),c()(Qm,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e[0].isMindmap}));var $m=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram;t.selector.clear(),t.interaction.changeMode("beginAddMindmapStem")}}]),n}();function Jm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()($m,"className","MindmapBeginInsertStem");var tv=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.x,r=this.y;if(this.model=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jm(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t.query.insertStemModel()),null!=e&&null!=r)Object.assign(this.model,{x:e,y:r});else{var a=t.getCells().filter((function(t){return t.isStem})),i=a[a.length-1];Object.assign(this.model,{x:i.x+20,y:i.y+i.height+20})}_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(tv,"className","MindmapInsertStem");var ev=function(t){S()(n,Fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n)}();c()(ev,"className","MindmapCreateLink");var nv=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this,e=this.diagram,r=this.image;this.model={type:"mindmap",image:cu(r),html:""};var a=e.viewport.getCenter();this.model.x=a[0]-this.model.image.width/2,this.model.y=a[1]-this.model.image.height/2,_()(L()(n.prototype),"execute",this).call(this),Nt()((function(){var n=e.selector.selections;1===n.length&&n[0].model.id===t.id&&e.contentEditor.execCommand("justifyCenter")}),16)()}}]),n}();function rv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(nv,"className","MindmapInsertImage"),c()(nv,"enable",(function(t){return 0===t.selector.selections.length}));var av=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"info1",void 0),c()(E()(t),"info2",void 0),c()(E()(t),"info3",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.deduplicate(t.selector.selections).sort((function(t,e){return t.getNth()-e.getNth()})),n=e[0],r=Ll(t,e),a=b()(r,2);a[0];var i=a[1],o=e[0].mindmapParent,l=e[0].parent,s=o?n.quadrantNth:void 0,u=n.realQuadrant,d=Object(F.a)(),h={id:d,html:"",children:[]};o?Object.assign(h,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t.query.appendChildModel(o))):Object.assign(h,{type:"mindmap",x:n.x,y:n.y,layout:n.layout}),this.info1=bm(t,e.map((function(t){return t.model.id})));var f=Bl([h],l,u,s),p=b()(f,2),m=p[0],v=p[1];this.info2=vm(t,m,v);var y=t.find(d),g=Bl(i,y,1),x=b()(g,2),k=x[0],w=x[1];this.info3=vm(t,k,w),t.selector.select(d)}},{key:"forward",value:function(){var t=this.diagram;km.apply(void 0,[t].concat(D()(this.info1)));var e=gm.apply(void 0,[t].concat(D()(this.info2)));gm.apply(void 0,[t].concat(D()(this.info3))),t.selector.select(e)}},{key:"backward",value:function(){var t=this.diagram;ym.apply(void 0,[t].concat(D()(this.info3))),ym.apply(void 0,[t].concat(D()(this.info2)));var e=xm.apply(void 0,[t].concat(D()(this.info1)));t.selector.select(e)}}]),n}();c()(av,"className","MindmapAppendParent"),c()(av,"enable",(function(t){var e=function(t,e){return t=t.filter((function(t){return t.isMindmap})),e.deduplicate(t)}(t.selector.selections,t);return e.length>0&&e.every((function(t){return t.isMindmap&&t.parent===e[0].parent&&!t.isAbstract}))}));var iv=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"info1",void 0),c()(E()(r),"info2",void 0),c()(E()(r),"transBatch",void 0),r.pinLine=new wf(t.diagram),r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.pinLine,n=t.selector.selections[0];this.selfId=n.model.id;var r=n.getChildren(),a=n.parent,i=n.realQuadrant,o=a&&a.isMindmap?n.getNth():void 0,c=(null!=a?a:{}).quadrantTreeLists,l=c?c[i-1].indexOf(o):o,s=Ll(t,r)[1];e.cache([n]),this.info1=bm(t,[this.selfId]),e.pin();var u=Bl(s,a,i,l),d=b()(u,2),h=d[0],f=d[1];this.info2=vm(t,h,f),this.select(this.info2[0])}},{key:"forward",value:function(){var t=this.diagram,e=this.pinLine;km.apply(void 0,[t].concat(D()(this.info1))),e.pin();var n=gm.apply(void 0,[t].concat(D()(this.info2)));this.select(n)}},{key:"backward",value:function(){var t=this.diagram,e=this.selfId,n=this.pinLine;ym.apply(void 0,[t].concat(D()(this.info2))),xm.apply(void 0,[t].concat(D()(this.info1))),n.reset(),this.select(e)}}]),n}();c()(iv,"className","MindmapRemoveSingleNode"),c()(iv,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return t.isMindmap&&!t.isAbstract}))}));var ov=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).queue=!1,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=t.selector.selections[0];t.emit("opennote",{cell:e})}}]),n}();function cv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function sv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}c()(ov,"className","MindmapAttachNote"),c()(ov,"isModelChange",!1),c()(ov,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return t.isMindmap}))}));var uv=function(t){if(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]){var e=t.some((function(t){if(t.isMindmap&&t.mindmapParent&&!t.isAbstract){var e=t.realQuadrant,n=t.mindmapParent,r=n.getChildren(),a=n.quadrantTreeLists,i=r.indexOf(t),o=0===a.length?i:a[e-1].indexOf(i);return r.filter((function(t){return t.model.abstract})).some((function(t){var n=t.model,r=n.start,a=n.end,i=t.realQuadrant;return e===i&&o>=r&&o<=a}))}return!1}));if(e)return!1}return t.every((function(t){return t.isMindmap&&t.mindmapParent&&!t.isAbstract}))},dv=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"originSelectionsCollapsed",{}),c()(E()(t),"selections",void 0),c()(E()(t),"fatherGroup",{}),c()(E()(t),"updateInfo",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this,e=this.diagram,r=e.deduplicate(e.selector.selections),a={model:[],cellOptions:[]},o=[],c=[],l=[];this.selections=r.map((function(t){return t.model.id})),r.forEach((function(e){if(e.mindmapParent){var n=e.mindmapParent,r=n.model,a=r.id,i=r.children.indexOf(e.model),o=i;if(n.layoutQuadrantConstraint&&n.layoutQuadrantConstraint.length>1){var c,l,s=null!==(c=null===(l=e.model.layout)||void 0===l?void 0:l.quadrant)&&void 0!==c?c:1;a+=":"+s,o=n.quadrantTreeLists[s-1].indexOf(i)}var u=t.fatherGroup[a]||{},d=u.start,h=u.end;if(-1===o)throw new Error("水金");t.fatherGroup[a]=void 0===d?{start:o,end:o}:{start:Math.min(o,d),end:Math.max(o,h)}}}));var s,u=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return sv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sv(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}(Object.keys(this.fatherGroup).sort());try{var d=function(){var n=s.value,r=n.split(":"),i=b()(r,2),u=i[0],d=i[1],h=void 0===d?void 0:parseInt(d);if("number"==typeof h&&isNaN(h))throw new Error("new abstract quadrant === nan");var f=t.fatherGroup[n],p=f.start,m=f.end,v=e.find(u);if(v){var y=!0,g=v.model.children.filter((function(t){return!t.abstract})),x=g.length;-1===x&&(x=v.model.children.length);var k=x,w=void 0===h?k:v.quadrantTreeLists[h-1].length;if(p>=w||m>=w||p>m||p<0)return{v:void 0};for(var C=null!=h?h:1;k<v.model.children.length;k++){var A=v.model.children[k],O=A.start,E=A.end,P=A.layout,S=(void 0===P?{}:P).quadrant;if(C===(void 0===h?1:S)){if(p<O)break;if(E>p){y=!1;break}}else if(C<S)break}for(var M=k;M<v.model.children.length;M++){var j=v.model.children[M],R=j.start,L=j.layout.quadrant;if((void 0===h||void 0===L?1:L)===C&&m>=R){y=!1;break}}y&&(v.quadrantTreeLists[C-1].forEach((function(t,e){if(e>=p&&e<=m){var n=g[t];if(!n)return;var r=n.layout,a=(void 0===r?{}:r).quadrant,i=void 0===a?1:a,s=n.id;i!==C&&(o.push(s),c.push({layout:lv(lv({},n.layout),{},{quadrant:C})}),l.push({}))}})),a.model.push({start:p,end:m,abstract:!0,layout:{quadrant:C},border:{shape:"rect",stroke:"#BFBFBF",fill:"transparent","stroke-width":2},treeEdge:{stroke:"#BFBFBF","stroke-width":2},html:Mr("概要")}),2===h&&t.fatherGroup[u+":1"]&&k++,a.cellOptions.push({parent:v.model.id,nth:k}))}};for(u.s();!(s=u.n()).done;){var h=d();if("object"===i()(h))return h.v}}catch(t){u.e(t)}finally{u.f()}this.updateInfo=wm(e,o,c,l),a.model.forEach((function(t){e.hooks.decorateAddMindmapAbstract.call(t)})),Object.assign(this,a),_()(L()(n.prototype),"execute",this).call(this),e.contentEditor.beginEdit()}},{key:"forward",value:function(){var t=this.diagram,e=this.updateInfo;_()(L()(n.prototype),"forward",this).call(this),Am.apply(void 0,[t].concat(D()(e)))}},{key:"backward",value:function(){var t=this.diagram,e=this.updateInfo;Cm.apply(void 0,[t].concat(D()(e))),_()(L()(n.prototype),"backward",this).call(this)}}]),n}();function hv(t,e){return t&&e&&st()(t).toHex()===st()(e).toHex()}function fv(t,e){return t.reduce((function(t,e){return"object"===i()(t)?t[e]:t}),e)}function pv(t,e,n){var r=t.length;n=s()(n),t.reduce((function(t,e,a){if(a===r-1)return t[e]=n,n;if("object"===i()(t[e]))return t[e];if(void 0===t[e]){var o={};return t[e]=o,o}return{}}),e)}function mv(t,e){var n=cl(e.find(t.id).textareaElement.htmlContainer);return t.children&&(n.children=t.children.map((function(t){return mv(t,e)}))),n}function vv(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=n.children,i=e.split("."),o=fv(i,n),c="none";if(a&&a.length>1)for(var l=0;l<a.length;l++){var s=fv(i,a[l]);if("none"!==c){if(!Ft()(s,c)){c="none";break}}else c=s}return"none"!==c?pv(i,t,c):o&&!r&&pv(i,t,o),t}c()(dv,"className","MindmapAppendAbstract"),c()(dv,"enable",(function(t){var e=t.deduplicate(t.selector.selections);return uv(e,!0)}));var yv=function(){function t(e){m()(this,t),c()(this,"diagram",void 0),this.diagram=e}return y()(t,[{key:"_getRainBowColors",value:function(){var t,e=this.diagram,n=null==e||null===(t=e.theme)||void 0===t?void 0:t.values.mindmapRainbowTreeEdgeColors,r=jr;return n&&(r=n),r}},{key:"appendChildAddButtonTail",value:function(t){var e=this._getRainBowColors(),n=t.stem.rainbow;return t.isStem?{treeEdge:{stroke:n?e[t.model.children.length%e.length]:"#959EA6","stroke-width":t.getDefaultStrokeWidth(t.depth+1)}}:{treeEdge:{stroke:t.computedProps.treeEdge.stroke,"stroke-width":t.getDefaultStrokeWidth(t.depth+1)}}}},{key:"appendChildTransitiveCommon",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];vv(t,"border.shape",e.model,n),vv(t,"border.stroke",e.model,n),vv(t,"border.fill",e.model,n),vv(t,"border.stroke-width",e.model,n),vv(t,"layout",e.model,!0),vv(t,"treeEdge.stroke-width",e.model,n)}},{key:"appendChildTransitiveTextFormat",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=mv(e.model,this.diagram),a={},i=[];vv(a,"fontSize",r,n),vv(a,"color",r,n),a.fontSize&&14!==a.fontSize&&i.push("font-size: ".concat(a.fontSize,"px")),a.color&&!hv(a.color,"rgb(38, 38, 38)")&&i.push("color: ".concat(a.color)),i.length>0&&(t.html='<span style="'.concat(i.join(";"),'">').concat("&#8203;","</span>"))}},{key:"appendChildTreeEdge",value:function(t,e){var n,r,a,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=null!==(n=e.model.children)&&void 0!==n?n:[],l=null===(r=c[0])||void 0===r||null===(a=r.treeEdge)||void 0===a?void 0:a.stroke;if(l&&c.length>1&&c.every((function(t){var e;return hv(null==t||null===(e=t.treeEdge)||void 0===e?void 0:e.stroke,l)})))i=l;else if(e.isStem){var s=e.model.children,u=e.rainbow,d=this._getRainBowColors();i=u?d[(s.length+o)%d.length]:"#959EA6"}i&&pv(["treeEdge","stroke"],t,i)}},{key:"appendChildModel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.diagram,r={};return t&&t.isMindmap&&(this.appendChildTransitiveCommon(r,t,t.isStem),this.appendChildTransitiveTextFormat(r,t,t.isStem),this.appendChildTreeEdge(r,t,e)),n.hooks.decorateAddMindmapCellModel.call(r),r}},{key:"insertStemModel",value:function(){var t=this.diagram,e=Object.assign({},Rr);return t.hooks.decorateAddMindmapStemModel.call(e),e}},{key:"destroy",value:function(){this.diagram=void 0}}]),t}();c()(yv,"className","Query");var gv=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"aftercommandexecute",(function(n){var r=n.command;if(r instanceof hc){var a=r.changeArguments?r.changeArguments[0]:[],i=hm(e,a.map((function(t){return t.id})).filter((function(t){return t})),!1,r instanceof Zm?"next":r instanceof Um?"prev":"");t.weakMap.set(r,i)}})),this.bind(e,"beforecommandbackward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof hc&&fm(e,a)})),this.bind(e,"aftercommandforward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof hc&&pm(e,a)}))}}]),n}();var bv=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.initEvent()}},{key:"initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof Of){var a=r.cells||e.selector.selections.concat([]),i=hm(t.diagram,a,!0);r.cells=a,t.weakMap.set(r,i)}})),this.bind(e,"aftercommandbackward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof Of&&fm(e,a)})),this.bind(e,"beforecommandforward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof Of&&pm(e,a)}))}}]),n}();var xv=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this.diagram;this.bind(t,"beforepaste:lake",(function(e){var n,r=e.body,a=e.options,i=e.extraInfomations,o=e.offset,c=function(t){return"mindmap"===i[t.id].rootType},l=t.selector.selections,u=l[0];1===l.length&&u.isMindmap?(u.collapsed&&t.update(u,{collapsed:null}),n=u):r.forEach((function(t){if(c(t)){var e=i[t.id];delete t.collapsed,Object.keys(Rr).forEach((function(e){null==t[e]&&(t[e]=s()(Rr[e]))})),t.x="number"==typeof t.x?t.x:e.x,t.y="number"==typeof t.y?t.y:e.y,t.x+=o[0],t.y+=o[1],t.children&&t.children.forEach((function(t){var e=i[t.id];e.treeEdge&&e.treeEdge.stroke&&(t.treeEdge?t.treeEdge.stroke||(t.treeEdge.stroke=e.treeEdge.stroke):t.treeEdge={stroke:e.treeEdge.stroke})}))}}));var d=Bl(r,n,void 0,void 0,c),h=b()(d,2),f=h[0],p=h[1];e.body=f,e.options=a.map((function(t,e){return Object.assign(t,p[e])}))}))}}]),n}();function kv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function wv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Cv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Av(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ov=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.initEvent()}},{key:"initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"beforecommandexecute",(function(n){var r=n.command;if(r instanceof fc){var a=r.id,i=r.model,o=ir(a instanceof Array?a:[a],i),c=b()(o,2),l=c[0],s=c[1],u=l.map((function(t){return e.find(t)})),d=[[],[],[]];if(l.forEach((function(t,n){var r=e.find(t);if(r&&r.isMindmap&&r.isStem){var a=s[n],i=u[n];if(void 0!==i&&a.layout){var o=a.layout.quadrantConstraint,c=i.layout,l=(void 0===c?{}:c).quadrantConstraint;if(r.isTwoQuadrantLayout&&o&&1===o.length){var h,f,p,m=function(t){var e=[],n=[],r=[],a=-1,i=0;return t.forEach((function(t,o){var c=t.abstract,l=t.layout,s=(void 0===l?{}:l).quadrant,u=void 0===s?1:s,d=t.id,h=t.start,f=void 0===h?0:h,p=t.end,m=void 0===p?0:p;c?2===u&&(e.push(d),n.push({layout:wv(wv({},t.layout),{},{quadrant:1}),start:f+i,end:m+i}),r.push({})):2===u?(-1===a&&(a=o),e.push(d),n.push({layout:wv(wv({},t.layout),{},{quadrant:1})}),r.push({})):(i++,a>=0&&(e.push(d),n.push({layout:wv(wv({},t.layout),{},{quadrant:1})}),r.push({nth:a}),a++))})),[e,n,r]}(r.model.children),v=b()(m,3),y=v[0],g=v[1],x=v[2];(h=d[0]).push.apply(h,D()(y)),(f=d[1]).push.apply(f,D()(g)),(p=d[2]).push.apply(p,D()(x))}else if(l&&1===l.length&&(o&&2===o.length||null===o)){var k,w,C,A=r.model.children.filter((function(t){return!t.abstract})).length,O=Math.ceil(A/2),E=[],P=[],S=[];r.model.children.forEach((function(t,e){var n=t.abstract,r=t.id,a=t.start,i=void 0===a?0:a,o=t.end,c=void 0===o?0:o;if(n){var l=i<O?1:2,s=i<O?i:i-O,u=1===l?c<O?c:O-1:c-O;E.push(r),P.push({layout:Av(Av({},t.layout),{},{quadrant:l}),start:s,end:u}),S.push({})}else{var d=e<O?1:2;E.push(r),P.push({layout:Av(Av({},t.layout),{},{quadrant:d})}),S.push({})}})),(k=d[0]).push.apply(k,E),(w=d[1]).push.apply(w,P),(C=d[2]).push.apply(C,S)}}}})),d[0].length>0){var h=wm.apply(void 0,[e].concat(d));t.weakMap.set(r,h)}}})),this.bind(e,"aftercommandbackward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof fc&&Cm.apply(void 0,[e].concat(D()(a)))})),this.bind(e,"beforecommandforward",(function(n){var r=n.command,a=t.weakMap.get(r);a&&r instanceof fc&&Am.apply(void 0,[e].concat(D()(a)))}))}}]),n}(),Ev=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=t.x,a=t.y,i=t.width,o=t.height,c=b()(e,2),l=c[0],s=c[1],u=b()(n,2);return[r+l*i+u[0],a+s*o+u[1]]},Pv=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return"x"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"x")?[t,e]:[e,t]},Sv=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"group",new na),c()(this,"eventHelper",new hl),c()(this,"arr",[]),c()(this,"destroyed",!1),(new na).css({"pointer-events":"none"})}return y()(t,[{key:"setDragInfo",value:function(t,e,n){this.diagram.contentEditor.unbind();var r=e.cell,a=r.breadthPositive,i=r.abstractCoveredCells,o=r.ad,c=this.diagram.viewport.invertClient([t.clientX,t.clientY]),l=function(t,e){if(t.isAbstract){var n=t.realQuadrant,r=t.parent,a=r.getChildren(),i=r.quadrantTreeLists,o=a.filter((function(t){return t.isAbstract})),c=o.indexOf(t);if(e>0){var l=o[c+1];if(l){var s=l.realQuadrant,u=l.model.start,d=void 0===u?0:u;if(n===s)return a[i[n-1][d-1]]}var h=i[n-1];return a[h[h.length-1]]}if(c>0){var f=o[c-1],p=f.realQuadrant,m=f.model.end,v=void 0===m?0:m;if(n===p)return a[i[n-1][v+1]]}return a[i[n-1][0]]}return t}(r,n),s=-1===n?i[i.length-1]:i[0],u=Ev(s,Pv(o,(a*n+1)/2)),d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=t.minX,a=t.minY,i=t.maxX,o=t.maxY;return Ev({x:r,y:a,width:i-r,height:o-a},e,n)}(Er(l.getAllChildren().concat([l]),(function(t){return t.getKeyShapeBox()})),Pv(o,(a*n+1)/2)),h="x"===o?u[0]:u[1],f="x"===o?d[0]:d[1];return{renderInfo:e,boundaryCoord:h>f?[f,h]:[h,f],dragNodeOrder:n,dragCoord:c,dragFromNode:s,dragToNode:l}}},{key:"bind",value:function(){var t=this,e=this.diagram,n=this.eventHelper;n.unbind(),n.bind(e,"afterchange",(function(e){var n=e.action;t.arr.length>0&&("update"===n||"delete"===n)&&t.draw()}))}},{key:"show",value:function(){this.group.show()}},{key:"hide",value:function(){this.group.hide()}},{key:"select",value:function(t){var e,n,r,a=this,i=this.diagram,o=this.group,c=this.eventHelper;i.viewport.zoom,t=t.filter((function(t){return t.isCell&&t.state.visible&&t.isAbstract})),this.clear(),i.frontRootGroup.add(o),this.bind(),this.arr=t.map((function(t,e){var n={fill:"none",stroke:"#3384F5","fill-rule":"nonzero"},r={fill:"none",stroke:"rgba(255,255,255,0)"},a={fill:"none","stroke-linecap":"round"},i=t.abstractCoveredCells,c=t.abstractCoveredCellsWithAllChildren,l=t.ad,s={cell:t,coveredCells:i,coveredCellsWithAllChildren:c,rectStyle:n,handleStyle:r,rectElement:new ha(n),centerBarElements:[new ha(a),new ha(a)],handleElements:[new ha(r),new ha(r)]},u=s.rectElement,d=b()(s.centerBarElements,2),h=d[0],f=d[1],p=b()(s.handleElements,2),m=p[0],v=p[1];return[u,h,f].forEach((function(t){o.add(t)})),[m,v].forEach((function(t,n){o.add(t),t.dataset({lake_prevent_click_unselect:"true",abst_adjust_controller:"".concat(e,"-").concat(n,"-")+l})})),s})),this.draw(),this.arr.forEach((function(t){var n=b()(t.handleElements,2),r=n[0],i=n[1],o=t.cell.breadthPositive;c.bind(r.rendererElement,"mousedown",(function(n){e=a.setDragInfo(n,t,-o)})),c.bind(i.rendererElement,"mousedown",(function(n){e=a.setDragInfo(n,t,o)}))})),c.bind(i,"mousemove",(function(t){if(e)Bt()((function(){i.emit("abstadjuststart");var n=i.viewport.invertClient([t.clientX,t.clientY]);e&&(e.dragCoord=n,a.updateShape(e.renderInfo,e))}))();else{var o=t.target.dataset.abst_adjust_controller;if(o){var c=o.split("-"),l=b()(c,3),s=l[0],u=l[1],d=l[2],h=a.arr[s],f=parseInt(u),p=h.centerBarElements[f];p.update({stroke:"rgba(95,159,246)","stroke-width":4}),r&&r!==p&&r.update({stroke:"rgba(129,179,248,0.6)","stroke-width":3}),r=p;var m="x"===d?"ew-resize":"ns-resize";n!==m&&(i.setCursor(m),n=m)}else n?(i.resetCursor(),n=void 0):r&&(r.update({stroke:"rgba(129,179,248,0.6)","stroke-width":3}),r=void 0)}})),c.bind(i,"mouseup",(function(t){if(e){n=void 0,i.resetCursor();var r=i.viewport.invertClient([t.clientX,t.clientY]);e.dragCoord=r;for(var o,c=e,l=c.dragFromNode,s=c.dragToNode,u=c.renderInfo,d=c.dragNodeOrder,h=c.dragCoord,f=b()(c.boundaryCoord,2),p=f[0],m=f[1],v=u.cell,y=v.realQuadrant,g=v.ad,x=v.breadthPositive,k=v.parent,w=k.quadrantTreeLists[y-1],C=l.getNth(),A=s.getNth(),O=w.findIndex((function(t){return t===C})),E=w.findIndex((function(t){return t===A})),P="x"===g?h[0]:h[1],S=Math.max(p,Math.min(P,m)),M=x*d,j=E;(j-O)*d>=0;j-=d){var R=k.getChildren()[w[j]],L=Ev(R);if((S-("x"===g?L[0]:L[1]))*M>0){o=j;break}}e=void 0;var B=v.model,D=B.start,N=B.end;if(void 0!==o&&(1===d&&N!==o||-1===d&&D!==o)){var _=1===d?{end:o}:{start:o};i.command.execute("Update",{id:v.model.id,model:_})}else a.updateShape(u)}}))}},{key:"updateShape",value:function(t,e){this.diagram.viewport.zoom;var n=t.coveredCellsWithAllChildren,r=t.rectElement,a=t.handleElements,i=t.cell,o=t.centerBarElements,c=i.ad,l=i.breadthPositive,s=c,u="x"===s?"y":"x",d=e?t.coordCache:Er(n,(function(t){return t.getKeyShapeBox()})),h=d.minX,f=d.minY,p=d.maxX,m=d.maxY,v=!1;if(e){var y=e.dragNodeOrder,g=e.dragCoord,x=b()(e.boundaryCoord,2),k=x[0],w=x[1],C="x"===s?g[0]:g[1];C=Math.max(k,Math.min(C,w));var A=y*l==1;A?"x"===s?p=C:m=C:"x"===s?h=C:f=C,v=A?"max":"min"}else t.coordCache={minX:h,minY:f,maxX:p,maxY:m},v=!1;h-=2,p+=2,f-=2,m+=2;var O="x"===s?[p,f]:[h,m],E="x"===u?[p,f]:[h,m],P=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"x",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=n/2,l=r/2,s=c<a?c:a,u=l<a?l:a,d="x"===i?Math.min(n-2*s,o):Math.min(r-2*u,o);return[["M",+t+ +s,e]].concat("x"===i?[["l",n/2-s-d/2,0],["m",d,0],["l",n/2-s-d/2,0]]:[["l",n-2*s,0]],[["a",s,u,0,0,1,s,u]],"y"===i?[["l",0,r/2-u-d/2],["m",0,d],["l",0,r/2-u-d/2]]:[["l",0,r-2*u]],[["a",s,u,0,0,1,-s,u]],"x"===i?[["l",-(n/2-s-d/2),0],["m",-d,0],["l",-(n/2-s-d/2),0]]:[["l",-(n-2*s),0]],[["a",s,u,0,0,1,-s,-u]],"y"===i?[["l",0,-(r/2-u-d/2)],["m",0,-d],["l",0,-(r/2-u-d/2)]]:[["l",0,-(r-2*u)]],[["a",s,u,0,0,1,s,-u]])}(h,f,p-h,m-f,4,u,22);r.update({d:P,"stroke-width":1});var S="x"===s?(f+m)/2-9:(h+p)/2-9,M="min"===v?4:3;o[0].update({d:"x"===s?"M".concat(h,",").concat(S+M/2," L").concat(h,",").concat(S+18-M/2):"M".concat(S+M/2,",").concat(f," L").concat(S+18-M/2,",").concat(f),"stroke-width":M,stroke:"min"===v?"rgba(95,159,246)":"rgba(129,179,248,0.6)"});var j="max"===v?4:3;o[1].update({d:"x"===s?"M".concat(p,",").concat(S+j/2," L").concat(p,",").concat(S+18-j/2):"M".concat(S+j/2,",").concat(m," L").concat(S+18-j/2,",").concat(m),"stroke-width":j,stroke:"max"===v?"rgba(95,159,246)":"rgba(129,179,248,0.6)"}),a[0].update({d:"M".concat(h,",").concat(f," L").concat(E.join(",")),"stroke-width":8}),a[1].update({d:"M".concat(O.join(",")," L").concat(p,",").concat(m),"stroke-width":8})}},{key:"draw",value:function(){var t=this;this.arr.forEach((function(e){t.updateShape(e)}))}},{key:"clear",value:function(){this.destroyed||(this.arr=[],this.group.clear(),this.group.remove(),this.eventHelper.unbind())}},{key:"destroy",value:function(){this.eventHelper.destroy(),this.group.destroy(),this.diagram=void 0,this.group=void 0,this.arr=void 0,this.destroyed=!0}}]),t}();c()(Sv,"className","AbstractView");var Mv=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(t,"afterselect",(function(e){var n=e.selections;t.abstractView.select(n)}))}}]),n}();var jv={Cells:[qp,Zp],Extends:[yv,Sv],defaultCursors:{},modes:[{mode:"edit",Behaviours:[Kp,Qp,$p,Sm,Bm,Nm,Fm,zm,tm,function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"init",value:function(t){this.bind(window,"click",(function(e){var n=e.target;if(null!=n&&n.closest(".lake-diagram-mindmap-icon")){var r=n.getAttribute("lake-mindmap-icon-key"),a=t.getCell(n);a&&r&&(n.dataset.lakeMindmapIconSelected="true",t.emit("changemindmapicon",{key:r,cell:a,nativeEvent:e}),t.selector.selections.length>1&&t.selector.select([a]))}}))}}]),n}(),qm,Hm,Gm,Xm,gv,bv,Mv,xv,Ov]},{mode:"read",Behaviours:[Kp,$p,Hm,Jp,Fm,zm,tm]},{mode:"beginAddMindmapStem",Behaviours:[Kp,Tm]}],Commands:[Wm,Zm,Km,Qm,$m,ev,Um,tv,nv,av,iv,ov,dv]};function Rv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Lv=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"parent",void 0),c()(E()(r),"offsetY",void 0),r}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.textarea=new tu(this),this.render(),this.updateModel(this.model),this.parent.children.push(this)}},{key:"getBBox",value:function(){var t=this.offsetY,e=this.height,n=this.parent.getBBox();return n.y+=t,n.height=e,n.minY=n.y,n.maxY=n.minY+n.height,n}},{key:"canTextVerticalAlign",value:function(){return!1}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"getTextareaPosition",value:function(t){return{x:Math.max((this.width-t.width)/2,4),y:(this.height-t.height)/2+(this.offsetY||0)}}},{key:"render",value:function(){var t=mu({name:"rect",x:0,y:0,width:1,height:1});t.update({fill:"transparent"}),this.shapeElement=t,this.graphicGroup.add(t),this.textarea.render(),"edit"===this.diagram.interaction.currentMode&&this.capture(!1,!0)}},{key:"updateModel",value:function(t){var e;_()(L()(n.prototype),"updateModel",this).call(this,t),this.width=(null===(e=this.parent)||void 0===e?void 0:e.width)||0,this.textarea.update()}},{key:"draw",value:function(){this.drawPosition(),this.updateCache()}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(t){this.graphicGroup.attr({opacity:t})}},{key:"drawTextRegion",value:function(){var t=this.offsetY,e=this.width,n=this.height,r={width:e,height:n,d:Jn(0,t,e,n)};this.shapeElement.update(r)}},{key:"drawPosition",value:function(){this.drawMatrix(),this.isCacheStale("width","height","offsetY")&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"getOuterWidth",value:function(){return this.width}},{key:"capture",value:function(t,e){e&&_()(L()(n.prototype),"capture",this).call(this,t)}},{key:"updateCache",value:function(){var t=this,e=this.cache;["width","offsetY","height","rotate"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"destroy",value:function(){_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"16px","min-width":"24px","line-height":"1.45","word-break":"break-word"}}],defaultFontFamily:'SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace',multiSelectHighlight:!1,isStackCell:!0,penetratedKeys:["x","y","width","height","rotate","html","shape","offsetY","id","nth"]})}}]),n}();function Bv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(Lv,"className","StackCell");var Nv=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",new na),c()(E()(t),"elements",void 0),t}return y()(n,[{key:"render",value:function(){this.elements=[],ur(this.cell)&&this.cell.clipGroup.add(this.group)}},{key:"renderElements",value:function(){var t=this,e=this.group,n=this.cell,r=n.stencil,a=n.getRoughGraphicOptions();r.scene.forEach((function(n){var r=mu(n,a);n.attr&&r.update(n.attr),e.add(r),t.elements.push(r)}))}},{key:"update",value:function(){var t=this.cell,e=this.elements;t.isCacheStale("shape")&&(e&&e.forEach((function(t){return t.remove()})),this.renderElements())}},{key:"draw",value:function(){var t,e,n=this.cell,r=this.elements,a=n.stroke,i=n.heights,o=Dv({},n.convertStrokeStyle());n.isCacheStale("stroke")&&(o.stroke=a.color,o["stroke-width"]=a.width);for(var c=[i[0]],l=1;l<i.length;l++){var s=i[l];c[l]=c[l-1]+s}r.forEach((function(r,a){if(n.isCacheStale("width","height")){var i=n.stencil,l=n.width;t=l/i.width,e=c[a]/i.scene[a].height}t&&e?r.update(Dv(Dv({},o),{},{d:r.getPath(t,e)})):r.update(o),t=e=void 0}))}}]),n}();function _v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Iv=function(t){S()(n,wu);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n);var a=sc[sc.findIndex((function(e){return e.name===t.model.shape}))],i={row:a.row,heights:a.heights};return r=e.call(this,f()(t,i)),c()(E()(r),"children",void 0),r}return y()(n,[{key:"canRough",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"getChildren",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var t=this.getRoughGraphicOptions();return mu(this.stencil.outline,t)}}},{key:"updateStencil",value:function(){var t=this,e=this.shape,n=this.stencils,r=e||"process";if(!this.stencil||this.stencil.name!==r){var a=n.find((function(t){return t.name===r}));if(!a)throw new Error("unknown shape ".concat(r));this.stencil=a,this.updateAnchors(),["width","height"].forEach((function(e){null==t[e]&&(t[e]=a[e])})),this.cache={}}}},{key:"updateAnchors",value:function(){for(var t=this.anchors,e=this.stencil,n=function(){var n=t[r],a=e.anchors.find((function(t){return t.name===n.name}));a&&(t[r]=a)},r=0;r<t.length;r++)n()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),_()(L()(n.prototype),"afterUpdateModel",this).call(this)}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"getOutlinePath",value:function(t){var e,n=this.width,r=this.heights,a=this.stencil,i=r.reduce((function(t,e){return t+e}),0);if(a.outline.path)e=a.outline.path(n,i);else{var o=n/a.width,c=i/a.height;e=t.getPath(o,c)}return e}},{key:"render",value:function(){_()(L()(n.prototype),"render",this).call(this);var t=this.model;t.width||(t.width=this.width),t.height||(t.height=this.height)}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(t){return t.capture(!0,!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(t){return t.capture(!1,!0)}))}},{key:"_drawInner",value:function(){this.isCacheStale("height","width","heights","roughFillStyle")&&(this.subcells.forEach((function(t){return t.draw()})),this.updateCache())}},{key:"updateCache",value:function(){var t=this,e=this.cache;["x","y","width","height","heights","rotate","fill","stroke","opacity","shape","roughFillStyle"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_v(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"executeLayout",value:function(){var t=this,e=this.diagram,n=this.getZIndex(),r=[0],a=D()(this.children),i=e.contentEditor,o=e.rootGroup;a.forEach((function(e,a){e.width=t.width,e.textarea.update();var i=e.textarea.getBBox();t.heights[a]=Math.max(i.height+12,30),e.matrix=t.matrix,e.height=t.heights[a],e.offsetY=r[a],e.opacity=t.opacity,r[a+1]=r[a]+t.heights[a],e.model.zIndex=n+a+1,e.textarea.draw()})),this.height=this.heights.reduce((function(t,e){return t+e}),0),a.sort((function(t,e){return e.model.zIndex-t.model.zIndex})),a.forEach((function(e){i.isBegin||o.insertBefore(t.graphicGroup,e.graphicGroup)})),this._drawInner()}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var t=this.graphicGroup,e=this.matrix;t.update({matrix:e})}}},{key:"drawOpacity",value:function(){var t=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(e){e.drawOpacity(t.opacity)})))}},{key:"draw",value:function(){this.subcells.forEach((function(t){return t.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stencils:sc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},children:[],isStack:!0,resizeRotatePoints:["lc","rc","rotate"],penetratedKeys:["x","y","width","height","rotate","heights","shape"],Subcells:[Nv]})}}]),n}();c()(Iv,"className","StackStem");var Tv=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.model,e=this.htmls,r=this.diagram;t.children=[];for(var a=0;a<t.row;a++)t.children.push({html:e[a],id:Object(F.a)(),nth:a});r.hooks.decorateAddStackModel.call(t),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Tv,"className","AddStack");var Fv=function(t){S()(n,Pf);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.model,e=this.htmls,r=this.diagram;t.children=[];for(var a=0;a<t.row;a++)t.children.push({html:e[a],id:Object(F.a)(),nth:a});r.hooks.decorateAddStackModel.call(t),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Fv,"className","AddStackVertex");var zv={Cells:[Lv,Iv],Extends:[],defaultCursors:{},modes:[{mode:"edit",Behaviours:[function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"stack",void 0),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(){this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"dblclick",(function(n){var r=e.viewport.invertClient([n.clientX,n.clientY]),a=e.getCell(n.target);if(a&&br(a)){var i,o=a;t.stack=o,o.getChildren().forEach((function(t){t.isPointInShape({x:r[0],y:r[1]})&&(i=t)})),o.enter(),i&&(e.selector.select(i),e.contentEditor.beginEdit())}})),this.bind(e,"afterselect",(function(e){var n=e.selections;t.stack&&n.findIndex((function(e){var n;return e.model.id===t.stack.model.id||(null===(n=e.parent)||void 0===n?void 0:n.model.id)===t.stack.model.id}))<0&&t.stack.exit()}))}}]),n}()]},{mode:"read",Behaviours:[]}],Commands:[Tv,Fv]};function qv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Yv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}rp.registerClipboardProcessor("swimlane",{lake:function(t){var e=t.model,n=t.offset;e.x=(e.x||0)+n[0],e.y=(e.y||0)+n[1],e.contain=[]}});var Hv=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"elements",[]),c()(E()(t),"bc",void 0),c()(E()(t),"lc",void 0),c()(E()(t),"rc",void 0),c()(E()(t),"tc",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell;this.group=new na;for(var e=0;e<4;e++){var n=mu({stroke:"none","stroke-width":1});this.group.add(n),this.elements.push(n)}t.clipGroup.prepend(this.group),this.tc=this.elements[0],this.rc=this.elements[1],this.bc=this.elements[2],this.lc=this.elements[3]}},{key:"update",value:function(){}},{key:"draw",value:function(){var t=this.cell;if(t.isCacheStale("width","height","stroke")){var e=t.width,n=t.height,r=t.convertStrokeStyle();r.stroke="#fff",r["stroke-width"]=2*t.stroke.width,this.tc.update(Yv(Yv({},r),{},{d:Vn(0,0,e,0)})),this.rc.update(Yv(Yv({},r),{},{d:Vn(e,0,e,n)})),this.bc.update(Yv(Yv({},r),{},{d:Vn(e,n,0,n)})),this.lc.update(Yv(Yv({},r),{},{d:Vn(0,n,0,0)}))}}}]),n}();function Gv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Xv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wv=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"horizentalElements",void 0),c()(E()(t),"verticalElements",void 0),c()(E()(t),"length",0),c()(E()(t),"numberWidth",0),c()(E()(t),"numberHeight",0),t}return y()(n,[{key:"render",value:function(){var t=this.cell;this.group=new na,t.group.add(this.group)}},{key:"init",value:function(){var t=this,e=this.cell,n=e.getRoughGraphicOptions();this.group.clear(),this.horizentalElements=[],this.verticalElements=[],e.widths.forEach((function(){var e=mu({},n);e.dataset({test_tag:"verticalSwimlaneLine"}),t.group.add(e),t.verticalElements.push(e)})),e.heights.forEach((function(){var e=mu({},n);e.dataset({test_tag:"horizentalSwimlaneLine"}),t.group.add(e),t.horizentalElements.push(e)}))}},{key:"update",value:function(){var t,e,n,r,a,i,o,c;this.numberWidth===(null===(t=this.cell.model)||void 0===t||null===(e=t.widths)||void 0===e?void 0:e.length)&&this.numberHeight===(null===(n=this.cell.model)||void 0===n||null===(r=n.heights)||void 0===r?void 0:r.length)||(this.numberWidth=null===(a=this.cell.model)||void 0===a||null===(i=a.widths)||void 0===i?void 0:i.length,this.numberHeight=null===(o=this.cell.model)||void 0===o||null===(c=o.heights)||void 0===c?void 0:c.length)}},{key:"draw",value:function(){var t=this.cell;if(t.isCacheStale("stroke","width","height","widths","heights","roughFillStyle")){this.init();var e=Xv(Xv({},t.convertStrokeStyle()),{},{stroke:t.stroke.color,"stroke-width":t.stroke.width,d:""});this.horizentalElements.forEach((function(n,r){var a=t.heights[r]*t.height;e.d="M0,".concat(a," L").concat(t.width,",").concat(a),n.update(e)})),this.verticalElements.forEach((function(n,r){var a=t.widths[r]*t.width;e.d="M".concat(a,",0 L").concat(a,",").concat(t.height),n.update(e)}))}}}]),n}();var Vv=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"element",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell;this.group=new na,this.element=mu({stroke:"none",fill:"transparent"}),this.group.add(this.element),t.graphicGroup.prepend(this.group)}},{key:"update",value:function(){}},{key:"draw",value:function(){var t=this.cell;if(t.isCacheStale("width","height","widths","heights")){var e={d:""};e.d=t.isVertical?Jn(0,0,t.width,t.height*t.heights[0]):Jn(0,0,t.width*t.widths[0],t.height),this.element.update(e)}}}]),n}();function Zv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Uv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Kv=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"clipGroup",new na),c()(E()(r),"clipPathID",Object(F.a)()),c()(E()(r),"group",new na),c()(E()(r),"isSwimlane",!0),c()(E()(r),"stencils",void 0),c()(E()(r),"stencil",void 0),c()(E()(r),"widths",void 0),c()(E()(r),"heights",void 0),c()(E()(r),"children",void 0),c()(E()(r),"contain",void 0),c()(E()(r),"shape",void 0),r}return y()(n,[{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.clipGroup.add(this.group),this.group.capture(!1),this.graphicGroup.prepend(this.clipGroup),this.subcells=this.Subcells.map((function(t){return new t(e)})),this.subcells.forEach((function(t){return t.render()})),this.model.contain=this.model.contain||[],this.updateModel(this.model),this.eventDelegation()}},{key:"updateDefaultSize",value:function(){var t=this,e=this.stencil;e&&["width","height"].forEach((function(n){null==t[n]&&(t[n]=e[n])}))}},{key:"isVertical",get:function(){return"swimlane-vertical"===this.model.shape}},{key:"getTextBox",value:function(){var t=this.x,e=this.y,n=this.heights,r=this.width,a=this.height;if(this.isVertical){var i={x:t,y:e,width:r,height:n[0]*a};return Uv(Uv({},i),Ar(i))}return this.getBBox()}},{key:"containerBBox",get:function(){if(this.isVertical){var t=this.y+this.heights[0]*this.height,e=(1-this.heights[0])*this.height;return{x:this.x,y:t,width:this.width,height:e}}var n=this.x+this.widths[0]*this.width,r=(1-this.widths[0])*this.width;return{x:n,y:this.y,width:r,height:this.height}}},{key:"containerBBoxs",get:function(){var t=this;if(this.isVertical){var e=this.height*this.heights[0];return this.children.map((function(n){return{x:t.x+n.offsetX,y:t.y+e,width:n.width,height:t.height-e}}))}var n=this.width*this.widths[0];return this.children.map((function(e){return{x:t.x+n,y:t.y+e.offsetY,width:t.width-n,height:e.height}}))}},{key:"canUpdateText",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"canRough",value:function(){return!0}},{key:"getOutlinePath",value:function(t){var e=this.width,n=this.height,r=this.stencil;if(this.isCacheStale("width","height","roughFillStyle")){var a;if(r.outline.path)a=r.outline.path(e,n);else{var i=e/r.width,o=n/r.height;a=t.getPath(i,o)}return a}}},{key:"canConnect",value:function(){return!1}},{key:"canRotate",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(t){return t.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(t){return t.capture(!1)}))}},{key:"getChildren",value:function(){return this.children}},{key:"getKeyShape",value:function(){return this.outlineElement}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var t=this.stencil,e=this.getRoughGraphicOptions();return mu(t.outline,e)}}},{key:"updateModel",value:function(t){_()(L()(n.prototype),"updateModel",this).call(this,t),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateDefaultSize(),this._updateStencil(),this.updateMatrix(),this.subcells.forEach((function(t){t.update()})),this.getRoughGraphicOptions()?this.clipGroup.update({"clip-path":"none"}):this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")})}},{key:"_updateStencil",value:function(){var t=this.shape,e=this.stencils,n=t||"swimlane-vertical";if(!this.stencil||this.stencil.name!==n){var r=e.find((function(t){return t.name===n}));if(!r)throw new Error("unknown shape ".concat(n));this.stencil=r,this.updateDefaultSize(),this.cache={}}}},{key:"_layoutZIndex",value:function(){var t=this,e=this.diagram,n=e.rootGroup;e.contentEditor.isBegin||this.children.forEach((function(e){n.insertBefore(e.graphicGroup,t.graphicGroup)}))}},{key:"executeLayout",value:function(){var t=this;this._layoutZIndex();var e;e="swimlane-vertical"===this.shape?[0].concat(D()(this.widths),[1]):[0].concat(D()(this.heights),[1]),this.children.forEach((function(n,r){n.matrix=t.matrix,"swimlane-vertical"===t.shape?(n.offsetX=e[r]*t.width,n.offsetY=0,n.width=(e[r+1]-e[r])*t.width,n.height=t.height,n.textHeight=t.height*t.heights[0],n.textWidth=n.width):(n.offsetX=0,n.offsetY=e[r]*t.height,n.width=t.width,n.height=(e[r+1]-e[r])*t.height,n.textHeight=n.height,n.textWidth=t.width*t.widths[0]),n.x=t.x+n.offsetX,n.y=t.y+n.offsetY,n.textarea.update(),n.opacity=t.opacity,n.matrix=Qi(n.x,n.y,n.width,n.height,0)}))}},{key:"updateCache",value:function(){var t=this,e=this.cache;["x","y","width","widths","height","heights","rotate","shape","stroke","controlPoints","round","opacity","roughFillStyle"].forEach((function(n){var r=t[n];e[n]=d()(r)?Uv({},r):r}))}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(t){t.draw()})),this.subcells.forEach((function(t){return t.draw()})),this.drawOpacity(),this.drawPosition(),this.updateCache()}},{key:"drawOpacity",value:function(){var t=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(e){e.drawOpacity(t.opacity)})))}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var t=this.graphicGroup,e=this.matrix;t.update({matrix:e})}}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stencils:sc,stroke:{color:"#595959",width:2},rotate:0,children:[],penetratedKeys:["x","y","width","height","widths","heights","shape","htmls","stroke","contain","opacity"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[Wv,xu,Hs,Hv,Vv]})}}]),n}();function Qv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qv(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(Kv,"className","SwimlaneStem");var Jv=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"textVerticalAlign",void 0),c()(E()(r),"offsetX",0),c()(E()(r),"offsetY",0),c()(E()(r),"textWidth",0),c()(E()(r),"textHeight",0),c()(E()(r),"textRegion",void 0),c()(E()(r),"textarea",void 0),c()(E()(r),"parent",void 0),r}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.textarea=new tu(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return{minX:t,minY:e,maxX:t+n,maxY:e+r,x:t,y:e,width:n,height:r}}},{key:"canRotate",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var t=this.parent,e=mu({name:"rect",x:0,y:0,width:1,height:1,stroke:"none"},null==t?void 0:t.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=e,this.graphicGroup.prepend(e)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(t){_()(L()(n.prototype),"updateModel",this).call(this,t),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(t){var e=this.textVerticalAlign,n={x:Math.max((this.textWidth-t.width)/2,4),y:0};return n.y="top"===e?4:"bottom"===e?this.textHeight-t.height:(this.textHeight-t.height)/2,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.textWidth}},{key:"getTextBox",value:function(){var t={x:this.x,y:this.y,width:this.textWidth,height:this.textHeight};return $v($v({},t),Ar(t))}},{key:"drawTextRegion",value:function(){var t=this.width,e=this.textHeight,n={width:t,textHeight:e,d:Jn(0,0,this.textWidth,e)};this.textRegion.update(n)}},{key:"updateCache",value:function(t){var e=this,n=this.cache;(t=t||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(t){var r=e[t];n[t]=d()(r)?$v({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(t){this.isCacheStale("opacity")&&(t=t||this.opacity,this.graphicGroup.attr({opacity:t}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){sn(this.parent.children,this),_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums",margin:0}}],multiSelectHighlight:!1,isSwimlaneCell:!0,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(Jv,"className","SwimlaneCell");var ty=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.model,e=this.htmls,r=this.number,a=this.diagram;t.children=[],t.id=t.id||Object(F.a)();for(var i=0;i<r;i++){var o=Object(F.a)();t.children.push({html:e[i],id:o,nth:i})}a.hooks.decorateAddSwimlaneModel.call(t),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(ty,"className","AddSwimlane");var ey=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"set",void 0),c()(E()(t),"swimlaneID",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this,e=this.id,r=this.diagram,a="string"==typeof e?r.find(e):e;this.swimlaneID=a.model.id,this.set=new Set,a.contain.forEach((function(e){var n=r.find(e);if(n){var i=vi(n);t.set.has(i.model.id)||r.swimlane.isCellsInSwimlane([i],a)||(t.set.add(i.model.id),r.swimlane.unbind(i,a))}})),_()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var t=this;this.set.forEach((function(e){t.diagram.swimlane.unbind(e,t.swimlaneID)})),_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var t=this;this.set.forEach((function(e){t.diagram.swimlane.bind(e,t.swimlaneID)})),_()(L()(n.prototype),"backward",this).call(this)}}]),n}();function ny(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ry(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ry(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function ry(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}c()(ey,"className","UpdateSwimlane"),c()(ey,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return yr(t)}))}));var ay=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"originMap",new Map),c()(E()(t),"newMap",new Map),c()(E()(t),"ids",void 0),c()(E()(t),"parentID",void 0),t}return y()(n,[{key:"execute",value:function(){var t,e=this,r=this.id,a=this.parent,i=this.diagram;this.parentID=null==a||null===(t=a.model)||void 0===t?void 0:t.id;var o=r.map((function(t){return"string"==typeof t?e.diagram.find(t):t}));this.ids=r.map((function(t){return t.model.id})),o.forEach((function(t){var n=vi(t),r=n.model.id;e.originMap.has(r)||(e.originMap.set(r,n.swimlane),e.newMap.set(r,e.parentID),i.swimlane.unbind(r,n.swimlane),i.swimlane.bind(r,e.parentID))})),_()(L()(n.prototype),"execute",this).call(this)}},{key:"forward",value:function(){var t,e=ny(this.originMap);try{for(e.s();!(t=e.n()).done;){var r=b()(t.value,2),a=r[0],i=r[1],o=this.newMap.get(a);this.diagram.swimlane.unbind(a,i),this.diagram.swimlane.bind(a,o)}}catch(t){e.e(t)}finally{e.f()}_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var t,e=ny(this.originMap);try{for(e.s();!(t=e.n()).done;){var r=b()(t.value,2),a=r[0],i=r[1],o=this.newMap.get(a);this.diagram.swimlane.unbind(a,o),this.diagram.swimlane.bind(a,i)}}catch(t){e.e(t)}finally{e.f()}_()(L()(n.prototype),"backward",this).call(this)}}]),n}();c()(ay,"className","InteractSwimlane");var iy=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"swimlaneID",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this.diagram.selector.selections[0];this.swimlaneID=t.model.id,this._execute()}},{key:"forward",value:function(){this._execute()}},{key:"backward",value:function(){this._execute()}},{key:"_execute",value:function(){var t=this.diagram.find(this.swimlaneID);if(t&&yr(t)){var e=this.switch(t),n=e.ids,r=e.nmodels;n.unshift(t.model.id);var a={width:t.height,height:t.width,widths:t.heights,heights:t.widths,shape:""};t.isVertical?a.shape="swimlane-horizontal":a.shape="swimlane-vertical",r.unshift(a),this.diagram.update(n,r)}}},{key:"getSwimlaneContainModels",value:function(t){var e=this.diagram,n=[];return Ze(t.model,(function(t){return"group"===t.type||!t.type||(n.push(t),!0)}),(function(t){return"swimlane"===t.type?t.contain.map((function(t){var n;return null===(n=e.find(t))||void 0===n?void 0:n.model})):t.children})),n}},{key:"switch",value:function(t){var e=this.getSwimlaneContainModels(t),n=t.isVertical?-90:90,r=t.center,a=[],i=e.map((function(e){a.push(e.id);var i={};t.isVertical?(i.x=r.x-e.x+r.x,i.y=e.y):(i.x=e.x,i.y=r.y-e.y+r.y);var o=Mo(r,n,[{x:i.x,y:i.y,w:0,h:0,r:0}]),c=b()(o,1)[0];i.x=c.x,i.y=c.y;var l=Math.abs(t.width-t.height)/2;return t.width>t.height?(i.x-=l,i.y+=l):(i.x+=l,i.y-=l),i}));return{ids:a,nmodels:i}}}],[{key:"enable",value:function(t){return 1===t.selector.selections.length&&yr(t.selector.selections[0])}}]),n}();c()(iy,"className","SwitchSwimlane");var oy=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"swimlaneID",void 0),c()(E()(r),"removeLaneModel",void 0),c()(E()(r),"addLaneModel",void 0),c()(E()(r),"field",void 0),c()(E()(r),"number",void 0),c()(E()(r),"startNumber",void 0),c()(E()(r),"ids",[]),c()(E()(r),"removedChildIDSet",new Set),r.number=t.number,r}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.number;if(!(e<1||50<e)){var n=t.selector.selections[0];if(gr(n)&&(n=n.parent),n&&yr(n)){this.swimlaneID=n.model.id,this.field="height",n.isVertical&&(this.field="width");var r=n.children.length;if(this.startNumber=r,this.options={model:[],cellOptions:[]},this.processModel(n),e>this.startNumber){for(var a=r;a<e;a++){var i=Object(F.a)();this.ids.push(i),this.options.model.push({html:'<div style="text-align:center;"><span style="font-weight:bold;">Lane '.concat(a+1,"</span></div>"),fill:n.children[r-1].model.fill,id:i,nth:a}),this.options.cellOptions.push({parent:n.model.id,nth:a})}this.addLane(n)}else if(e<r){for(var o=e;o<r;o++){var c=n.children[o],l=c.model,s=l.nth,u=l.id,d=l.html,h=l.fill;this.ids.push(c.model.id),this.options.model.push({html:d,id:u,nth:s,fill:h}),this.options.cellOptions.push({parent:n.model.id,nth:s})}this.removeLane(n),this.unbind(n)}}}}},{key:"forward",value:function(){var t=this,e=this.diagram.find(this.swimlaneID);e&&(this.number>this.startNumber?this.addLane(e):(this.removeLane(e),this.removedChildIDSet.forEach((function(n){t.diagram.swimlane.unbind(n,e)}))))}},{key:"backward",value:function(){var t=this,e=this.diagram.find(this.swimlaneID);e&&(this.number>this.startNumber?this.removeLane(e):(this.addLane(e),this.removedChildIDSet.forEach((function(n){t.diagram.swimlane.bind(n,e)}))))}},{key:"unbind",value:function(t){var e=this;this.diagram.swimlane.updateContain(t).forEach((function(t){e.removedChildIDSet.add(t)}))}},{key:"processModel",value:function(t){var e=this,n=this.field,r=t.children.length;if(this.number>r){var a,i;this.removeLaneModel=(c()(a={},"".concat(n,"s"),t["".concat(n,"s")]),c()(a,n,t[n]),a);var o=[0].concat(D()(t["".concat(n,"s")]),[1]),l=t[n],s=t[n]+150*(this.number-r),u=[];o.forEach((function(t,e){e!==o.length-1&&u.push(l*(o[e+1]-o[e]))}));for(var d=r;d<this.number;d++)u.push(150);var h=[];u.reduce((function(t,e,n){return n>=u.length-1?0:(h.push((t+e)/s),t+e)}),0),this.addLaneModel=(c()(i={},"".concat(n,"s"),h),c()(i,n,s),i)}else if(this.number<r){var f,p;this.addLaneModel=(c()(f={},"".concat(n,"s"),t["".concat(n,"s")]),c()(f,n,t[n]),f);var m=[0].concat(D()(t["".concat(n,"s")]),[1]),v=t[n],y=[];m.forEach((function(t,n){n>=e.number||y.push(v*(m[n+1]-m[n]))}));var g=y.reduce((function(t,n,r){return r>=e.number?t:t+n}),0),b=[];y.reduce((function(t,e,n){return n===y.length-1?0:(b.push((t+e)/g),t+e)}),0),this.removeLaneModel=(c()(p={},"".concat(n,"s"),b),c()(p,n,g),p)}}},{key:"addLane",value:function(t){var e=this.diagram,n=this.field;t["".concat(n,"s")]=this.addLaneModel["".concat(n,"s")],t[n]=this.addLaneModel[n],e.hooks.decorateAddSwimlaneChildModel.call(this.options.model[0]),e.add(this.options.model,this.options.cellOptions),e.update(t,this.addLaneModel)}},{key:"removeLane",value:function(t){var e=this.diagram,n=this.field;this.isRemovedInSelections()&&e.selector.select([]),e.remove(this.ids),t["".concat(n,"s")]=this.removeLaneModel["".concat(n,"s")],t[n]=this.removeLaneModel[n],e.update(t,this.removeLaneModel)}},{key:"isRemovedInSelections",value:function(){var t=this;return this.ids.some((function(e){return t.diagram.selector.selections.find((function(t){return t.model.id===e}))}))}}]),n}();c()(oy,"className","ChangeLaneNumber"),c()(oy,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&yr(e[0])||e.every((function(t){return t.swimlane===e[0].swimlane}))}));var cy=function(){function t(e){m()(this,t),this.diagram=e,c()(this,"swimlanes",void 0),c()(this,"group",new na),this.swimlanes=[],e.frontRootGroup.add(this.group)}return y()(t,[{key:"findSwimlane",value:function(t){if(0!==t.length&&!t.some((function(t){return yr(t)}))){for(var e,n=this.getSwimlanes(),r=this.computeRegion(t),a=0;a<n.length;a++){var i=n[a];if(io(Ar(i.containerBBox),r)){e=i;break}}return this.swimlanes=[],e}}},{key:"highlight",value:function(t){var e=this.diagram.connect.getCellConnectStateElement(t);this.group.clear(),this.group.add(e)}},{key:"unhighlight",value:function(){this.group.clear()}},{key:"updateContain",value:function(t){var e=this,n=[],r=this.diagram;return t.model.contain.forEach((function(a){var i=r.find(a);i&&(e.isCellsInSwimlane([i],t)||(r.swimlane.unbind(i,t),n.push(i.model.id)))})),n}},{key:"resetNth",value:function(t){var e=this;Array.isArray(t)||(t=[t]),t.forEach((function(t){var n=e.diagram.find(t);n&&n.children.forEach((function(t,e){t.nth=e,t.model.nth=e}))}))}},{key:"isCellsInSwimlane",value:function(t,e){var n=this.diagram,r=t.map((function(t){return n.find(t)})).filter((function(t){return t})),a=this.computeRegion(r),i=n.find(e);return!!i&&io(Ar(i.containerBBox),a)}},{key:"bind",value:function(t,e){var n=this.diagram,r=n.find(t),a=n.find(e);r&&(a&&yr(a)?(r.swimlane=a.model.id,dn(a.model.contain,r.model.id)):r.swimlane=void 0)}},{key:"unbind",value:function(t,e){var n=this.diagram,r=n.find(t),a=e?n.find(e):n.find(null==r?void 0:r.swimlane);a&&yr(a)&&(r?(r.swimlane=void 0,sn(a.model.contain,r.model.id)):"string"==typeof t&&sn(a.model.contain,t))}},{key:"getSwimlanes",value:function(){return this.swimlanes.length>0?this.swimlanes:this.swimlanes=this.diagram.getCells().filter((function(t){return yr(t)})).sort((function(t,e){return e.getZIndex()-t.getZIndex()}))}},{key:"getCellofSwimlane",value:function(t,e){for(var n=e.containerBBoxs,r=0,a=-1,i=0;i<n.length;i++){var o=n[i],c=So(o,t);c>r&&(r=c,a=i)}return e.children[a]}},{key:"computeRegion",value:function(t){return Er(t,(function(t){return sr(t)?t.getPointBox():t.getBBox()}))}},{key:"destroy",value:function(){this.group.remove()}}]),t}();c()(cy,"className","Swimlane");var ly={lake_prevent_click_unselect:"true",swimlane_resize_controller:"true"},sy=function(t){S()(n,rh);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"cell",void 0),c()(E()(r),"horizontals",[]),c()(E()(r),"verticals",[]),c()(E()(r),"swimlaneGroup",new na),c()(E()(r),"swimlane",void 0),r}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.swimlane=yr(t)?t:t.parent,this._init()}},{key:"_init",value:function(){this.swimlane.widths.length===this.verticals.length&&this.swimlane.heights.length===this.horizontals.length||(this.prepareResizeLines(),this.bindEvent())}},{key:"prepareResizeLines",value:function(){var t=this;this.swimlaneGroup.clear(),this.verticals=[],this.horizontals=[],this.swimlane.widths.forEach((function(){var e=pi("vertical",ly);e.visShape.update({stroke:"rgba(255,255,255,0)"}),t.swimlaneGroup.add(e.group),t.verticals.push(e)})),this.swimlane.heights.forEach((function(){var e=pi("horizontal",ly);e.visShape.update({stroke:"rgba(255,255,255,0)"}),t.swimlaneGroup.add(e.group),t.horizontals.push(e)}))}},{key:"update",value:function(){var t=this.swimlane,e=this.diagram;if(t){this._init();var r=1/e.viewport.zoom,a=r,i=8*r;_()(L()(n.prototype),"update",this).call(this),this.verticals.forEach((function(e,n){var r=t.percentage2Canvas([t.widths[n],0]),o=t.percentage2Canvas([t.widths[n],1]);e.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":i}),e.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":a})})),this.horizontals.forEach((function(e,n){var r=t.percentage2Canvas([0,t.heights[n]]),o=t.percentage2Canvas([1,t.heights[n]]);e.shape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":i}),e.visShape.update({d:"M".concat(r.x,",").concat(r.y," L").concat(o.x,",").concat(o.y),"stroke-width":a})}))}}},{key:"bindEvent",value:function(){var t,e,r,a,i=this,o=this.eventHelper,c=this.diagram,l=this.swimlane;this.eventHelper.unbind();var u={},d={},h=!1;[].concat(D()(this.verticals),D()(this.horizontals)).forEach((function(n,s){o.bind(n.shape,"mouseenter",(function(){n.visShape.update({stroke:"#3384F5"})})),o.bind(n.shape,"mouseleave",(function(){n.visShape.update({stroke:"rgba(255,255,255,0)"})})),o.bind(n.shape,"mousedown",(function(o){c.contentEditor.unbind(),r=n.name,t=l.widths,e=l.heights,a="horizontal"===n.name?s-i.verticals.length:s,u={widths:t,heights:e}}))})),o.bind(c,"mousemove",(function(n){if(r&&t&&e&&void 0!==a){var o,l,u=c.viewport.invertClient([n.clientX,n.clientY]),f=i.swimlane.canvas2percentage(u),p=[0].concat(D()(t),[1]),m=[0].concat(D()(e),[1]);"vertical"===r?(o=p[a],l=p[a+2],d.widths=s()(t),d.widths[a]=Je(f[0],o,l)):(o=m[a],l=m[a+2],d.heights=s()(e),d.heights[a]=Je(f[1],o,l)),c.update(i.swimlane,d)}else if(n.target.dataset.swimlane_resize_controller){var v;if("line"===n.target.dataset.type){var y=Qn(n.target.getAttribute("d"));v=bi([y[1][1]-y[0][1],y[1][2]-y[0][2]],{x:-1,y:-1,width:1,height:1},Math.PI/2+.01)}h||(h=!0),v&&c.setCursor(v)}else h&&(c.resetCursor(),h=!1)})),o.bind(c,"mouseup",(function(){Object.keys(d).length>0&&(Ft()(d.widths,t)&&Ft()(d.heights,e)||c.command.execute("Update",{id:l,model:d,originModels:[u],select:function(){}})),e=void 0,e=void 0,r=void 0,a=void 0,h=!1,u={},d={}})),_()(L()(n.prototype),"bindEvent",this).call(this)}},{key:"begin",value:function(){this.group.add(this.swimlaneGroup),_()(L()(n.prototype),"begin",this).call(this)}}]),n}();c()(sy,"className","SwimlaneResize");var uy=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"swimlane",void 0),c()(E()(t),"diagram",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"dblclick",(function(n){var r=e.viewport.invertClient([n.clientX,n.clientY]),a=e.getCell(n.target);if(a&&yr(a)){var i,o=a;t.swimlane=o,o.children.forEach((function(t){t.isPointInShape({x:r[0],y:r[1]})&&(i=t)})),o.enter(),i&&(e.selector.select(i),e.contentEditor.beginEdit())}})),this.bind(e,"afterselect",(function(e){var n=e.selections;t.swimlane&&n.findIndex((function(e){return e===t.swimlane||e.parent===t.swimlane}))<0&&t.swimlane.exit()}))}}]),n}();var dy=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"group",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.group=new na,t.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram,n=[];this.bind(e,"afterselectionchange",(function(e){var r=e.selections.filter((function(t){return yr(t)}));t.group.clear(),n=[],r.forEach((function(e){var r=mu({stroke:"none",fill:"transparent",d:Jn(e.x,e.y,e.width,e.height)});r.css({cursor:"move"}),r.dataset({cellid:e.model.id}),n.push(r),t.group.add(r)}))}));var r=function(){n.forEach((function(t){var n=e.find(t.rendererElement.dataset.cellid);if(n){var r=n.containerBBox,a=r.x,i=r.y,o=r.width,c=r.height;t.update({d:Jn(a,i,o,c)})}}))};this.bind(e,"cell:dragend",(function(){r()})),this.bind(e,"aftervertexresize",(function(){r()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var hy=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"group",void 0),c()(E()(t),"swimlane",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.group=new na,t.backRootGroup.add(this.group)}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"afterselectionchange",(function(e){var n,r,a=e.selections,i=a[0];i&&(yr(i)?r=i:gr(i)&&(r=i.parent),r&&(t.swimlane=r,a.every((function(t){return yr(t)?r===t:!!gr(t)&&r===t.parent}))))?r.swimlaneExtension.show():null===(n=t.swimlane)||void 0===n||n.swimlaneExtension.hide()}))}},{key:"reset",value:function(){this.group.remove()}}]),n}();var fy=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"group",void 0),c()(E()(t),"swimlane",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.group=new na,t.backRootGroup.add(this.group),this._initEvent()}},{key:"_initEvent",value:function(){var t=this.diagram;this.bind(t,"afterimport",(function(){t.getCells().forEach((function(e){if(yr(e)){var n,r=[];null===(n=e.model.contain)||void 0===n||n.forEach((function(n){var a=t.find(n);a?a.swimlane=e.model.id:r.push(n)})),sn.apply(void 0,[e.model.contain].concat(r))}}))}))}}]),n}();function py(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return my(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?my(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function my(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var vy=function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=["Add","AddVertex","AddStack","AddStackVertex"],n=this.diagram;this.bind(n,"aftercommandexecute",(function(r){var a=r.commandName,i=r.command;if(e.includes(a)){var o=new Map,c=Array.isArray(i.model)?i.model:[i.model],l=!1;c.forEach((function(t){var e=n.find(t.id);if(e){var r=vi(e);if(!o.has(r.model.id)){var a,i=null===(a=n.swimlane)||void 0===a?void 0:a.findSwimlane([r]);i&&(l=!0,n.swimlane.bind(r,i),o.set(r.model.id,i.model.id))}}})),l&&t.weakMap.set(i,o)}})),this.bind(n,"beforecommandbackward",(function(n){var r=n.command,a=t.weakMap.get(r);if(a&&e.includes(r.commandName)){var i,o=py(a);try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];t.diagram.swimlane.unbind(l,s)}}catch(t){o.e(t)}finally{o.f()}}})),this.bind(n,"aftercommandforward",(function(n){var r=n.command,a=t.weakMap.get(r);if(a&&e.includes(r.commandName)){var i,o=py(a);try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];t.diagram.swimlane.bind(l,s)}}catch(t){o.e(t)}finally{o.f()}}}))}}]),n}();function yy(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return gy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gy(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function gy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var by=y()((function t(){m()(this,t),c()(this,"map",new Map),c()(this,"groupID",void 0),c()(this,"swimlaneID",void 0)}));function xy(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return ky(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ky(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw i}}}}function ky(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var wy={Cells:[Kv,Jv],Extends:[cy,sy],defaultCursors:{},modes:[{mode:"edit",Behaviours:[hy,uy,dy,fy,vy,function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t,e=this,n=this.diagram;this.bind(n,"beforecommandexecute",(function(r){var a=r.commandName;if("MakeGroup"===a)t=D()(n.selector.selections);else if("Ungroup"===a){var i=new by,o=!1;n.selector.selections.forEach((function(t){t.swimlane&&(i.map.set(t.model.id,t.swimlane),o=!0)})),o&&(e.weakMap.set(r.command,i),e.unGroupForward(i))}})),this.bind(n,"aftercommandexecute",(function(r){if(t&&"MakeGroup"===r.commandName){var a=new by,i=a.map,o=!1,c=!1;if(t.some((function(t){return t.swimlane}))&&(o=!0),t.forEach((function(t){yr(t)&&(c=!0),i.set(t.model.id,t.swimlane)})),o&&!c){t.forEach((function(t){n.swimlane.unbind(t,t.swimlane)}));var l=t[0].parent;if(l){a.groupID=l.model.id;var s=n.swimlane.findSwimlane([l]);s&&(n.swimlane.bind(l,s),a.swimlaneID=s.model.id)}t=void 0,e.weakMap.set(r.command,a)}}})),this.bind(n,"aftercommandbackward",(function(t){var r=t.command,a=e.weakMap.get(r);if(a)if("MakeGroup"===r.commandName){n.swimlane.unbind(a.groupID,a.swimlaneID);var i,o=yy(a.map.entries());try{for(o.s();!(i=o.n()).done;){var c=b()(i.value,2),l=c[0],s=c[1];n.swimlane.bind(l,s)}}catch(t){o.e(t)}finally{o.f()}}else if("Ungroup"===r.commandName){var u,d=yy(a.map);try{var h=function(){var t=b()(u.value,2),e=t[0],r=t[1],a=n.find(e),i=n.find(r);a&&i&&(n.swimlane.bind(a,i),a.children.forEach((function(t){n.swimlane.unbind(t,i)})))};for(d.s();!(u=d.n()).done;)h()}catch(t){d.e(t)}finally{d.f()}}})),this.bind(n,"aftercommandforward",(function(t){var r=t.command;if("MakeGroup"===r.commandName){var a=e.weakMap.get(r);if(a){var i=n.find(a.groupID);if(i){var o,c=yy(a.map);try{for(c.s();!(o=c.n()).done;){var l=b()(o.value,1)[0];n.swimlane.unbind(l)}}catch(t){c.e(t)}finally{c.f()}var s=n.swimlane.findSwimlane([i]);s&&n.swimlane.bind(i,s)}}}})),this.bind(n,"beforecommandforward",(function(t){var n=t.command,r=e.weakMap.get(n);r&&"Ungroup"===n.commandName&&e.unGroupForward(r)}))}},{key:"unGroupForward",value:function(t){var e,n=this.diagram,r=yy(t.map);try{var a=function(){var t=b()(e.value,2),r=t[0],a=t[1],i=n.find(r),o=n.find(a);i&&o&&(n.swimlane.unbind(i,o),i.children.forEach((function(t){n.swimlane.isCellsInSwimlane([t],o)&&n.swimlane.bind(t,o)})))};for(r.s();!(e=r.n()).done;)a()}catch(t){r.e(t)}finally{r.f()}}}]),n}(),function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"weakMap",new WeakMap),c()(E()(t),"DeleteNames",["Delete"]),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this.initEvent()}},{key:"getRecords",value:function(t){return this.weakMap.get(t)}},{key:"check",value:function(t){var e=this.getRecords(t);if(e&&this.DeleteNames.includes(t.commandName))return e}},{key:"initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"beforecommandexecute",(function(n){var r=n.commandName,a=n.command;if(t.DeleteNames.includes(r)){var o=a.cells||e.selector.selections,l=o.map((function(t){return e.find(t)}));if(l.some((function(t){return gr(t)}))){var s=new Set,u=new Map;l.forEach((function(t){if(yr(t))s.add(t.model.id);else if(gr(t)){var e,n=t.parent.model.id,r=t.model.id;u.has(n)?null===(e=u.get(n))||void 0===e||e.add(r):u.set(n,new Set([r]))}}));var d={unbindIDs:new Map,newModels:new Map,originModels:new Map};t.weakMap.set(a,d);var h,f=xy(u);try{var p=function(){var t=b()(h.value,2),n=t[0],r=t[1];if(s.has(n))return sn.apply(void 0,[o].concat(D()(ke()(Array,D()(r))))),"continue";var a=e.find(n);if(!a)return{v:void 0};if(r.size===a.children.length)sn.apply(void 0,[o].concat(D()(ke()(Array,D()(r))))),o.push(n);else{var i,l,u="height";a.isVertical&&(u="width");var f=0,p=[],m=[];a.children.forEach((function(t){r.has(t.model.id)||(f+=t[u],p.push(t[u]))})),p.reduce((function(t,e,n){return n>=p.length-1?t:(m.push((t+e)/f),t+e)}),0),d.originModels.set(a.model.id,(c()(i={},u,a[u]),c()(i,"".concat(u,"s"),a["".concat(u,"s")]),i)),d.newModels.set(a.model.id,(c()(l={},u,f),c()(l,"".concat(u,"s"),m),l)),a["".concat(u,"s")]=m,a[u]=f,d.unbindIDs.set(a.model.id,e.swimlane.updateContain(a))}};for(f.s();!(h=f.n()).done;){var m=p();if("continue"!==m&&"object"===i()(m))return m.v}}catch(t){f.e(t)}finally{f.f()}a.cells=o}}}));var n=function(e){var n,r=t.diagram,a=[],i=[],o=xy(e.newModels);try{var c=function(){var t,o=b()(n.value,2),c=o[0],l=o[1];if(a.push(c),i.push(l),!r.find(c))return"continue";null===(t=e.unbindIDs.get(c))||void 0===t||t.forEach((function(t){r.swimlane.unbind(t,c)}))};for(o.s();!(n=o.n()).done;)c()}catch(t){o.e(t)}finally{o.f()}a.length>0&&(r.update(a,i),r.swimlane.resetNth(a))};this.bind(e,"aftercommandexecute",(function(e){var r=e.command;if(t.check(r)){var a=t.getRecords(r);a&&n(a)}})),this.bind(e,"aftercommandforward",(function(e){var r=e.command;if(t.check(r)){var a=t.getRecords(r);a&&n(a)}})),this.bind(e,"beforecommandbackward",(function(e){var n=e.command,r=t.weakMap.get(n);if(r&&t.DeleteNames.includes(n.commandName)){var a,i=t.diagram,o=[],c=[],l=xy(r.originModels);try{var s=function(){var t,e=b()(a.value,2),n=e[0],l=e[1],s=i.find(n);if(!s)return"continue";null===(t=r.unbindIDs.get(n))||void 0===t||t.forEach((function(t){i.swimlane.bind(t,n)})),Object.assign(s,l),o.push(n),c.push(l)};for(l.s();!(a=l.n()).done;)s()}catch(t){l.e(t)}finally{l.f()}}})),this.bind(e,"aftercommandbackward",(function(n){var r=n.command,a=t.weakMap.get(r);if(a&&t.DeleteNames.includes(r.commandName)){var i,o=[],c=[],l=xy(a.originModels);try{for(l.s();!(i=l.n()).done;){var s=b()(i.value,2),u=s[0],d=s[1];e.find(u)&&(o.push(u),c.push(d))}}catch(t){l.e(t)}finally{l.f()}o.length>0&&(e.update(o,c),e.swimlane.resetNth(o))}}))}}]),n}()]},{mode:"read",Behaviours:[]}],Commands:[oy,ty,ey,ay,iy]};function Cy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ay(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Oy=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"elements",[]),t}return y()(n,[{key:"render",value:function(){this.group=new na,this.cell.clipGroup.add(this.group)}},{key:"init",value:function(){var t=this,e=this.cell;switch(this.elements=[],this.group.clear(),this.cell.shape){case"pyramid":e.info.forEach((function(n,r){if(r!==e.info.length-1)for(var a=1;a<=n;a++)t.createElement()}));break;case"segmented pyramid":for(var n=2;n<=e.otherInfo.rows;n++)for(var r=1;r<n;r++)this.createElement({fill:"transparent"});break;case"stage":e.info.forEach((function(e,n){t.createElement({fill:"transparent"})}));break;case"architecture":for(var a=e.info.reduce((function(t,e){return t+e}),0),i=0;i<a;i++)this.createElement({fill:"transparent"})}}},{key:"createElement",value:function(){var t=mu(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},this.cell.getRoughGraphicOptions());this.group.add(t),this.elements.push(t)}},{key:"update",value:function(){this.cell.isCacheStale("htmls")&&this.init()}},{key:"draw",value:function(){var t=this,e=this.cell;if(e.isCacheStale("stroke","width","height","htmls","roughFillStyle")){this.init();var n=Ay(Ay({},e.convertStrokeStyle()),{},{stroke:e.stroke.color,"stroke-width":e.stroke.width,d:""});if("architecture"!==e.shape)if("segmented pyramid"!==e.shape){var r=0,a=e.info.length;e.info.forEach((function(i,o){if("pyramid"===e.shape){if(o===a-1)return;for(var c=1;c<=i;c++)if(1===c){var l=(o+1)/a,s=(1-(o+1)/a)*(e.width/2),u=e.width-s,d=l*e.height;n.d="M".concat(s,",").concat(d," L").concat(u,",").concat(d),t.elements[r++].update(n)}}else if("stage"===e.shape){var h=o/a,f=e.width*h;n.d="M".concat(f-25,",",0," L").concat(f,",").concat(e.height/2," L").concat(f-25,",").concat(e.height),t.elements[r++].update(n)}}))}else for(var i=e.otherInfo.rows,o=0,c=2;c<=e.otherInfo.rows;c++)for(var l=(c-1)/i,s=1-l,u=l*e.height,d=s*(e.width/2),h=e.width-d,f=c/i,p=1-f,m=f*e.height,v=p*(e.width/2),y=c-1,g=(h-d)/y,b=(e.width-v-v)/(y+1),x=0;x<y;x++){var k=this.elements[o++],w=d+x*g,C=w+g,A=v+(x+1)*b;n.d="M".concat(w,",").concat(u," L").concat(C,",").concat(u," L").concat(A,",").concat(m," Z"),k.update(n)}else{var O=0,E=e.info.length,P=(e.height-10*(E+1))/E;e.info.forEach((function(r,a){for(var i=r,o=(e.width-10*(i+1))/i,c=0;c<r;c++){var l=10+(o+10)*c,s=10+(P+10)*a;n.d=Ji(o,P,4,l,s),t.elements[O++].update(n)}}))}}}}]),n}();function Ey(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Py=function(t){S()(n,Fs);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"group",void 0),c()(E()(t),"shapeElement",void 0),t}return y()(n,[{key:"render",value:function(){var t=this.cell,e=new na;this.group=e,t.backGroup.add(e)}},{key:"update",value:function(){var t=this.cell,e=this.group,n=t.createOutlineShapeElement();n&&(e.clear(),e.add(n),this.shapeElement=n)}},{key:"draw",value:function(){var t=this.cell,e=this.shapeElement,n=t.stroke,r=t.fill;if(n){var a={},i=t.getOutlinePath(e);i&&(a.d=i),t.isCacheStale("stroke","roughFillStyle")&&Object.assign(a,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ey(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({stroke:"none"},t.convertStrokeStyle())),a.fill=r.color,e.update(a)}}}]),n}();function Sy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var My=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"isDsl",!0),c()(E()(t),"stencils",void 0),c()(E()(t),"stencil",void 0),c()(E()(t),"info",void 0),c()(E()(t),"clipGroup",new na),c()(E()(t),"clipPathID",Object(F.a)()),c()(E()(t),"backGroup",new na),c()(E()(t),"group",new na),c()(E()(t),"children",void 0),c()(E()(t),"shape",void 0),t}return y()(n,[{key:"init",value:function(t){var e=this;_()(L()(n.prototype),"init",this).call(this,t),this.clipGroup.update({"clip-path":"url(#".concat(this.clipPathID,")")}),this.graphicGroup.prepend(this.clipGroup),"architecture"===t.model.shape&&(this.graphicGroup.prepend(this.backGroup),this.Subcells.push(Py)),this.subcells=this.Subcells.map((function(t){return new t(e)})),this.subcells.forEach((function(t){return t.render()})),this.updateModel(this.model)}},{key:"getOutlinePath",value:function(t){var e,n=this.width,r=this.height,a=this.stencil;if(a.outline.path)e=a.outline.path(n,r);else{var i=n/a.width,o=r/a.height;e=t.getPath(i,o)}return e}},{key:"canUpdateText",value:function(){return!0}},{key:"canRotate",value:function(){return!1}},{key:"canRough",value:function(){return!0}},{key:"getCanTextCell",value:function(){return this.children}},{key:"createOutlineShapeElement",value:function(){if(this.isCacheStale("shape","roughFillStyle")){var t=this.stencil,e=this.getRoughGraphicOptions();return mu(t.outline,e)}}},{key:"canConnect",value:function(){return!1}},{key:"canText",value:function(){return!1}},{key:"getKeyShape",value:function(){var t;return null===(t=this.subcells.find((function(t){return t instanceof xu})))||void 0===t?void 0:t.shapeElement}},{key:"updateModel",value:function(t){_()(L()(n.prototype),"updateModel",this).call(this,t),this.afterUpdateModel()}},{key:"afterUpdateModel",value:function(){this.updateStencil(),this.parse(),this.updateMatrix(),this.subcells.forEach((function(t){return t.update()}))}},{key:"parse",value:function(){var t,e,n=null===(t=(e=this.stencil).parse)||void 0===t?void 0:t.call(e,this.htmls);this.info=null==n?void 0:n.info,this.otherInfo=null==n?void 0:n.otherInfo}},{key:"updateDefaultSize",value:function(){var t=this,e=this.stencil;e&&["width","height"].forEach((function(n){null==t[n]&&(t[n]=e[n])}))}},{key:"updateStencil",value:function(){var t=this.shape,e=this.stencils,n=t||"pyramid";if(!this.stencil||this.stencil.name!==n){var r,a,i,o=e.find((function(t){return t.name===n}));if(!o)throw new Error("unknown shape ".concat(n));this.stencil=o,this.updateDefaultSize(),this.htmls=null!==(r=this.htmls)&&void 0!==r?r:o.htmls,this.model.width=null!==(a=this.model.width)&&void 0!==a?a:o.width,this.model.height=null!==(i=this.model.height)&&void 0!==i?i:o.height,this.cache={}}}},{key:"drawPosition",value:function(){if(this.isCacheStale("matrix")){var t=this.graphicGroup,e=this.matrix;t.update({matrix:e})}}},{key:"enter",value:function(){this.capture(!1),this.children.forEach((function(t){return t.capture(!0)}))}},{key:"exit",value:function(){this.capture(!0),this.children.forEach((function(t){return t.capture(!1)}))}},{key:"layoutZIndex",value:function(){var t,e=this,n=this.diagram,r=n.rootGroup;n.contentEditor.isBegin||this.children.forEach((function(t){r.insertBefore(t.graphicGroup,e.graphicGroup)})),"architecture"===this.shape&&(this.backGroup.update({matrix:this.matrix}),r.insertBefore(this.backGroup,null!==(t=this.children[0].graphicGroup)&&void 0!==t?t:this.graphicGroup))}},{key:"executeLayout",value:function(){var t=this;if(0!==this.children.length){this.layoutZIndex();var e=this.info,n=0,r=e.length;if("architecture"===this.shape){var a=this.info.length,i=(this.height-10*(a+1))/a;this.info.forEach((function(e,r){for(var a=e,o=(t.width-10*(a+1))/a,c=0;c<e;c++){var l=10+(o+10)*c,s=10+(i+10)*r,u=t.children[n++];if(!u)return;u.offsetX=l,u.offsetY=s,u.width=o,u.height=i,u.matrix=t.matrix,u.opacity=t.opacity,u.textWidth=u.width,u.textHeight=u.height,u.x=u.offsetX,u.y=u.offsetY,u.textarea.update()}}))}if("segmented pyramid"!==this.shape)e.forEach((function(e,a){if("pyramid"===t.shape)for(var i=r,o=(a+1)/i,c=t.width*o,l=t.height/i,s=(t.width-c)/2,u=a/i*t.height,d=c/e,h=0;h<e;h++){var f=t.children[n++];f.offsetX=s+d*h,f.offsetY=u,f.width=d,f.height=l,f.matrix=t.matrix,f.opacity=t.opacity,f.textWidth=f.width,f.textHeight=f.height,f.x=f.offsetX,f.y=f.offsetY,f.textarea.update()}else if("stage"===t.shape){var p=t.children[n++],m=t.width/r,v=a/r;p.offsetX=v*t.width,p.offsetY=0,p.width=m,p.height=t.height,p.matrix=t.matrix,p.opacity=t.opacity,p.textWidth=p.width,p.textHeight=p.height,p.x=p.offsetX,p.y=p.offsetY,p.textarea.update()}}));else for(var o=this.height/this.otherInfo.rows,c=this.width/this.otherInfo.rows,l=1;l<=this.otherInfo.rows;l++)for(var s=(1-l/this.otherInfo.rows)*(this.width/2),u=(l-1)*o,d=c/2,h=1;h<=2*l-1;h++){var f=this.children[n++];if(!f)return;f.offsetX=s+(h-1)*d,f.offsetY=u,f.width=c,f.height=o,f.matrix=this.matrix,f.opacity=this.opacity,f.textWidth=f.width,f.textHeight=f.height,f.x=f.offsetX,f.y=f.offsetY,f.textarea.update()}}}},{key:"draw",value:function(){this.isCacheStale("roughFillStyle")&&this.deepEachWithoutSelf((function(t){t.draw()})),this.drawOpacity(),this.drawPosition(),this.subcells.forEach((function(t){return t.draw()})),this.updateCache()}},{key:"drawOpacity",value:function(){var t=this;this.isCacheStale("opacity")&&(this.graphicGroup.attr({opacity:this.opacity}),this.children.forEach((function(e){e.drawOpacity(t.opacity)})))}},{key:"updateCache",value:function(){var t=this,e=this.cache;["matrix","shape","htmls","stroke","roughFillStyle","width","height","opacity","fill"].forEach((function(n){var r=t[n];e[n]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Sy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"destroy",value:function(){var t;null===(t=this.backGroup)||void 0===t||t.destroy(),_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{stencils:sc,stroke:{color:"#595959",width:2},fill:{color:"#fff"},rotate:0,children:[],penetratedKeys:["shape","htmls","stroke","opacity","x","y","width","height","rotate","fill"],resizeRotatePoints:["tl","tr","bl","br","tc","bc","lc","rc"],Subcells:[xu,Oy,Hs]})}}]),n}();function jy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}c()(My,"className","DslStem");var Ry=function(t){S()(n,Ys);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;return m()(this,n),r=e.call(this,t),c()(E()(r),"isDslCell",!0),c()(E()(r),"textVerticalAlign",void 0),c()(E()(r),"offsetX",0),c()(E()(r),"offsetY",0),c()(E()(r),"textWidth",0),c()(E()(r),"textHeight",0),c()(E()(r),"textRegion",void 0),c()(E()(r),"textarea",void 0),c()(E()(r),"parent",void 0),r}return y()(n,[{key:"init",value:function(t){_()(L()(n.prototype),"init",this).call(this,t),this.graphicGroup.update({"clip-path":"url(#".concat(this.parent.clipPathID,")")}),this.textarea=new tu(this),this.render(),this.updateModel(this.model),this.parent.children.splice(this.nth,0,this)}},{key:"getBBox",value:function(){var t=this.offsetY,e=this.height,n=this.width,r=this.offsetX,a=this.parent.getBBox();return a.height=e,a.width=n,a.x+=r,a.minX=a.x,a.maxX=a.minX+a.width,a.y+=t,a.minY=a.y,a.maxY=a.minY+a.height,a}},{key:"canRotate",value:function(){return!1}},{key:"canUpdateText",value:function(){return!0}},{key:"canText",value:function(){return!1}},{key:"contanerBBox",get:function(){return this.parent.containerBBoxs[this.nth]}},{key:"createTextRegion",value:function(){if(!this.textRegion||this.parent.isCacheStale("roughFillStyle")){var t=this.parent,e=mu({name:"path",x:0,y:0,width:1,height:1,stroke:"none"},null==t?void 0:t.getRoughGraphicOptions());this.cache.fill=null,this.textRegion&&this.textRegion.remove(),this.textRegion=e,this.graphicGroup.prepend(e)}}},{key:"render",value:function(){this.createTextRegion(),this.textarea.render(),this.capture(!1)}},{key:"getKeyShape",value:function(){return this.textRegion}},{key:"updateModel",value:function(t){_()(L()(n.prototype),"updateModel",this).call(this,t),this.textarea.update()}},{key:"canConnect",value:function(){return!1}},{key:"getTextareaPosition",value:function(t){var e=this.textVerticalAlign,n={x:Math.max((this.textWidth-t.width)/2,4)+this.offsetX,y:0};if(n.y="top"===e?4:"bottom"===e?this.textHeight-t.height:(this.textHeight-t.height)/2,"pyramid"===this.parent.shape)0===this.nth&&(n.y+=this.textHeight/6);else if("segmented pyramid"===this.parent.shape){var r=Math.ceil(Math.sqrt(this.nth+1)),a=r*r-(2*r-1)+1;(this.nth+1-a)%2==0?n.y+=this.textHeight/6:n.y-=this.textHeight/6}else"stage"===this.parent.shape&&0!==this.nth&&(n.x-=12.5);return n.y+=this.offsetY,n}},{key:"getPadding",value:function(){return[4,4,4,4]}},{key:"getOuterWidth",value:function(){return this.width}},{key:"getTextBox",value:function(){var t=this.x,e=this.y,n=this.textWidth,r=this.textHeight;return{x:t,y:e,width:n,height:r,minX:t,minY:e,maxX:t+n,maxY:e+r}}},{key:"drawTextRegion",value:function(){var t=this.width,e=this.textHeight,n=this.textWidth,r=this.offsetX,a=this.offsetY,i="";switch(this.parent.shape){case"pyramid":i=Jn(r,a,n,e);break;case"segmented pyramid":var o=Math.ceil(Math.sqrt(this.nth+1)),c=o*o-(2*o-1)+1;i=Yn((this.nth+1-c)%2==0?[["M",this.offsetX+this.width/2,this.y],["L",this.offsetX+this.width,this.y+this.height],["L",this.offsetX,this.y+this.height],["Z"]]:[["M",this.offsetX,this.y],["L",this.offsetX+this.width,this.y],["L",this.offsetX+this.width/2,this.y+this.height],["Z"]]);break;case"stage":var l=r-25;i=Yn([["M",l,0],["L",l+n,0],["L",r+n,e/2],["L",l+n,e],["L",l,e],["L",r,e/2],["Z"]]);break;case"architecture":i=Yn(Ji(this.width,this.height,4,this.x,this.y));break;default:i=""}var s={width:t,height:e,d:i};this.textRegion.update(s)}},{key:"updateCache",value:function(t){var e=this,n=this.cache;(t=t||["html","width","offsetX","offsetY","height","textWidth","textHeight","textVerticalAlign"]).forEach((function(t){var r=e[t];n[t]=d()(r)?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r):r}))}},{key:"drawMatrix",value:function(){this.isCacheStale("matrix")&&this.graphicGroup.update({matrix:this.matrix})}},{key:"drawOpacity",value:function(t){this.isCacheStale("opacity")&&(t=t||this.opacity,this.graphicGroup.attr({opacity:t}),this.updateCache(["opacity"]))}},{key:"drawFill",value:function(){this.isCacheStale("fill")&&(0===this.nth&&(this.parent.fill=this.fill),this.textRegion.update({fill:this.fill.color}))}},{key:"drawPosition",value:function(){this.drawMatrix(),(this.isCacheStale("textWidth","textHeight","offsetY","offsetX","html","textVerticalAlign")||this.parent.isCacheStale("roughFillStyle"))&&(this.drawTextRegion(),this.textarea.draw()),this.updateCache()}},{key:"draw",value:function(){this.createTextRegion(),this.drawPosition(),this.drawOpacity(),this.drawFill(),this.updateCache()}},{key:"destroy",value:function(){sn(this.parent.children,this),_()(L()(n.prototype),"destroy",this).call(this)}}],[{key:"getDefaultProps",value:function(){return Vi(_()(L()(n),"getDefaultProps",this).call(this),{textareaContentStyleSheets:[{query:"self",css:{outline:"none","white-space":"normal","letter-spacing":"normal","font-size":"14px","min-height":"24px","min-width":"24px","line-height":"1.74","word-break":"break-word","font-feature-settings":'"tnum"',"font-variant":"tabular-nums","text-align":"center",margin:0}}],multiSelectHighlight:!1,textVerticalAlign:"center",penetratedKeys:["html","id","nth","fill","textVerticalAlign"],resizeRotatePoints:[],width:0,height:0,fill:{color:"#fff"},matrix:[1,0,0,0,1,0,0,0,1]})}}]),n}();c()(Ry,"className","DslCell");var Ly=function(t){S()(n,hc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.model,e=this.diagram,r=this.models;t.id=t.id||Object(F.a)(),r.forEach((function(t,e){var n=Object(F.a)();t.id=n,t.nth=e})),t.children=r,e.hooks.decorateAddDslModel.call(t),_()(L()(n.prototype),"execute",this).call(this)}}]),n}();c()(Ly,"className","AddDsl");var By=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"queue",!1),t}return y()(n,[{key:"execute",value:function(){this.queue=!1;var t=this.diagram,e=t.selector.selections[0];e=hr(e)?e.parent:e,t.emit("opendsleditor",{cell:e}),[e].concat(D()(e.getChildren())).forEach((function(t){return t.hide()})),t.vertexRotateResize.hide()}}]),n}();function Dy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ny(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}c()(By,"className","OpenDslEditNote"),c()(By,"isModelChange",!1),c()(By,"enable",(function(t){var e=t.selector.selections;return 1===e.length&&e.every((function(t){return dr(t)||hr(t)}))}));var _y=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"oldHtmls",void 0),c()(E()(t),"oldIds",void 0),c()(E()(t),"newIds",[]),c()(E()(t),"newHtmls",void 0),c()(E()(t),"dslId",void 0),t}return y()(n,[{key:"execute",value:function(){var t=this.dsl,e=this.htmls;this.dslId=t.model.id,this.oldHtmls=t.htmls,this.oldIds=t.children.map((function(t){return t.model.id})),this.newHtmls=e,this.forward()}},{key:"forward",value:function(){this.updateHtml(this.newHtmls,0===this.newIds.length?void 0:this.newIds)}},{key:"backward",value:function(){this.updateHtml(this.oldHtmls,this.oldIds)}},{key:"updateHtml",value:function(t,e){var n,r,a=this;e||(this.newIds=[]);var i=this.diagram,o=i.find(this.dslId),c=null===(n=(r=o.stencil).parse)||void 0===n?void 0:n.call(r,t),l=o.children.map((function(t){return[t.fill,t.textVerticalAlign]})),s=l[l.length-1][0],u=l[l.length-1][1];i.remove(o.model.children.map((function(t){return t.id})));var d=null==c?void 0:c.models.map((function(t,n){var r;return e?r=e[n]:(r=Object(F.a)(),a.newIds.push(r)),Ny(Ny({},t),{},{id:r,nth:n,fill:n<l.length?l[n][0]:s,textVerticalAlign:n<l.length?l[n][1]:u})})),h=d.map((function(t,e){return{parent:o.model.id,nth:e}}));i.update(o,{htmls:t}),i.hooks.decorateAddDslChildModel.call(d[0]),i.add(d,h)}}]),n}();c()(_y,"className","UpdateDslHtml");var Iy={Cells:[My,Ry],Extends:[],Commands:[Ly,By,_y],modes:[{mode:"edit",Behaviours:[function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"dsl",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this,e=this.diagram;this.bind(e,"dblclick",(function(n){var r=e.viewport.invertClient([n.clientX,n.clientY]),a=e.getCell(n.target);if(a&&dr(a)){var i,o=a;t.dsl=o,o.children.forEach((function(t){t.isPointInShape({x:r[0],y:r[1]})&&(i=t)})),o.enter(),i&&e.selector.select(i)}})),this.bind(e,"afterselect",(function(e){var n=e.selections;t.dsl&&n.findIndex((function(e){return e===t.dsl||e.parent===t.dsl}))<0&&t.dsl.exit()}))}}]),n}(),function(t){S()(n,Kl);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){var t;m()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a)),c()(E()(t),"diagram",void 0),c()(E()(t),"dsl",void 0),t}return y()(n,[{key:"init",value:function(t){this.diagram=t,this._initEvent()}},{key:"_initEvent",value:function(){var t=this.diagram,e=function(t){return"ContentCommand"===(null==t?void 0:t.commandName)&&t.id.every((function(t){return hr(t)}))},n=function(e,n){var r=e[0].parent;if("architecture"===r.shape){var a=[];r.htmls.forEach((function(t){a.push.apply(a,D()(t))})),e.forEach((function(t,e){a[t.nth]=n[e]}));var i=[],o=0;return r.info.forEach((function(t){for(var e=[],n=0;n<t;n++)e.push(a[o++]);i.push(e)})),void t.update(r,{htmls:i})}var c=r.htmls;e.forEach((function(t,e){c[t.nth]=n[e]})),t.update(r,{htmls:c})};this.bind(t,"aftercommandexecute",(function(t){var r=t.command;e(r)&&n(r.id,r.endHTML)})),this.bind(t,"aftercommandforward",(function(t){var r=t.command;e(r)&&n(r.id,r.endHTML)})),this.bind(t,"aftercommandbackward",(function(t){var r=t.command;e(r)&&n(r.id,r.startHTML)}))}}]),n}()]}]},Ty={roughFillStyle:"hachure",defaultContentStyle:{"font-family":"shouxie"}},Fy={default:{roughFillStyle:null},hachure:{roughFillStyle:"hachure"},"cross-hatch":{roughFillStyle:"cross-hatch"},solid:{roughFillStyle:"solid"}};function zy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qy(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Yy(t){return Object.values(t).every((function(t){return null===t}))?{roughFillStyle:null,defaultContentStyle:{"font-family":null}}:qy(qy({},Ty),t)}function Hy(t,e,n){Xo(t,"roughFillStyle",Yy(e).roughFillStyle,n)}function Gy(t,e,n){var r=Yy(e);(Uo(t)||$o(t)||Ko(t)||Qo(t)||Zo(t))&&(Xo(t,"roughFillStyle",r.roughFillStyle,n),Xo(t,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n))}function Xy(t,e,n){var r=Yy(e);Xo(t,"roughFillStyle",r.roughFillStyle,n),Xo(t,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function Wy(t,e,n){var r=Yy(e);Xo(t,"roughFillStyle",r.roughFillStyle,n),Xo(t,"defaultContentStyle.font-family",r.defaultContentStyle["font-family"],n)}function Vy(t,e,n){t.forEach((function(t){Ve(t,(function(t){Uo(t)||$o(t)||Ko(t)||Qo(t)||Zo(t)?Gy(t,e,n):function(t){return!!t.type&&"pen"===t.type}(t)?Hy(t,e,n):Wo(t)?Xy(t,e,n):function(t){return!!t.type&&"mindmap"===t.type}(t)&&Wy(t,e,n)}))}))}function Zy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Uy=function(){function t(e){m()(this,t),c()(this,"diagram",void 0),c()(this,"name","default"),c()(this,"destroyed",!1),this.diagram=e,this.bindEvent(),this.tabHook()}return y()(t,[{key:"tabHook",value:function(){var t=this,e=this.diagram.hooks;e.forceDecorateImportModels.tap("rough",(function(e){Vy(e,Fy[t.name],!0)})),e.decorateImportModels.tap("rough",(function(e){Vy(e,Fy[t.name])})),e.decorateAddPenModel.tap("rough",(function(e){Hy(e,Fy[t.name])})),e.decorateAddVertexModel.tap("rough",(function(e){Gy(e,Fy[t.name])})),e.decorateAddLineModel.tap("rough",(function(e){Xy(e,Fy[t.name])})),e.decorateAddMindmapStemModel.tap("rough",(function(e){Wy(e,Fy[t.name])}))}},{key:"bindEvent",value:function(){var t=this,e=this.diagram;e.on("beforeimport",(function(){var n,r=e.head,a=(null==r||null===(n=r.rough)||void 0===n?void 0:n.name)||"default";a&&t.setRough(a)})),e.on("beforeexporter",(function(){e.head.rough={name:t.name}}))}},{key:"setRough",value:function(t){var e=Fy[t];if(e){var n=this.diagram.getCells().filter((function(t){return t.isStem&&(null==t?void 0:t.canRough())})).map((function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zy(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:t.model.id},Yy(e))}));return this.name=t,n}}},{key:"destroy",value:function(){this.destroyed=!0}}]),t}();c()(Uy,"className","Rough");var Ky=function(t){S()(n,dc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram.theme;this.originColor=t.values.canvasBackgroundColor,this.forward()}},{key:"forward",value:function(){var t=this.diagram,e=this.color;t.theme.setTheme({canvasBackgroundColor:e})}},{key:"backward",value:function(){var t=this.diagram,e=this.originColor;t.theme.setTheme({canvasBackgroundColor:e})}}],[{key:"enable",value:function(){return!0}}]),n}();c()(Ky,"className","SetCanvasBackgroundColor");var Qy=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.name,r=t.rough,a=r.name,i=r.setRough(e),o=r.name;i&&(this.id=i.map((function(t){return t.id})),this.model=i,this.beforeName=a,this.afterName=o,this.autoSelect=!1,_()(L()(n.prototype),"execute",this).call(this))}},{key:"forward",value:function(){var t=this.diagram,e=this.afterName,r=t.rough;e&&r.setRough(e),_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var t=this.diagram,e=this.beforeName,r=t.rough;e&&r.setRough(e),_()(L()(n.prototype),"backward",this).call(this)}}]),n}();c()(Qy,"className","SetRough");var $y=function(t){S()(n,fc);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"execute",value:function(){var t=this.diagram,e=this.name,r=t.theme,a=s()(r.values),i=r.setTheme(e),o=s()(r.values);i&&(this.id=i.map((function(t){return t.id})),this.model=i,this.beforeValues=a,this.afterValues=o,this.autoSelect=!1,_()(L()(n.prototype),"execute",this).call(this),t.emit("afterThemeChange",e))}},{key:"forward",value:function(){var t=this.diagram,e=this.afterValues,r=t.theme;e&&(r.setTheme(e),t.emit("afterThemeChange",e.themeName)),_()(L()(n.prototype),"forward",this).call(this)}},{key:"backward",value:function(){var t=this.diagram,e=this.beforeValues,r=t.theme;e&&(r.setTheme(e),t.emit("afterThemeChange",e.themeName)),_()(L()(n.prototype),"backward",this).call(this)}}],[{key:"enable",value:function(){return!0}}]),n}();function Jy(t,e){var n,r=e.stackFill,a=e.stackStroke,i=e.fontColor;Xo(t,"fill.color",r),Xo(t,"stroke.color",a),null===(n=t.children)||void 0===n||n.forEach((function(t){Xo(t,"defaultContentStyle.color",i)}))}function tg(t,e){var n=e.swimlaneHeadFill,r=e.fontColor;Xo(t,"fill.color",n),Xo(t,"defaultContentStyle.color",r)}function eg(t,e){var n,r=e.swimlaneStroke;null===(n=t.children)||void 0===n||n.forEach((function(t){tg(t,e)})),Xo(t,"stroke.color",r)}function ng(t,e){var n,r=e.dslStroke,a=e.dslFill;null===(n=t.children)||void 0===n||n.forEach((function(t){tg(t,e)})),Xo(t,"fill.color",a),Xo(t,"stroke.color",r)}c()($y,"className","SetTheme");var rg=["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],ag=["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],ig=["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],og=["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],cg=["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],lg=["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],sg={default:{themeName:"default",swatches:fg(rg),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#585A5A",lineStroke:"#585A5A",mindmapRainbowTreeEdgeColors:rg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#585A5A",dslStroke:"#585A5A",dslFill:"#FFFFFF",stackFill:"#FFFFFF",stackStroke:"#585A5A",specialUMLFill:"#FFFFFF",specialUMLStroke:"#585A5A",drawColor:"#585A5A"},dark:{themeName:"dark",swatches:fg(ag),canvasBackgroundColor:"#141414",fontColor:"#EFF0F0",geometryFill:"#141414",geometryStroke:"#BEC0BF",lineStroke:"#BEC0BF",mindmapRainbowTreeEdgeColors:ag,mindmapSingleTreeEdgeStroke:"#848484",mindmapStemFill:"#262626",mindmapStemStroke:"rgb(255, 255, 255, 0)",mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#141414",swimlaneStroke:"#BEC0BF",dslStroke:"#BEC0BF",dslFill:"#141414",stackFill:"#141414",stackStroke:"#BEC0BF",specialUMLFill:"#141414",specialUMLStroke:"#BEC0BF",drawColor:"#BEC0BF"},colorful_kano:{themeName:"colorful_kano",swatches:fg(ig),canvasBackgroundColor:"#FFFFFF",fontColor:"#262626",geometryFill:"#FFFFFF",geometryStroke:"#00AEBF",lineStroke:"#00AEBF",mindmapRainbowTreeEdgeColors:ig,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#EFF0F0",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#FFFFFF",swimlaneStroke:"#00AEBF",stackFill:"#FFFFFF",dslStroke:"#00AEBF",dslFill:"#FFFFFF",stackStroke:"#00AEBF",specialUMLFill:"#FFFFFF",specialUMLStroke:"#00AEBF",drawColor:"#00AEBF"},van_cogh_starry_sky:{themeName:"van_cogh_starry_sky",swatches:fg(og.concat(["#0B1822"])),canvasBackgroundColor:"#0B1822",fontColor:"#EFF0F0",geometryFill:"#0B1822",geometryStroke:"#149EC1",lineStroke:"#149EC1",mindmapRainbowTreeEdgeColors:og,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#262626",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#0B1822",swimlaneStroke:"#149EC1",stackFill:"#0B1822",stackStroke:"#149EC1",dslStroke:"#149EC1",dslFill:"#0B1822",specialUMLFill:"#0B1822",specialUMLStroke:"#149EC1",drawColor:"#149EC1"},iris:{themeName:"iris",swatches:fg(cg),canvasBackgroundColor:"#F3F3F6",fontColor:"#262626",geometryFill:"#CFDDE8",geometryStroke:"#88ABC5",lineStroke:"#88ABC5",mindmapRainbowTreeEdgeColors:cg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#CFDDE8",swimlaneStroke:"#88ABC5",dslStroke:"#88ABC5",dslFill:"#CFDDE8",stackFill:"#CFDDE8",stackStroke:"#88ABC5",specialUMLFill:"#CFDDE8",specialUMLStroke:"#88ABC5",drawColor:"#88ABC5"},wuxia_qingqiu:{themeName:"wuxia_qingqiu",swatches:fg(lg),canvasBackgroundColor:"#FBF7EF",fontColor:"#585A5A",geometryFill:"#F7F0D7",geometryStroke:"#D6B235",lineStroke:"#D6B235",mindmapRainbowTreeEdgeColors:lg,mindmapSingleTreeEdgeStroke:"#BFBFBF",mindmapStemFill:"#FFFFFF",mindmapStemStroke:null,mindmapAbstractStroke:"#BEC0BF",swimlaneHeadFill:"#F7F0D7",swimlaneStroke:"#D6B235",dslStroke:"#D6B235",dslFill:"#F7F0D7",stackFill:"#F7F0D7",stackStroke:"#D6B235",specialUMLFill:"#F7F0D7",specialUMLStroke:"#D6B235",drawColor:"#D6B235"}},ug=["finish"],dg=["start","fork"];function hg(t){var e=[];return[[[0,0,0,1],[.4,.8,1]],[[255,255,255,1],[.7,.4,.2]]].forEach((function(n){var r=b()(n,2),a=r[0];r[1].forEach((function(n){var r,i,o,c,l,s,u,d,h,f=new st.a(t).toRgb(),p=(r=f.r,i=f.g,o=f.b,c=n,l=a[0],s=a[1],u=a[2],d=a[3],"rgb(".concat((r*c+l*d*(1-c))/(h=1-(1-c)*(1-d)),", ").concat((i*c+s*d*(1-c))/h,", ").concat((o*c+u*d*(1-c))/h,")"));e.push(p)}))})),e.reverse()}function fg(t){return[{title:"主题配色",palettes:["transparent",{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]}].concat(D()(t.map((function(t){return{standard:t,gradient:hg(t)}}))))},{title:"默认配色",palettes:[{standard:"#FFFFFF",gradient:["#FFFFFF","#FAFAFA","#F4F5F5","#EFF0F0","#E7E9E8"]},{standard:"#FDE6D3",gradient:["#FDE6D3","#F8B881","#F38F39","#ED740C","#C75C00","#663000"]},{standard:"#F9EFCD",gradient:["#F9EFCD","#F5D480","#F3BB2F","#ECAA04","#C99103","#664900"]},{standard:"#D9DFFC",gradient:["#D9DFFC","#96A7FD","#4861E0","#2F4BDA","#213BC0","#101E60"]},{standard:"#FBDFEF",gradient:["#FBDFEF","#F297CC","#E746A4","#D22D8D","#AE146E","#5C0036"]},{standard:"#CEF5F7",gradient:["#CEF5F7","#5ED3D9","#1DC0C9","#01B2BC","#07787E","#004347"]},{standard:"#262626",gradient:["#D8DAD9","#BEC0BF","#8A8F8D","#585A5A","#262626","#000000"]},{standard:"#DF2A3F",gradient:["#FBE4E7","#F1A2AB","#E4495B","#DF2A3F","#AD1A2B","#70000D"]},{standard:"#FBDE28",gradient:["#FBF5CB","#FCE75A","#FBDE28","#EDCE02","#A58F04","#665800"]},{standard:"#117CEE",gradient:["#D9EAFC","#81BBF8","#2F8EF4","#117CEE","#0C68CA","#00346B"]},{standard:"#601BDE",gradient:["#E6DCF9","#BA9BF2","#7E45E8","#601BDE","#4C16B1","#270070"]},{standard:"#74B602",gradient:["#E8F7CF","#C1E77E","#8CCF17","#74B602","#5C8D07","#2A4200"]}]}]}function pg(t){var e,n=null==t||null===(e=t.stencil)||void 0===e?void 0:e.name;return vr(t)&&n&&-1!==dg.indexOf(n)}function mg(t){var e,n=null==t||null===(e=t.stencil)||void 0===e?void 0:e.name;return vr(t)&&n&&-1!==ug.indexOf(n)}function vg(t,e){return t.map((function(t,n){return t+e[n]}))}function yg(t,e){return t instanceof Array?t.map((function(t){return t*e})):t*e}function gg(t){return[parseInt(t.slice(1,3),16),parseInt(t.slice(3,5),16),parseInt(t.slice(5,7),16)]}function bg(t){var e=t.map((function(t){var e=t/255;return 100*(e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)})),n=[(.4124*e[0]+.3576*e[1]+.1805*e[2])/95.047,(.2126*e[0]+.7152*e[1]+.0722*e[2])/100,(.0193*e[0]+.1192*e[1]+.9505*e[2])/108.883].map((function(t){return t>.008856?Math.pow(t,1/3):7.787*t+16/116}));return[116*n[1]-16,500*(n[0]-n[1]),200*(n[1]-n[2])]}function xg(t,e){return t.reduce((function(t,n,r){return t+Math.pow(n-e[r],2)}),0)}function kg(t,e){return Math.pow(Math.abs(Math.atan2(t[0],t[1])-Math.atan2(e[0],e[1])),2)}function wg(t){switch(t){case"lab":return kg;case"hct":return xg;default:throw new Error("Unsupported color space")}}function Cg(t,e){var n;return(n=t<26?5:t<51?4:t<63?3:t<74?2:t<85?1:0)<=2&&"dark"===e&&(n=5-n),n>=4&&"light"===e&&(n=5-n),n}function Ag(t,e,n,r,a){var i=wg(a),o=!1,c=n||100,l=t.length,s=t[0].length,u=[],d=[],h=new Array(l).fill(-1),f=new Array(l).fill(0);if("rand"===r)for(var p,m=0;u.length<e;)-1===h[p=Math.floor(Math.random()*l)]&&(u[m++]=t[p],h[p]=0);for("kspp"===r&&u.push.apply(u,D()(function(t,e,n){var r=[],a=t.length,i=wg(n),o=Math.floor(Math.random()*a);for(r.push(t[o]);r.length<e;){for(var c=[],l=[],s=r.length,u=0,d=0;d<a;d++){for(var h=1/0,f=0;f<s;f++){var p=i(t[d],r[f]);p<=h&&(h=p)}c[d]=h}for(var m=0;m<a;m++)u+=c[m];for(var v=0;v<a;v++)l[v]=c[v]/u;for(var y=Math.random(),g=0,b=-1,x=0;x<a;x++)if((g+=l[x])>=y){b=x;break}r.push(t[b])}return r}(t,e,a)));!o&&c-- >0;){for(var v=void 0,y=void 0,g=void 0,b=0;b<l;b++){v=1/0,y=-1;for(var x=0;x<e;x++)(g=i(t[b],u[x]))<=v&&(v=g,y=x);h[b]=y,f[y]++}for(var k=0;k<e;k++)d[k]=u[k],u[k]=new Array(s).fill(0);for(var w=0;w<l;w++)u[h[w]]=vg(u[h[w]],t[w]);for(var C=0;C<e;C++)u[C]=yg(u[C],1/f[C]);o=!0;for(var A=0;A<e;A++)if(i(d[A],u[A])>1e-4){o=!1;break}for(var O=0;O<e;O++)f[O]=0}return{centroids:u,idxs:h}}function Og(t,e,n,r){if(1===t.length)return 0;var a=function(t,e,n){for(var r=wg(n),a=0,i=0;i<t.length;i++)a+=r(e,t[i]);return a/t.length}(t,n,r),i=function(t,e,n){for(var r=wg(n),a=0,i=0;i<t.length;i++)a+=r(e,t[i]);return a/t.length}(e,n,r);return(i-a)/Math.max(a,i)}function Eg(t,e,n,r){for(var a=0,i=0,o=function(t){for(var e,n=1/0,r=-1,a=[],i=0;i<t.length;i++){for(var o=0;o<t.length;o++)i!==o&&(e=xg(t[i],t[o]))<=n&&(n=e,r=o);a[i]=r}return a}(t),c=0;c<t.length;c++){for(var l=[],s=[],u=0;u<e.length;u++)n[u]===c&&l.push(e[u]),n[u]===o[c]&&s.push(e[u]);for(var d=0;d<l.length;d++)a+=Og(l,s,l[d],r),i++}return a/i}function Pg(t,e,n,r,a,i){for(var o,c,l,s=-1/0,u=-1,d=e;d<=n;d++)c=(o=Ag(t,d,r,a,i)).idxs,(l=Eg(o.centroids,t,c,i))>s&&(s=l,u=d);return u}var Sg=function(){function t(){var e=this;m()(this,t),c()(this,"residualColors",void 0),c()(this,"paletteColors",void 0),c()(this,"colorHues",void 0),c()(this,"residualColorSetting",void 0),c()(this,"paletteColorSetting",void 0),c()(this,"colorHueSetting",void 0);var n={default:{palette:["#A287E1","#6F81DB","#6EC4C4","#DFB85D","#77C386","#E48484","#E482D4","#69B1E4"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#585A5A"]},dark:{palette:["#00B090","#D87C25","#DB699B","#FFC849","#6EC25A","#4C6DC7","#946BB1","#268FAC"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#141414","#BEC0BF"]},colorful_kano:{palette:["#00AEBF","#0086FF","#15CA52","#FF8710","#8958E5","#E53385","#F25D4B","#456FF2"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#FFFFFF","#00AEBF"]},van_cogh_starry_sky:{palette:["#F2CF66","#149EC1","#CF8502","#59985A","#216AC7","#00648F","#2D7E75","#787865"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#0B1822","#149EC1"]},iris:{palette:["#6FC07F","#88ABC5","#C5CD29","#6D89C2","#61B4D1","#E89400","#AB8F61","#8C8C92"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#CFDDE8","#88ABC5"]},wuxia_qingqiu:{palette:["#93AC8F","#D6B235","#439476","#D48344","#C14B41","#9A884F","#CB6743","#6F8E63"],residual:["#D8DAD9","#8A8F8D","#262626","#000000","#F7F0D7","#D6B235"]}};this.residualColorSetting={},this.paletteColorSetting={},this.colorHueSetting={},this.residualColors=Object.entries(n).reduce((function(t,n,r){var a=b()(n,2),i=a[0],o=a[1].residual.map((function(t){return t.toLowerCase()}));return e.residualColorSetting[i]={idx:0===r?0:t.length,len:o.length},t.concat(o)}),[]),this.paletteColors=Object.entries(n).reduce((function(t,n,r){var a=b()(n,2),i=a[0],o=a[1],c=D()(o.palette.reduce((function(t,e){var n=hg(e).map((function(t){return st()(t).toHexString()}));return t.concat.apply(t,D()(n))}),[]));return e.paletteColorSetting[i]={idx:0===r?0:t.length,len:c.length},t.concat(c)}),[]),this.colorHues=Object.entries(n).reduce((function(t,n,r){var a=b()(n,2),i=a[0],o=a[1].palette.map((function(t){return t.toLowerCase()}));return e.colorHueSetting[i]={idx:0===r?0:t.length,len:o.length},t.concat(o)}),[])}return y()(t,[{key:"getResidualColors",value:function(){return this.residualColors}},{key:"getPaletteColors",value:function(){return this.paletteColors}},{key:"getColorHues",value:function(){return this.colorHues}},{key:"isClusterable",value:function(t){var e=t.toLowerCase();return!this.paletteColors.includes(e)&&!this.residualColors.includes(e)}},{key:"isPaletteMapping",value:function(t){return this.paletteColors.includes(t.toLowerCase())}},{key:"indexMapping",value:function(t,e,n){return(t+n)%e}},{key:"adjustLuminanceLevel",value:function(t,e){var n=t;return t<=2&&"dark"===e&&(n=5-t),t>=4&&"light"===e&&(n=5-t),n}},{key:"getResidualColorIndex",value:function(t,e,n){var r=this.residualColorSetting[t].idx,a=this.residualColorSetting[e].idx,i=this.residualColors.indexOf(n);Object.entries(this.residualColorSetting).forEach((function(t){var e=b()(t,2);e[0];var n=e[1];i>=n.idx&&i<n.idx+n.len&&(r=n.idx)}));var o=a>=r?a-r:a+(this.residualColors.length-r);return this.indexMapping(i,this.residualColors.length,o)}},{key:"getPaletteColorIndex",value:function(t,e,n,r){var a=this.paletteColorSetting[t].idx,i=this.paletteColorSetting[e].idx,o=this.paletteColors.indexOf(n);Object.entries(this.paletteColorSetting).forEach((function(t){var e=b()(t,2);e[0];var n=e[1];o>=n.idx&&o<n.idx+n.len&&(a=n.idx)}));var c=i>=a?i-a:i+(this.paletteColors.length-a),l=this.getColorHueIndexByPaletteColorIndex(o),s=this.adjustLuminanceLevel(o%6,r),u=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(l,s);return this.indexMapping(u,this.paletteColors.length,c)}},{key:"getColorHueIndexByPaletteColorIndex",value:function(t){return Math.floor(t/6)}},{key:"getPaletteColorIndexByColorHueIndexAndLuminanceLevel",value:function(t,e){return 6*t+e}},{key:"getMappedColors",value:function(t,e,n,r){var a=this,i={};return n.forEach((function(n){i[n]||(a.isPaletteMapping(n)?i[n]=a.paletteColors[a.getPaletteColorIndex(t,e,n,r)]:i[n]=a.residualColors[a.getResidualColorIndex(t,e,n)])})),i}},{key:"getMappedColorsFromClusteredColors",value:function(t,e){for(var n,r,a,i=Object.values(e).map((function(t){return t[0]})),o={},c=Object.values(e).map((function(t){return t[1]})),l=Object.keys(e),s=this.colorHueSetting[t].idx,u=this.colorHueSetting[t].len,d=0;d<i.length;d++)n=i[d]%u+s,a=c[d],r=this.getPaletteColorIndexByColorHueIndexAndLuminanceLevel(n,a),o[l[d]]=this.paletteColors[r];return o}},{key:"destroy",value:function(){this.colorHues=[],this.paletteColors=[],this.residualColors=[]}}]),t}(),Mg=function(){function t(e){m()(this,t),c()(this,"name","default"),c()(this,"values",s()(sg.default)),c()(this,"themes",sg),c()(this,"palette",new Sg),c()(this,"destroyed",!1),c()(this,"diagram",void 0),this.diagram=e,this.bindEvent(),this.tapHook()}return y()(t,[{key:"tapHook",value:function(){var t=this,e=this.diagram.hooks;e.decorateAddVertexModel.tap("theme",(function(e){Uo(e)?function(t,e){var n=e.geometryFill,r=e.geometryStroke,a=e.fontColor;Xo(t,"fill.color",n),Xo(t,"stroke.color",r),Xo(t,"defaultContentStyle.color",a)}(e,t.values):$o(e)?function(t,e){Xo(t,"defaultContentStyle.color",e.fontColor)}(e,t.values):Ko(e)?Jy(e,t.values):Qo(e)?eg(e,t.values):Zo(e)&&ng(e,t.values)})),e.decorateAddStackModel.tap("theme",(function(e){Jy(e,t.values)})),e.decorateAddMindmapAbstract.tap("theme",(function(e){!function(t,e){var n=e.mindmapAbstractStroke,r=e.fontColor;Xo(t,"treeEdge.stroke",n),Xo(t,"border.stroke",n),Xo(t,"defaultContentStyle.color",r)}(e,t.values)})),e.decorateAddMindmapStemModel.tap("theme",(function(e){!function(t,e){var n=e.mindmapStemFill,r=e.fontColor;Xo(t,"border.fill",n),Xo(t,"defaultContentStyle.color",r)}(e,t.values)})),e.decorateAddMindmapCellModel.tap("theme",(function(e){!function(t,e){Xo(t,"defaultContentStyle.color",e.fontColor)}(e,t.values)})),e.decorateAddLineModel.tap("theme",(function(e){!function(t,e){var n=e.lineStroke,r=e.fontColor;Xo(t,"stroke.color",n),Xo(t,"defaultContentStyle.color",r)}(e,t.values)})),e.decorateAddSwimlaneModel.tap("theme",(function(e){eg(e,t.values)})),e.decorateAddSwimlaneChildModel.tap("theme",(function(e){tg(e,t.values)})),e.decorateNonMindmapCellModels.tap("theme",(function(e,n){t.setNonMindmapCells(e,n)})),e.decorateAddDslModel.tap("theme",(function(e){ng(e,t.values)})),e.decorateAddDslChildModel.tap("theme",(function(e){!function(t,e){var n=e.dslFill,r=e.fontColor;Xo(t,"fill.color",n),Xo(t,"defaultContentStyle.color",r)}(e,t.values)}))}},{key:"bindEvent",value:function(){var t=this,e=this.diagram;e.on("beforeimport",(function(){var n,r=e.head,a=(null==r||null===(n=r.theme)||void 0===n?void 0:n.name)||"default";a&&t.setTheme(a)})),e.on("beforeexporter",(function(){e.head.theme={name:t.name}}))}},{key:"setThemeName",value:function(t){this.values.themeName=t}},{key:"setNonMindmapCells",value:function(t,e){var n=this;if(t.length){var r=this.diagram,a=!1,i=[],o=[];t.forEach((function(t){var e=t.color;o.push(e),n.palette.isClusterable(e)&&(a=!0)}));var l,s=["default","colorful_kano","iris","wuxia_qingqiu"].includes(this.name)?"light":"dark";if(a){var u=function(t,e){for(var n,r=t.map(gg).map(bg),a=r.map((function(t){return t[0]})),i=r.map((function(t){return t.slice(1)})),o=Array.from(new Set(t)).length,c={},l=Pg(i,1,o,100,"kspp","lab"),s=-1/0,u=0;u<5;u++)c[n=Pg(i,1,o,100,"kspp","lab")]?c[n]++:c[n]=1;Object.entries(c).forEach((function(t){var e=b()(t,2),n=e[0],r=e[1];r>s&&(s=r,l=Number(n))}));for(var d=Ag(i,l,100,"kspp","lab").idxs.reduce((function(n,r,i){return n[t[i]]=[r,Cg(a[i],e)],n}),{}),h=Object.values(d).map((function(t){return t[0]})),f=0,p={},m=0;m<h.length;m++)p[h[m]]||(p[h[m]]=f,f++);return Object.keys(d).forEach((function(t,e){d[t][0]=p[h[e]]})),d}(o,s);l=this.palette.getMappedColorsFromClusteredColors(this.name,u)}else l=this.palette.getMappedColors(e,this.name,o,s);t.forEach((function(t){var e=t.alpha,n=t.color,r=t.id,a=t.type,o=st()(l[n]).toRgb(),s=o.r,u=o.g,d=o.b,h="rgba(".concat(s,", ").concat(u,", ").concat(d,", ").concat(e,")");i.push(c()({id:r},a,{color:h}))})),r.update(i.map((function(t){return t.id})),i)}}},{key:"setStackFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return br(t)}));return this.values.stackFill=t,e.map((function(e){return{id:e.id,fill:{color:t}}}))}},{key:"setStackStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return br(t)}));return this.values.stackStroke=t,e.map((function(e){return{id:e.model.id,stroke:{color:t}}}))}},{key:"setDslFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return hr(t)}));return this.values.dslFill=t,e.map((function(e){return{id:e.model.id,fill:{color:t}}}))}},{key:"setDslStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return dr(t)}));return this.values.dslStroke=t,e.map((function(e){return{id:e.model.id,stroke:{color:t}}}))}},{key:"setSwimlaneHeadFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return gr(t)}));return this.values.swimlaneHeadFill=t,e.map((function(e){return{id:e.model.id,fill:{color:t}}}))}},{key:"setSwimlaneStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return yr(t)}));return this.values.swimlaneStroke=t,e.map((function(e){return{id:e.model.id,fill:{color:t}}}))}},{key:"setMindmapAbstractStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return mr(t)&&t.isAbstract}));return this.values.mindmapAbstractStroke=t,e.map((function(e){return{id:e.model.id,border:{stroke:t},treeEdge:{stroke:t}}}))}},{key:"setMindmapStemStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return mr(t)&&t.isStem}));return this.values.mindmapStemStroke=t,e.map((function(e){return{id:e.model.id,border:{stroke:t}}}))}},{key:"setMindmapStemFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return mr(t)&&t.isStem}));return this.values.mindmapStemFill=t,e.map((function(e){return{id:e.model.id,border:{fill:t}}}))}},{key:"setFontColor",value:function(t){var e=this.diagram,n=e.getCells().filter((function(t){return t.textareaElement})),r=n.map((function(t){return t.textareaElement.htmlContainer}));return e.contentEditor.batchEdit(r,"foreColor",t),this.values.fontColor=t,n.map((function(e,n){return{id:e.model.id,html:r[n].innerHTML,defaultContentStyle:{color:t}}}))}},{key:"setGeometryFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return vr(t)&&!pg(t)}));return this.values.geometryFill=t,e.map((function(e){return{id:e.model.id,fill:{color:t}}}))}},{key:"setGeometryStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return vr(t)&&!mg(t)}));return this.values.geometryStroke=t,e.map((function(e){return{id:e.model.id,stroke:{color:t}}}))}},{key:"setLineStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return sr(t)}));return this.values.lineStroke=t,e.map((function(e){return{id:e.model.id,stroke:{color:t}}}))}},{key:"setMindmapRainbowTreeEdgeColors",value:function(t){var e=[];return this.diagram.getCells().filter((function(t){return mr(t)&&!t.isStem&&t.stem.rainbow})).forEach((function(n){n.depth===n.stem.depth+1?e.push({id:n.model.id,treeEdge:{stroke:t[n.getNth()%t.length]}}):e.push({id:n.model.id,treeEdge:{stroke:null}})})),this.values.mindmapRainbowTreeEdgeColors=t,e}},{key:"setCanvasBackgroundColor",value:function(t){this.diagram.canvas.css({"background-color":t}),this.values.canvasBackgroundColor=t}},{key:"setSpecialUMLFill",value:function(t){var e=this.diagram.getCells().filter((function(t){return pg(t)}));return this.values.specialUMLFill=t,e.map((function(e){return{id:e.model.id,fill:{color:t}}}))}},{key:"setSpecialUMLStroke",value:function(t){var e=this.diagram.getCells().filter((function(t){return mg(t)}));return this.values.specialUMLStroke=t,e.map((function(e){return{id:e.model.id,stroke:{color:t}}}))}},{key:"deleteMindmapAttrs",value:function(){return this.diagram.getCells().filter((function(t){return mr(t)&&!t.isStem})).map((function(t){return{id:t.model.id,border:{fill:null,stroke:null,"stroke-width":null}}}))}},{key:"setSwatches",value:function(t){this.values.swatches=t}},{key:"setDrawColor",value:function(t){var e=this.diagram;e.settings.freehand&&(e.settings.freehand.stroke=t),this.values.drawColor=t}},{key:"register",value:function(t,e){this.themes[t]=e}},{key:"getTheme",value:function(t){return t=t||this.name,s()(this.themes[t])}},{key:"setTheme",value:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.themes,i=this.diagram,o=[],c=[];return"string"==typeof t?(Object.keys(a).includes(t)&&(c=s()(a[t])),this.name=t):d()(t)&&(c=t,this.name=t.themeName),Object.keys(c).forEach((function(t){var e=c[t];switch(t){case"mindmapAbstractStroke":var r;"string"==typeof e&&(r=o).push.apply(r,D()(n.setMindmapAbstractStroke(e)));break;case"stackStroke":var a;"string"==typeof e&&(a=o).push.apply(a,D()(n.setStackStroke(e)));break;case"stackFill":var i;"string"==typeof e&&(i=o).push.apply(i,D()(n.setStackFill(e)));break;case"swimlaneHeadFill":var l;"string"==typeof e&&(l=o).push.apply(l,D()(n.setSwimlaneHeadFill(e)));break;case"swimlaneStroke":var s;"string"==typeof e&&(s=o).push.apply(s,D()(n.setSwimlaneStroke(e)));break;case"dslStroke":var u;"string"==typeof e&&(u=o).push.apply(u,D()(n.setDslStroke(e)));break;case"dslFill":var d;"string"==typeof e&&(d=o).push.apply(d,D()(n.setDslFill(e)));break;case"fontColor":var h;"string"==typeof e&&(h=o).push.apply(h,D()(n.setFontColor(e)));break;case"geometryFill":var f;"string"==typeof e&&(f=o).push.apply(f,D()(n.setGeometryFill(e)));break;case"geometryStroke":var p;"string"==typeof e&&(p=o).push.apply(p,D()(n.setGeometryStroke(e)));break;case"lineStroke":var m;"string"==typeof e&&(m=o).push.apply(m,D()(n.setLineStroke(e)));break;case"mindmapStemStroke":var v;"string"==typeof e&&(v=o).push.apply(v,D()(n.setMindmapStemStroke(e)));break;case"mindmapStemFill":var y;"string"==typeof e&&(y=o).push.apply(y,D()(n.setMindmapStemFill(e)));break;case"mindmapRainbowTreeEdgeColors":var g;Array.isArray(e)&&(g=o).push.apply(g,D()(n.setMindmapRainbowTreeEdgeColors(e)));break;case"canvasBackgroundColor":"string"==typeof e&&n.setCanvasBackgroundColor(e);break;case"specialUMLFill":var b;"string"==typeof e&&(b=o).push.apply(b,D()(n.setSpecialUMLFill(e)));break;case"specialUMLStroke":var x;"string"==typeof e&&(x=o).push.apply(x,D()(n.setSpecialUMLStroke(e)));break;case"swatches":e&&n.setSwatches(e);break;case"drawColor":"string"==typeof e&&n.setDrawColor(e);break;case"themeName":"string"==typeof e&&n.setThemeName(e)}})),(e=o).push.apply(e,D()(this.deleteMindmapAttrs())),o=function(t){var e={};return t.forEach((function(t){var n=t.id;if(n){var r=e[n];r?xt()(r,t):e[n]=s()(t)}})),Object.keys(e).map((function(t){return e[t]}))}(o=o.filter((function(t){return"string"==typeof t.id}))),r&&i.update(o.map((function(t){return t.id})),o),o}},{key:"destroy",value:function(){this.palette.destroy(),this.destroyed=!0}}]),t}();c()(Mg,"className","Theme");var jg=function(){var t={};return Array.from(arguments).forEach((function(e){Object.keys(e).forEach((function(n){var r=e[n];d()(r)?t[n]?Object.assign(t[n],r):t[n]=Object.assign({},r):Array.isArray(r)?t[n]?t[n]=[].concat(t[n],r):t[n]=[].concat(r):t[n]=r}))})),t}({Extends:[Mg,Uy],Commands:[$y,Qy,Ky]},lp,jv,zv,wy,Dp,Iy),Rg=Object.freeze({__proto__:null,Board:jg});We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar-dropdown .ant-btn:after {\n  display: none;\n}\n.lake-diagram-toolbar-dropdown .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button {\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  display: flex;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: 30px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon:before {\n  content: '';\n}\n.lake-diagram-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-dropdown-menu .lake-icon {\n  font-size: 16px;\n}\n");var Lg=["mode"];function Bg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bg(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ng(t){return t.overlay?t.overlay:Oe.a.createElement(Ne.a,{onClick:t.onSelect,className:Me()("lake-diagram-toolbar-dropdown-menu",t.menuClassName)},t.data.map((function(t){return Oe.a.createElement(Ne.a.Item,{key:t.key},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon)}))})))}function _g(t){var e=t.command,n=t.name;return Oe.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Ng(Dg(Dg({},t),{},{onSelect:function(n){var r=n.key;t.onSelect?t.onSelect({key:r}):t.execCommand(e,{key:r})}}))},Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon)}))))}function Ig(t){var e=t.name,n=t.command,r=t.defaultKey,a=t.data,i=Object(Ae.useState)(r),o=b()(i,2),c=o[0],l=o[1],s=a.find((function(t){return t.key===c}));return Oe.a.createElement("div",{className:"lake-diagram-toolbar-command lake-diagram-toolbar-dropdown"},Oe.a.createElement(De.a.Button,{onClick:function(){t.onClick?t.onClick({key:c}):t.execCommand(n,{key:c})},overlay:Ng(Dg(Dg({},t),{},{onSelect:function(e){var n=e.key;l(n),t.onSelect&&t.onSelect({key:n})}})),icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}),"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon||s.icon)})))}function Tg(t){var e=t.mode,n=Be()(t,Lg);return"button"===e?Oe.a.createElement(Ig,n):Oe.a.createElement(_g,n)}function Fg(t){var e=t.name,n=t.icon,r=t.accept,a=t.disabled,i=t.title,o=t.onChange,c=Object(Ae.useRef)();return Oe.a.createElement("div",{className:"lake-diagram-toolbar-command","data-testid":e},Oe.a.createElement(je.a,{disabled:a||!i,placement:"bottom",title:Oe.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},i&&Oe.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},i))},Oe.a.createElement(Re.a,{className:"lake-diagram-toolbar-upload",onClick:function(){return c.current.click()},disabled:a},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Oe.a.createElement("input",{type:"file",accept:r,onChange:o,ref:c}))))}function zg(t){var e=t.name,n=t.title,r=t.hotkey,a=t.icon,i=t.label,o=t.command,c=t.disabled,l=t.active,s=Object.keys(t).reduce((function(e,n){return n.startsWith("data-")&&(e[n]=t[n]),e}),{});return Oe.a.createElement("div",Ce()({className:"lake-diagram-toolbar-command","data-testid":e},s),Oe.a.createElement(je.a,{disabled:c||!(n||r),placement:"bottom",title:Oe.a.createElement("div",{className:"lake-diagram-toolbar-tooltip"},n&&Oe.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-title"},n),r&&Oe.a.createElement("div",{className:"lake-diagram-toolbar-tooltip-hotkey"},r))},Oe.a.createElement(Re.a,{onClick:function(e){e.stopPropagation(),t.onClick?t.onClick():t.execCommand(o)},disabled:c,className:Me()({"lake-button-active":l}),"data-testid":"".concat(e,"-button")},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(a)}),i&&Oe.a.createElement("span",{className:"lake-diagram-toolbar-command-label"},i))))}function qg(t){switch(t.type){case"separator":return Oe.a.createElement("div",{className:"lake-diagram-toolbar-separator"});case"dropdown":return Oe.a.createElement(Tg,t);case"upload":return Oe.a.createElement(Fg,t);default:return Oe.a.createElement(zg,t)}}function Yg(t){var e=t.commands,n=t.extra,r=t.execCommand;return Oe.a.createElement("div",{className:Me()("lake-diagram-toolbar",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-toolbar-title"},t.title),Oe.a.createElement("div",{className:"lake-diagram-toolbar-body"},e.map((function(t,e){return Oe.a.createElement(qg,Ce()({key:"".concat(t.name||t.type,"-").concat(e),execCommand:r},t))}))),Oe.a.createElement("div",{className:"lake-diagram-toolbar-extra"},n))}Ng.propTypes={data:Pe.a.array,overlay:Pe.a.node,onSelect:Pe.a.func,menuClassName:Pe.a.string},_g.propTypes={command:Pe.a.string,name:Pe.a.string,icon:Pe.a.string,onSelect:Pe.a.func,execCommand:Pe.a.func},Ig.propTypes={command:Pe.a.string,name:Pe.a.string,defaultKey:Pe.a.string,title:Pe.a.string,data:Pe.a.array,icon:Pe.a.string,onClick:Pe.a.func,onSelect:Pe.a.func,execCommand:Pe.a.func},Tg.propTypes={mode:Pe.a.string},We(".lake-diagram-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),Fg.propTypes={name:Pe.a.string,icon:Pe.a.string,accept:Pe.a.string,disabled:Pe.a.bool,title:Pe.a.string,onChange:Pe.a.func},zg.defaultProps={disabled:!0},zg.propTypes={disabled:Pe.a.bool,name:Pe.a.string,title:Pe.a.string,hotkey:Pe.a.string,type:Pe.a.string,icon:Pe.a.string,label:Pe.a.string,command:Pe.a.string,onClick:Pe.a.func,execCommand:Pe.a.func,active:Pe.a.bool},qg.propTypes={type:Pe.a.string},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-toolbar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 38px;\n  border: solid var(--yq-border-primary);\n  border-width: 1px 0;\n  padding-left: 16px;\n  padding-right: 12px;\n  background: var(--yq-bg-secondary);\n}\n.lake-diagram-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-toolbar-separator {\n  width: 1px;\n  height: 100%;\n  margin: 0 4px;\n  background: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 8px;\n  height: 32px;\n  min-width: 32px;\n  margin-left: 4px;\n  margin-right: 4px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-toolbar-command .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-toolbar-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 16px;\n}\n.lake-diagram-toolbar-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-toolbar-command-label {\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-toolbar-tooltip {\n  text-align: center;\n}\n.lake-diagram-toolbar-tooltip-hotkey {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n"),Yg.defaultProps={commands:[],toggleProperties:function(){},domContainer:null},Yg.propTypes={className:Pe.a.string,commands:Pe.a.array,domContainer:Pe.a.object,title:Pe.a.node,extra:Pe.a.node,execCommand:Pe.a.func},Yg.Control=qg,We("/* stylelint-disable */\n.lake-diagram-link-editor {\n  max-width: 398px;\n  display: inline-block;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  box-shadow: rgba(216, 218, 217, 0.5) 0px 1px 3px;\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-link-editor .lake-link-invalid-link {\n  color: var(--yq-red-6);\n}\n.lake-diagram-link-editor p {\n  margin-top: 0;\n  margin-bottom: 14px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  margin: 0 2px;\n}\n.lake-diagram-link-editor .lake-diagram-link-editor-slash {\n  width: 1px;\n  height: 14px;\n  border-left: 1px solid var(--yq-border-primary);\n  margin: 0 1px;\n  margin-top: 5px;\n  vertical-align: top;\n}\n.lake-diagram-link-editor .lake-icon {\n  color: #8590a6;\n  font-size: 16px;\n}\n.lake-diagram-link-editor-preview {\n  line-height: 16px;\n  padding: 6px 8px;\n  vertical-align: middle;\n  white-space: nowrap;\n}\n.lake-diagram-link-editor-preview * {\n  display: inline-block;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button {\n  color: var(--yq-text-body);\n  margin: 0px 0px 0px 8px;\n  padding: 4px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-button:hover {\n  background: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container {\n  color: var(--yq-blue-5);\n  height: 16px;\n  padding: 0 6px;\n  min-width: 180px;\n  max-width: 292px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  text-decoration: none;\n  line-height: 12px;\n  font-size: 14px;\n  letter-spacing: 1.2px;\n  vertical-align: middle;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-empty {\n  height: 16px;\n  padding: 0 6px;\n  min-width: 146px;\n  max-width: 292px;\n  line-height: 20px;\n  font-size: 14px;\n}\n.lake-diagram-link-editor-preview .lake-diagram-link-editor-link-container:hover {\n  cursor: pointer;\n}\n.lake-diagram-link-editor-edit {\n  width: 365px;\n  padding: 16px 12px;\n  padding-bottom: 4px;\n}\n");var Hg={"zh-cn":{text:"文本",link:"链接",editLink:"编辑链接",addDescription:"添加描述",linkAddress:"链接地址",deleteLink:"删除链接",confirm:"确定",pleaseInputLink:"请输入链接",emptyLink:"空链接",pleaseEnterCorrectLink:"请输入正确的链接",selectedContent:"多行文字被选中，暂不支持修改文本"},en:{text:"Text",link:"Link",editLink:"Edit link",addDescription:"Add a description",linkAddress:"Link address",deleteLink:"Delete link",confirm:"Confirm",pleaseInputLink:"Please input link address",emptyLink:"Empty link",pleaseEnterCorrectLink:"Please enter the correct link",selectedContent:"Selected in the document"}};Hg["en-us"]=Hg.en;var Gg=function(t){S()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(t){var r;m()(this,n);var a=(r=e.call(this,t)).props,i=a.lang,o=a.target;return r.locale=Hg[i],r.nativeEvents=[],r.rect=o.getBoundingClientRect(),r.link=o.getAttribute("href"),r.isMultiLink=o.length>1,r.state={invalidLink:r.isInvalidLink(r.link)},r.preventScrollCancel=!1,r}return y()(n,[{key:"adjustPosition",value:function(){var t=this.container,e=this.props.target,n=t.getBoundingClientRect(),r=t.offsetParent.getBoundingClientRect(),a=e.getBoundingClientRect(),i=a.bottom+4-r.top,o=a.left-r.left;r.top+i+n.height>window.innerHeight-20&&(i-=n.height-4),n.right>window.innerWidth-20?o=window.innerWidth-n.width-4:o<20&&(o=20),t.style.top="".concat(i,"px"),t.style.left="".concat(o,"px")}},{key:"componentDidMount",value:function(){this.bindNativeEvents(),this.adjustPosition()}},{key:"componentDidUpdate",value:function(){this.adjustPosition()}},{key:"componentWillUnmount",value:function(){this.removeNativeEvents()}},{key:"bindNativeEvents",value:function(){var t=this,e=this.container,n=!1;this.addNativeEvent(window,"scroll",(function(e){!0!==t.preventScrollCancel?e.target.className&&-1!==e.target.className.indexOf("lake-link")||t.cancel():e.preventDefault()}),!0),this.addNativeEvent(window,"resize",(function(){t.cancel()}),!0),this.addNativeEvent(window,"mousedown",(function(t){var r=t.target;e.contains(r)||(n=!0)}),!0),this.addNativeEvent(window,"mouseup",(function(r){var a=r.target;n&&!e.contains(a)&&t.cancel(),n=!1}))}},{key:"cancel",value:function(){var t=this.props,e=t.onCancel,n=t.target;e({link:n&&n.getAttribute("href")})}},{key:"addNativeEvent",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.addEventListener(e,n,r),this.nativeEvents.push({dom:t,name:e,callback:n,useCapture:r})}},{key:"removeNativeEvents",value:function(){this.nativeEvents.forEach((function(t){var e=t.dom,n=t.name,r=t.callback,a=t.useCapture;e.removeEventListener(n,r,a)})),this.nativeEvents=[]}},{key:"confirm",value:function(){var t=this.props.onConfirm,e=this.state.invalidLink,n=this.getText(),r=this.getLink();e||t(n,r)}},{key:"renderPreview",value:function(){var t,e=this.props,n=e.onDeleteLink,r=e.shouldTargetBlank,a=e.onSwitchToEdit,i=e.dataset,o=this.getLink(),c=this.locale,l=o||c.emptyLink;return t=o?r(o)?Oe.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(o),target:"_blank"},l):Oe.a.createElement("a",{className:"lake-diagram-link-editor-link-container",href:ml(o)},l):Oe.a.createElement("span",{className:"lake-diagram-link-editor-link-empty"},l),Oe.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-preview"},Oe.a.createElement("span",{className:"lake-icon lake-icon-link"}),t,Oe.a.createElement("span",{className:"lake-diagram-link-editor-slash"}),Oe.a.createElement(je.a,{title:c.editLink},Oe.a.createElement("a",Ce()({},i,{className:"lake-icon lake-icon-edit lake-diagram-link-editor-button",onClick:function(){a()}}))),Oe.a.createElement(je.a,{title:c.deleteLink},Oe.a.createElement("a",Ce()({},i,{className:"lake-icon lake-icon-unlink lake-diagram-link-editor-button",onClick:n}))))}},{key:"isInvalidLink",value:function(t){return function(t){return!t||t&&!t.match(/^[\x00-\x7F]/)||t.startsWith("javascript:")}(t)}},{key:"renderEditorContent",value:function(){var t=this,e=this.props.dataset,n=this.state.invalidLink,r=this.getText(),a=this.getLink(),i=this.locale;return Oe.a.createElement("div",{className:"lake-diagram-link-editor lake-diagram-link-editor-edit",onKeyDown:function(e){var n=e.key,r=t.state.invalidLink;"Enter"!==n||r||t.confirm(),"Escape"===n&&t.cancel()}},Oe.a.createElement("p",null,i.text),Oe.a.createElement("p",null,Oe.a.createElement(_e.a,{className:"lake-link-text-input",defaultValue:this.isMultiLink?i.selectedContent:r,ref:function(e){t.textInputDom=e},placeholder:i.addDescription,disabled:this.isMultiLink,onChange:function(e){t.text=e.target.value}})),Oe.a.createElement("p",null,i.link),Oe.a.createElement("p",null,Oe.a.createElement(_e.a,{className:"lake-link-link-input",defaultValue:a,ref:function(e){t.preventScrollCancel=!0,e&&e.focus(),t.linkInputDom=e,setTimeout((function(){t.preventScrollCancel=!1}),32)},placeholder:i.linkAddress,onChange:function(e){t.link=e.target.value,t.setState({invalidLink:t.isInvalidLink(t.link)})}})),n&&""!==a?Oe.a.createElement("p",{className:"lake-link-invalid-link"},i.pleaseEnterCorrectLink):"",Oe.a.createElement("p",null,Oe.a.createElement(Re.a,Ce()({},e,{className:"lake-link-confirm-button",onClick:function(){t.confirm()},disabled:!this.link||n}),i.confirm)))}},{key:"getLink",value:function(){var t=this.props.getLink;return this.link&&t(this.link)||""}},{key:"getText",value:function(){var t=this.props.target;return this.isMultiLink?"":this.text||t.textContent}},{key:"render",value:function(){var t,e=this,n=this.props,r=n.type,a=n.className,i=n.dataset;return t="edit"===r?this.renderEditorContent():this.renderPreview(),Oe.a.createElement("div",Ce()({},i,{className:a,ref:function(t){e.container=t},style:{top:"0px",position:"absolute",zIndex:"1400"}}),t)}}]),n}(Oe.a.Component);function Xg(t){var e=window.location,n=(e.origin+e.pathname.replace("/edit","")).replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp("^".concat(n,"#"));return t=t.replace(r,"#").trim(),/^(\w+\.)+\w+(\/|$)/.test(t)&&(t="https://"+t),t}function Wg(t){var e=t.diagram,n=Object(Ae.useState)(null),r=b()(n,2),a=r[0],i=r[1],o=Object(Ae.useState)("preview"),c=b()(o,2),l=c[0],s=c[1];return Object(Ae.useEffect)((function(){function t(t,e){i(t),s(e)}function n(e){var n=e.result,r=e.target,a=e.name;n&&"createLink"===a&&t(r,"edit")}function r(){i(null)}var a=Nt()((function(){var n=e.contentEditor.getRange();if(n){var r=e.contentEditor.closest(n.commonAncestorContainer,"a");r?t(r,"preview"):i(null)}}),16);return e.contentEditor.on("execcommand",n),e.contentEditor.on("endedit",r),e.contentEditor.on("selectionchange",a),function(){e.contentEditor.off("execcommand",n),e.contentEditor.off("endedit",r),e.contentEditor.off("selectionchange",a)}}),[e]),a?Oe.a.createElement(Gg,{dataset:{"data-lake_prevent_click_unselect":!0},target:a,type:l,lang:Sr.locale,getLink:Xg,onConfirm:function(t,n){a.textContent=t,a.setAttribute("href",n),setTimeout((function(){if(a&&e.viewportContainer.contains(a)){var t=window.getSelection(),n=document.createRange();n.selectNode(a),n.collapse(),t.removeAllRanges(),t.addRange(n)}}),16),i(null)},onSwitchToEdit:function(){s("edit")},onCancel:function(){i(null)},onDeleteLink:function(){a.removeAttribute("href"),function(t){for(var e=t.firstChild;e;){var n=e.nextSibling;t.parentNode.insertBefore(e,t),e=n}t.parentNode.removeChild(t)}(a),i(null)},shouldTargetBlank:function(){return!0}}):Oe.a.createElement("div",null)}Gg.defaultProps={dataset:{},className:null,type:"preview",lang:"zh-cn",onDeleteLink:function(){},onSwitchToEdit:function(){},onConfirm:function(){},onCancel:function(){},shouldTargetBlank:function(){},getLink:function(t){return t}},Gg.propTypes={dataset:Pe.a.object,className:Pe.a.string,target:Pe.a.object,type:Pe.a.string,lang:Pe.a.string,onDeleteLink:Pe.a.func,onSwitchToEdit:Pe.a.func,onConfirm:Pe.a.func,onCancel:Pe.a.func,shouldTargetBlank:Pe.a.func,getLink:Pe.a.func},We(""),Wg.defaultProps={diagram:null},Wg.propTypes={diagram:Pe.a.object.isRequired};var Vg=Nh(),Zg=function(t){var e=t.shapeSelect,n=t.groups,r=t.basicWithSwimlane,a=t.diagram;t.popoverVisible;var i=t.pen,o=Object(Ae.useRef)(),c=Object(Ae.useState)(""),l=b()(c,2),s=l[0];return l[1],e||(e=Object(Ae.useMemo)((function(){return new Kh({groups:n,basicWithSwimlane:r})}),D()(n))),Object(Ae.useEffect)((function(){var n,r=Vg?8.5:0,c=new ba({href:Vg?"https://gw.alipayobjects.com/zos/bmw-prod/d9d2b1a7-fe9b-41f9-8450-a9aacab3b014.svg":"https://gw.alipayobjects.com/zos/bmw-prod/ab304cc5-55d8-4bfc-a551-b884d0b88824.svg",matrix:[1,0,0,0,1,0,r,r,1]}),l=new Oa({x:0,y:0,width:32,height:32,rx:4,fill:Vg?"#141414":"#fff"}),s=new na({matrix:[1,0,0,0,1,0,172,4,1]});s.add(new Ra({title:"矢量绘图"})),s.add(l),s.add(c),s.dataset({test_id:"pen"}),s.css({cursor:"pointer"});var u=function(t){l.attr({fill:_h("hover")})},d=function(t){l.attr({fill:Vg?"#141414":"#fff"})},h=function(e){var n,r;a.penDrawInteract.clearCache(),null==a||null===(n=a.interaction)||void 0===n||n.changeMode("pen"),null===(r=t.hide)||void 0===r||r.call(t)};s.on("mouseover",u),s.on("mouseleave",d),s.on("click",h),i&&e.add(s),o.current.appendChild(e.rendererElement),o.current.setAttribute("height",e.height),null===(n=o.current)||void 0===n||n.setAttribute("width",e.width);var f=function(t){var e,n=t.height;null===(e=o.current)||void 0===e||e.setAttribute("height",n)};return e.on("update:height",f),function(){e.off("update:height",f),s.off("mouseover",u),s.off("mouseleave",d),s.off("click",h),s.destroy()}}),[e]),Object(Ae.useEffect)((function(){function n(e){var n=e.shape,r=e.group,a=e.category,i=e.attr;t.onSelect({key:n,group:r,category:a,attr:i})}return e.on("shape:select",n),function(){e.off("shape:select",n)}}),[t.onSelect]),Oe.a.createElement("svg",{viewBox:s,className:Me()(t.className,"lake-prevent-card-activated"),"data-lake_prevent_click_unselect":"true",ref:o,onClick:function(){var e;return null===(e=t.onClick)||void 0===e?void 0:e.call(t)},"data-testid":"shape-overlay"})};Zg.propTypes={groups:Pe.a.array,onSelect:Pe.a.func,onClick:Pe.a.func,className:Pe.a.string,shapeSelect:Pe.a.object,basicWithSwimlane:Pe.a.bool,diagram:Pe.a.object,pen:Pe.a.bool,popoverVisible:Pe.a.bool},We('.lake-diagram-toolbar-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  max-width: 220px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs {\n  height: 40px;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab-btn {\n  font-weight: 400;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-tab .ant-tabs-tab-active {\n  font-weight: 500;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-nav {\n  padding-left: 12px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-operations,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-operations {\n  width: auto !important;\n  padding: 0 !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-more,\n.lake-diagram-toolbar-shape-select-container .ant-tabs > div > .ant-tabs-nav .ant-tabs-nav-more {\n  padding: 0;\n  margin-left: 8px !important;\n  margin-right: 8px !important;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-ink-bar {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-right::after {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-top > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before,\n.lake-diagram-toolbar-shape-select-container .ant-tabs-bottom > div > .ant-tabs-nav .ant-tabs-nav-wrap.ant-tabs-nav-wrap-ping-left::before {\n  opacity: 0;\n}\n.lake-diagram-toolbar-shape-container {\n  overflow: scroll;\n  display: flex;\n  justify-content: center;\n  max-height: 218px;\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n[data-kumuhana="pouli"] .lake-diagram-toolbar-shape-container::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.3);\n}\n');var Ug=["groups","popoverVisible"];function Kg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Qg=Ie.a.TabPane;function $g(t){var e=t.groups,n=t.popoverVisible,r=Be()(t,Ug),a=Object(Ae.useRef)(),i=Object(Ae.useMemo)((function(){var t=new Kh(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kg(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({groups:e,containerHeight:218,backgroundColor:"transparent"},r)),n=e.map((function(e){return t.getOffset(e)}));return{shapeSelect:t,offsets:n}}),D()(e)),o=i.shapeSelect,l=i.offsets,s=Object(Ae.useState)(e[0]),u=b()(s,2),d=u[0],h=u[1],f=Object(Ae.useRef)();return Object(Ae.useEffect)((function(){var t,n=Bt()((function(t){for(var n=t.target.scrollTop,r=l.length-1;r>=0&&!(n>l[r]-32);r--);h((function(t){return t!==e[r]?e[r]:t}))}),16);return null===(t=a.current)||void 0===t||t.addEventListener("scroll",n),function(){var t;return null===(t=a.current)||void 0===t?void 0:t.removeEventListener("scroll",n)}}),[]),Object(Ae.useEffect)((function(){var t;Array.from(null===(t=f.current)||void 0===t?void 0:t.querySelectorAll(".ant-tabs-tab")).forEach((function(t,e){0!==e&&(t.style.marginLeft="16px")}))}),[]),Oe.a.createElement("div",{className:"lake-diagram-toolbar-shape-select-container",ref:f},Oe.a.createElement(Ie.a,{tabBarStyle:{width:"100%",padding:"0 8px",height:"40px",color:"#8c8c8c",fontSize:"14px"},animated:{inkBar:!0,tabPane:!0},onChange:function(t){var e;return null===(e=a.current)||void 0===e?void 0:e.scrollTo(0,o.getOffset(t))},activeKey:d,onTabClick:function(t){h(t)}},e.map((function(t){return Oe.a.createElement(Qg,{tab:Uh[t].title,key:t})}))),Oe.a.createElement("div",{ref:a,className:"lake-diagram-toolbar-shape-container"},Oe.a.createElement(Zg,Ce()({groups:e,shapeSelect:o,popoverVisible:n},r))))}$g.propTypes={groups:Pe.a.array,popoverVisible:Pe.a.bool},We("/* stylelint-disable */\n.lake-zoom-tool {\n  padding: 0 5px;\n  width: auto;\n  height: 25px;\n  border: 1px solid var(--yq-border-primary);\n  box-shadow: 0px 2px 4px rgba(231, 233, 232, 0.5);\n  color: var(--yq-yuque-grey-3);\n  background: var(--yq-yuque-grey-6);\n  position: absolute;\n  top: 16px;\n  right: 28px;\n  border-radius: 6px;\n  font-size: 14px;\n  line-height: 24px;\n  letter-spacing: 0.05em;\n  outline-style: none;\n  word-wrap: break-word;\n}\n.lake-zoom-tool .ant-dropdown {\n  left: -2.5px;\n}\n.lake-zoom-tool ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu {\n  width: 86px;\n  background: var(--yq-yuque-grey-8);\n}\n.lake-zoom-tool ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-zoom-tool .ant-dropdown-menu-item:hover {\n  background: var(--yq-yuque-grey-9);\n}\n.lake-zoom-tool .ant-dropdown-menu-item {\n  color: var(--yq-white);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-zoom-tool .lake-icon {\n  margin: 3.5px;\n  margin-top: 2px;\n  font-size: 14px;\n  width: 14px;\n  height: 14px;\n}\n.lake-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: top;\n  line-height: 23px;\n}\n.lake-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-zoom-tool .lake-zoom-tool-dropdown:hover {\n  cursor: pointer;\n}\n.lake-zoom-tool:hover {\n  background: var(--yq-yuque-grey-8);\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n");var Jg=function(t){S()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"_setZoom",value:function(t){var e=this.props,n=e.onChange,r=e.minZoom,a=e.maxZoom;t<r&&(t=r),t>a&&(t=a),n(t)}},{key:"_clickZoomIn",value:function(){var t=this.props,e=t.zoomStep,n=t.zoom;this._setZoom(n+e)}},{key:"_clickZoomOut",value:function(){var t=this.props,e=t.zoomStep,n=t.zoom;this._setZoom(n-e)}},{key:"render",value:function(){var t=this,e=this.props.zoom,n=Oe.a.createElement(Ne.a,{className:"lake-zoom-tool-menu",onClick:function(e){var n=e.item;t._setZoom(n.props.value)}},Oe.a.createElement(Ne.a.Item,{value:"resetView"},Mr("回到中心")),Oe.a.createElement(Ne.a.Item,{value:.2},"20%"),Oe.a.createElement(Ne.a.Item,{value:.5},"50%"),Oe.a.createElement(Ne.a.Item,{value:1},"100%"),Oe.a.createElement(Ne.a.Item,{value:2},"200%"),Oe.a.createElement(Ne.a.Item,{value:4},"400%"),Oe.a.createElement(Ne.a.Item,{value:"autoFit"},Mr("适应画布")));return Oe.a.createElement("div",{className:"lake-zoom-tool",ref:function(e){t.zoomToolDOM=e}},Oe.a.createElement("span",{className:"lake-icon lake-icon-zoom-out",onClick:this._clickZoomOut.bind(this)}),Oe.a.createElement(De.a,{className:"lake-zoom-tool-dropdown",overlay:n,placement:"bottomCenter",trigger:["click"],getPopupContainer:function(){return t.zoomToolDOM}},Oe.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*e)+"%")),Oe.a.createElement("span",{className:"lake-icon lake-icon-zoom-in",onClick:this._clickZoomIn.bind(this)}))}}]),n}(Oe.a.Component);function tb(t){var e=t.diagram,n=Object(Ae.useState)(null),r=b()(n,2),a=r[0],i=r[1];return Object(Ae.useEffect)((function(){if(e){i(e.viewport.zoom);var t=Nt()((function(){i(e.viewport.zoom)}),32);return e.on("afterviewportchange",t),function(){e.off("afterviewportchange",t)}}}),[a,e]),e?Oe.a.createElement(Jg,{zoom:a,onChange:function(t){"autoFit"===t?e.viewport.autoFit():"resetView"===t?e.viewport.focusFirstRoot():e.viewport.setViewport(t)}}):Oe.a.createElement("div",null)}Jg.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},Jg.propTypes={zoom:Pe.a.number,onChange:Pe.a.func,minZoom:Pe.a.number,maxZoom:Pe.a.number,zoomStep:Pe.a.number},tb.propTypes={diagram:Pe.a.object};var eb=function(t){return Ae.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t,{className:["larkui-icon","larkui-icon-review-arrow-down",t.className].filter(Boolean).join(" ")}),Ae.createElement("defs",null,Ae.createElement("path",{id:"3742204692a",d:"M0 0h256v256H0z"})),Ae.createElement("g",{fill:"none",fillRule:"evenodd"},Ae.createElement("mask",{id:"3742204692b",fill:"#fff"},Ae.createElement("use",{xlinkHref:"#3742204692a"})),Ae.createElement("path",{d:"M181.1 118.925 135 165.096a9.889 9.889 0 0 1-14 0l-46.1-46.17c-3.866-3.873-3.866-10.15 0-14.022a9.892 9.892 0 0 1 7-2.904h92.2c5.468 0 9.9 4.439 9.9 9.915a9.922 9.922 0 0 1-2.9 7.01Z",fill:"currentColor",fillRule:"nonzero",mask:"url(#3742204692b)"})))},nb=function(t){return Ae.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},t,{className:["larkui-icon","larkui-icon-review-arrow-right",t.className].filter(Boolean).join(" ")}),Ae.createElement("path",{d:"m115.925 74.9 46.171 46.1a9.889 9.889 0 0 1 0 14l-46.17 46.1c-3.873 3.866-10.15 3.866-14.022 0a9.892 9.892 0 0 1-2.904-7V81.9c0-5.468 4.439-9.9 9.915-9.9a9.922 9.922 0 0 1 7.01 2.9Z",fill:"currentColor",fillRule:"nonzero"}))},rb=function(t){return Ae.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg"},t,{className:["larkui-icon","larkui-icon-help-search",t.className].filter(Boolean).join(" ")}),Ae.createElement("path",{d:"M114 20c51.362 0 93 41.638 93 93 0 21.782-7.489 41.816-20.032 57.666l45.82 46.277c4.275 4.317 4.24 11.282-.077 15.556-4.317 4.275-11.281 4.24-15.556-.077l-45.774-46.23C155.576 198.602 135.652 206 114 206c-51.362 0-93-41.638-93-93s41.638-93 93-93Zm0 20c-40.317 0-73 32.683-73 73s32.683 73 73 73 73-32.683 73-73-32.683-73-73-73Z",fill:"currentColor",fillRule:"nonzero"}))};function ab(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}We("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n/**\n * lake/editor 的卡片容器实现方式会导致文档样式影响卡片编辑器样式\n */\n.lake-diagram-panel-properties ~ div .ant-dropdown-menu-item {\n  margin-left: 0;\n  list-style-type: none;\n}\n.lake-diagram-panel-properties {\n  background-color: var(--yq-bg-secondary);\n  border-left: 1px solid var(--yq-border-primary);\n  height: 100%;\n  width: 100%;\n  min-width: 212px;\n  max-width: 286px;\n  cursor: default;\n  user-select: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header {\n  margin-top: 8px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-menu-hide-header .ant-collapse-header {\n  display: none;\n}\n.lake-diagram-panel-properties .lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs {\n  height: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav {\n  width: 100%;\n  margin-bottom: 0px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list {\n  width: 100%;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: 1;\n  margin: 0 2px;\n  display: inline-block;\n  text-align: center;\n  border: none;\n  color: var(--yq-text-caption);\n  border-radius: 0;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab:hover {\n  color: var(--yq-text-primary);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active .ant-tabs-tab-btn {\n  color: var(--yq-text-primary);\n  font-weight: 400;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs .ant-tabs-content-holder {\n  overflow: auto;\n  height: calc(100% - 38px);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-tabs-bar {\n  margin: 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse {\n  border: none;\n  background-color: rgba(0, 0, 0, 0);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header {\n  padding: 0 16px;\n  margin: 8px 0;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-header .larkui-icon {\n  padding: 0;\n  margin-right: 8px;\n  top: 6px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item {\n  padding-top: 8px;\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content {\n  border: none;\n  background: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item .ant-collapse-content .ant-collapse-content-box {\n  margin: 0px 16px;\n  padding: 0px;\n  padding-bottom: 8px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.09);\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child .ant-collapse-content-box {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body .ant-collapse .ant-collapse-item:last-child {\n  border-bottom: none;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty {\n  height: 100%;\n  position: relative;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  margin: auto;\n  padding-bottom: 96px;\n  width: 200px;\n  height: 140px;\n  text-align: center;\n  color: var(--yq-text-disable);\n  line-height: 24px;\n}\n.lake-diagram-panel-properties .lake-diagram-panel-body-empty .lake-diagram-background-wrapper p {\n  margin-bottom: 0;\n}\n.lake-diagram-control {\n  margin-bottom: 8px;\n}\n.lake-diagram-control.disabled .lake-diagram-control-title {\n  color: var(--yq-text-caption);\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  border-color: var(--yq-border-primary);\n  background: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra > svg {\n  display: none;\n}\n.lake-diagram-control-title {\n  color: var(--yq-text-body);\n  letter-spacing: 0;\n}\n.lake-diagram-control-head {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-diagram-control-extra {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 92px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n.lake-diagram-control-extra > svg {\n  display: block;\n}\n.lake-diagram-control-body .ant-checkbox + span {\n  letter-spacing: 0;\n}\n.lake-diagram-panel-head {\n  border-bottom: 1px solid var(--yq-border-primary);\n  margin-bottom: 12px;\n  padding-bottom: 4px;\n}\n.lake-diagram-panel-head-title {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  font-weight: 500;\n}\n");var ib=Ie.a.TabPane;function ob(t,e){var n="object"===i()(t)?t:c()({},t,e),r={},a=function(t){t.split(".").reduce((function(e,r,a,i){return e[r]=a+1===i.length?n[t]:{}}),r)};for(var o in n)a(o);return r}function cb(t){var e,n,r=t.diagram,a=t.menus,i=t.tabs,o=t.emptyImg,l=t.className,s=Object(Ae.useState)(t.selections||r.selector.selections.concat([])),u=b()(s,2),d=u[0],h=u[1],f=Object(Ae.useState)(null),p=b()(f,2),m=p[0],v=p[1],y=function(t,e,n){var r={},a=[];return t.forEach((function(t,e){var n=t.name,a=t.key;r[a]={name:n,menus:[],index:e,key:a}})),e.forEach((function(t){t.condition(n)&&(r[t.tabKey].menus.push(t),a.push(t.name))})),Object.values(r).filter((function(t){return t.menus.length>0})).sort((function(t,e){return t.index-e.index}))}(i,a,d);function g(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;if("function"==typeof e)return e(),void h(D()(d));if(t.onChange)return t.onChange(ob(e,n),a);if(a.every((function(t){return t.isGroup}))){var i,o=[],c=[],l=[],s=ob(e,n);return s.hasOwnProperty("width")?i="lc":s.hasOwnProperty("height")&&(i="tc"),a.forEach((function(t){var e=wd(t),n=b()(e,3),r=n[0],a=n[1],u=n[2],d=gd(s,{x:t.x,y:t.y,w:t.width,h:t.height,r:0},a);l.push.apply(l,D()(Cd(d,r,i))),c.push.apply(c,D()(r)),o.push.apply(o,D()(u))})),r.command.execute("Update",{id:c,model:l,originModels:o,autoSelect:!1}),void h(D()(d))}r.command.execute("Update",{id:a,model:ob(e,n),autoSelect:!1}),h(D()(d))}return Object(Ae.useEffect)((function(){Array.isArray(t.selections)&&h(t.selections)}),[t.selections]),Object(Ae.useEffect)((function(){if(r){var t=Nt()((function(t){t&&v(t),h(r.selector.selections.concat([]))}),32),e=function(){t()};return r.on("afterselect",e),function(){r.off("afterselect",e)}}}),[r,m]),Oe.a.createElement("div",{className:Me()("lake-diagram-panel lake-diagram-panel-properties",l),"data-lake_prevent_click_unselect":"true"},y.length>0?(e=a.map((function(t){return t.name})),n=y.map((function(t){return t.key})),Oe.a.createElement("div",{className:"lake-diagram-panel-body"},Oe.a.createElement(Ie.a,{type:"card",activeKey:m&&-1!==n.indexOf(m)?m:d.length>0&&d.every((function(t){return t.isText}))?"text":y[0].key,onChange:function(t){v(t)}},y.map((function(t){var n=t.name,a=t.menus,i=t.key;return Oe.a.createElement(ib,{tab:n,key:i},Oe.a.createElement(Te.a,{defaultActiveKey:e,expandIcon:function(t){return t.isActive?Oe.a.createElement(eb,{style:{color:"#595959"}}):Oe.a.createElement(nb,{style:{color:"#595959"}})}},a.map((function(t){return Oe.a.createElement(Te.a.Panel,{header:t.name,key:t.name,className:!0===t.hideHeader?"lake-diagram-panel-menu-hide-header":""},t.controls.map((function(t,e){return t.display&&!t.display(d)?null:Oe.a.createElement(t.Control,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ab(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ab(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({key:e,path:t.path,title:t.title,selections:d,diagram:r,onChange:g},t.props))})))}))))}))))):Oe.a.createElement("div",{className:"lake-diagram-panel-body lake-diagram-panel-body-empty"},Oe.a.createElement("div",{className:"lake-diagram-background-wrapper"},Oe.a.createElement("img",{src:o}),Oe.a.createElement("p",null,Mr("点击选中元素")),Oe.a.createElement("p",null,Mr("可设置颜色、布局、文字等样式")))))}function lb(t){var e=t.title,n=t.extra,r=t.children,a=t.disabled,i=t.onMouseDown,o=Me()("lake-diagram-control",t.className,{disabled:a});return Oe.a.createElement("div",{className:o,onMouseDown:i},e&&Oe.a.createElement("div",{className:"lake-diagram-control-head"},Oe.a.createElement("div",{className:"lake-diagram-control-title"},e),n&&Oe.a.createElement("div",{className:"lake-diagram-control-extra"},n)),r&&Oe.a.createElement("div",{className:"lake-diagram-control-body"},r))}function sb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ub(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sb(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function db(t){var e=t.zoom;t=ub(ub({},t),{},{zoomToolDOM:null});var n=function(e){var n=t,r=n.onChange,a=n.minZoom,i=n.maxZoom;e<a&&(e=a),e>i&&(e=i),r(e)},r=Oe.a.createElement(Ne.a,{className:"lake-zoom-tool-menu",onClick:function(t){var e=t.item;n(e.props.value)}},[{value:.2,title:"20%"},{value:.5,title:"50%"},{value:.75,title:"75%"},{value:1,title:"100%"},{value:1.5,title:"150%"},{value:2,title:"200%"},{value:3,title:"300%"},{value:4,title:"400%"}].map((function(t,e){return Oe.a.createElement(Ne.a.Item,{key:e,value:t.value},t.title)})));return Oe.a.createElement("div",{className:"lake-board-zoom-tool",ref:function(e){t.zoomToolDOM=e}},Oe.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-out",onClick:function(){var e=t,r=e.zoomStep,a=e.zoom;n(a-r)}}),Oe.a.createElement(De.a,{overlayClassName:"lake-board-zoom-tool-dropdown-overlay ne-ignore-pointer-events",overlay:r,placement:"bottomCenter",trigger:["click"]},Oe.a.createElement("span",{className:"lake-zoom-tool-precent"},Math.round(100*e)+"%")),Oe.a.createElement("span",{className:"lake-icon lake-icon-board-zoom-in",onClick:function(){var e=t,r=e.zoomStep,a=e.zoom;n(a+r)}}))}function hb(t){var e=t.diagram,n=Object(Ae.useState)(null),r=b()(n,2),a=r[0],i=r[1];return Object(Ae.useEffect)((function(){if(e){i(e.viewport.zoom);var t=Nt()((function(){i(e.viewport.zoom)}),32);return e.on("afterviewportchange",t),function(){e.off("afterviewportchange",t)}}}),[a,e]),e?Oe.a.createElement(db,{zoom:a,onChange:function(t){"autoFit"===t?e.viewport.autoFit():"resetView"===t?e.viewport.focusFirstRoot():e.viewport.setViewport(t)}}):Oe.a.createElement("div",null)}function fb(t){var e=t.onClose;return Oe.a.createElement(Ge.a,{className:"lake-board-iconfont-copyright-notice",title:Mr("素材版权说明"),visible:!0,centered:!0,onCancel:e,zIndex:3e3,footer:null},Oe.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-description"},Mr("所有 icon 素材均来自 iconfont 平台，仅供广大用户交流学习使用，未经 iconfont 或其关联公司书面授权许可，不得用于任何商业用途。")),Oe.a.createElement("p",{className:"lake-board-iconfont-copyright-notice-links"},Oe.a.createElement("a",{href:"https://mos.m.taobao.com/iconfont-legal-agreement?spm=a313x.7781069.0.0"},"法律声明"),Oe.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/pg3x76"},"更多说明"),Oe.a.createElement(Re.a,{type:"primary",onClick:e},"我知道了")))}function pb(){var t=Object(Ae.useState)(!1),e=b()(t,2),n=e[0],r=e[1],a=Nh()?"https://gw.alipayobjects.com/zos/bmw-prod/96082767-9c85-4ce2-86bb-e72a8be83d6a.svg":"https://gw.alipayobjects.com/zos/bmw-prod/a0598dc0-6ccd-4e13-93ef-99068cd483a9.svg";return Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-header"},Oe.a.createElement("img",{onClick:function(){window.open("https://www.iconfont.cn/","_blank")},className:"lake-board-iconfont-searcher-header-icon",src:a}),Oe.a.createElement("a",{className:"lake-board-iconfont-searcher-header-copyright",target:"_blank",href:"https://www.yuque.com/yuque/wknab3/pg3x76"}),n&&Oe.a.createElement(fb,{onClose:function(){r(!1)}}))}function mb(){return Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-container","data-testid":"lake-board-iconfont-searcher-offline"},Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-image"}),Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-offline-background-tips"},Mr("暂时无法从 iconfont 获取资源")))}function vb(){return Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-container","data-testid":"lake-board-iconfont-searcher-empty"},Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-image"}),Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-empty-background-tips"},Mr("搜索结果为空")))}cb.defaultProps={diagram:null,menus:null,tabs:null,emptyImg:"",className:""},cb.propTypes={diagram:Pe.a.object,menus:Pe.a.array,tabs:Pe.a.array,emptyImg:Pe.a.string,selections:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func,className:Pe.a.string},We("/* stylelint-disable */\n.lake-diagram-control .lake-diagram-control-extra .ant-input-number {\n  border: none;\n}\n.lake-diagram-control .lake-diagram-control-extra .lake-diagram-dropdown-input {\n  border: none;\n}\n.lake-diagram-control.disabled .lake-diagram-control-extra {\n  background-color: var(--yq-bg-secondary);\n}\n.lake-diagram-control.disabled .ant-input-number.ant-input-number-disabled {\n  background-color: var(--yq-bg-secondary);\n}\n"),Object.assign(lb,{get:function(t,e,n){var r=n;if(t.length>0)if((r=t.map((function(t){return e.split(".").reduce((function(t,e){return t?t.isCell&&t.get(e)||t[e]:t}),t)}))).every((function(t){return t===r[0]})))r=r[0];else{if(!r.every((function(t){return"number"==typeof t})))return"multiValue";r.sort(),r=r[r.length-1]}return r}}),lb.propTypes={title:Pe.a.string,extra:Pe.a.object,children:Pe.a.node,className:Pe.a.string,disabled:Pe.a.bool,onMouseDown:Pe.a.func},cb.Control=lb,We(".lake-board-zoom-tool-dropdown-overlay {\n  padding-top: 6px;\n  min-width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul {\n  list-style-type: none;\n  margin: 0;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu {\n  width: 111px;\n}\n.lake-board-zoom-tool-dropdown-overlay ul.lake-zoom-tool-menu li {\n  font-size: 12px;\n  margin-left: 0;\n  margin-top: 0;\n  margin-bottom: 0;\n  white-space: nowrap;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu {\n  border-radius: 5px;\n}\n.lake-board-zoom-tool-dropdown-overlay .ant-dropdown-menu .ant-dropdown-menu-item {\n  color: var(--yq-black);\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-board-zoom-tool {\n  display: flex;\n  align-items: center;\n  height: 100%;\n  padding: 0 4px;\n}\n.lake-board-zoom-tool .lake-icon {\n  color: var(--yq-text-primary);\n  margin-left: 2px;\n  margin-right: 2px;\n  font-size: 14px;\n  line-height: 18px;\n  width: 18px;\n  height: 18px;\n}\n.lake-board-zoom-tool .lake-icon:hover {\n  cursor: pointer;\n}\n.lake-board-zoom-tool .lake-zoom-tool-precent {\n  vertical-align: middle;\n  width: 40px;\n  line-height: 25px;\n}\n.lake-board-zoom-tool span {\n  display: inline-block;\n  padding: 0;\n  font-size: 12px;\n  height: 26px;\n  text-align: center;\n  user-select: none;\n}\n.lake-card-block-max .lake-zoom-tool {\n  margin: 8px;\n}\n"),db.defaultProps={zoom:1,onChange:function(){},minZoom:.2,maxZoom:4,zoomStep:.2},db.propTypes={zoom:Pe.a.number,onChange:Pe.a.func,minZoom:Pe.a.number,maxZoom:Pe.a.number,zoomStep:Pe.a.number,zoomToolDOM:Pe.a.element},hb.propTypes={diagram:Pe.a.object},We("/* stylelint-disable */\n.lake-board-iconfont-copyright-notice .ant-modal-close {\n  top: -8px;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header {\n  padding-top: 12px;\n  padding-bottom: 0px;\n  border-bottom: none;\n}\n.lake-board-iconfont-copyright-notice .ant-modal-header .ant-modal-title {\n  font-size: 14px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-description {\n  color: var(--yq-text-body);\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links {\n  margin-top: 24px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a:first-child {\n  padding-right: 8px;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links button {\n  float: right;\n}\n.lake-board-iconfont-copyright-notice .lake-board-iconfont-copyright-notice-links a ~ a {\n  border-left: 1px solid var(--yq-border-primary);\n  padding: 0 8px;\n}\n"),We('/* stylelint-disable */\n.lake-board-iconfont-searcher-header {\n  height: 44px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 0 16px;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-icon {\n  cursor: pointer;\n}\n.lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/c50d07f1-891a-4dea-84f7-0c08fd92bc6a.svg);\n}\n[data-kumuhana="pouli"] .lake-board-iconfont-searcher-header .lake-board-iconfont-searcher-header-copyright {\n  filter: invert(100%);\n}\n'),We("/* stylelint-disable */\n.lake-board-iconfont-searcher-offline-container {\n  height: 256px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-image {\n  width: 70px;\n  height: 59px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/82cfa582-d999-4c73-bfbe-5b9945af9726.svg);\n  background-position: center;\n  margin-top: 48px;\n  margin-bottom: 24px;\n}\n.lake-board-iconfont-searcher-offline-container .lake-board-iconfont-searcher-offline-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),We("/* stylelint-disable */\n.lake-board-iconfont-searcher-empty-container {\n  height: 212px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  align-content: start;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-image {\n  width: 100px;\n  height: 68px;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/80736e19-e03c-44c7-9223-1d67449e98cf.svg);\n  background-position: center;\n  margin-top: 40px;\n  margin-bottom: 15px;\n}\n.lake-board-iconfont-searcher-empty-container .lake-board-iconfont-searcher-empty-background-tips {\n  color: var(--yq-text-disable);\n  width: 100%;\n  text-align: center;\n}\n"),We("/* stylelint-disable */\n.lake-board-iconfont-searcher-container {\n  width: 230px;\n  height: 300px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content {\n  border-top: 1px solid var(--yq-border-primary);\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-search-input-container {\n  width: calc(100% - 16px);\n  margin: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list {\n  height: 200px;\n  display: flex;\n  flex-wrap: wrap;\n  align-content: flex-start;\n  overflow: auto;\n  margin-left: 8px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container {\n  display: inline-block;\n  margin-right: 4px;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container .lake-board-iconfont-searcher-content-list-item-img {\n  width: 16px;\n  height: 16px;\n  background-position: center;\n  margin: 8px;\n  background-repeat: no-repeat;\n}\n.lake-board-iconfont-searcher-container .lake-board-iconfont-searcher-content .lake-board-iconfont-searcher-content-list .lake-board-iconfont-searcher-content-list-item-container:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n");var yb={};function gb(t){var e=function(t){var e=t.diagram,n=t.onSelect,r=Object(Ae.useState)([]),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)(!0),l=b()(c,2),s=l[0],u=l[1];function d(){return(d=dt()(ft.a.mark((function e(n,r){var a,i,c,l,s,u,d,h,f;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=yb.data,i=yb.keyword,c=yb.count,l=yb.page,s=t.boardWebProxy,a&&l&&i&&null!=s&&s.iconfont&&c){e.next=4;break}return e.abrupt("return");case 4:if(!((u=(null==a?void 0:a.length)||0)>=c)){e.next=7;break}return e.abrupt("return");case 7:if(!(u/6*32-r<=1.5*n)){e.next=14;break}return d=l+1,e.next=12,s.iconfont.search({keyword:i,page_size:100,page:d});case 12:(h=e.sent)&&(f=a.concat(h.data),o(f),yb.data=f,yb.page=d);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(t){return f.apply(this,arguments)}function f(){return(f=dt()(ft.a.mark((function e(n){var r,a,i;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.boardWebProxy).iconfont){e.next=13;break}return a=1,e.next=5,r.iconfont.search({keyword:n,page_size:100,page:a});case 5:if(!(i=e.sent)){e.next=13;break}return o(i.data),yb.page=a,yb.count=i.count,yb.data=i.data,yb.keyword=n,e.abrupt("return");case 13:o([]);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=dt()(ft.a.mark((function t(r){var a,i,o,c,l;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.svg,i=fl(a),t.next=4,Ci(i);case 4:return o=t.sent,t.next=7,fetch(i).then((function(t){return t.blob()}));case 7:c=t.sent,l=new File([c],"iconfont.svg",{type:"image/svg+xml"}),e.command.execute("BeginInsertImage",{model:{image:{src:i,naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight},width:32,height:32},files:[l]}),n&&n();case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(){return(m=dt()(ft.a.mark((function t(){return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h("");case 2:u(!1);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var v=Nt()(h,200);return Object(Ae.useEffect)((function(){e&&function(){m.apply(this,arguments)}()}),[e]),{state:{data:i,loading:s},onSearch:function(t){Object.assign(yb,{data:void 0,keyword:void 0,count:void 0,page:void 0}),v(t)},onItemClick:function(t){return p.apply(this,arguments)},onListScroll:Nt()((function(t,e){return d.apply(this,arguments)}),200)}}(t);return Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-container"},Oe.a.createElement(pb,null),function(t){var e,n=t.state,r=n.data,a=n.loading;return r?(a||(e=Array.isArray(r)&&0===r.length?Oe.a.createElement(vb,null):function(t){var e=t.state.data;return Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list",onScroll:function(e){t.onListScroll(e.target.offsetHeight,e.target.scrollTop)}},Array.isArray(e)&&e.map((function(e,n){var r=e.svg;return Oe.a.createElement("div",{"data-testid":"lake-board-iconfont-searcher-content-list-item-".concat(n),onClick:function(){null==t||t.onItemClick(e)},key:n,className:"lake-board-iconfont-searcher-content-list-item-container"},Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-content-list-item-img",style:{backgroundImage:"url(".concat(fl(r),")")}}))})))}(t)),Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-content"},Oe.a.createElement("div",{className:"lake-board-iconfont-searcher-search-input-container","data-testid":"lake-board-iconfont-searcher-search-input-container"},Oe.a.createElement(_e.a,{onCompositionEnd:function(e){t.onSearch(e.target.value)},placeholder:Mr("请搜索"),maxLength:50,prefix:Oe.a.createElement(rb,null),onInput:function(e){e.nativeEvent.isComposing||t.onSearch(e.target.value)}})),e)):Oe.a.createElement(mb,null)}(e))}We("/* stylelint-disable */\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header {\n  padding: 10px 16px;\n  padding-bottom: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-board-theme-picker-header-title {\n  font-size: 14px;\n  color: var(--yq-text-primary);\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert {\n  margin-left: 4px;\n}\n.lake-board-toolbard-theme-picker-outer-container .lake-board-theme-picker-header .lake-icon-alert:hover {\n  cursor: pointer;\n}\n.lake-board-theme-picker-header-help-tips {\n  font-size: 14px;\n  max-width: 212px;\n}\n"),We("/* stylelint-disable */\n.lake-board-theme-picker-container {\n  width: 230px;\n  overflow: auto;\n  padding: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-content: flex-start;\n  padding-bottom: 6px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container {\n  border-radius: 4px;\n  outline: 1px solid #d8d8d8;\n  width: 98px;\n  height: 64px;\n  margin-bottom: 12px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-title {\n  font-size: 14px;\n  width: 82px;\n  height: 18px;\n  margin: 4px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container .lake-board-theme-picker-item-cover {\n  background-position: center;\n  background-repeat: no-repeat;\n  width: 86px;\n  height: 18px;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container.lake-board-theme-picker-item-container-selected {\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:hover {\n  cursor: pointer;\n  outline: 1px solid #1672f3;\n}\n.lake-board-theme-picker-container .lake-board-theme-picker-item-container:nth-child(odd) {\n  margin-right: 10px;\n}\n");var bb=Mr("未命名"),xb=[{cover:"https://gw.alipayobjects.com/zos/bmw-prod/1b30aa39-33a1-4d27-b4c7-9e1e0b5ac1f1.svg",theme:"default",backgroundColor:"white",titleFontColor:"#262626",title:Mr("浅色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/ce15e90d-b07e-4da5-9dce-3f7b126c6015.svg",theme:"dark",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:Mr("暗色风")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/db33a600-59c1-4ec2-b0e6-ad9b6953194c.svg",theme:"colorful_kano",backgroundColor:"white",titleFontColor:"#262626",title:Mr("多彩卡诺")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/59d288e4-280f-48d1-9940-a3e0ba0e5ce7.svg",theme:"van_cogh_starry_sky",backgroundColor:"rgba(41, 41, 41, 0.96)",titleFontColor:"rgba(255, 255, 255, 0.88)",title:Mr("星空")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/a3c840a3-63a0-4d11-9dca-de8cdb3572eb.svg",theme:"iris",backgroundColor:"#F3F3F6",titleFontColor:"#163866",title:Mr("鸢尾花")},{cover:"https://gw.alipayobjects.com/zos/bmw-prod/60a05954-c6d0-41ab-8899-3e63f09c63c8.svg",theme:"wuxia_qingqiu",backgroundColor:"#FAF5EC",titleFontColor:"#5B4E26",title:Mr("巫峡清秋")}];function kb(t){var e=s()(xb);return e.forEach((function(e){e.cover=e.cover||"https://gw.alipayobjects.com/zos/bmw-prod/9ad1c2ce-f565-421b-a867-fb9c5ef1206b.svg",e.title=e.title||bb,e.theme===t&&(e.selected=!0)})),e}function wb(t){var e=t.className,n=function(t){var e,n=t.diagram,r=t.data,a=t.sourceTheme,i=Object(Ae.useState)(kb((null==n||null===(e=n.theme)||void 0===e?void 0:e.name)||"default")),o=b()(i,2),c=o[0],l=o[1];function s(t){var e=t.commandName;["SetTheme","Undo","Redo"].includes(e)&&l(kb(n.theme.name))}return Object(Ae.useEffect)((function(){if(n)return n.on("aftercommandexecute",s),function(){n.off("aftercommandexecute",s)}}),[n]),{onItemClick:function(t){n&&n.command.execute("SetTheme",{name:t.theme}),n&&n.hooks.decorateNonMindmapCellModels.call(r,a)},state:{items:c}}}(t),r=n.state.items;return Oe.a.createElement("div",{className:Me()("lake-board-theme-picker-container",e)},r.map((function(t,e){var r=t.cover,a=t.title,i=t.selected,o=t.backgroundColor,c=t.titleFontColor,l=i?"lake-board-theme-picker-item-container-selected":null,s={},u={};return o&&(s.backgroundColor=o),c&&(u.color=c),Oe.a.createElement("div",{className:Me()("lake-board-theme-picker-item-container",l),key:e,style:s,onClick:function(){n.onItemClick(t)}},Oe.a.createElement("div",{className:"lake-board-theme-picker-item-title",style:u},a),Oe.a.createElement("div",{className:"lake-board-theme-picker-item-cover",style:{backgroundImage:"url(".concat(r,")")}}))})))}function Cb(t){var e=st()(t).toRgb(),n=e.r,r=e.g,a=e.b;return e.a,st()("rgb(".concat(n,", ").concat(r,", ").concat(a,")")).toHexString()}function Ab(t){var e=function(t){var e=t.diagram,n=t.popoverVisible,r=Object(Ae.useState)([]),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)("default"),l=b()(c,2),s=l[0],u=l[1];return Object(Ae.useEffect)((function(){!function(){if(!e.destroyed&&n){var t=e.getCells().filter((function(t){return vr(t)||sr(t)||br(t)||xr(t)||yr(t)||gr(t)||wr(t)||dr(t)||hr(t)})),r=[];t.forEach((function(t){t.fill&&"transparent"!==t.fill.color&&"rgba(0,0,0,0)"!==t.fill.color&&r.push({id:t.model.id,type:"fill",color:Cb(t.fill.color),alpha:st()(t.fill.color).getAlpha()}),t.stroke&&"transparent"!==t.stroke.color&&"rgba(0,0,0,0)"!==t.stroke.color&&r.push({id:t.model.id,type:"stroke",color:Cb(t.stroke.color),alpha:st()(t.stroke.color).getAlpha()})})),o(r),u(e.theme.name)}}()}),[e,n]),{state:{data:i,sourceTheme:s}}}(t).state;return Oe.a.createElement("div",{className:Me()("lake-board-toolbard-theme-picker-outer-container")},Oe.a.createElement("div",{className:Me()("lake-board-theme-picker-header")},Oe.a.createElement("span",{className:Me()("lake-board-theme-picker-header-title")},Mr("主题配色")),Oe.a.createElement(je.a,{title:Oe.a.createElement("div",{className:Me()("lake-board-theme-picker-header-help-tips")},Mr("切换主题时会对画布上已有图形生效，  \n          ⌘/Ctrl+Z 可撤销")),open:!0})),Oe.a.createElement(wb,Ce()({},t,e)))}function Ob(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}We("/* stylelint-disable */\n.lake-board-rough-setting-container {\n  padding: 10px 16px;\n  padding-bottom: 0px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title {\n  font-size: 14px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-open-switch-container .lake-board-rough-setting-title .lake-icon-question {\n  color: inherit;\n}\n.lake-board-rough-setting-container .lake-diagam-rough-setting-switch {\n  float: right;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas {\n  border-radius: 4px;\n  border: 1px solid rgba(0, 0, 0, 0);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas:hover {\n  cursor: pointer;\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container canvas.lake-diagram-rough-setting-fill-style-selected {\n  border: 1px solid var(--yq-blue-6);\n}\n.lake-board-rough-setting-container .lake-board-rough-setting-fill-style-container.disable canvas:hover {\n  cursor: not-allowed;\n}\n");var Eb=["hachure","cross-hatch","solid"];function Pb(t){return"default"!==(null==t?void 0:t.rough.name)}function Sb(t){var e=t.diagram,n=Object(Ae.useState)(Pb(e)),r=b()(n,2),a=r[0],i=r[1],o=Object(Ae.useState)(null==e?void 0:e.rough.name),l=b()(o,2),s=l[0],u=l[1],d=Object(Ae.useRef)(null);function h(t){["SetRough","Undo","Redo"].includes(t.commandName)&&(i(Pb(e)),u(null==e?void 0:e.rough.name))}return Object(Ae.useEffect)((function(){if(e)return e.on("aftercommandexecute",h),function(){e.off("aftercommandexecute",h)}}),[e]),Object(Ae.useEffect)((function(){var t=d.current;if(t){!function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(t);var n=Nh()?Wr:Xr;Eb.forEach((function(r){var i={fillStyle:r};"solid"===r?(i.roughness=0,i.fill=a?n.roughIconSolidfill:n.roughIconSolidDisablefill):"hachure"===r?i.fill=a?n.roughIconHachurefill:n.roughIconHachureDisablefill:"cross-hatch"===r&&(i.fill=a?n.roughIconCrossHatchfill:n.roughIconCrossHatchDisablefill);var o=function(t){var e=document.createElement("canvas"),n=gt.a.canvas(e);return e.width=122,e.height=40,e.style.width="".concat(61,"px"),e.style.height="".concat(20,"px"),n.rectangle(0,0,122,40,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ob(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ob(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({seed:20,stroke:"none",hachureGap:12},t)),e}(i);s===r&&a&&o.classList.add("lake-diagram-rough-setting-fill-style-selected"),a&&o.addEventListener("click",(function(){(null==e?void 0:e.rough.name)!==r&&e.command.execute("SetRough",{name:r})})),t.appendChild(o)}))}}),[d,s,a]),Oe.a.createElement("div",{className:Me()("lake-board-rough-setting-container")},Oe.a.createElement("p",{className:Me()("lake-board-rough-setting-open-switch-container")},Oe.a.createElement("span",{className:"lake-board-rough-setting-title"},Mr("手绘风格")," ",Oe.a.createElement("a",{className:Me()("lake-icon","lake-icon-question"),href:"https://www.yuque.com/yuque/wknab3/nu8ptz",target:"_blank"})),Oe.a.createElement(Xe.a,{size:"small",checked:!!a,onChange:function(t){var n;n=t?"default"!==s?s:"hachure":"default",e.command.execute("SetRough",{name:n})},className:"lake-diagam-rough-setting-switch"})),Oe.a.createElement("div",{ref:d,className:Me()("lake-board-rough-setting-fill-style-container",{disable:!a})}))}var Mb=r.FileUtils.isImage;function jb(t,e){var n=Array.from(t.nativeEvent.target.files).filter((function(t){return Mb(t)}));n[0]&&e.emit("importimage",{files:n,from:"uploadButton"})}function Rb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rb(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Bb(t){return t.overlay?t.overlay({onSelect:t.onSelect,setPopoverVisible:t.setPopoverVisible,popoverVisible:t.popoverVisible}):Oe.a.createElement(Ne.a,{onClick:t.onSelect,className:Me()("lake-diagram-board-toolbar-menu",t.menuClassName)},t.data.map((function(t){return Oe.a.createElement(Ne.a.Item,{key:t.key,style:{marginTop:"2px"}},Oe.a.createElement("div",{className:"lake-icon lake-icon-".concat(t.icon)}))})))}function Db(t){var e=t.name,n=t.icon,r=t.tooltipPlacement,a=t.popoverPlacement,i=t.defaultKey,o=t.data,c=t.titleTag,l=t.shouldClickUpdateOverlay,s=t.className,u=Object(Ae.useState)(i),d=b()(u,2),h=d[0],f=d[1],p=o&&o.find((function(t){return t.key===h})),m=Object(Ae.useState)(!1),v=b()(m,2),y=v[0],g=v[1],x=Object(Ae.useState)(!1),k=b()(x,2),w=k[0],C=k[1];function A(e){var n=e.key;f(n),C(!1),t.onSelect&&t.onSelect({key:n})}function O(){return Bb(Lb(Lb({},t),{},{onSelect:A,setPopoverVisible:C,popoverVisible:w}))}var E=Object(Ae.useState)(O()),P=b()(E,2),S=P[0],M=P[1];return Object(Ae.useEffect)((function(){M(O())}),[w]),Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-command"},Oe.a.createElement(Fe.a,{overlayClassName:"lake-diagram-board-toolbar-popover",content:S,trigger:"click",placement:"".concat(a),visible:w,onVisibleChange:function(){return C(!w)}},Oe.a.createElement(je.a,{visible:y,placement:r,overlayClassName:Me()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===r}),title:c},Oe.a.createElement(Re.a,{className:s,"data-testid":e,onClick:function(){g(!1),C(!w),l&&M(O()),t.onClick&&t.onClick({key:h,popoverVisible:w})},onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}},function(t){return"string"==typeof t?Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t||p.icon)}):t}(n)))))}function Nb(t){var e=t.name,n=t.icon,r=t.accept,a=t.disabled,i=t.title,o=t.tooltipPlacement,c=t.onChange,l=t.titleTag,s=Object(Ae.useRef)();return Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-command","data-testid":e},Oe.a.createElement(je.a,{disabled:a||!i,placement:o,title:l,overlayClassName:Me()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===o})},Oe.a.createElement(Re.a,{className:"lake-diagram-board-toolbar-upload",onClick:function(){s.current.value="",s.current.click()},disabled:a},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),Oe.a.createElement("input",{type:"file",accept:r,onChange:c,ref:s}))))}function _b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ib(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_b(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Tb(t){var e=t.name,n=t.titleTag,r=t.title,a=t.hotkey,i=t.label,o=t.tooltipPlacement,c=t.disabled,l=t.diagram,s=t.defaultKey,u=t.active,d=Object.keys(t).reduce((function(e,n){return n.startsWith("data-")&&(e[n]=t[n]),e}),{}),h="string"==typeof t.icon?Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon)}):t.icon;return Oe.a.createElement("div",Ce()({className:"lake-diagram-board-toolbar-command","data-testid":e},d),Oe.a.createElement(je.a,{disabled:c||!(r||a),placement:o,title:n,overlayClassName:Me()({"lake-diagram-board-toolbar-tooltip-overlay":"right"===o})},Oe.a.createElement(Re.a,{onClick:function(e){e.stopPropagation(),t.onClick?t.onClick({key:s}):t.execCommand&&t.execCommand(l)},disabled:c,className:Me()({"lake-button-active":u})},h,i&&Oe.a.createElement("span",{className:"lake-diagram-board-toolbar-command-label"},i))))}function Fb(t){var e=t.speratorAlignment,n=t.tooltipPlacement,r=t.title,a=t.hotkey,i=t.diagram,o=t.className,c=t.disabled,l=t.active;c="function"==typeof c?c(i):c,l="function"==typeof l?l(i):l;var s=Ib(Ib({},t),{},{disabled:c,active:l,className:o}),u="bottom"===n?Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r),a&&Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-hotkey"},a)):Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip"},r&&Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-tooltip-title"},r,a&&Oe.a.createElement("span",{className:"lake-diagram-board-toolbar-popover-shortcut"},a)));switch(t.type){case"separator":return Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-".concat(e,"-separator")});case"popover":return Oe.a.createElement(Db,Ce()({},s,{titleTag:u}));case"upload":return Oe.a.createElement(Nb,Ce()({},s,{titleTag:u}));case"custom":return t.component;default:return Oe.a.createElement(Tb,Ce()({},s,{titleTag:u}))}}function zb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zb(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}We("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-board-toolbar-popover .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-btn.ant-dropdown-trigger:hover {\n  background: var(--yq-border-primary);\n  border-radius: 2px;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-board-toolbar-popover .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-popover-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n  border-radius: 3px;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-board-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-board-toolbar-menu.ant-menu {\n  width: 38px;\n  padding-top: 3px;\n  padding-bottom: 3px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item {\n  padding: 0 5px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  width: 28px;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 28px;\n  line-height: 32px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-board-toolbar-menu.ant-menu .ant-menu-item-selected {\n  background-color: transparent;\n}\n"),Bb.propTypes={data:Pe.a.array,overlay:Pe.a.node,onSelect:Pe.a.func,menuClassName:Pe.a.string},Db.defaultProps={popoverPlacement:"rightTop"},Db.propTypes={command:Pe.a.string,name:Pe.a.string,icon:Pe.a.oneOfType([Pe.a.string,Pe.a.element]),overlay:Pe.a.func,onSelect:Pe.a.func,onClick:Pe.a.func,execCommand:Pe.a.func,defaultKey:Pe.a.string,data:Pe.a.array,tooltipPlacement:Pe.a.string,popoverPlacement:Pe.a.string,diagram:Pe.a.object,titleTag:Pe.a.object,shouldClickUpdateOverlay:Pe.a.bool,className:Pe.a.string},We(".lake-diagram-board-toolbar-upload {\n  position: relative;\n}\n.lake-diagram-board-toolbar-upload input {\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display: none;\n}\n"),Nb.propTypes={name:Pe.a.string,icon:Pe.a.string,accept:Pe.a.string,disabled:Pe.a.bool,title:Pe.a.string,onChange:Pe.a.func,diagram:Pe.a.object,tooltipPlacement:Pe.a.string,titleTag:Pe.a.object},We(".lake-diagram-board-toolbar-tooltip-overlay .ant-tooltip-content {\n  padding-left: 4px;\n}\n"),Tb.propTypes={disabled:Pe.a.bool,active:Pe.a.bool,name:Pe.a.string,title:Pe.a.string,hotkey:Pe.a.string,titleTag:Pe.a.object,type:Pe.a.string,icon:Pe.a.oneOfType([Pe.a.string,Pe.a.object]),label:Pe.a.string,command:Pe.a.string,onClick:Pe.a.func,execCommand:Pe.a.func,diagram:Pe.a.object,tooltipPlacement:Pe.a.string,defaultKey:Pe.a.string},Fb.propTypes={type:Pe.a.string,component:Pe.a.object,speratorAlignment:Pe.a.string,tooltipPlacement:Pe.a.string,title:Pe.a.string,hotkey:Pe.a.string,disabled:Pe.a.oneOfType([Pe.a.bool,Pe.a.func]),active:Pe.a.oneOfType([Pe.a.bool,Pe.a.func]),diagram:Pe.a.object,className:Pe.a.string},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-side-toolbar:empty {\n  display: none;\n}\n.lake-diagram-board-top-toolbar {\n  position: absolute;\n  top: 10px;\n  left: 0;\n  right: 0;\n  z-index: 1;\n  padding-left: 8px;\n  padding-right: 16px;\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  pointer-events: none;\n}\n.lake-diagram-board-top-toolbar > div {\n  pointer-events: auto;\n}\n.lake-diagram-board-top-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 8px;\n  margin-right: 8px;\n  height: 100%;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-top-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-left {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-board-toolbar-right {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n.lake-diagram-board-side-toolbar {\n  position: absolute;\n  width: 40px;\n  left: 16px;\n  height: 100%;\n  z-index: 1;\n  display: flex;\n  align-content: center;\n  pointer-events: none;\n}\n.lake-diagram-board-side-toolbar-body {\n  display: flex;\n  align-items: center;\n  flex-flow: column;\n  margin: auto;\n  pointer-events: initial;\n  padding: 4px 0;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-side-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-board-toolbar-vertical-separator {\n  width: 1px;\n  height: 60%;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-horizontal-separator {\n  height: 1px;\n  margin-top: 4px;\n  margin-bottom: 4px;\n  width: calc(100% - 16px);\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-horizontal-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-toolbar-command .ant-btn {\n  border: none;\n  padding: 0 5px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  width: 32px;\n  margin-left: 3px;\n  margin-right: 3px;\n  color: var(--yq-text-primary);\n  vertical-align: middle;\n  border-radius: 6px;\n  background-color: transparent;\n}\n.lake-diagram-board-toolbar-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn:hover,\n.lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-board-toolbar-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-board-toolbar-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-board-toolbar-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-board-toolbar-command .ant-btn .lake-icon {\n  font-size: 18px;\n  margin: 0;\n}\n.lake-diagram-board-toolbar-command .lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-board-toolbar-command-label {\n  font-size: 12px;\n  display: inline-block;\n  margin-left: 0.25em;\n}\n.lake-diagram-board-toolbar-tooltip {\n  text-align: center;\n  font-size: 12px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey {\n  color: var(--yq-text-caption);\n  margin-top: 4px;\n}\n.lake-diagram-board-toolbar-tooltip .lake-diagram-board-toolbar-tooltip-hotkey:first-child {\n  margin-top: 0;\n}\n.lake-diagram-board-toolbar-popover-shortcut {\n  font-size: 12px;\n  color: #d8dad9;\n  padding-left: 4px;\n}\n");var Yb="top-left",Hb="top-right",Gb="left-middle";function Xb(t){var e=t.items,n=t.tooltipPlacement,r=t.className,a=t.diagram;return Oe.a.createElement("div",{className:r},e.map((function(e,r){return Oe.a.createElement(Fb,Ce()({key:"".concat(e.name||e.type,"-").concat(r),execCommand:e.execCommand,tooltipPlacement:n,diagram:a},e,t,{className:e.className}))})))}function Wb(t){var e=t.items,n={placement:Yb,tooltipPlacement:"bottom",speratorAlignment:"vertical",className:"lake-diagram-board-top-toolbar-body"},r=function(n){return(r=n.placement,e.reduce((function(t,e){return e.align===r&&t.push(e.subItems),t}),[])).map((function(e,r){return Oe.a.createElement(Xb,{key:r,items:e,tooltipPlacement:n.tooltipPlacement,speratorAlignment:n.speratorAlignment,className:n.className,diagram:t.diagram})}));var r};return Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement("div",{className:Me()("lake-diagram-board-top-toolbar",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-left"},r(n)),Oe.a.createElement("div",{className:"lake-diagram-board-toolbar-right"},r(qb(qb({},n),{},{placement:Hb})))),Oe.a.createElement("div",{className:Me()("lake-diagram-board-side-toolbar",t.className),"data-lake_prevent_click_unselect":"true"},r(qb(qb({},n),{},{placement:Gb,tooltipPlacement:"right",speratorAlignment:"horizontal",className:"lake-diagram-board-side-toolbar-body"}))))}Xb.defaultProps={items:[]},Xb.propTypes={items:Pe.a.array,tooltipPlacement:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object},Wb.defaultProps={items:[]},Wb.propTypes={className:Pe.a.string,items:Pe.a.array,execCommand:Pe.a.func,diagram:Pe.a.object},Wb.Control=Fb,We(".ne-embed-icon {\n  display: inline-flex;\n  width: 16px;\n  height: 16px;\n}\n");var Vb=function(t){S()(n,Ae.Component);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L()(t);if(e){var a=L()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return j()(this,n)}}(n);function n(){return m()(this,n),e.apply(this,arguments)}return y()(n,[{key:"_isLowContrast",value:function(t){var e=st()(t).toRgb();return.3*e.r+.59*e.g+.11*e.b>=248}},{key:"_isTransparent",value:function(t){return!t||"transparent"===t||"rgba(255,255,255,0)"===t.replace(/ /g,"")||"rgba(0,0,0,0)"===t.replace(/ /g,"")}},{key:"requireStroke",value:function(t){return this._isTransparent(t)||this._isLowContrast(t)}},{key:"render",value:function(){return this._getIcon()}},{key:"_getIcon",value:function(){var t,e=this.props,n=e.type,r=e.fill,a=e.stroke,i=e.strokeWidth,o=e.pen;if(this._isTransparent(r))return Oe.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Oe.a.createElement("defs",null,Oe.a.createElement("pattern",{id:"rect",viewBox:"0,0,8,8",width:"35%",height:"35%"},Oe.a.createElement("rect",{id:"矩形",fill:"#FAFAFA",x:"0",y:"0",width:"4",height:"4"}),Oe.a.createElement("rect",{id:"矩形备份-21",fill:"#FAFAFA",x:"4",y:"4",width:"4",height:"4"}),Oe.a.createElement("rect",{id:"矩形备份-20",fill:"#D9D9D9",x:"4",y:"0",width:"4",height:"4"}),Oe.a.createElement("rect",{id:"矩形备份-22",fill:"#D9D9D9",x:"0",y:"4",width:"4",height:"4"}))),Oe.a.createElement("circle",{cx:"8",cy:"8",r:"8",fill:"url(#rect)"}));if("stroke-color"===n&&this._isTransparent(a))return Oe.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Oe.a.createElement("title",null,"透明环"),Oe.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"0.5",fill:"none",fillRule:"evenodd"},Oe.a.createElement("g",{id:"透明环",transform:"translate(-0.000000, 0.000000)"},Oe.a.createElement("path",{d:"M8,0 C12.418278,0 16,3.581722 16,8 C16,12.418278 12.418278,16 8,16 C3.581722,16 0,12.418278 0,8 C0,3.581722 3.581722,0 8,0 Z M8,3 C5.23857625,3 3,5.23857625 3,8 C3,10.7614237 5.23857625,13 8,13 C10.7614237,13 13,10.7614237 13,8 C13,5.23857625 10.7614237,3 8,3 Z",id:"形状",fill:"#FAFAFA"}),Oe.a.createElement("path",{d:"M8,13 L8,12.999 L8,16 C6.91549955,16 5.88140117,15.7842031 4.93830231,15.3932066 L6.08631593,12.6207031 C6.67578581,12.8651081 7.32214006,13 8,13 Z M11.5247537,11.5462815 L13.6458509,13.6678364 C12.905585,14.4052487 12.0216994,14.9985887 11.0398062,15.4022444 L9.89058451,12.6302127 C10.5062584,12.3785637 11.0605479,12.0076869 11.5247537,11.5462815 Z M4.48114009,11.5521301 L2.36015992,13.6738177 C1.61882513,12.9368948 1.02109994,12.0556625 0.612650477,11.075787 L3.38472128,9.92671467 C3.64106728,10.5400536 4.01611047,11.091429 4.48114009,11.5521301 Z M16,7.999 C16,9.08450045 15.7842031,10.1185988 15.3932066,11.0616977 L12.6207031,9.91368407 C12.8651081,9.32421419 13,8.67785994 13,8 L16,7.999 Z M3,8 L2.999,8 L4.45652404e-11,8 C4.45652404e-11,6.91549955 0.215796936,5.88140117 0.606793361,4.93830231 L3.37929685,6.08631593 C3.13489185,6.67578581 3,7.32214006 3,8 Z M13.6398401,2.32618229 C14.3811749,3.06310522 14.9789001,3.94433749 15.3873495,4.92421296 L12.6152787,6.07328533 C12.3589327,5.45994637 11.9838895,4.90857096 11.5188599,4.44786988 L13.6398401,2.32618229 Z M8,9.09494702e-13 C9.0848864,9.09494702e-13 10.1193348,0.215950555 11.0627045,0.607210861 L9.91368407,3.37929685 C9.32421419,3.13489185 8.67785994,3 8,3 L7.999,9.09494702e-13 L8,9.09494702e-13 Z M2.37521442,2.31125673 C2.36817981,2.31821274 2.36115804,2.32518171 2.35414914,2.33216359 C2.47280694,2.21398682 2.594547,2.10004476 2.71975554,1.98995348 L2.91043586,1.82748893 C3.08291716,1.68509277 3.26177813,1.54957175 3.44628096,1.42161318 L3.44587689,1.42189343 C3.64121394,1.28642097 3.84244471,1.15967042 4.04944431,1.04189047 L4.04893797,1.04217859 L4.35587152,0.876283146 L4.35587152,0.876283146 L4.67022901,0.723755702 L4.96019384,0.597755619 L6.10941549,3.36978734 L6.08230453,3.38096211 C6.01729624,3.40798236 5.95298109,3.43633501 5.88939319,3.46598597 L6.10941549,3.36978734 C6.00994969,3.41044274 5.91208604,3.45421002 5.81594555,3.50096817 C5.67093771,3.57146782 5.52925326,3.64913643 5.39194239,3.73324727 C5.36336599,3.75074884 5.33464738,3.76874189 5.30612657,3.78701662 C5.2498994,3.8230481 5.19464208,3.86003397 5.14017772,3.89807688 C5.13087827,3.90457251 5.12161081,3.91109266 5.11236658,3.91764341 C5.0411436,3.96811355 4.9712726,4.02042159 4.90284866,4.07448042 C4.89157281,4.08338639 4.8797933,4.09277659 4.86805733,4.10221872 C4.81544399,4.14455883 4.76415727,4.18754838 4.71376093,4.2315324 C4.69109675,4.25131063 4.66840717,4.2714759 4.64590384,4.29184316 L4.61016998,4.32449924 L4.61016998,4.32449924 L4.47532075,4.45364446 L4.47532075,4.45364446 L2.35414914,2.33216359 L2.359,2.326 L2.36467214,2.32170046 L2.361,2.325 Z",id:"形状结合",fill:"#D9D9D9"}))));var c=this._isLowContrast(a)?"#e8e8e8":a;switch(n){case"t-font-color":t=function(t){return Oe.a.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18"},Oe.a.createElement("title",null,"color-font"),Oe.a.createElement("desc",null,"Created with Sketch."),Oe.a.createElement("g",{id:"color-font",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Oe.a.createElement("rect",{fill:t,id:"Rectangle-55",stroke:"none",strokeWidth:"1",x:"2",y:"13.75",width:"12",height:"1.5",rx:"0.125"}),Oe.a.createElement("path",{d:"M5.29102819,11.25 L3.96365715,11.25 C3.87952002,11.25 3.8113134,11.1817934 3.8113134,11.0976562 C3.8113134,11.08076 3.81412419,11.0639814 3.81963067,11.0480076 L7.0756112,1.60269506 C7.09679504,1.5412426 7.15463644,1.5 7.21963767,1.5 L8.81868806,1.5 C8.883726,1.5 8.94159158,1.54128846 8.96274706,1.60278951 L12.2118,11.048102 C12.239168,11.1276636 12.1968568,11.2143472 12.1172952,11.2417152 C12.1013495,11.2472004 12.0846037,11.25 12.067741,11.25 L10.6761419,11.25 C10.6099165,11.25 10.5512771,11.2072154 10.531066,11.1441494 L9.69970662,8.55 L6.27433466,8.55 L5.43599205,11.1444975 C5.41567115,11.2073865 5.35711879,11.25 5.29102819,11.25 Z M8.02635163,3.18571429 L7.96199183,3.18571429 L6.63904023,7.30714286 L9.33500105,7.30714286 L8.02635163,3.18571429 Z",id:"A",fill:"#595959"})))}(r);break;case"t-bg-color":t=function(t,e){return Oe.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Oe.a.createElement("g",{id:"控件",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Oe.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/背景色",transform:"translate(-5.000000, -6.000000)"},Oe.a.createElement("g",{id:"编组-9",transform:"translate(-1.000000, 0.000000)"},Oe.a.createElement("mask",{id:"mask-2",fill:"black"},Oe.a.createElement("use",{xlinkHref:"#path-1"})),Oe.a.createElement("circle",{fill:t,stroke:e,strokeWidth:"1",cx:"14",cy:"14",r:"7.5"})))))}(r,a);break;case"stroke-color":t=function(t,e){return Oe.a.createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1"},Oe.a.createElement("title",null,"编组 10"),Oe.a.createElement("g",{id:"控件",stroke:"none",fill:"none",fillRule:"evenodd"},Oe.a.createElement("g",{id:"Z图标/2.编辑器/2.格式/描边",transform:"translate(-6.000000, -8.000000)"},Oe.a.createElement("g",{id:"编组-10",transform:"translate(6.000000, 8.000000)"},Oe.a.createElement("circle",{id:"椭圆形",stroke:e,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"3"})),Oe.a.createElement("g",{id:"编组-11",transform:"translate(6.000000, 8.000000)"},Oe.a.createElement("circle",{id:"椭圆形2",stroke:t,fill:"none",cx:"8",cy:"8",r:"6.5",strokeWidth:"1"})))))}(a,c);break;case"properties-cb-trans":t=Oe.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"context-cb-trans":t=Oe.a.createElement("svg",{width:"30",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("path",{d:"M0 30L30 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"}));break;case"freehand-stroke":t=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e="#b3b3b3";return"pencil"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pencil")?Oe.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("path",{d:"M16.2475842,16.3512937 L16.0279135,16.3959976 L15.8755758,16.4439378 L15.8755758,16.4439378 L15.6885047,16.5214086 L15.5037725,16.6091468 L15.1502378,16.7917247 L14.1582912,17.3270847 C12.5308696,18.169164 11.3207925,18.3244874 10.2613836,17.253022 C9.07268531,16.050796 9.45279022,14.0280592 11.1264226,11.012497 L11.4449119,10.4532344 C11.5557853,10.2631412 11.6713488,10.0693629 11.7915409,9.87186119 L12.1659422,9.26814722 C12.4768539,8.77557644 13.1282051,8.62831267 13.6207759,8.93922439 C14.1133467,9.2501361 14.2606104,9.90148735 13.9496987,10.3940581 L13.606469,10.9483066 L13.2933472,11.4749154 L13.1478871,11.7277362 L13.1478871,11.7277362 L12.8787892,12.2121732 L12.7549996,12.4436944 L12.7549996,12.4436944 L12.5285601,12.8851048 C12.422311,13.0985518 12.3264419,13.3010641 12.2406117,13.492428 L12.0822349,13.8602279 C12.0580359,13.9190293 12.034927,13.9765762 12.0128956,14.0328607 L11.8935358,14.3553545 C11.626955,15.1233988 11.5971181,15.6038285 11.7613521,15.7699316 C11.9337328,15.944274 12.2587181,15.9156574 13.0191883,15.5396003 L13.3553885,15.3660406 L14.0683854,14.9777715 L14.5588768,14.7208035 L14.5588768,14.7208035 L14.8283108,14.5909996 C14.9959703,14.5142859 15.1424127,14.4562192 15.283892,14.4108156 L15.4944206,14.3514596 L15.6411755,14.3193385 L15.6411755,14.3193385 L15.8229221,14.288223 L15.8229221,14.288223 C16.0206409,14.257605 16.2316784,14.2449705 16.3867188,14.2421875 C16.9895921,14.2313658 17.5330764,14.5999486 17.8897979,15.0602489 C18.5859881,15.7413305 18.8037075,17.0609002 18.528112,18.9499392 C18.2631318,20.7662161 19.8942188,21.4062736 22.0220888,20.5801796 C22.4202909,20.4255872 22.8684194,20.6230719 23.0230117,21.0212741 C23.1776041,21.4194762 22.9801193,21.8676047 22.5819172,22.022197 C19.586905,23.1849381 16.6409228,22.0776091 16.9718374,18.9302877 L17.056926,18.2825549 L17.0985526,17.8865412 C17.1398894,17.4151216 17.1382613,17.0537588 17.0932478,16.7824691 C16.9205623,16.4164746 16.7376596,16.3526922 16.3718084,16.3487976 L16.2475842,16.3512937 L16.2475842,16.3512937 Z",stroke:Nh()?e:"#000",strokeWidth:t/3.3,fill:Nh()?e:"#000"})):Oe.a.createElement("svg",{width:"32px",height:"32px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("defs",null,Oe.a.createElement("linearGradient",{x1:"6.80751023%",y1:"2.11021409%",x2:"93.1924898%",y2:"100%",id:"linearGradient-1"},Oe.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"0%"}),Oe.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"11.7862402%"}),Oe.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.9",offset:"89.2893774%"}),Oe.a.createElement("stop",{stopColor:"#262626",stopOpacity:"0.7",offset:"100%"}))),Oe.a.createElement("g",{id:"马克笔笔触",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinejoin:"round"},Oe.a.createElement("line",{x1:"12",y1:"11",x2:"20.8528558",y2:"20.5249844",id:"路径-3",stroke:Nh()?e:"url(#linearGradient-1)",strokeWidth:t})))}(i,o);break;default:t=null}return Oe.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},onClick:this.props.onClick},t)}}]),n}();c()(Vb,"propTypes",{className:Pe.a.string,type:Pe.a.string.isRequired,fill:Pe.a.string,stroke:Pe.a.string,onClick:Pe.a.func,strokeWidth:Pe.a.number,pen:Pe.a.string}),c()(Vb,"defaultProps",{fill:"red"}),We("/* stylelint-disable */\n.lake-diagram-color-pick-v2-container {\n  z-index: 1050;\n}\n.lake-diagram-color-pick-v2-container .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-color-pick-v2-overlay {\n  z-index: 1051;\n}\n");var Zb=function(t){var e,n=t.color,a=t.defaultColor,i=t.disabled,o=t.onClear,c=t.diagram,l=t.transSVG,s=t.onSelect,u=c&&(null==c||null===(e=c.theme)||void 0===e?void 0:e.values.swatches);return Oe.a.createElement(Fe.a,{overlayClassName:"lake-prevent-card-activated lake-diagram-color-pick-v2-container lake-diagram-prevent-mouse-select",disabled:i,trigger:["click"],destroyTooltipOnHide:!0,content:Oe.a.createElement(r.ColorPickerV2,{overlayClassName:"lake-diagram-color-pick-v2-overlay lake-prevent-card-activated lake-diagram-prevent-mouse-select",defaultColor:a,currentColor:n,onSelect:s,onClear:o,swatches:u}),placement:"topRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},!n||function(t){return!t||"transparent"===t||"rgba(255,255,255,0)"===t.replace(/ /g,"")||"rgba(0,0,0,0)"===t.replace(/ /g,"")}(n)?l||Oe.a.createElement("svg",{width:"90",viewBox:"0 0 90 30",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("path",{d:"M0 30L90 0",stroke:"#D0021B",fill:"none",fillRule:"evenodd",strokeLinecap:"square"})):t.children)};We(".lake-diagram-toolbar-free-hand-container {\n  display: flex;\n  flex-direction: column;\n  align-content: center;\n  margin: auto;\n  background: var(--yq-bg-primary);\n  border-radius: 3px;\n  box-shadow: 0 1px 2px -2px #00000014, 0 2px 6px 0 #0000000a, 0 4px 8px 1px #00000005;\n  border: 1px solid var(--yq-border-primary);\n  pointer-events: initial;\n  padding: 4px 4px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row {\n  width: 32px;\n  height: 32px;\n  border-radius: 3px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-diagram-toolbar-free-hand-stroke-width {\n  width: 32px;\n  height: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row .lake-icon {\n  font-size: 32px;\n}\n.lake-diagram-toolbar-free-hand-container .lake-diagram-toolbar-free-hand-row:hover {\n  background-color: var(--yq-border-primary);\n}\n"),We(".lake-diagram-toolbar-free-hand-stroke-container .lake-diagram-toolbar-free-hand-stroke-slider {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 160px;\n}\n");var Ub=function(t){var e=t.strokeWidth,n=t.setStrokeWidth,r="lake-diagram-toolbar-free-hand-stroke";return Oe.a.createElement("div",{className:"".concat(r,"-container")},Oe.a.createElement("div",null,Mr("粗细")),Oe.a.createElement("div",{className:"".concat(r,"-slider")},Oe.a.createElement(He.a,{style:{width:125},min:1,max:10,step:1,value:e,onChange:function(t){n(t)}}),Oe.a.createElement("div",null,e)))},Kb=function(t){var e=t.diagram,n=t.boardWebProxy,r=Object(Ae.useState)("pencil"),a=b()(r,2),i=a[0],o=a[1],l=Object(Ae.useState)("#595959"),s=b()(l,2),u=s[0],d=s[1],h=Object(Ae.useRef)(null),f=Object(Ae.useState)(2),p=b()(f,2),m=p[0],v=p[1],y=Object(Ae.useState)(!1),g=b()(y,2),x=g[0],k=g[1],w=function(t){"pencil"!==t&&"mark-pencil"!==t||(e.settings.freehand.shape=t),o(t)},C=function(t){e.settings.freehand.stroke=t,d(t)},A=function(t){e.settings.freehand.strokeWidth=t,v(t)};Object(Ae.useEffect)((function(){var t,r=function(t){var r=t.target;if(null!=r&&r.classList.contains("lake-icon-board-toolbar-pencil"))e.interaction.changeMode("free-hand"),w("pencil"),A(2),C("#595959");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-mark-pencil"))e.interaction.changeMode("free-hand"),w("mark-pencil"),A(8),C("#DFB85D");else if(null!=r&&r.classList.contains("lake-icon-board-toolbar-eraser")){var a,i;e.interaction.changeMode("eraser"),null==n||null===(a=n.spm)||void 0===a||null===(i=a.click)||void 0===i||i.call(a,"a385.b4693.c121188.d251469"),w("eraser")}};return null===(t=h.current)||void 0===t||t.addEventListener("click",r),function(){var t;return null===(t=h.current)||void 0===t?void 0:t.removeEventListener("click",r)}}),[]);var O="lake-diagram-toolbar-free-hand",E=function(t){C(t)};return Oe.a.createElement("div",{ref:h,className:"".concat(O,"-container")},Oe.a.createElement("div",{className:Me()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"pencil"===i))},Oe.a.createElement(je.a,{placement:"right",title:Mr("铅笔")},Oe.a.createElement("span",{className:Me()("lake-icon","lake-icon-board-toolbar-pencil")}))),Oe.a.createElement("div",{className:Me()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"mark-pencil"===i))},Oe.a.createElement(je.a,{placement:"right",title:Mr("马克笔")},Oe.a.createElement("span",{"data-testid":"free-hand-mark",className:Me()("lake-icon","lake-icon-board-toolbar-mark-pencil")}))),Oe.a.createElement("div",{className:Me()("".concat(O,"-row"),c()({},"".concat(O,"-selected"),"eraser"===i))},Oe.a.createElement(je.a,{placement:"right",title:Mr("橡皮")},Oe.a.createElement("span",{"data-testid":"free-hand-eraser",className:Me()("lake-icon","lake-icon-board-toolbar-eraser")}))),"eraser"!==i&&Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement("div",{className:"".concat(O,"-row")},Oe.a.createElement(Fe.a,{trigger:"click",visible:x,onVisibleChange:function(t){k(t)},content:Oe.a.createElement(Ub,{strokeWidth:m,setStrokeWidth:A}),placement:"rightTop"},Oe.a.createElement("div",{className:"".concat(O,"-stroke-width")},Oe.a.createElement(je.a,{placement:"right",title:Mr("粗细")},Oe.a.createElement("div",null,Oe.a.createElement(Vb,{type:"freehand-stroke",strokeWidth:m,pen:i,onClick:function(){return k(!x)}})))))),Oe.a.createElement("div",{className:"".concat(O,"-row")},Oe.a.createElement(Zb,{color:u,defaultColor:"#595959",onSelect:E,onClear:function(){return E("rgba(0, 0, 0, 0)")},diagram:e,transSVG:Oe.a.createElement(Vb,{type:"context-cb-trans"})},Oe.a.createElement(je.a,{placement:"right",title:Mr("颜色")},Oe.a.createElement("div",null,Oe.a.createElement(Vb,{type:"t-bg-color",fill:u})))))))},Qb={basic:"a385.b4693.c111722.d231218",flowchart:"a385.b4693.c111722.d231226",UML:"a385.b4693.c111722.d231225",ER:"a385.b4693.c111722.d231227",swimlane:"a385.b4693.c111722.d231186",DSL:{pyramid:"ca33306.da22351","segmented pyramid":"ca33306.da22352",stage:"ca33306.da22353",architecture:"ca33306.da22354"}};function $b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Jb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$b(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tx(t){var e=t.diagram,n=t.mini,r=t.onProperties,a=t.onSave,i=Object(Ae.useState)([]),o=b()(i,2),c=o[0],l=o[1];return Object(Ae.useEffect)((function(){if(e){var n=function(){var e=function(t){var e=t.focusMode,n=t.mini,r=t.readOnly,a=t.showProperties,i=t.boardWebProxy;return function(t){var e=t.diagram,n=t.mini,r=t.boardWebProxy;return[{align:"top-left",subItems:[{name:"save",type:"button",title:Mr("保存"),hotkey:pt.ua.macos?"⌘+S":"Ctrl+S",noMini:!0,noReadOnly:!0,icon:"board-save",disabled:!1,execCommand:function(){return t.onSave&&t.onSave()}},{type:"separator",noMini:!0,noReadOnly:!0},{name:"undo",type:"button",title:Mr("撤销"),hotkey:pt.ua.macos?"⌘+Z":"Ctrl+Z",icon:"board-undo",noMini:!0,noReadOnly:!0,disabled:function(t){return!t.command.enable("Undo")},execCommand:function(t){return t.command.execute("Undo")}},{name:"redo",title:Mr("重做"),hotkey:pt.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"board-redo",noMini:!0,noReadOnly:!0,disabled:function(t){return!t.command.enable("Redo")},execCommand:function(t){return t.command.execute("Redo")}}],focusHidden:!0},{align:"top-right",subItems:[{name:"hand",type:"button",title:Mr("拖拽"),noReadOnly:!0,hotkey:"Space",icon:"board-hand",active:function(t){return"dragCanvas"===t.interaction.currentMode},disabled:function(t){return!t.command.enable("ButtonDragCanvas")},execCommand:function(t){return t.command.execute("ButtonDragCanvas")}},{type:"separator",noReadOnly:!0},{name:"fitViewport",type:"button",title:Mr("适应画布"),hotkey:pt.ua.macos?"⌘+Shift+=":"Ctrl+Shift+=",icon:"board-viewport-autofit",disabled:function(){return!1},execCommand:function(t){return t.command.execute("FitViewport")}},{type:"separator",noReadOnly:!0},{type:"custom",component:Oe.a.createElement(hb,{diagram:e}),show:function(){return!(n&&pt.ua.mobile)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"theme",type:"popover",title:Mr("更换主题"),noReadOnly:!0,popoverPlacement:"bottomRight",icon:"board-toolbar-theme",overlay:function(t){var n=t.popoverVisible;return Oe.a.createElement("div",{className:"lake-board-toolbar-theme-setting"},Oe.a.createElement(Sb,{diagram:e}),Oe.a.createElement(Ab,{diagram:e,popoverVisible:n}))}},{name:"properties",type:"button",title:Mr("打开设置"),noReadOnly:!0,icon:"board-setting",disabled:function(){return!1},execCommand:function(){t.onProperties&&t.onProperties()},noMini:!0}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:Mr("隐藏工具栏"),hotkey:pt.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!0,icon:"board-toolbar-hide",disabled:!1,execCommand:function(){return t.setFocusMode&&t.setFocusMode(!0)}}],focusHidden:!0},{align:"top-right",subItems:[{name:"focusmode",type:"button",title:Mr("展开工具栏"),hotkey:pt.ua.macos?"⌘+.":"Ctrl+.",noMini:!1,noReadOnly:!0,noMaxim:!0,icon:"board-toolbar-show",disabled:!1,execCommand:function(){return t.setFocusMode&&t.setFocusMode(!1)}}],focusHidden:!1},{align:"left-middle",subItems:[{type:"button",name:"material",title:Mr("素材库"),noReadOnly:!0,icon:Oe.a.createElement("span",{className:"lake-board-toolbar-material-icon",style:{backgroundImage:Nh()?"url(https://gw.alipayobjects.com/zos/bmw-prod/b0db2f07-dfa1-4ae8-86bc-baa44c9e42b1.svg)":"url(https://gw.alipayobjects.com/zos/bmw-prod/4bdfc4e6-e50c-493b-a809-33016c1f95e2.svg)"}}),execCommand:function(){null==t||t.onMaterialMaximize()}},{name:"iconfont",title:Mr("插入 Iconfont"),type:"popover",noReadOnly:!0,icon:"board-iconfont",overlay:function(n){var r=n.setPopoverVisible;return Oe.a.createElement(gb,{diagram:e,boardWebProxy:null==t?void 0:t.boardWebProxy,onSelect:function(){r(!1)}})}},{type:"separator",noReadOnly:!0},{name:"hand",type:"button",title:"".concat(Mr("选择")," V"),noReadOnly:!0,icon:"board-toolbar-select",active:function(t){return"edit"===t.interaction.currentMode},execCommand:function(t){"edit"!==t.interaction.currentMode&&t.interaction.changeMode("edit")}},{type:"popover",name:"free-hand",title:Mr("画笔"),className:"free-hand"===e.interaction.currentMode||"eraser"===e.interaction.currentMode?"lake-diagram-toolbar-selected":"",icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-board-toolbar-free-hand"}),noReadOnly:!0,overlay:function(){return Oe.a.createElement(Kb,{diagram:e,boardWebProxy:r})},execCommand:function(t){return t.interaction.changeMode("free-hand")},onClick:function(){e.interaction.changeMode("free-hand")}},{type:"button",name:"pen",title:Mr("矢量绘图"),active:function(t){return"pen"===t.interaction.currentMode},icon:Oe.a.createElement("span",{"data-testid":"toolbar-pen",className:"lake-icon lake-icon-board-toolbar-pen"}),noReadOnly:!0,execCommand:function(t){var e;t.penDrawInteract.clearCache(),null===(e=t.interaction)||void 0===e||e.changeMode("pen")}},{type:"button",name:"insertText",title:Mr("文本"),noReadOnly:!0,hotkey:"T",icon:"board-insert-text",disabled:function(t){return!t.command.enable("BeginInsertText")},execCommand:function(t){return t.command.execute("BeginInsertText")}},{name:"board:insertShape",title:Mr("图形"),hotkey:"S",type:"popover",noReadOnly:!0,icon:"board-insert-shape",execCommand:function(t){return t.command.execute("BeginInsertGeometry")},overlay:function(t){var n=t.onSelect,r=t.setPopoverVisible,a=t.popoverVisible;return Oe.a.createElement($g,{diagram:e,basicWithSwimlane:!0,groups:["basic","flowchart","DSL","UML","ER"],onSelect:function(r){var a,i=r.key,o=r.attr;n({key:i}),function(t,e){if(t){var n=sc.find((function(t){return t.name===e}));if(n)if("DSL"===n.category){var r=Qb[n.category];t.click(r[e])}else t.click(Qb[n.category],{shape:e})}}(null==t||null===(a=t.boardWebProxy)||void 0===a?void 0:a.spm,i),e.command.execute("BeginInsertGeometry",{shape:i,attr:o})},hide:function(){r(!1)},popoverVisible:a})}},{type:"popover",name:"insertEdge",title:Mr("连线"),hotkey:pt.ua.macos?"⌘+L":"Ctrl+L",defaultKey:"straight-line-arrow",icon:"board-straight-line-arrow",noReadOnly:!0,disabled:function(t){return!t.command.enable("BeginInsertLine")},data:[{key:"straight-line-arrow",icon:"board-straight-line-arrow"},{key:"curve-line-arrow",icon:"board-curve-line-arrow"},{key:"elbow-line-arrow",icon:"board-elbow-line-arrow"}],onClick:function(){e.selector.clear(),e.command.execute("BeginInsertLine",e.settings.line)},onSelect:function(t){var n=t.key.split("-"),r=b()(n,3),a=r[0],i=r[2];e.command.execute("BeginInsertLine",{shape:a,marker:i})}},{type:"button",name:"insertMindmap",title:Mr("思维导图"),hotkey:"M",icon:"board-mind",noReadOnly:!0,disabled:function(t){return!t.command.enable("MindmapBeginInsertStem")},execCommand:function(t){return t.command.execute("MindmapBeginInsertStem")}},{type:"separator",noReadOnly:!0},{name:"insertImage",title:Mr("图片"),type:"upload",icon:"board-upload-image",noReadOnly:!0,accept:pt.EXTS.IMAGE_EXT.map((function(t){return"."+t})).join(","),disabled:!1,onChange:function(t){jb(t,e)}}],focusHidden:!0}]}(t).map((function(t){if(e===t.focusHidden)return null;var o=t.subItems.filter((function(t){return t.show instanceof Function?t.show():(!n||!t.noMini)&&(!(!n&&t.noMaxim)&&((!r||!t.noReadOnly)&&(("properties"!==t.name||!a)&&(!!("material"!==t.name||null!=i&&i.material)&&!("iconfont"===t.name&&(null==i||!i.iconfont||null!=i&&null!==(e=i.iconfont)&&void 0!==e&&e.disable))))));var e}));return o.length>0?Jb(Jb({},t),{},{subItems:o}):null})).filter((function(t){return t}))}(t);l(e)};n();var r=function(t){t.isModelChange&&n()};return e.on("aftercommandexecute",r),e.on("aftermodechange",n),function(){e.off("aftercommandexecute",r),e.off("aftermodechange",n)}}return function(){return!1}}),[e,n,r,a]),Oe.a.createElement(Wb,{diagram:e,items:c,className:"lake-diagram-board-toolbar"})}function ex(t){var e=t.icon,n=t.title,r=t.hotkey;return Oe.a.createElement("div",null,e,n,r&&Oe.a.createElement("span",{className:"lake-context-menu-hotkey"},r))}function nx(t){var e=t.title,n=t.hotkey,r=t.accept,a=t.icon,i=t.onChange,o=Object(Ae.useRef)();return Oe.a.createElement("div",{className:"lake-board-context-menu-upload-item-content",onClick:function(t){t.stopPropagation(),o.current.click()}},a,e,n&&Oe.a.createElement("span",{className:"lake-context-menu-hotkey"},n),Oe.a.createElement("input",{type:"file",accept:r,onChange:i,ref:o}))}function rx(t,e){var n=t.disabled,r=t.title,a=t.key,i=t.hotkey,o=t.type,c=t.accept,l=t.onChange;if(t.data)return Oe.a.createElement(Ne.a.SubMenu,{key:a,title:r,disabled:n,popupClassName:"lake-context-submenu lake-prevent-card-activated lake-diagram-dialog-popover lake-diagram-prevent-mouse-select"},t.data.map(rx));if("separator"===o)return Oe.a.createElement(Ne.a.Divider,{key:a+"_"+e});var s,u="string"==typeof t.icon?Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(t.icon)}):t.icon;return s="upload"===o?Oe.a.createElement(nx,{icon:u,title:r,hotkey:i,accept:c,onChange:l}):Oe.a.createElement(ex,{icon:u,title:r,hotkey:i}),Oe.a.createElement(Ne.a.Item,{key:a,className:"ant-menu-item",disabled:n},s)}function ax(t){var e=t.coord,n=t.overlayClassName,r=t.diagram,a=t.onClose,i=Object(Ae.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=Object(Ae.useRef)();if(Object(Ae.useEffect)((function(){if(e){var t=s.current.offsetParent.getBoundingClientRect();l([e[0]-t.x,e[1]-t.y])}else l(null)}),[e]),Object(Ae.useEffect)((function(){function t(){a()}function e(e){e.target.closest(".lake-diagram-dialog-popover")||t()}function n(){t()}return window.addEventListener("mousedown",e),window.addEventListener("scroll",t,{passive:!0}),r.on("afterviewportchange",n),function(){window.removeEventListener("mousedown",e),window.removeEventListener("scroll",t),r.off("afterviewportchange",n)}}),[r,a]),c){var u="lake-diagram-dialog-popover lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Oe.a.createElement(Fe.a,Ce()({},t,{getPopupContainer:function(){return t.getPopupContainer?t.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||document.body},visible:!0,overlayClassName:n?n+" "+u:u}),Oe.a.createElement("div",{ref:s,style:{position:"absolute",left:"".concat(c[0],"px"),top:"".concat(c[1],"px"),pointerEvents:"none",width:"0px",height:"0px"}}))}return Oe.a.createElement("span",{ref:s})}function ix(t){var e=t.getMenuData,n=t.diagram,r=t.boardWebProxy,a=Object(Ae.useState)(t.coord),i=b()(a,2),o=i[0],c=i[1],l=Object(Ae.useState)(e()),s=b()(l,2),u=s[0],d=s[1],h=Object.keys(t).reduce((function(e,n){return n.startsWith("data-")&&(e[n]=t[n]),e}),{});Object(Ae.useEffect)((function(){function t(t){d(e()),c([t.clientX,t.clientY])}return n.on("contextmenu",t),function(){n.off("contextmenu",t)}}),[n]);var f=Oe.a.createElement("div",Ce()({},h,{className:Me()("lake-context-menu",t.className)}),Oe.a.createElement(Ne.a,{className:"lake-context-submenu",onMouseDown:function(t){t.preventDefault()},onClick:function(e){var r=n.viewport.invertClient(o);t.onClick({key:e.key,canvasPoint:r}),c(null)},selectable:!1},u.map(rx)));return Oe.a.createElement(ax,{placement:"rightTop",content:f,visible:!0,overlayClassName:"lake-diagram-context-menu-popover ne-ignore-pointer-events",diagram:n,coord:o,onClose:function(){c(null)},boardWebProxy:r})}We("/* stylelint-disable */\n.lake-board-toolbar-material-icon {\n  width: 24px;\n  height: 24px;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.ant-btn > span.lake-board-toolbar-material-icon {\n  display: block;\n}\n.lake-diagram-toolbar-selected {\n  background-color: var(--yq-border-primary);\n}\n.lake-board-toolbar-theme-setting {\n  border-radius: 8px;\n  background: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),tx.defaultProps={mini:!1,readOnly:!1,diagram:null,showProperties:!0,boardWebProxy:{},onProperties:function(){return!1},onSave:function(){return!1},onMaterialUse:function(){return!1},onMaterialMore:function(){return!1},onMaterialMaximize:function(){return!1}},tx.propTypes={mini:Pe.a.bool,readOnly:Pe.a.bool,diagram:Pe.a.object,showProperties:Pe.a.bool,onProperties:Pe.a.func,onSave:Pe.a.func,focusMode:Pe.a.bool,setFocusMode:Pe.a.func,boardWebProxy:Pe.a.object,onMaterialMore:Pe.a.func,onMaterialUse:Pe.a.func,onMaterialMaximize:Pe.a.func},ex.propTypes={title:Pe.a.string,hotkey:Pe.a.string,icon:Pe.a.node},We(".lake-board-context-menu-upload-item-content input {\n  display: none;\n}\n"),nx.propTypes={title:Pe.a.string,hotkey:Pe.a.string,icon:Pe.a.oneOf([Pe.a.string,Pe.a.node]),data:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func,accept:Pe.a.string},rx.propTypes={title:Pe.a.string,key:Pe.a.string,hotkey:Pe.a.string,type:Pe.a.string,disabled:Pe.a.bool,icon:Pe.a.oneOf([Pe.a.string,Pe.a.node]),data:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func,accept:Pe.a.string},We("/* stylelint-disable */\n.lake-diagram-dialog-popover .ant-popover-inner-content {\n  padding: 0;\n}\n"),ax.defaultProps={coord:null,diagram:null,onClose:function(){}},ax.propTypes={coord:Pe.a.array,diagram:Pe.a.object,onClose:Pe.a.func,overlayClassName:Pe.a.string,getPopupContainer:Pe.a.object},We("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-context-menu-popover {\n  z-index: 1033;\n}\n.lake-diagram-context-menu-popover .ant-popover-arrow {\n  display: none;\n}\n.lake-context-menu {\n  z-index: 13;\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.13);\n}\n.lake-context-menu,\n.lake-context-submenu {\n  list-style-type: none !important;\n}\n.lake-context-menu li,\n.lake-context-submenu li {\n  margin-left: 0 !important;\n}\n.lake-context-menu .ant-menu,\n.lake-context-submenu .ant-menu {\n  border-radius: 2px;\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n.lake-context-menu .ant-menu .ant-menu-submenu,\n.lake-context-submenu .ant-menu .ant-menu-submenu,\n.lake-context-menu .ant-menu .ant-menu-item,\n.lake-context-submenu .ant-menu .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  min-width: 164px;\n}\n.lake-context-menu .ant-menu .ant-menu-item-active,\n.lake-context-submenu .ant-menu .ant-menu-item-active,\n.lake-context-menu .ant-menu .ant-menu-submenu-active,\n.lake-context-submenu .ant-menu .ant-menu-submenu-active {\n  background: var(--yq-bg-tertiary);\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-title,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-title {\n  height: auto;\n  line-height: inherit;\n  color: var(--yq-text-body);\n}\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::before,\n.lake-context-menu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after,\n.lake-context-submenu .ant-menu .ant-menu-submenu .ant-menu-submenu-arrow::after {\n  width: 5px;\n  height: 1px;\n  background-image: linear-gradient(90deg, var(--yq-yuque-grey-900), var(--yq-yuque-grey-900));\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-item,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-item {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-vertical .ant-menu-submenu,\n.lake-context-submenu .ant-menu.ant-menu-vertical .ant-menu-submenu {\n  margin-bottom: 4px;\n}\n.lake-context-menu .ant-menu.ant-menu-sub,\n.lake-context-submenu .ant-menu.ant-menu-sub {\n  width: auto;\n}\n.lake-context-menu .ant-menu.ant-menu-sub > li,\n.lake-context-submenu .ant-menu.ant-menu-sub > li {\n  width: auto;\n}\n.lake-context-menu .lake-icon,\n.lake-context-submenu .lake-icon {\n  display: inline-block;\n  margin-right: 0.25em;\n}\n.lake-context-menu-hotkey {\n  float: right;\n  color: var(--yq-text-caption);\n  margin-left: 16px;\n}\n"),ix.defaultProps={},ix.propTypes={className:Pe.a.string,coord:Pe.a.object,data:Pe.a.arrayOf(Pe.a.object),onClick:Pe.a.func,diagram:Pe.a.object,getMenuData:Pe.a.func,boardWebProxy:Pe.a.object};var ox=[{key:"Align",title:Mr("对齐"),data:[{key:"AlignLeft",icon:"align-left",title:Mr("左对齐"),hotkey:"Option+←"},{key:"AlignHCenter",icon:"align-h-center",title:Mr("左右居中"),hotkey:"Option+H"},{key:"AlignRight",icon:"align-right",title:Mr("右对齐"),hotkey:"Option+→"},{key:"DistributeHorizontally",icon:"distribute-horizontally",title:Mr("水平均分")},{type:"separator"},{key:"AlignTop",icon:"align-top",title:Mr("顶对齐"),hotkey:"Option+↑"},{key:"AlignVCenter",icon:"align-v-center",title:Mr("上下居中"),hotkey:"Option+V"},{key:"AlignBottom",icon:"align-bottom",title:Mr("底对齐"),hotkey:"Option+↓"},{key:"DistributeVertically",icon:"distribute-vertically",title:Mr("垂直均分")}]},{key:"ZIndex",title:Mr("层级"),data:[{key:"ToFront",title:Mr("置顶"),hotkey:"⌘+]"},{key:"ToBack",title:Mr("置底"),hotkey:"⌘+["},{key:"Forward",title:Mr("上移一层"),hotkey:"\t⌘+Option+]"},{key:"Backward",title:Mr("下移一层"),hotkey:"⌘+Option+["}]},{key:"AttachToVertex",title:Mr("插入"),data:[{key:"AttachLink",title:Mr("链接"),hotkey:"⌘+K"}]},{key:"MindmapAppendAbstract",title:Mr("添加概要")},{key:"AttachToMindmapCell",title:Mr("插入"),data:[{key:"MindmapAppendChild",title:Mr("子级"),hotkey:"Tab"},{key:"MindmapAppendParent",title:Mr("父级"),hotkey:"Option+Tab"},{key:"MindmapAppendSibling",title:Mr("同级"),hotkey:"Enter"},{key:"separator",type:"separator"},{key:"AttachLink",title:Mr("链接"),hotkey:"⌘+K"},{key:"MindmapAttachImage",title:Mr("图片"),type:"upload",accept:pt.EXTS.IMAGE_EXT.map((function(t){return"."+t})).join(",")},{key:"MindmapAttachNote",title:Mr("备注")}]},{key:"Cut",title:Mr("剪切"),hotkey:"⌘+X"},{key:"Copy",title:Mr("复制"),hotkey:"⌘+C"},{key:"CopyOtherFormat",title:Mr("复制为其它格式"),data:[{key:"CopyDoc",title:Mr("语雀文档")},{key:"CopyTable",title:Mr("语雀表格")}]},{key:"Paste",title:Mr("粘贴"),hotkey:"⌘+V"},{key:"Collapse",title:Mr("折叠"),hotkey:"⌘+/"},{key:"Expand",title:Mr("展开"),hotkey:"⌘+/"},{key:"MindmapAppendParent",title:Mr("插入父级"),hotkey:"Option+Tab"},{key:"MindmapInsertStem",title:Mr("添加思维导图"),hotkey:"M"},{key:"MindmapAppendSibling",title:Mr("插入同级"),hotkey:"Enter"},{key:"MindmapAppendChild",title:Mr("插入子级"),hotkey:"Tab"},{key:"ActualSize",title:Mr("实际尺寸"),hotkey:"⌘+0"},{key:"FitViewport",title:Mr("适应画布"),hotkey:"⌘+Shift+="},{key:"Delete",title:Mr("删除"),hotkey:"Delete"},{key:"MindmapRemoveSingleNode",title:Mr("删除单个节点"),hotkey:"⌘+Delete"},{key:"BeginInsertLine",title:Mr("添加连线"),hotkey:"⌘+L"},{key:"BeginEditContent",title:Mr("编辑文本")},{key:"separator",type:"separator"},{key:"InsertText",title:Mr("添加文字"),hotkey:"T"},{key:"InsertGeometry",title:Mr("添加图形"),hotkey:"S"},{key:"MakeGroup",title:Mr("成组"),hotkey:"⌘+G"},{key:"Ungroup",title:Mr("取消成组"),hotkey:"⌘+Shift+G"},{key:"AddMaterialLib",title:Mr("添加到素材库")},{key:"SaveImage",title:Mr("另存为图片")}],cx={};function lx(t,e){cx[t]=e}function sx(t){return cx[t]}function ux(t){return dx.apply(this,arguments)}function dx(){return(dx=dt()(ft.a.mark((function t(e){var n,r,a,i,o,c,l;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.arrayBuffer();case 3:return n=t.sent,t.next=6,crypto.subtle.digest("SHA-256",n);case 6:return r=t.sent,a=Array.from(new Uint8Array(r)),i=a.map((function(t){return t.toString(16).padStart(2,"0")})).join(""),t.abrupt("return",i);case 12:return t.prev=12,t.t0=t.catch(0),t.next=16,e.arrayBuffer();case 16:return o=t.sent,c=Array.from(new Uint8Array(o)),l=c.map((function(t){return t.toString(16).padStart(2,"0")})).join(""),t.abrupt("return",l.length>100&&l.substring(l.length-100,l.length));case 20:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function hx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hx(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hx(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function px(t,e){return t.every((function(e){return t.includes(e.stem)}))?e.deduplicate(t).filter((function(t){return t.isStem})):[]}function mx(t,e,n){return vx.apply(this,arguments)}function vx(){return(vx=dt()(ft.a.mark((function t(e,n,r){var a,i,o,c,l,s,u,d,h,f;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.destroyed){t.next=2;break}return t.abrupt("return");case 2:return e=px(e,n),a=e.reduce((function(t,e){return e.deepEach((function(e){t.push(e)})),t}),[]),t.next=6,n.exporter.blob("png",{cells:a,width:220});case 6:if(i=t.sent){t.next=10;break}return kt.a.warn(Mr("导出素材图片失败")),t.abrupt("return",!1);case 10:return o=Object(F.a)(),kt.a.loading({content:Mr("上传素材中"),key:o,duration:0}),c=Array.from(new Set(e.map((function(t){var e,n,r;return t.isImage&&(null===(e=t.model)||void 0===e||null===(n=e.image)||void 0===n||null===(r=n.uploadInfo)||void 0===r?void 0:r.hash)})))),l=c.map((function(t){var e;return null===(e=sx(t))||void 0===e?void 0:e.imageCdnPromise})),t.next=16,Promise.all(l);case 16:return s=new File([i],"lake_board_material.jpeg"),t.next=19,r.uploader.image(s);case 19:if(u=t.sent,kt.a.destroy(o),u){t.next=24;break}return kt.a.warn(Mr("上传素材图片失败")),t.abrupt("return",!1);case 24:return d=n.exporter.json(e),h=Er(a),t.next=28,r.material.create({cover:u,diagramData:d,graphicsBBox:fx(fx({},h),{},{x:h.minX,y:h.minY,width:h.maxX-h.minX,height:h.maxY-h.minY})});case 28:return f=t.sent,t.abrupt("return",f);case 30:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function gx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yx(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yx(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}window.___lakeDiagramUploadFileHashMap=cx;var bx=ox.reduce((function(t,e){var n;return t[e.key]=e,e.hotkey&&(e.hotkey=(n=e.hotkey,pt.ua.macos?n:n.replace(/⌘/g,"Ctrl").replace(/Option/g,"Alt"))),t}),{});function xx(t,e){var n=t.key;t.disabled=!!e.command.find(n)&&!e.command.enable(n),"MindmapAttachImage"===n&&(t.onChange=function(t){jb(t,e)})}function kx(t,e){return(t=t.filter((function(t){return null!=t}))).map((function(t,n){var r=gx(gx({},s()(bx[t])),{},{disabled:!!e.command.find(t)&&!e.command.enable(t)});return xx(r,e),r.data&&r.data.forEach((function(t){xx(t,e)})),"separator"===t&&(r.key=t+"-"+n),r}))}function wx(t){return t.command.enable("Expand")?["Expand"]:["Collapse"]}function Cx(t){var e=[],n=t.filter((function(t){return t.isStem}));return n.length>1&&e.push("Align"),n.length>0&&e.push("ZIndex"),e.length>0?e.push("separator"):e=null,e}function Ax(t){var e=[];return t.filter((function(t){return t.isStem})).length>1?(e.push("MakeGroup"),e.push("separator")):e=null,e}function Ox(t,e,n){var r=px(t,e),a=[];return t.length>0&&a.push("SaveImage"),n&&r.length>0&&!function(t){for(var e=t.reduce((function(t,e){return e.deepEach((function(e){t.push(e)})),t}),[]),n=e.reduce((function(t,e){return t[e.model.id]=e,t}),{}),r=e.filter((function(t){return t.isLine})),a=0;a<r.length;a++){var i,o,c,l,s=r[a],u=null===(i=s.model)||void 0===i||null===(o=i.target)||void 0===o?void 0:o.id,d=null===(c=s.model)||void 0===c||null===(l=c.source)||void 0===l?void 0:l.id;if(u&&!n[u]||d&&!n[d])return!0}return!1}(r)&&a.push("AddMaterialLib"),a.length>0?(a.push("separator"),a):null}function Ex(){return(Ex=dt()(ft.a.mark((function t(e,n,r,a){var i,o;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,mx(e,n,r);case 2:(i=t.sent)&&((o=r.spm)&&o.click("b4693.c107432.d223055",{material_id:null==i?void 0:i.id}),a&&a(null==i?void 0:i.id));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Px(t){try{Rc("copy",t),kt.a.success(Mr("复制成功"))}catch(t){kt.a.error(Mr("复制失败"))}}function Sx(t){var e=t.diagram,n=t.boardWebProxy,r=t.onAddMaterial,a=!(null==n||!n.material);return Oe.a.createElement(ix,{diagram:e,getMenuData:function(){return function(t,e){var n=e.materialLibEnable;return"read"===t.interaction.currentMode?function(t){var e=t.selector.selections,n=["ActualSize","FitViewport"];return e.length>0&&e.every((function(t){return t.isMindmap}))&&(n=["Copy"].concat(wx(t)).concat(["separator"]).concat(n)),kx(n,t)}(t):function(t,e){var n=t.selector.selections,r=[];return 0===n.length?r=["InsertText","InsertGeometry","BeginInsertLine","MindmapInsertStem","separator","Paste","separator","ActualSize","FitViewport"]:n.every((function(t){return t.isMindmap}))?(1===n.length&&(r=["AttachToMindmapCell","separator"]),uv(n,!0)&&r.push("MindmapAppendAbstract","separator"),r=r.concat(wx(t)).concat(["separator","Cut","Copy","CopyOtherFormat","Paste","separator"]).concat(Ox(n,t,e)).concat(Cx(n)).concat(Ax(n)).concat(["Delete","MindmapRemoveSingleNode"])):n.every((function(t){return t.isVertex}))?(1!==n.length||n[0].isImage||(r=["AttachToVertex","separator"]),r=r.concat(["Cut","Copy","Paste","separator"]).concat(Ox(n,t,e)).concat(Cx(n)).concat(Ax(n)).concat(["Delete"])):r=n.every((function(t){return t.isGroup}))?r.concat(["Cut","Copy","Paste","separator"]).concat(Ox(n,t,e)).concat(Cx(n)).concat(Ax(n)).concat(["Ungroup","separator"]).concat(["Delete"]):["Cut","Copy","Paste","separator"].concat(Ox(n,t,e)).concat(Cx(n)).concat(Ax(n)).concat(["Delete"]),kx(r,t)}(t,n)}(e,{materialLibEnable:a})},boardWebProxy:n,onClick:function(t){var a=t.key,i=t.canvasPoint;e.tryFocus();var o=e.selector.selections;switch(a){case"Cut":!function(t){try{Rc("cut",t),kt.a.success(Mr("剪切成功"))}catch(t){kt.a.error(Mr("剪切失败"))}}(e);break;case"Copy":Px(e);break;case"CopyDoc":e.settings.copyType="doc",Px(e),e.settings.copyType="default";break;case"CopyTable":e.settings.copyType="table",Px(e),e.settings.copyType="default";break;case"Paste":!function(t,e){try{Rc("paste",t,e)}catch(t){kt.a.error(Mr("粘贴失败"))}}(e,i);break;case"MindmapInsertStem":e.command.execute("MindmapInsertStem",{x:i[0],y:i[1]});break;case"InsertText":e.command.execute("InsertText",{x:i[0],y:i[1]});break;case"InsertGeometry":e.command.execute("InsertGeometry",{x:i[0],y:i[1]});break;case"AddMaterialLib":!function(t,e,n,r){Ex.apply(this,arguments)}(o,e,n,r);break;case"SaveImage":!function(t,e){e.exporter.download("png",{cells:Pc(t,e)})}(o,e);break;default:if(a)try{"MindmapAppendAbstract"===a&&n&&n.spm&&n.spm.click("b4693.c116586.d241682",{"right-click(MindmapAppendAbstract)":1}),e.command.execute(a)}catch(t){throw new Error("unknown command ".concat(a))}}e.tryFocus()}})}function Mx(t){var e=t.diagram;return Oe.a.createElement("div",{className:"lake-diagram-properties-alignment"},Oe.a.createElement(ze.a.Group,{onChange:function(t){e.command.execute(t.target.value)},value:null},Oe.a.createElement(ze.a.Button,{value:"AlignLeft",disabled:!e.command.enable("AlignLeft")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-left"})),Oe.a.createElement(ze.a.Button,{value:"AlignHCenter",disabled:!e.command.enable("AlignHCenter")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-h-center"})),Oe.a.createElement(ze.a.Button,{value:"AlignRight",disabled:!e.command.enable("AlignRight")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-right"})),Oe.a.createElement(ze.a.Button,{value:"AlignTop",disabled:!e.command.enable("AlignTop")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-top"})),Oe.a.createElement(ze.a.Button,{value:"AlignVCenter",disabled:!e.command.enable("AlignVCenter")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-v-center"})),Oe.a.createElement(ze.a.Button,{value:"AlignBottom",disabled:!e.command.enable("AlignBottom")},Oe.a.createElement("span",{className:"lake-icon lake-icon-align-bottom"}))))}function jx(t){var e=t.selections,n=t.diagram,r=e.filter((function(t){return t.canArrange()})).length<3;return Oe.a.createElement("div",{className:"lake-diagram-properties-distribute"},Oe.a.createElement(ze.a.Group,{onChange:function(t){n.command.execute(t.target.value)},value:null},Oe.a.createElement(ze.a.Button,{value:"DistributeHorizontally",disabled:r},Oe.a.createElement("span",{className:"lake-icon lake-icon-horizontally"})),Oe.a.createElement(ze.a.Button,{value:"DistributeVertically",disabled:r},Oe.a.createElement("span",{className:"lake-icon lake-icon-vertically"}))),Oe.a.createElement("div",{className:"lake-diagram-properties-distribute-label-group"},Oe.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},Mr("水平均分")),Oe.a.createElement("span",{className:"lake-diagram-properties-distribute-label"},Mr("垂直均分"))))}function Rx(t){var e=t.diagram,n=t.selections,r=e.getCells(),a=n.some((function(t){return t.locked}))||1===n.length&&n[0].getZIndex()===r.length-1,i=n.some((function(t){return t.locked}))||1===n.length&&0===n[0].getZIndex();function o(r){t.onChange((function(){e.command.execute(r.target.value,{cells:n})}))}return Oe.a.createElement("div",{className:"lake-diagram-properties-z-index"},Oe.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Oe.a.createElement(ze.a.Group,{onChange:o,value:null},Oe.a.createElement(je.a,{title:Mr("置顶")},Oe.a.createElement(ze.a.Button,{value:"ToFront",disabled:a},Oe.a.createElement("span",{className:"lake-icon lake-icon-to-front"}))),Oe.a.createElement(je.a,{title:Mr("置底")},Oe.a.createElement(ze.a.Button,{value:"ToBack",disabled:i},Oe.a.createElement("span",{className:"lake-icon lake-icon-to-back"}))))),Oe.a.createElement("div",{className:"lake-diagram-properties-z-index-btn-group"},Oe.a.createElement(ze.a.Group,{onChange:o,value:null},Oe.a.createElement(je.a,{title:Mr("上移")},Oe.a.createElement(ze.a.Button,{value:"Forward",disabled:a},Oe.a.createElement("span",{className:"lake-icon lake-icon-forward"}))),Oe.a.createElement(je.a,{title:Mr("下移")},Oe.a.createElement(ze.a.Button,{value:"Backward",disabled:i},Oe.a.createElement("span",{className:"lake-icon lake-icon-backward"}))))))}function Lx(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bx(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lx(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lx(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Dx(t){var e=t,n=e.onBlur,r=e.onPressEnter,a=e.onStep,i=e.value,o=Object(Ae.useState)(null),c=b()(o,2),l=c[0],s=c[1];return t=Bx(Bx({},t),{},{value:"number"==typeof l?l:i,onChange:function(t){s(t)},onBlur:function(t){s(null),n&&n(t)},onPressEnter:function(t){s(null),r&&r(t)},onStep:function(t){s(null),a&&a(t)}}),Dx.propTypes={value:Pe.a.number,onStep:Pe.a.func,onBlur:Pe.a.func,onPressEnter:Pe.a.func},Oe.a.createElement(qe.a,t)}function Nx(t){var e=t.selections,n=0===e.length||e.some((function(t){return t.locked})),r={width:Mr("宽"),height:Mr("高")};function a(e,n){n>=1&&t.onChange(e,n)}return Oe.a.createElement(lb,{className:"lake-diagram-size-control",disabled:n},Object.keys(r).map((function(t){return Oe.a.createElement("div",{className:"lake-diagram-size-control-".concat(t),key:t},r[t],Oe.a.createElement(Dx,{disabled:n,min:1,max:2560,value:Math.round(lb.get(e,t)),onBlur:function(e){return a(t,parseFloat(e.target.value))},onPressEnter:function(e){return a(t,parseFloat(e.target.value))},onStep:function(e){return a(t,e)}}))})))}function _x(t){var e=t.path,n=t.selections,r=0===n.length||n.some((function(t){return t.locked}));return Oe.a.createElement(lb,{className:"lake-diagram-ratio-control",disabled:r},Oe.a.createElement(Ye.a,{disabled:r,checked:lb.get(n,e),onChange:function(n){t.onChange(e,n.target.checked)}},Mr("保持宽高比")))}function Ix(t){var e=t.selections,n=t.onChange,r=0===e.length||e.some((function(t){return t.locked}));return Oe.a.createElement(lb,{className:"lake-diagram-reset-size-control",disabled:r},Oe.a.createElement(Re.a,{disabled:r,onClick:function(){var t=e[0];t.isImage?n({width:t.image.naturalWidth,height:t.image.naturalHeight}):t.isVertex&&n({width:t.stencil.width,height:t.stencil.height})}},Mr("原始大小")))}function Tx(t){var e=t.selections,n=0===e.length||e.some((function(t){return t.locked}));function r(e,n){t.onChange(e,n)}return Oe.a.createElement(lb,{className:"lake-diagram-position-control",disabled:n},["x","y"].map((function(t){return Oe.a.createElement("div",{className:"lake-diagram-position-control-".concat(t),key:t},t.toUpperCase(),Oe.a.createElement(Dx,{disabled:n,value:Math.round(lb.get(e,t)),onBlur:function(e){return r(t,parseFloat(e.target.value))},onPressEnter:function(e){return r(t,parseFloat(e.target.value))},onStep:function(e){return r(t,e)}}))})))}function Fx(t){return""===t?t:"".concat(Math.round(t),"°")}function zx(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("°","");return""===t?t:parseInt(t,10)%360||0}function qx(t){var e=t.selections,n=0===e.length||e.some((function(t){return null==t.rotate}))||e.some((function(t){return t.locked}));function r(e){isFinite(e)&&t.onChange("rotate",e)}function a(t){var e=t.target.value.replace("°","");e<-180||e>180||r(parseFloat(e))}return Oe.a.createElement(lb,{className:"lake-diagram-rotate-control",disabled:n},Mr("角度"),Oe.a.createElement(Dx,{disabled:n,min:-180,max:180,formatter:Fx,parser:zx,value:lb.get(e,"rotate"),onBlur:a,onPressEnter:a,onStep:r}))}function Yx(t){var e=t.selections,n=[],r=[];e.forEach((function(t){n.push(t.width,t.height),r.push(t.round)}));var a;a=r.every((function(t){return t===r[0]}))?r[0]:Mr("多个值");var i=Math.min.apply(Math,n)/2,o=Bt()((function(e){e=parseInt(e),isFinite(e)&&t.onChange("round",Je(e,0,i))}),16);function c(t){o(t.target.value)}return Object(Ae.useEffect)((function(){return function(){return o.cancel()}})),Oe.a.createElement(lb,{className:"lake-diagram-opacity-control"},Oe.a.createElement(He.a,{min:0,max:i,step:1,tooltipVisible:!1,value:a,onChange:o}),Oe.a.createElement(Dx,{min:0,max:i,step:1,value:a,formatter:function(t){return Math.floor(Je(t,0,i))},onBlur:c,onPressEnter:c,onStep:o}))}Sx.defaultProps={boardWebProxy:null,onAddMaterial:null},Sx.propTypes={diagram:Pe.a.object,boardWebProxy:Pe.a.object,onAddMaterial:Pe.a.func},We(".lake-diagram-properties-alignment {\n  margin-top: 8px;\n  margin-bottom: 16px;\n}\n.lake-diagram-properties-alignment .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-alignment .ant-radio-group label {\n  flex-grow: 1;\n  padding: 0;\n  text-align: center;\n}\n"),Mx.defaultProps={},Mx.propTypes={diagram:Pe.a.object.isRequired,selections:Pe.a.arrayOf(Pe.a.object).isRequired},Mx.key="AlignControl",We(".lake-diagram-properties-distribute {\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-distribute .ant-radio-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute .ant-radio-button-wrapper {\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-distribute-label-group {\n  width: 100%;\n}\n.lake-diagram-properties-distribute-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n"),jx.propTypes={selections:Pe.a.arrayOf(Pe.a.object),diagram:Pe.a.object},We(".lake-diagram-properties-z-index {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 8px;\n}\n.lake-diagram-properties-z-index .ant-radio-button-wrapper {\n  padding: 0 14px;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-label {\n  display: inline-block;\n  width: 50%;\n  text-align: center;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group {\n  width: calc(50% - 4px);\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group {\n  display: flex;\n}\n.lake-diagram-properties-z-index .lake-diagram-properties-z-index-btn-group .ant-radio-group label {\n  text-align: center;\n  flex-grow: 1;\n  flex-shrink: 1;\n}\n"),Rx.defaultProps={onChange:function(){}},Rx.propTypes={onChange:Pe.a.func.isRequired,diagram:Pe.a.object.isRequired,selections:Pe.a.arrayOf(Pe.a.object).isRequired},Rx.key="ZIndexControl",We(".lake-diagram-size-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-size-control-width,\n.lake-diagram-size-control-height {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-size-control-width .ant-input-number,\n.lake-diagram-size-control-height .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),Nx.propTypes={selections:Pe.a.array,onChange:Pe.a.func},_x.defaultProps={path:"constraints.proportion"},_x.propTypes={path:Pe.a.string,selections:Pe.a.array,onChange:Pe.a.func},We(".lake-diagram-reset-size-control .lake-diagram-control-body {\n  margin-top: 12px;\n}\n.lake-diagram-reset-size-control .ant-btn {\n  width: 100%;\n}\n"),Ix.propTypes={selections:Pe.a.array,onChange:Pe.a.func},We(".lake-diagram-position-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-position-control-x,\n.lake-diagram-position-control-y {\n  display: flex;\n  align-items: center;\n  width: calc(50% - 8px);\n}\n.lake-diagram-position-control-x .ant-input-number,\n.lake-diagram-position-control-y .ant-input-number {\n  margin-left: 16px;\n  width: calc(100% - 32px);\n}\n"),Tx.propTypes={selections:Pe.a.array,onChange:Pe.a.func},We(".lake-diagram-rotate-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n"),qx.propTypes={selections:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func},We(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n"),Yx.propTypes={selections:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func};var Hx=[{name:Mr("排列"),hideHeader:!0,tabKey:"arrangement",condition:function(t){return t.length>0&&t.some((function(t){return t.isStem}))},controls:[{Control:Mx},{Control:jx},{Control:Rx}]},{name:Mr("位置"),tabKey:"arrangement",condition:function(t){return t.length>0&&t.every((function(t){return(t.isVertex&&t.isStem||t.isGroup)&&!Cr(t)}))},controls:[{Control:Tx,display:function(t){return t.every((function(t){return t.isGroup}))||t.every((function(t){return!t.isGroup}))}}]},{name:Mr("大小"),tabKey:"arrangement",condition:function(t){return t.length>0&&t.every((function(t){return t.isGeometry&&t.isStem||t.isGroup}))},controls:[{Control:Nx,display:function(t){return t.every((function(t){return t.isGroup}))||t.every((function(t){return!t.isGroup}))}},{Control:_x,display:function(t){return!t.some((function(t){return t.isGroup}))}},{Control:Ix,display:function(t){return!t.some((function(t){return t.isGroup}))}}]},{name:Mr("圆角半径"),tabKey:"arrangement",condition:function(t){return t.length>0&&t.every((function(t){return t.isGeometry&&t.canRound()}))},controls:[{Control:Yx}]},{name:Mr("旋转"),tabKey:"arrangement",condition:function(t){return t.length>0&&t.every((function(t){return t.canRotate()&&!Cr(t)}))},controls:[{Control:qx}]}];function Gx(t){var e=t.path,n=t.title,r=t.diagram,a=t.selections.filter((function(t){return t.canFill()})),i=0===a.length||a.some((function(t){return t.locked})),o=lb.get(a,e),c="multiValue"===o?"#FFFFFF":o;function l(n){t.onChange(e,n,us(a))}return Oe.a.createElement(lb,{disabled:i,title:n,extra:Oe.a.createElement(Zb,{disabled:i,color:c,defaultColor:t.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Oe.a.createElement("div",{className:Me()("lake-diagram-fill",{"lake-diagam-multi-properties-selection":"multiValue"===o}),style:"multiValue"===o?void 0:{backgroundColor:c}}))})}function Xx(t){var e=t.path,n=t.title,r=t.diagram,a=t.selections.filter((function(t){return t.canStroke()})),i=function(t,e){return lb.get(t,e)||(t.length>0&&!t[0].isStem?lb.get(t,"treeEdge.stroke"):void 0)}(a,e)||"rgba(0, 0, 0, 0)",o=0===a.length||a.some((function(t){return t.locked})),c="multiValue"===i?"#FFFFFF":i;function l(n){t.onChange(e,n,a)}return Oe.a.createElement(lb,{disabled:o,title:n||Mr("颜色"),extra:Oe.a.createElement(Zb,{disabled:o,color:c,defaultColor:t.defaultColor,onSelect:l,onClear:function(){return l("rgba(0, 0, 0, 0)")},diagram:r},Oe.a.createElement("div",{className:Me()("lake-diagram-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===i}),style:"multiValue"===i?void 0:{backgroundColor:c}}))})}function Wx(t){var e=t.selections,n=t.path,r=0===e.length||e.some((function(t){return t.locked})),a=e.filter((function(t){return t.canStrokeWidth()})),i=lb.get(a,n);function o(e){var r=Math.min(Math.max(e,1),10);r!==i&&t.onChange(n,r,a)}function c(t){o(parseFloat(t.target.value))}return Oe.a.createElement(lb,{className:"lake-diagram-stroke-width-control",disabled:r,title:Mr("粗细"),extra:Oe.a.createElement(Dx,{disabled:r,min:1,max:10,value:i,onBlur:c,onPressEnter:c,onStep:o})})}We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-fill {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-fill {\n  display: none;\n}\n"),Gx.defaultProps={defaultColor:"transparent",title:Mr("填充颜色"),onChange:function(){}},Gx.propTypes={defaultColor:Pe.a.string,selections:Pe.a.arrayOf(Pe.a.object).isRequired,path:Pe.a.string.isRequired,title:Pe.a.string,onChange:Pe.a.func.isRequired,diagram:Pe.a.object},Gx.key="FillControl",We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.disabled .lake-diagram-stroke {\n  display: none;\n}\n.lake-diagram-stroke {\n  border: 4px solid var(--yq-white);\n  height: 30px;\n}\n"),Xx.defaultProps={defaultColor:"transparent",onChange:function(){}},Xx.propTypes={defaultColor:Pe.a.string,selections:Pe.a.arrayOf(Pe.a.object).isRequired,path:Pe.a.string.isRequired,onChange:Pe.a.func.isRequired,title:Pe.a.string,diagram:Pe.a.object},Xx.key="StrokeControl",We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),Wx.defaultProps={onChange:function(){}},Wx.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,path:Pe.a.string.isRequired,onChange:Pe.a.func.isRequired},Wx.key="StrokeWidthControl",We(".lake-diagram-stroke-style-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-stroke-style-selected {\n  line-height: 0;\n}\n.lake-diagram-stroke-style-selected .lake-diagram-stroke-style-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-stroke-style-selected .lake-properties-stroke-style-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-stroke-style-selected .lake-diagram-properties-stroke-style {\n  width: 100%;\n  height: 100%;\n}\n");var Vx={none:"https://gw.alipayobjects.com/zos/bmw-prod/5e3dbea7-f3c3-418f-91de-cfbcb825343c.svg",dash:"https://gw.alipayobjects.com/zos/bmw-prod/3d7118e9-1bac-465d-acb9-cc0766ece25e.svg"};function Zx(t){var e=t.selections,n=t.path,r=0===e.length||e.some((function(t){return t.locked})),a=e.filter((function(t){return t.canStrokeStyle()})),i=lb.get(a,n);return Oe.a.createElement(lb,{className:"lake-diagram-properties-stroke-style",disabled:r,title:Mr("样式"),extra:Oe.a.createElement(De.a,{disabled:r,trigger:["click"],overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,onClick:function(e){var r=e.key;t.onChange(n,"none"===r?null:r,a)}},Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-none",key:"none",style:{backgroundImage:"url(".concat(Vx.none,")")}}),Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-stroke-style-item","test-id":"lake-diagram-stroke-style-item-dash",key:"dash",style:{backgroundImage:"url(".concat(Vx.dash,")")}})),placement:"bottomRight"},Oe.a.createElement("div",{className:"lake-diagram-stroke-style-selected"},Oe.a.createElement("span",{className:"lake-diagram-stroke-style-item lake-diagram-stroke-style-selected-item",style:{backgroundImage:"url(".concat(Vx[i||"none"],")")}}),Oe.a.createElement(eb,{className:"lake-properties-stroke-style-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}function Ux(t){return""===t?t:"".concat(Math.round(100*t),"%")}function Kx(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace("%","");return""===t?t:Math.min(Math.max(parseFloat(t)/100||0,0),1)}function Qx(t){var e=t.selections,n=0===e.length||e.some((function(t){return t.locked})),r=parseFloat(lb.get(e,"opacity"))||1,a=Bt()((function(e){isFinite(e)&&t.onChange("opacity",e)}),16);function i(t){a(Kx(t.target.value))}return Object(Ae.useEffect)((function(){return function(){return a.cancel()}})),Oe.a.createElement(lb,{className:"lake-diagram-opacity-control",disabled:n},Oe.a.createElement(He.a,{disabled:n,min:0,max:1,step:.01,tooltipVisible:!1,value:r,onChange:a}),Oe.a.createElement(Dx,{disabled:n,min:0,max:1,step:.01,value:r,formatter:Ux,parser:Kx,onBlur:i,onPressEnter:i,onStep:a}))}function $x(t){var e=Object(Ae.useRef)(),n=t.width,r=t.height,a=t.shape,i=a&&sc.find((function(t){return t.name===a}));return Object(Ae.useEffect)((function(){if(e.current&&i){var t=new Xh({stencil:i,width:n,height:r,noFill:!0,stroke:_h("text"),fill:"transparent"}).rendererElement;Array.from(e.current.children,(function(t){return t.remove()})),e.current.appendChild(t)}}),[e,n,r,i]),i?Oe.a.createElement("svg",{ref:e,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}function Jx(t){var e,n=t.selections,r=0===n.length,a=n.filter((function(t){return t.isGeometry})),i=lb.get(a,t.path),o=(null===(e=sc[sc.findIndex((function(t){return t.name===i}))])||void 0===e?void 0:e.category)||"basic";return Oe.a.createElement(lb,{className:"lake-diagram-geometry-shape-control",disabled:r,title:Mr("形状"),extra:Oe.a.createElement(De.a,{disabled:r,overlay:Oe.a.createElement("div",{className:"lake-diagram-properties-shape-select-container"},Oe.a.createElement(Zg,{onSelect:function(e){var n=e.key;t.onChange(t.path,n,a)},groups:[o]})),placement:"bottomRight",trigger:["click"]},Oe.a.createElement(Re.a,null,Oe.a.createElement("div",{className:Me()("lake-diagram-geometry-shape-current",{"multi-geometry-selection":"multiValue"===i})},Oe.a.createElement($x,{shape:i,width:32,height:32}))))})}Zx.defaultProps={onChange:function(){},path:"stroke.style"},Zx.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired,path:Pe.a.string.isRequired},Zx.key="StrokeStyleControl",We(".lake-diagram-opacity-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: space-between;\n}\n.lake-diagram-opacity-control .lake-diagram-control-body .ant-slider {\n  flex: 1 0 auto;\n  margin-left: 0;\n  margin-right: 16px;\n}\n"),Qx.propTypes={selections:Pe.a.arrayOf(Pe.a.object),onChange:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-geometry-shape-control .lake-diagram-control-extra .ant-btn {\n  background: none;\n  border: none;\n  height: 32px;\n  width: 100%;\n  padding: 0;\n}\n.lake-diagram-geometry-shape-control .multi-geometry-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-geometry-shape-control .lake-diagram-geometry-shape-current {\n  width: 100%;\n  min-height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-properties-shape-select-container {\n  background-color: var(--yq-bg-primary);\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n}\n"),$x.propTypes={width:Pe.a.number,height:Pe.a.number,shape:Pe.a.string},Jx.defaultProps={path:"shape",groups:["basic","flowchart"],onChange:function(){}},Jx.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,path:Pe.a.string.isRequired,groups:Pe.a.array,onChange:Pe.a.func.isRequired},Jx.key="GeometryShapeControl";var tk=[{name:Mr("节点"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isGeometry||wr(t)}))},controls:[{path:"shape",Control:Jx,display:function(t){return t.every((function(t){return"UML"!==t.category&&!Cr(t)}))}},{path:"fill.color",Control:Gx}]},{name:Mr("边框"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isGeometry||Cr(t)}))},controls:[{path:"stroke.color",Control:Xx},{path:"stroke.width",Control:Wx},{display:function(t){return t.every((function(t){return!kr(t)}))},Control:Zx}]},{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isGeometry&&null!=t.opacity}))},controls:[{Control:Qx}]}],ek=[{name:Mr("节点"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isStack}))},controls:[{path:"fill.color",Control:Gx}]},{name:Mr("边框"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isStack}))},controls:[{path:"stroke.color",Control:Xx},{path:"stroke.width",Control:Wx},{Control:Zx}]},{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isStack&&null!=t.opacity}))},controls:[{Control:Qx}]}];function nk(t){var e=t.selections,n=t.diagram,r=e.filter((function(t){return t.isMindmap})),a=Ri(r,lb),i=Object(Ae.useState)(!1),o=b()(i,2),c=o[0],l=o[1],s=r.map((function(t){return t.upDirection}));r.map((function(t){return t.upLayoutType}));var u=ji.filter((function(t){if(r.every((function(t){return t.isStem})))return!0;var n=t.key.split("-")[0],a=e.some((function(t){var e=t.upLayoutType,r=t.isAbstract;return Di(e,n,r)})),i=!t.directions.every((function(t){return s.every((function(e){return Bi(e,t)}))}));return!a&&!i}));function d(t){0!==u.length&&l(t)}return Oe.a.createElement(lb,{className:"lake-diagram-layout-control",title:Mr("结构"),disabled:0===u.length,extra:Oe.a.createElement(De.a,{overlay:Oe.a.createElement(Oe.a.Fragment,null,u.map((function(e){var i=e.key;return Oe.a.createElement("div",{key:i,"data-lake_prevent_click_unselect":"true",className:Me()("lake-diagram-layout-thumb",{selected:i===a}),onClick:function(){d(!c),function(e){t.onChange("layout",Li(e),r),n&&n.selector.select(r)}(i)}},Oe.a.createElement("div",{className:i}))}))),overlayClassName:"lake-diagram-layout-dropdown",placement:"bottomRight",onClick:function(){d(!c)},visible:c,onVisibleChange:function(t){d(t)},trigger:["click"]},Oe.a.createElement("div",{className:Me()("lake-diagram-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===a})},Oe.a.createElement("div",{className:"lake-diagram-layout-thumb"},Oe.a.createElement("div",{className:a}))))})}function rk(t){var e=t.selections,n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1],o=0===e.length;return Object(Ae.useEffect)((function(){var t=lb.get(e,"model.width");i("multiValue"===t?"multiValue":null!=t)}),[e]),Oe.a.createElement(lb,{disabled:o},Oe.a.createElement(Ye.a,{disabled:o,indeterminate:"multiValue"===a,checked:!!a,onChange:function(n){var r=n.target.checked?lb.get(e,"width"):null;i(n.target.checked),t.onChange({width:r,height:null})},"data-testid":"checkbox-node-width"},Mr("手动设置节点尺寸")))}We("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control.lake-diagram-layout-control .lake-diagram-control-extra {\n  padding: 0;\n  justify-content: space-around;\n}\n.lake-diagram-layout-dropdown {\n  width: 168px;\n  border-radius: 4px;\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n  flex-wrap: wrap;\n  background: var(--yq-bg-primary);\n  justify-content: initial;\n  padding: 8px 11px;\n}\n.lake-diagram-layout-dropdown.ant-dropdown-hidden {\n  display: none;\n}\n.lake-diagram-layout-thumb {\n  width: 48px;\n  height: 32px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n}\n.lake-diagram-layout-thumb > div {\n  transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);\n  width: 100%;\n  height: 100%;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb > div {\n  filter: invert(100%);\n}\n.lake-diagram-layout-thumb > .indent-bl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/bc67f2b4-b84a-4b09-970f-92bc893cdc1a.svg);\n}\n.lake-diagram-layout-thumb > .indent-br {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/103fb753-229b-4717-9e49-356f013b3309.svg);\n}\n.lake-diagram-layout-thumb > .indent-tr {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/15763057-474a-4b44-a999-3058a5328e9a.svg);\n}\n.lake-diagram-layout-thumb > .indent-tl {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/44546c1d-75f7-4839-a198-6f7d4049798f.svg);\n}\n.lake-diagram-layout-thumb > .standard-t {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f2060601-21d5-4882-8159-01a1fa4c241a.svg);\n}\n.lake-diagram-layout-thumb > .standard-b {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f9e3e9f4-638c-46bb-ba35-9d9bf5a87f41.svg);\n}\n.lake-diagram-layout-thumb > .standard-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/f7687207-ddcc-4e07-abfa-a9985f86e70a.svg);\n}\n.lake-diagram-layout-thumb > .standard-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/af8bdfa5-f0ae-446b-836e-1d0340d2f5c6.svg);\n}\n.lake-diagram-layout-thumb > .standard-h {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/069fa8cc-c99f-4d1b-98a5-371367ace0e5.svg);\n}\n.lake-diagram-layout-thumb > .timeline-r {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/56c34bb7-b888-4103-bc03-3124cd7b99a3.svg);\n}\n.lake-diagram-layout-thumb > .timeline-l {\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/23f1801a-504c-4254-a5d2-f33fcee86de7.svg);\n}\n.lake-diagram-layout-thumb:hover,\n.lake-diagram-layout-thumb.selected {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background-color: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-thumb.selected {\n  background-color: rgba(255, 255, 255, 0.12);\n}\n.lake-diagram-layout-current {\n  background: var(--yq-bg-primary);\n  width: 100%;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-layout-current .lake-diagram-layout-thumb:hover {\n  background-color: transparent;\n}\n"),nk.defaultProps={onChange:function(){}},nk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired,diagram:Pe.a.object},nk.key="LayoutControl",rk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},rk.key="NodeWidthControl",We("/* stylelint-disable */\n/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-border-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.lake-diagram-border-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-border-shape-selected .lake-diagram-border-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n.lake-diagram-border-shape-selected .lake-properties-border-shape-dropdown-icon {\n  width: 10x;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-border-shape-selected .lake-diagram-properties-border-shape {\n  width: 100%;\n  height: 100%;\n}\n");var ak=["line","rect","capsule"],ik={none:"https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg",line:"https://gw.alipayobjects.com/zos/bmw-prod/6ffe619f-04e8-48c7-af45-5f0f3cf2c4a1.svg",rect:"https://gw.alipayobjects.com/zos/bmw-prod/7b0ba540-6360-430b-a960-90c928ca037c.svg",capsule:"https://gw.alipayobjects.com/zos/bmw-prod/3818284f-32e3-44cb-875c-1b722074ddaa.svg"};function ok(t){var e=t.selections,n=lb.get(e,"border.shape","line")||null,r=e.length>0&&e.some((function(t){return t.isStem})),a=e.length>0&&e.some((function(t){return t.isAbstract})),i=r||a?ak.filter((function(t){return"line"!==t})):ak,o=i.find((function(t){return t===n}))?n:"",c=0===e.length;return Oe.a.createElement(lb,{className:"lake-diagram-properties-border-shape",disabled:c,title:Mr("节点形状"),extra:Oe.a.createElement(De.a,{disabled:c,trigger:["click"],overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,onClick:function(n){var r=n.key;t.onChange("border.shape",r,e)}},i.map((function(t){return Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-border-shape-item","test-id":"lake-diagram-border-shape-item-".concat(t),key:t,style:{backgroundImage:"url(".concat(ik[t],")")}})}))),placement:"bottomRight",getPopupContainer:function(){return document.querySelector(".yuque-sdk-extra-container")||document.body}},Oe.a.createElement("div",{className:"lake-diagram-border-shape-selected"},Oe.a.createElement("span",{className:"lake-diagram-border-shape-item lake-diagram-border-shape-selected-item",style:{backgroundImage:"url(".concat(ik[o||"none"],")")}}),Oe.a.createElement(eb,{className:"lake-properties-border-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}function ck(t){var e=t.selections.filter((function(t){return t.canStroke()&&t.isMindmap})),n=0===e.length,r=lb.get(e,"border.stroke-width");function a(n){var a=Math.min(Math.max(n,1),10);a!==r&&t.onChange("border.stroke-width",a,e)}function i(t){a(parseFloat(t.target.value))}return Oe.a.createElement(lb,{className:"lake-diagram-border-stroke-width-control",disabled:n,title:Mr("边框粗细"),extra:Oe.a.createElement(Dx,{disabled:n,min:1,max:10,value:r,onBlur:i,onPressEnter:i,onStep:a})})}function lk(t){var e=on(t.selections.map((function(t){return t.stem}))),n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Object(Ae.useEffect)((function(){i(lb.get(e,"rainbow"))}),[e]),Oe.a.createElement(lb,null,Oe.a.createElement(Ye.a,{indeterminate:"multiValue"===a,checked:!!a,onChange:function(n){var r=n.target.checked;i(r),t.onChange("rainbow",r,e)}},Mr("彩虹分支")))}function sk(t){var e=on(t.selections.map((function(t){return t.stem}))),n=lb.get(e,"tapered");return Oe.a.createElement(lb,null,Oe.a.createElement(Ye.a,{indeterminate:"multiValue"===n,checked:!!n,onChange:function(n){var r=n.target.checked;t.onChange("tapered",r,e)}},Mr("分支线条宽度逐渐变细")))}function uk(t){var e=t.selections,n=t.onChange,r=on(e.map((function(t){return t.stem}))),a=lb.get(r,"treeEdge.shape",null);a="multiValue"===a?null:void 0===a?"curve":a;var i=0===e.length;return Oe.a.createElement(lb,{className:"lake-diagram-properties-edge-shape",disabled:i,title:Mr("分支类型"),extra:Oe.a.createElement(ze.a.Group,{disabled:i,value:a,onChange:function(t){var e="curve"===t.target.value?null:t.target.value;n("treeEdge.shape",e,r)}},Oe.a.createElement(ze.a.Button,{value:"curve"},Oe.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"})),Oe.a.createElement(ze.a.Button,{value:"polyline"},Oe.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"})))})}function dk(t){var e=t.selections,n=t.diagram,r=lb.get(e,"treeEdge.stroke","#A287E1"),a="multiValue"===r?"#FFFFFF":r;return Oe.a.createElement(lb,{disabled:0===e.length,title:Mr("分支颜色"),extra:Oe.a.createElement(Zb,{disabled:0===e.length,color:a,onSelect:function(e){t.onChange("treeEdge.stroke",e)},diagram:n},Oe.a.createElement("div",{className:Me()("lake-diagram-tree-edge-stroke",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Oe.a.createElement("svg",{width:"64",viewBox:"0 0 64 12",xmlns:"http://www.w3.org/2000/svg"},Oe.a.createElement("path",{d:"M64 2c-27.42 0-35.012 8-64 8",stroke:"multiValue"===r?"none":r,strokeWidth:"4",fill:"none",fillRule:"evenodd"}))))})}function hk(t){var e=t.selections.filter((function(t){return t.isMindmap&&!t.isStem})),n=0===e.length,r=lb.get(e,"treeEdge.stroke-width");function a(n){var a=Math.min(Math.max(n,1),5);"number"==typeof a&&a!==r&&t.onChange("treeEdge.stroke-width",a,e)}function i(t){a(parseFloat(t.target.value))}return Oe.a.createElement(lb,{className:"lake-diagram-tree-edge-stroke-width-control",disabled:n,title:Mr("分支粗细"),extra:Oe.a.createElement(Dx,{disabled:n,min:1,max:5,value:r,onBlur:i,onPressEnter:i,onStep:a})})}ok.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},ok.key="BorderShapeControl",We("/* stylelint-disable */\n.lake-diagram-border-stroke-width-control .ant-input-number {\n  width: 100%;\n}\n"),ck.defaultProps={onChange:function(){}},ck.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},ck.key="BorderStrokeWidthControl",lk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func},lk.key="TreeEdgeRainbowControl",sk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func},sk.key="TreeEdgeTaperedControl",We(".lake-diagram-properties-edge-shape .lake-diagram-control-extra {\n  border: none;\n}\n.lake-diagram-properties-edge-shape .lake-diagram-control-extra button {\n  padding: 0 13px;\n}\n"),uk.defaultProps={onChange:function(){}},uk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},uk.key="TreeEdgeShapeControl",We(".lake-diagram-tree-edge-stroke {\n  height: 32px;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n}\n"),dk.defaultProps={onChange:function(){}},dk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired,diagram:Pe.a.object},dk.key="TreeEdgeStrokeControl",We("/* stylelint-disable */\n"),hk.defaultProps={onChange:function(){}},hk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},hk.key="TreeEdgeStrokeWidthControl";var fk=[{name:Mr("布局"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isMindmap}))},controls:[{Control:nk}]},{name:Mr("节点"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isMindmap}))},controls:[{Control:ok},{path:"border.fill",Control:Gx},{path:"border.stroke",title:Mr("边框颜色"),Control:Xx},{Control:ck},{Control:rk}]},{name:Mr("分支"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isMindmap&&t.isStem}))},controls:[{Control:lk},{Control:sk},{Control:uk}]},{name:Mr("分支"),tabKey:"style",condition:function(t){return t.length>0&&!t.every((function(t){return t.isStem}))&&t.every((function(t){return t.isMindmap&&!t.isStem}))},controls:[{Control:dk},{Control:hk},{Control:uk},{Control:lk},{Control:sk}]}];We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-dropdown-input {\n  position: relative;\n  overflow: hidden;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  transition: border-color 0.3s;\n}\n.lake-diagram-dropdown-input:hover {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-dropdown-input-focus {\n  border-color: var(--yq-yuque-green-500);\n  box-shadow: 0 0 0 2px rgba(11, 208, 125, 0.2);\n  outline: none;\n}\n.lake-diagram-dropdown-input .ant-input {\n  padding-right: 24px;\n  border: none;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger {\n  position: absolute;\n  top: -1px;\n  right: -1px;\n  padding: 0;\n  border-width: 0 0 0 1px;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  width: 24px;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon {\n  position: absolute;\n  right: 8px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  border: 4px solid;\n  border-color: var(--yq-yuque-grey-7) transparent transparent transparent;\n  box-sizing: border-box;\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger .lake-icon::before {\n  content: ' ';\n}\n.lake-diagram-dropdown-input .ant-dropdown-trigger:hover {\n  background: var(--yq-bg-tertiary);\n  border-color: var(--yq-border-primary);\n}\n");var pk=["disabled"];function mk(t){var e=t.disabled,n=Be()(t,pk),r=Object(Ae.useState)(t.value),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)(!1),l=b()(c,2),s=l[0],u=l[1];return Object(Ae.useEffect)((function(){o(t.value)}),[t.value]),Oe.a.createElement("div",{className:Me()("lake-diagram-dropdown-input",{"lake-diagram-dropdown-input-focus":s})},Oe.a.createElement(_e.a,{disabled:e,value:i,onFocus:function(){u(!0)},onBlur:function(e){parseInt(e.target.value,10)>0&&t.onChange(e),u(!1)},onChange:function(t){o(t.target.value)},onKeyDown:function(e){"Enter"===e.key&&parseInt(e.target.value,10)>0&&(t.onChange(e),e.target.select())}}),Oe.a.createElement(De.a,Ce()({disabled:e},n),Oe.a.createElement(Re.a,null,Oe.a.createElement("span",{className:"lake-icon lake-icon-dropdown-arrow"}))))}function vk(t){var e=t.selections,n=t.diagram,r=0===e.length||e.some((function(t){return t.locked})),a=Object(Ae.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=n.contentEditorPlus,s=o.fontSize,u=o.color,d=o.bold,h=o.italic,f=o.strikethrough,p=o.underline;return Object(Ae.useEffect)((function(){function t(t){var e=t.query;c(e)}return l.emitQueryChange(),n&&l.on("querychange",t),function(){l.off("querychange",t)}}),[n]),Oe.a.createElement(lb,{disabled:r,className:"text-format-control"},Oe.a.createElement("div",{className:"text-format-li",style:{display:"flex",justifyContent:"space-between"}},Oe.a.createElement("span",{style:{display:"flex",flexWrap:"nowrap"}},Oe.a.createElement(Re.a,{disabled:r,className:Me()("bisu-btn",{active:d}),onClick:function(){return l.execCommand("bold")}},Oe.a.createElement("span",{className:"lake-icon lake-icon-bold"})),Oe.a.createElement(Re.a,{disabled:r,className:Me()("bisu-btn",{active:h}),onClick:function(){return l.execCommand("italic")}},Oe.a.createElement("span",{className:"lake-icon lake-icon-italic"})),Oe.a.createElement(Re.a,{disabled:r,className:Me()("bisu-btn",{active:f}),onClick:function(){return l.execCommand("strikethrough")}},Oe.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})),Oe.a.createElement(Re.a,{disabled:r,className:Me()("bisu-btn",{active:p}),onClick:function(){return l.execCommand("underline")}},Oe.a.createElement("span",{className:"lake-icon lake-icon-underline"})))),Oe.a.createElement("div",{className:"text-format-li text-format-font-color"},Mr("字号"),Oe.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Oe.a.createElement(mk,{disabled:r,trigger:["click"],value:s,onChange:function(t){return l.execCommand("fontSize",parseInt(t.target.value))},overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none text-format-font-size-menu",selectedKeys:[s&&s.toString()],onClick:function(t){var e=t.key;return l.execCommand("fontSize",parseInt(e))}},[12,14,16,18,22,24,32,36,48,64,92].map((function(t){return Oe.a.createElement(Ne.a.Item,{key:t},t===s&&Oe.a.createElement("span",{className:"lake-icon lake-icon-success"}),t,"px")}))),placement:"bottomRight"}))),Oe.a.createElement("div",{className:"text-format-li text-format-font-color"},Mr("文本颜色"),Oe.a.createElement("div",{className:"lake-diagram-control-extra lake-diagrm-font-color-control-extra"},Oe.a.createElement(Zb,{disabled:r,color:u,defaultColor:t.defaultColor,onSelect:Nt()((function(t){return l.execCommand("foreColor",t)}),16),diagram:n},Oe.a.createElement("div",{className:"lake-diagram-font-color",style:{backgroundColor:u}})))))}mk.propTypes={value:Pe.a.oneOfType([Pe.a.string,Pe.a.number]),disabled:Pe.a.bool,onChange:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-format-control .text-format-font-color {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.text-format-control .text-format-li {\n  margin-bottom: 16px;\n}\n.text-format-control .text-format-li:last-child {\n  margin-bottom: 0;\n}\n.text-format-control .lake-diagram-control-extra {\n  display: inline-block;\n  vertical-align: bottom;\n  margin-left: 8px;\n}\n.text-format-control .lake-diagram-font-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 30px;\n}\n.text-format-control.disabled .lake-diagram-font-color {\n  display: none;\n}\n.text-format-control .control-body {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: nowrap;\n}\n.text-format-control .bisu-btn {\n  padding: 0;\n  text-align: center;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n}\n.text-format-control .bisu-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.text-format-control .bisu-btn.active {\n  border-color: var(--yq-yuque-green-500);\n}\n.lake-diagram-control-extra.lake-diagrm-font-color-control-extra {\n  width: auto;\n  flex: auto;\n  max-width: 90px;\n}\n.text-format-font-size {\n  max-width: 90px;\n  display: inline-block;\n  flex: auto;\n  height: 32px;\n  line-height: 30px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 0 8px;\n  font-size: 14px;\n  font-weight: 400;\n}\n.text-format-font-size[disabled] {\n  color: var(--yq-text-caption);\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-font-size .lake-icon-arrow-down {\n  width: 8px;\n  height: 8px;\n  float: right;\n  margin-top: 12px;\n  background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSI1cHgiIHZpZXdCb3g9IjAgMCA4IDUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Mi41ICg2NzQ2OSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+DQogICAgPHRpdGxlPkdyb3VwIENvcHkgNjwvdGl0bGU+DQogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+DQogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuNDUiPg0KICAgICAgICA8ZyBpZD0idG9vbGJhciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyOC4wMDAwMDAsIC0xOC4wMDAwMDApIj4NCiAgICAgICAgICAgIDxnIGlkPSJwYXJhZ3JhcGgtc3R5bGUiPg0KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIyNi4wMDAwMDAsIDQuMDAwMDAwKSI+DQogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC1Db3B5LTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwMi4wMDAwMDAsIDEyLjAwMDAwMCkiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjgiIGhlaWdodD0iOCI+PC9yZWN0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTAuNTk2MDkzNzUsMi41NTcwMzEyNSBMMy43NDUzMTI1LDYuMzc4MTI1IEMzLjg3NzM0Mzc1LDYuNTI1NzgxMjUgNC4xMDg1OTM3NSw2LjUyNTc4MTI1IDQuMjQwNjI1LDYuMzc4MTI1IEw3LjQwNTQ2ODc1LDIuNTU3MDMxMjUgQzcuNTk2MDkzNzUsMi4zNDI5Njg3NSA3LjQ0NDUzMTI1LDIuMDAzOTA2MjUgNy4xNTc4MTI1LDIuMDAzOTA2MjUgTDAuODQ0NTMxMjUsMi4wMDM5MDYyNSBDMC41NTcwMzEyNSwyLjAwMzkwNjI1IDAuNDA0Njg3NSwyLjM0Mjk2ODc1IDAuNTk2MDkzNzUsMi41NTcwMzEyNSBaIiBpZD0iU2hhcGUiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPg0KICAgICAgICAgICAgICAgICAgICA8L2c+DQogICAgICAgICAgICAgICAgPC9nPg0KICAgICAgICAgICAgPC9nPg0KICAgICAgICA8L2c+DQogICAgPC9nPg0KPC9zdmc+) no-repeat;\n}\n.text-format-font-size .lake-icon-arrow-down::before {\n  display: none;\n}\n.text-format-font-size-menu {\n  min-width: 104px;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.text-format-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n.text-format-color {\n  margin-top: 8px;\n  width: 92px;\n  height: 32px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  padding: 4px;\n}\n.text-format-color-indicator {\n  width: 100%;\n  height: 100%;\n}\n.text-format-color[disabled] {\n  cursor: not-allowed;\n  border-color: var(--yq-border-primary);\n}\n.text-format-color[disabled]-indicator {\n  display: none;\n}\n"),vk.defaultProps={defaultColor:"rgb(38, 38, 38)"},vk.propTypes={defaultColor:Pe.a.string,selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired,diagram:Pe.a.object.isRequired},vk.key="TextBasicFormat",We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-h-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-h-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n");var yk={left:"justifyLeft",center:"justifyCenter",right:"justifyRight",justify:"justifyFull"};function gk(t){var e=t.selections,n=t.diagram,r=0===e.length||e.some((function(t){return t.locked})),a=Object(Ae.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=n.contentEditorPlus,s=o.textAlign;return Object(Ae.useEffect)((function(){function t(t){var e=t.query;c(e)}return l.emitQueryChange(),n&&l.on("querychange",t),function(){l.off("querychange",t)}}),[n]),Oe.a.createElement(lb,{disabled:r,className:"text-format-control"},Oe.a.createElement(ze.a.Group,{className:"text-format-li properties-text-format-text-h-align",disabled:r,defaultValue:yk.left,value:yk[s]},Oe.a.createElement(ze.a.Button,{value:yk.left,onClick:function(){return l.execCommand(yk.left)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-left"})),Oe.a.createElement(ze.a.Button,{value:yk.center,onClick:function(){return l.execCommand(yk.center)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-center"})),Oe.a.createElement(ze.a.Button,{value:yk.right,onClick:function(){return l.execCommand(yk.right)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-right"})),Oe.a.createElement(ze.a.Button,{value:yk.justify,onClick:function(){return l.execCommand(yk.justify)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-justify"}))))}function bk(t){var e=t.selections,n=0===e.length||e.some((function(t){return t.locked})),r=lb.get(e,"textVerticalAlign");return Hr.includes(r)||(r="middle"),Oe.a.createElement(lb,{disabled:n,className:"text-format-control"},Oe.a.createElement(ze.a.Group,{className:"text-format-li properties-text-format-text-v-align",disabled:n,defaultValue:"middle",value:r},Yr.map((function(n){var r=n.key,a=n.icon;return Oe.a.createElement(ze.a.Button,{key:r,value:r,onClick:function(){return function(n){t.onChange("textVerticalAlign",n,us(e))}(r)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(a)}))}))))}function xk(t){var e=t.diagram;return Oe.a.createElement(Re.a,{block:!0,onClick:function(){e.command.execute("AttachLink")}},Mr("添加链接"))}gk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,diagram:Pe.a.object.isRequired},gk.key="TextHAlign",We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.properties-text-format-text-v-align.ant-radio-group {\n  display: flex;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper {\n  flex-grow: 1;\n  padding: 0 17.5px;\n  text-align: center;\n}\n.properties-text-format-text-v-align.ant-radio-group .ant-radio-button-wrapper-disabled {\n  border-color: var(--yq-border-primary);\n}\n"),bk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,diagram:Pe.a.object.isRequired,onChange:Pe.a.func.isRequired},bk.key="TextVAlign",xk.propTypes={diagram:Pe.a.object.isRequired},xk.key="TextLink";var kk=[{name:Mr("基础格式"),hideHeader:!0,tabKey:"text",condition:function(t){return t.length>0&&t.every((function(t){return t.canUpdateText()}))},controls:[{Control:vk}]},{name:Mr("对齐方式"),tabKey:"text",condition:function(t){return t.length>0&&t.every((function(t){return t.canUpdateText()}))},controls:[{Control:gk},{Control:bk,display:function(t){return t.some((function(t){return t.canTextVerticalAlign()}))}}]},{name:Mr("链接"),tabKey:"text",condition:function(t){return t.length>0&&t.every((function(t){return t.canText()&&!hr(t)}))},controls:[{Control:xk}]}];function wk(t){var e=t.selections,n=t.diagram,r=0===e.length,a=e.filter((function(t){return t.isLine})),i={source:Mr("起点"),target:Mr("终点")},o=Object.keys(i).map((function(e){var n,i="".concat(e,".marker"),o=lb.get(a,i)||"none";return Oe.a.createElement("div",{className:"lake-diagram-line-arrow-control-".concat(e),key:e},Oe.a.createElement(De.a,{disabled:r,trigger:["click"],overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,onClick:function(e){var n=e.key;t.onChange(i,"none"===n?null:n,a)},style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Fu.map((function(t){return Oe.a.createElement(Ne.a.Item,{className:Me()("lake-diagram-line-endpoint-item",{active:t===o}),"test-id":"lake-diagram-line-endpoint-item-".concat(t),key:t,style:{textAlign:"center"}},Oe.a.createElement("span",{className:Me()("lake-icon lake-icon-contextual-".concat(t),{source:"source"===e})}))}))),placement:"bottomRight"},Oe.a.createElement("div",{className:Me()("lake-diagram-line-arrow-selected")},Oe.a.createElement("span",{className:Me()("lake-diagram-line-arrow-selected-item","lake-icon",(n={"lake-diagam-multi-properties-selection":"multiValue"===o},c()(n,"lake-icon-contextual-".concat(o),o),c()(n,"source","source"===e),n))}),Oe.a.createElement(eb,{className:"lake-properties-line-arrow-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}}))))}));return o.splice(1,0,Oe.a.createElement("span",{key:"lake-icon-contextual-line-swap-endpoint",onClick:function(){n.command.execute("LineSwapEndpoint",{autoSelect:!0})},style:{fontSize:"14px",cursor:"pointer"},className:"lake-icon lake-icon-contextual-line-swap-endpoint"})),Oe.a.createElement(lb,{className:"lake-diagram-line-arrow-control",disabled:r},o)}We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-line-arrow-control .lake-diagram-control-body {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  gap: 16px;\n}\n.lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.lake-diagram-line-endpoint-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-endpoint-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-line-arrow-selected {\n  line-height: 0;\n}\n.lake-diagram-line-arrow-selected .lake-diagram-line-arrow-selected-item {\n  width: 32px;\n  height: 32px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n}\n.lake-diagram-line-arrow-selected .lake-properties-line-arrow-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-arrow-selected .lake-diagram-properties-line-arrow {\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-line-arrow-control-source,\n.lake-diagram-line-arrow-control-target {\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-line-arrow-control-source .lake-diagram-line-arrow-selected,\n.lake-diagram-line-arrow-control-target .lake-diagram-line-arrow-selected {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n"),wk.defaultProps={onChange:function(){}},wk.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired,diagram:Pe.a.object},wk.key="LineArrowControl",We('.lake-diagram-line-shape-item {\n  width: 92px;\n  height: 32px;\n  background-repeat: no-repeat;\n  background-position: center;\n  text-align: center;\n}\n.lake-diagram-line-shape-item > img {\n  margin: auto;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-item > img {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected {\n  line-height: 0;\n}\n.lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  width: 70px;\n  display: inline-block;\n}\n[data-kumuhana="pouli"] .lake-diagram-line-shape-selected .lake-diagram-line-shape-selected-item {\n  filter: invert(100%);\n}\n.lake-diagram-line-shape-selected .lake-properties-line-shape-dropdown-icon {\n  width: 10px;\n  height: 10px;\n  float: right;\n  margin-top: 11px;\n  margin-right: 10px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-line-shape-selected .lake-diagram-properties-line-shape {\n  width: 100%;\n  height: 100%;\n}\n');var Ck={none:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",straight:"https://gw.alipayobjects.com/zos/bmw-prod/a9d015cf-7b31-496c-b60d-e224f7f0df29.svg",curve:"https://gw.alipayobjects.com/zos/bmw-prod/e683ab4e-70b3-4bcf-8eb1-ad843acf2add.svg",elbow:"https://gw.alipayobjects.com/zos/bmw-prod/96671966-3f77-469f-afa7-40ff402dc773.svg"};function Ak(t){var e=t.selections,n=0===e.length,r=e.filter((function(t){return t.isLine})),a=lb.get(r,"shape");return Oe.a.createElement(lb,{className:"lake-diagram-properties-line-shape",disabled:n,title:Mr("类型"),extra:Oe.a.createElement(De.a,{disabled:n,trigger:["click"],overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,onClick:function(e){var n=e.key;t.onChange("shape","none"===n?null:n,r)}},Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-none",key:"none"},Oe.a.createElement("img",{src:Ck.none,alt:Mr("直线")})),Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-curve",key:"curve"},Oe.a.createElement("img",{src:Ck.curve,alt:Mr("曲线")})),Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-line-shape-item","test-id":"lake-diagram-line-shape-item-elbow",key:"elbow"},Oe.a.createElement("img",{src:Ck.elbow,alt:Mr("折线")}))),placement:"bottomRight"},Oe.a.createElement("div",{className:"lake-diagram-line-shape-selected"},Oe.a.createElement("span",{className:"lake-diagram-line-shape-item lake-diagram-line-shape-selected-item",style:{backgroundImage:"url(".concat(Ck[a||"none"],")")}}),Oe.a.createElement(eb,{className:"lake-properties-line-shape-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}Ak.defaultProps={onChange:function(){}},Ak.propTypes={selections:Pe.a.arrayOf(Pe.a.object).isRequired,onChange:Pe.a.func.isRequired},Ak.key="LineShapeControl";var Ok=[{name:Mr("线条"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isLine}))},controls:[{Control:Ak},{path:"stroke.color",Control:Xx},{path:"stroke.width",Control:Wx},{Control:Zx}]},{name:Mr("端点"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isLine}))},controls:[{Control:wk}]},{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isLine}))},controls:[{Control:Qx}]}],Ek=[{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return t.isImage&&null!=t.opacity}))},controls:[{Control:Qx}]}],Pk=function(t){var e,n=t.diagram;n.selector.selections.length>0&&(e=n.selector.selections[0]);var r,a=0;e&&(gr(e)&&(e=e.parent),a=(null===(r=e.children)||void 0===r?void 0:r.length)||0);var i=Object(Ae.useState)(a),o=b()(i,2),c=o[0],l=o[1];function s(t){qt()(t)&&(t=Je(t,1,50))!==a&&(n.command.execute("ChangeLaneNumber",{number:t}),l(t))}return Oe.a.createElement(Dx,{min:1,max:50,value:c,onBlur:function(){},onPressEnter:function(t){s(Number(t.target.value))},onStep:s})},Sk=function(t){var e=t.title,n=t.diagram;return Oe.a.createElement(lb,{title:e,extra:Oe.a.createElement(Pk,{diagram:n})})};Sk.defaultProps={title:Mr("泳道数"),onChange:function(){}},Sk.propTypes={title:Pe.a.string,diagram:Pe.a.object},Sk.key="LaneNumberControl";var Mk=[{name:Mr("泳道"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return yr(t)}))},controls:[{display:function(t){return 1===t.length&&yr(t[0])},Control:Sk},{path:"fill.color",Control:Gx}]},{name:Mr("边框"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return yr(t)}))},controls:[{path:"stroke.color",Control:Xx},{path:"stroke.width",Control:Wx},{Control:Zx}]},{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return yr(t)}))},controls:[{Control:Qx}]}];function jk(t){if(t.length<1)return!1;var e=t[0],n=gr(e)?e.parent:void 0;return!!n&&t.every((function(t){return t.parent===n}))}var Rk=[{name:Mr("泳道"),tabKey:"style",condition:function(t){return jk(t)},controls:[{display:function(t){return jk(t)},Control:Sk},{path:"fill.color",Control:Gx}]}],Lk=[{name:Mr("节点"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return dr(t)}))},controls:[{path:"fill.color",Control:Gx}]},{name:Mr("边框"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return dr(t)}))},controls:[{path:"stroke.color",Control:Xx},{path:"stroke.width",Control:Wx},{Control:Zx}]},{name:Mr("不透明度"),tabKey:"style",condition:function(t){return t.length>0&&t.every((function(t){return dr(t)}))},controls:[{Control:Qx}]},{name:Mr("编辑"),tabKey:"style",condition:function(t){return 1===t.length&&t.every((function(t){return dr(t)}))},controls:[{Control:function(t){var e=t.diagram;return Oe.a.createElement(Re.a,{block:!0,onClick:function(){e.command.execute("OpenDslEditNote")}},Mr("编辑"))}}]}];We(".lake-diagram-properties-viewport .lake-diagram-control-extra {\n  display: inline-block;\n  width: auto;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected-name {\n  display: inline-block;\n  padding-left: 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  height: 30px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-icon {\n  padding: 0 8px;\n}\n.lake-diagram-properties-viewport .lake-diagram-control-extra .lake-diagram-properties-viewport-selected .lake-properties-viewport-dropdown-icon {\n  padding: 0 8px;\n}\n");var Bk={WYSIWYG:{name:Mr("与编辑一致"),icon:"viewport-option-WYSIWYG"},adapt:{name:Mr("自动适配"),icon:"viewport-option-WYSIWYG"}};function Dk(t){var e=t.onChange,n=t.viewportOption,r=Bk[n]||Bk.adapt;return Oe.a.createElement(lb,{className:"lake-diagram-properties-viewport",title:Mr("默认窗口"),extra:Oe.a.createElement(De.a,{trigger:["click"],overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,onClick:function(t){var n=t.key;e(n)}},Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-properties-viewport-item",key:"WYSIWYG"},Bk.WYSIWYG.name),Oe.a.createElement(Ne.a.Item,{className:"lake-diagram-properties-viewport-item",key:"adapt"},Bk.adapt.name)),placement:"bottomRight"},Oe.a.createElement("div",{className:"lake-diagram-properties-viewport-selected"},Oe.a.createElement("span",{className:"lake-diagram-properties-viewport-selected-name"},r.name),Oe.a.createElement(eb,{className:"lake-properties-viewport-dropdown-icon",style:{color:"#8C8C8C",fontSize:"10px"}})))})}Dk.defaultProps={viewportOption:"adapt",onChange:function(){}},Dk.propTypes={viewportOption:Pe.a.string,onChange:Pe.a.func.isRequired},Dk.key="ViewportControl",We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-control .lake-diagram-canvas-background-color {\n  border: 4px solid var(--yq-white);\n  border-radius: 2px;\n  width: 100%;\n  height: 32px;\n}\n.lake-diagram-control.disabled .lake-diagram-canvas-background-color {\n  display: none;\n}\n"),Mr("画布颜色"),Pe.a.string,Pe.a.object,We("/* stylelint-disable */\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container {\n  width: 100%;\n  padding: 12px 1px;\n  box-shadow: none;\n}\n.lake-board-theme-picker-container.lake-board-properties-theme-picker-container .lake-board-theme-picker-item-container {\n  width: 118px;\n  height: 86px;\n}\n");var Nk={Control:Dk,props:{}},_k=[{name:Mr("阅读页配置"),tabKey:"global",condition:function(t){return 0===t.length},controls:[Nk]}];function Ik(t){var e=t.diagram,n=t.onClose;Object.assign(Nk.props,t.viewportOptionProps);var r={tabs:[{name:Mr("样式"),key:"style"},{name:Mr("文本"),key:"text"},{name:Mr("排列"),key:"arrangement"},{name:Mr("全局"),key:"global"}],className:"lake-diagram-properties-board",menus:[].concat(_k).concat(Hx).concat(tk).concat(ek).concat(Mk).concat(Rk).concat(Lk).concat(kk).concat(fk).concat(Ok).concat(Ek),diagram:e,emptyImg:"https://gw.alipayobjects.com/zos/bmw-prod/209ef531-e33b-4e55-8273-5b56b6df44be.svg"};return Oe.a.createElement("div",{className:"lake-diagram-properties-board-wrapper","data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-properties-board-header"},Oe.a.createElement("span",{className:"lake-diagram-properties-board-header-title"},Mr("设置")),Oe.a.createElement("span",{className:"lake-diagram-properties-board-header-close-button",onClick:n})),Oe.a.createElement("div",{className:"lake-diagram-properties-body-wrapper"},Oe.a.createElement(cb,r)))}We(".lake-diagram-properties-board-wrapper {\n  height: 100%;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-body-wrapper {\n  height: calc(100% - 40px);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-left: 1px solid var(--yq-border-primary);\n  border-bottom: 1px solid var(--yq-border-primary);\n  padding: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-title {\n  margin: 4px 8px;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button {\n  margin-right: 8px;\n  width: 16px;\n  height: 16px;\n  display: block;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3a5cc682-0502-44f1-80cf-4a8de2d89e1e.svg);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board-header .lake-diagram-properties-board-header-close-button:hover {\n  cursor: pointer;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board {\n  background-color: var(--yq-white);\n  top: 0;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .ant-radio-button-wrapper {\n  background: var(--yq-bg-primary);\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab {\n  flex-grow: inherit;\n  padding: 8px 0;\n  margin: 0 16px;\n  border-bottom: 2px solid rgba(0, 0, 0, 0);\n  animation: none;\n}\n.lake-diagram-properties-board-wrapper .lake-diagram-properties-board .lake-diagram-panel-body .ant-tabs .ant-tabs-nav .ant-tabs-nav-list .ant-tabs-tab.ant-tabs-tab-active {\n  border-bottom: 2px solid black;\n}\n"),Ik.defaultProps={diagram:null,onClose:function(){},menus:[],viewportOptionProps:{}},Ik.propTypes={diagram:Pe.a.object,onClose:Pe.a.func,menus:Pe.a.array,viewportOptionProps:Pe.a.object};var Tk=function(t){var e=t.name,n=t.diagram,r=t.selections,a=0===r.length||r.some((function(t){return t.locked})),i=Object(Ae.useState)({}),o=b()(i,2),c=o[0],l=o[1],s=n.contentEditorPlus,u=c.bold;return Object(Ae.useEffect)((function(){function t(t){var e=t.query;l(e)}return n&&(s.on("querychange",t),s.emitQueryChange()),function(){s.off("querychange",t)}}),[n]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:a,placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-bold"}),className:Me()({active:u}),onClick:function(t){t.stopPropagation(),s.execCommand("bold")}})))};Tk.propTypes={title:Pe.a.string,selections:Pe.a.array,name:Pe.a.string,execCommand:Pe.a.func,diagram:Pe.a.object};var Fk=function(t){var e=t.name,n=t.diagram,r=t.title,a=t.disabled;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:a,placement:"top",title:r},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-link"}),onClick:function(t){t.preventDefault(),t.stopPropagation(),n.command.execute("CreateLink")}})))};Fk.propTypes={title:Pe.a.string,name:Pe.a.string,execCommand:Pe.a.func,diagram:Pe.a.object,disabled:Pe.a.oneOfType([Pe.a.bool,Pe.a.func])};var zk=function(t){var e=t.name,n=t.title,r=t.diagram;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:!1,placement:"top",title:n},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-dsl-edit"}),onClick:function(){r.command.execute("OpenDslEditNote")}})))},qk=function(t){var e=t.name,n=t.onProperties,r=t.title;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:!1,placement:"top",title:r},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-board-properties"}),onClick:n})))};qk.defaultProps={onProperties:function(){}},qk.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,onProperties:Pe.a.func},We(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var Yk=function(t){var e,n=t.name,r=t.diagram,a=Object(Ae.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=r.contentEditorPlus;r&&(null==r||null===(e=r.theme)||void 0===e||e.values.palette),Object(Ae.useEffect)((function(){function t(t){var e=t.query;c(e)}return r&&(l.on("querychange",t),l.emitQueryChange()),function(){l.off("querychange",t)}}),[r]);var s="#"+st()(o.color).toHex().toUpperCase(),u=Object(Ae.useState)(s||"rgb(38, 38, 38)"),d=b()(u,2),h=d[0],f=d[1],p=Object(Ae.useState)(!1),m=b()(p,2);function v(t){f(t),l.execCommand("foreColor",t)}return m[0],m[1],Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(Zb,{color:h,defaultColor:t.defaultColor,onSelect:v,onClear:function(){return v("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement("span",{style:{marginTop:"5px"}},Oe.a.createElement(Vb,{type:"t-font-color",fill:s})))},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement("span",{style:{marginTop:"5px"}},Oe.a.createElement(Vb,{type:"t-font-color",fill:s}))))))};Yk.defaultProps={defaultColor:"transparent"},Yk.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,currColor:Pe.a.string,defaultColor:Pe.a.string},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-h-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var Hk=function(t){return Oe.a.createElement(Ne.a,{className:Me()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-h-align",t.menuClassName),onSelect:t.onSelect,"data-lake_prevent_click_unselect":"true"},t.data.map((function(e){return Oe.a.createElement(Ne.a.Item,{key:e.key},Oe.a.createElement("span",{className:Me()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":e.key===t.currIcon})}),Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon," lake-diagram-dropdown-item")}),Oe.a.createElement("span",{className:"lake-diagram-dropdown-item"},e.title))})))},Gk=[{key:"left",icon:"left",title:"左对齐"},{key:"center",icon:"center",title:"居中对齐"},{key:"right",icon:"right",title:"右对齐"},{key:"justify",icon:"justify",title:"两端对齐"}],Xk=Gk.map((function(t){return t.key}));Hk.propTypes={title:Pe.a.string,menuClassName:Pe.a.string,data:Pe.a.array,onSelect:Pe.a.func,currIcon:Pe.a.string};var Wk=function(t){var e=t.name,n=t.diagram,r=n.contentEditorPlus,a=Object(Ae.useState)({}),i=b()(a,2),o=i[0],c=i[1],l=Object(Ae.useState)(!1),s=b()(l,2),u=s[0],d=s[1],h=o.textAlign;return Xk.includes(h)||(h="center"),Object(Ae.useEffect)((function(){function t(t){var e=t.query;c(e)}return n&&(r.on("querychange",t),r.emitQueryChange()),function(){r.off("querychange",t)}}),[n]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement(Hk,{data:Gk,onSelect:function(t){!function(t){if("justify"===t)r.execCommand("justifyFull");else r.execCommand("justify".concat(t&&t[0].toUpperCase()+t.slice(1)))}(t.key),d(!1)},currIcon:h}),placement:"bottomCenter",trigger:"click",visible:u,onVisibleChange:function(t){d(t)}},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e,onClick:function(){return d(!0)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(h)})))))};Wk.defaultProps={defaultAlign:"center"},Wk.propTypes={title:Pe.a.string,data:Pe.a.array,name:Pe.a.string,diagram:Pe.a.object,defaultAlign:Pe.a.string},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n.contextual-text-size-font-size-menu {\n  min-width: 104px;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item {\n  text-align: center;\n  position: relative;\n}\n.contextual-text-size-font-size-menu .ant-dropdown-menu-item .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  left: 12px;\n  top: 9px;\n}\n");var Vk=function(t){var e=t.name,n=t.diagram,r=Object(Ae.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=n.contentEditorPlus,l=i.fontSize;return Object(Ae.useEffect)((function(){function t(t){var e=t.query;o(e)}return n&&(c.on("querychange",t),c.emitQueryChange()),function(){c.off("querychange",t)}}),[n]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:["click"],value:l,onChange:function(t){return c.execCommand("fontSize",parseInt(t.target.value))},overlay:Oe.a.createElement(Ne.a,{"data-lake_prevent_click_unselect":!0,className:"lake-user-select-none contextual-text-size-font-size-menu",selectedKeys:[l&&l.toString()],onClick:function(t){var e=t.key;return c.execCommand("fontSize",parseInt(e))}},[12,14,15,16,18,22,24,32,36,48,64,92].map((function(t){return Oe.a.createElement(Ne.a.Item,{key:t},t===l&&Oe.a.createElement("span",{className:"lake-icon lake-icon-success"}),t,"px")}))),placement:"bottomCenter"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"text-msg"}," ",l?"".concat(l,"px"):t.defaultFontSize," ")))))};Vk.defaultProps={defaultFontSize:"14px"},Vk.propTypes={title:Pe.a.string,data:Pe.a.array,name:Pe.a.string,selections:Pe.a.array,diagram:Pe.a.object,defaultFontSize:Pe.a.string},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .lake-diagram-dropdown-item {\n  color: var(--yq-text-primary);\n  font-size: 14px;\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item {\n  height: 32px;\n  line-height: 32px;\n  padding: 0 12px;\n  text-align: left;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item.active {\n  background: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu.lake-diagram-contextual-toolbar-text-v-align .ant-menu-item-selected {\n  background: none;\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var Zk=function(t){return Oe.a.createElement(Ne.a,{className:Me()("lake-diagram-contextual-toolbar-dropdown-menu lake-diagram-contextual-toolbar-text-v-align",t.menuClassName),onSelect:t.onSelect,"data-lake_prevent_click_unselect":"true"},t.data.map((function(e){return Oe.a.createElement(Ne.a.Item,{key:e.key},Oe.a.createElement("span",{className:Me()("lake-icon lake-diagram-dropdown-item",{"lake-icon-success":e.key===t.currIcon})}),Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(e.icon," lake-diagram-dropdown-item")}),Oe.a.createElement("span",{className:"lake-diagram-dropdown-item"},e.title))})))};Zk.propTypes={title:Pe.a.string,menuClassName:Pe.a.string,data:Pe.a.array,onSelect:Pe.a.func,currIcon:Pe.a.string};var Uk=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)(!1),a=b()(r,2),i=a[0],o=a[1],c=t.get(n,"textVerticalAlign");return Hr.includes(c)||(c="middle"),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{disabled:!0,overlay:Oe.a.createElement(Zk,{data:Yr,onSelect:function(e){!function(e){t.execCommand("textVerticalAlign",e,us(n))}(e.key),o(!1)},currIcon:c}),placement:"bottomCenter",trigger:"click",visible:i,onVisibleChange:function(t){o(t)}},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e,onClick:function(){return o(!0)}},Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(c)})))))};Uk.defaultProps={defaultAlign:"middle"},Uk.propTypes={title:Pe.a.string,data:Pe.a.array,name:Pe.a.string,selections:Pe.a.array,defaultAlign:Pe.a.string,execCommand:Pe.a.func.isRequired,get:Pe.a.func.isRequired},We(".lake-diagram-board-color-pick-container {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 0;\n  min-width: 74px;\n}\n");var Kk=function(t){var e,n=t.name,r=t.diagram,a=t.selections,i=a.every((function(t){return t.isMindmap})),o=Object(Ae.useState)(t.defaultColor),c=b()(o,2),l=c[0],s=c[1],u=Object(Ae.useState)(!1),d=b()(u,2);d[0],d[1];var h=Object(Ae.useState)(null),f=b()(h,2),p=f[0],m=f[1];r&&(null==r||null===(e=r.theme)||void 0===e||e.values.palette);var v=function(t){var e=st()(t).toRgb();return.3*e.r+.59*e.g+.11*e.b>=248},y=function(e){s(e),i?t.execCommand("border.fill",e,a):t.execCommand("fill.color",e,us(a)),v(e)?m("#e8e8e8"):m(null)};return Object(Ae.useEffect)((function(){if(a&&a.length>0){var e=i?"border.fill":"fill.color",n=t.get(a,e),r="multiValue"===n?"#FFFFFF":n;s(r),v(r)?m("#e8e8e8"):m(null)}return function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(Zb,{color:l,defaultColor:t.defaultColor,onSelect:y,onClear:function(){return y("rgba(0, 0, 0, 0)")},diagram:r,transSVG:Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement(Vb,{type:"t-bg-color",fill:l,stroke:p}))},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement(Vb,{type:"t-bg-color",fill:l,stroke:p})))))};function Qk(t){var e=Object(Ae.useRef)(),n=t.width,r=t.height,a=t.shape,i=a&&sc.find((function(t){return t.name===a}));return Object(Ae.useEffect)((function(){if(e.current&&i){var t=new Xh({stencil:i,width:n,height:r,noFill:!0,stroke:_h("text"),fill:"transparent"}).rendererElement;Array.from(e.current.children,(function(t){return t.remove()})),e.current.appendChild(t)}}),[e,n,r,i]),i?Oe.a.createElement("svg",{ref:e,width:n,height:r,viewBox:[0,0,n,r].join(" ")}):null}Kk.defaultProps={defaultColor:"transparent"},Kk.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,currColor:Pe.a.string,defaultColor:Pe.a.string,execCommand:Pe.a.func,get:Pe.a.func,disabled:Pe.a.oneOfType([Pe.a.bool,Pe.a.func])},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-shape-current {\n  width: 100%;\n  height: 32px;\n  min-width: 34px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagrm-contexual-shape-select-container {\n  max-height: 272px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  display: flex;\n}\n"),Qk.propTypes={width:Pe.a.number,height:Pe.a.number,shape:Pe.a.string};var $k=function(t){var e,n=t.name,r=t.selections,a=t.get(r,"shape"),i=(null===(e=sc[sc.findIndex((function(t){return t.name===a}))])||void 0===e?void 0:e.category)||"basic";return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement("div",{className:"lake-diagrm-contexual-shape-select-container"},Oe.a.createElement(Zg,{onSelect:function(e){var n=e.key;t.execCommand("shape",n,r)},groups:[i]})),key:t.key,placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":n},Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-shape-current",{"lake-diagam-multi-properties-selection":"multiValue"===a})},Oe.a.createElement(Qk,{shape:a,width:30,height:30}))))))};function Jk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tw(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jk(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jk(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}$k.propTypes={title:Pe.a.string,command:Pe.a.string,name:Pe.a.string,onSelect:Pe.a.func,key:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,execCommand:Pe.a.func,get:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-stroke-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-right: 8px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-stroke-dropdown .geo-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-stroke-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-stroke-width-control .lake-diagram-board-contextual-stroke-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-stroke-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var ew=function(t){var e=t.diagram,n=t.selections,r=t.strokeProps,a=t.setStrokeProps,i=Object(Ae.useState)(r.style?"dash":"none"),o=b()(i,2),c=o[0],l=o[1],s=function(e){if((e=Number(e))>=1&&e<=10){var i=Math.min(Math.max(e,1),10);i!==r.width&&(a(tw(tw({},r),{},{width:i})),t.execCommand("stroke.width",i,n))}},u=function(e){t.onSelect&&t.onSelect(e)},d=function(e){t.execCommand("stroke.style",e,n)};return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-stroke-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},n.every((function(t){return!kr(t)}))&&Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:Me()("geo-btn",{active:"none"===c}),onClick:function(t){t.preventDefault(),l("none"),d(null)}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:Me()("geo-btn",{active:"dash"===c}),onClick:function(t){t.preventDefault(),l("dash"),d("dash")}})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"})),Oe.a.createElement("div",{className:"lake-diagram-contextual-stroke-dropdown-row"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-control"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-width-inner"},Oe.a.createElement(Dx,{min:1,max:10,value:r.width,onInput:s,onStep:s}))),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-stroke-color"},Oe.a.createElement(Zb,{color:r.color,defaultColor:t.defaultColor,onSelect:u,onClear:function(){return u("rgba(0, 0, 0, 0)")},transSVG:Oe.a.createElement(Vb,{type:"context-cb-trans"}),diagram:e},Oe.a.createElement("div",{className:Me()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};ew.propTypes={title:Pe.a.string,colorBadge:Pe.a.object,name:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,onSelect:Pe.a.func,defaultColor:Pe.a.string,strokeProps:Pe.a.object,selections:Pe.a.array,setStrokeProps:Pe.a.func,execCommand:Pe.a.func};var nw=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)(!1),l=b()(c,2),s=l[0],u=l[1];return Object(Ae.useEffect)((function(){return n&&n.length>0&&o(n[0].stroke),function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{visible:s,onVisibleChange:function(t){u(t)},overlay:Oe.a.createElement(ew,Ce()({setStrokeProps:o,strokeProps:i,onSelect:function(e){o(tw(tw({},i),{},{color:e})),t.execCommand("stroke.color",e,n)}},t)),placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement(Vb,{type:"stroke-color",stroke:i.color})))))};nw.defaultProps={defaultColor:"transparent"},nw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,currColor:Pe.a.string,defaultColor:Pe.a.string,execCommand:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-geometry-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-geometry-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-geometry-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var rw=function(t){var e=t.diagram,n=Object(Ae.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=e.contentEditorPlus;Object(Ae.useEffect)((function(){function t(t){var e=t.query;i(e)}return e&&(o.on("querychange",t),o.emitQueryChange()),function(){o.off("querychange",t)}}),[e]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-geometry-text-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Re.a,{className:Me()({active:c}),icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Oe.a.createElement(Re.a,{className:Me()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Oe.a.createElement(Re.a,{className:Me()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Oe.a.createElement(Re.a,{className:Me()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Vk,Ce()({},t,{textStyle:a,title:Mr("字号")})),Oe.a.createElement(Yk,Ce()({},t,{textStyle:a,title:Mr("字色")})),Oe.a.createElement(Wk,Ce()({},t,{textStyle:a,title:Mr("水平对齐")})),Oe.a.createElement(Uk,Ce()({},t,{title:Mr("竖直对齐")}))))};rw.defaultProps={defaultColor:"transparent"},rw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,className:Pe.a.string};var aw=function(t){var e=t.name,n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:"click",visible:a,onVisibleChange:function(t){i(t)},overlay:Oe.a.createElement(rw,t)},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};aw.defaultProps={defaultColor:"transparent"},aw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-toolbar-dropdown .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu {\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::before {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu::after {\n  display: none;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-diagram-dropdown-item {\n  margin-left: 4px;\n  margin-right: 4px;\n  min-width: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item {\n  min-width: 32px;\n  height: 32px;\n  padding: 0 6px;\n  border-radius: 3px;\n  text-align: center;\n  line-height: 32px;\n  margin: 0 2px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 16px;\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .lake-icon.source {\n  transform: matrix(-1, 0, 0, 1, 0, 0);\n}\n.ant-menu-root.lake-diagram-contextual-toolbar-dropdown-menu .ant-menu-item-selected {\n  color: var(--yq-text-body);\n}\n.text-msg {\n  min-width: 34px;\n  font-size: 16px;\n}\n");var iw=function(t){var e=t.onSelect,n=t.source,r=t.marker;return Oe.a.createElement(Ne.a,{className:Me()("lake-diagram-contextual-toolbar-dropdown-menu"),"data-lake_prevent_click_unselect":"true",onSelect:e,style:{padding:"5px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)"}},Fu.map((function(t){return Oe.a.createElement(Ne.a.Item,{key:t,className:Me()({active:t===r})},Oe.a.createElement("span",{className:Me()("lake-icon lake-icon-contextual-".concat(t," lake-diagram-dropdown-item"),{source:n})}))})))};iw.propTypes={source:Pe.a.bool,title:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,onSelect:Pe.a.func,marker:Pe.a.string};var ow=function(t){var e=t.name,n=t.selections,r=t.type,a=Object(Ae.useState)(null),i=b()(a,2),o=i[0],c=i[1],l=Object(Ae.useState)(t.defaultIcon),s=b()(l,2),u=s[0],d=s[1],h=Object(Ae.useState)(!1),f=b()(h,2),p=f[0],m=f[1];return Object(Ae.useEffect)((function(){if(n&&n.length>0){var t=n[0][r];t.marker?c(t.marker):c("none"),Fu.filter((function(e){return e===t.marker})).forEach((function(t){return d("contextual-".concat(t))}))}return function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement(iw,Ce()({onSelect:function(e){var a=e.key;t.execCommand("".concat(r,".marker"),"none"===a?null:a,n),c(a),Fu.filter((function(t){return t===a})).forEach((function(t){return d("contextual-".concat(t))})),m(!1)},marker:o,source:"source"===r,trigger:"click"},t)),placement:"bottomCenter",trigger:"click",visible:p,onVisibleChange:function(t){m(t)}},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e,onClick:function(){return m(!0)}},Oe.a.createElement("span",{className:Me()("lake-icon lake-icon-".concat(u),{source:"source"===r})})))))};function cw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lw(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cw(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cw(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}ow.defaultProps={defaultIcon:"contextual-stroke-none"},ow.propTypes={type:Pe.a.string,title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,defaultIcon:Pe.a.string,execCommand:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn .lake-icon {\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-toolbar-separator {\n  height: 1px;\n  background: var(--yq-border-primary);\n  width: 100%;\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.lake-diagram-board-contextual-line-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-line-width-control .lake-diagram-board-contextual-line-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-line-width-control .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-line-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  min-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var sw=function(t){var e=t.diagram,n=t.selections,r=t.strokeProps,a=t.setStrokeProps,i=Object(Ae.useState)(r.style?"dash":"none"),o=b()(i,2),c=o[0],l=o[1],s=function(e){if((e=Number(e))>=1&&e<=10){var i=Math.min(Math.max(e,1),10);i!==r.width&&(a(lw(lw({},r),{},{width:i})),t.execCommand("stroke.width",i,n))}},u=function(e){t.onSelect&&t.onSelect(e)},d=function(e){t.execCommand("stroke.style",e,n)},h=function(e){t.execCommand("shape",e,n)};return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-line-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-straight-line"}),className:Me()({active:"straight"===t.currShape}),onClick:function(e){e.preventDefault(),h("straight"),t.setCurrShape("straight")}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-curve-line"}),target:"dash",className:Me()({active:"curve"===t.currShape}),onClick:function(e){e.preventDefault(),h("curve"),t.setCurrShape("curve")}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-elbow-line"}),target:"dash",className:Me()({active:"elbow"===t.currShape}),onClick:function(e){e.preventDefault(),h("elbow"),t.setCurrShape("elbow")}})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-none"}),className:Me()({active:"none"===c}),onClick:function(t){t.preventDefault(),l("none"),d(null)}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-stroke-dash"}),target:"dash",className:Me()({active:"dash"===c}),onClick:function(t){t.preventDefault(),l("dash"),d("dash")}})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-line-dropdown-row"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-control"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-line-width-inner"},Oe.a.createElement(Dx,{min:1,max:10,value:r.width,onStep:s,onInput:s}))),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-line-color"},Oe.a.createElement(Zb,{color:r.color,defaultColor:t.defaultColor,onSelect:u,onClear:function(){return u("rgba(0, 0, 0, 0)")},diagram:e,transSVG:Oe.a.createElement(Vb,{type:"context-cb-trans"})},Oe.a.createElement("div",{className:Me()("lake-diagram-stroke"),style:{backgroundColor:r.color}})))))};sw.propTypes={title:Pe.a.string,colorBadge:Pe.a.object,name:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,onSelect:Pe.a.func,defaultColor:Pe.a.string,strokeProps:Pe.a.object,selections:Pe.a.array,setStrokeProps:Pe.a.func,currShape:Pe.a.string,setCurrShape:Pe.a.func,execCommand:Pe.a.func};var uw=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)(t.defaultShape),l=b()(c,2),s=l[0],u=l[1];return Object(Ae.useEffect)((function(){return n&&n.length>0&&(o(n[0].stroke),u(n[0].shape)),function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement(sw,Ce()({setStrokeProps:o,strokeProps:i,onSelect:function(e){o(lw(lw({},i),{},{color:e})),t.execCommand("stroke.color",e,n)},currShape:s,setCurrShape:u},t)),placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-".concat(s,"-line")})))))};uw.defaultProps={defaultShape:"straight"},uw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,defaultShape:Pe.a.string,execCommand:Pe.a.func};var dw=function(t){var e=t.title,n=t.name,r=t.diagram;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command","data-lake_prevent_click_unselect":"true"},Oe.a.createElement(je.a,{placement:"top",title:e},Oe.a.createElement(Re.a,{"data-testid":n,onClick:function(){r.command.execute("LineSwapEndpoint",{autoSelect:!1})}},Oe.a.createElement("span",{className:Me()("lake-icon lake-icon-".concat(n))}))))};We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-line-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-line-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-line-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var hw=function(t){var e=t.diagram,n=Object(Ae.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=e.contentEditorPlus;Object(Ae.useEffect)((function(){function t(t){var e=t.query;i(e)}return e&&(o.on("querychange",t),o.emitQueryChange()),function(){o.off("querychange",t)}}),[e]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-line-text-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Re.a,{className:Me()({active:c}),icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Oe.a.createElement(Re.a,{className:Me()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Oe.a.createElement(Re.a,{className:Me()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Oe.a.createElement(Re.a,{className:Me()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Vk,Ce()({},t,{textStyle:a,title:Mr("字号")})),Oe.a.createElement(Yk,Ce()({},t,{textStyle:a,title:Mr("字色")})),Oe.a.createElement(Wk,Ce()({},t,{textStyle:a,title:Mr("水平对齐")}))))};hw.defaultProps={defaultColor:"transparent"},hw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,className:Pe.a.string};var fw=function(t){var e=t.name,n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:"click",visible:a,onVisibleChange:function(t){i(t)},overlay:Oe.a.createElement(hw,t)},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};fw.defaultProps={defaultColor:"transparent"},fw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array};var pw=function(t){var e=t.name,n=t.title,r=t.diagram,a=t.boardWebProxy;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:!1,placement:"top",title:n},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-abstract"}),onClick:function(){a&&a.spm&&a.spm.click("b4693.c116586.d241682",{"toolbar(MindmapAppendAbstract)":1}),r.command.execute("MindmapAppendAbstract")}})))};pw.defaultProps={onProperties:function(){}},pw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,onProperties:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-layout-current {\n  width: 100%;\n  height: 30px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  border-radius: 4px;\n}\n.lake-diagram-contextual-command {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagram-contextual-command > * {\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n}\n.lake-diagam-multi-properties-selection {\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/8c02d0c7-9749-4078-b865-6084959df78f.svg);\n}\n.lake-diagram-contextual-mindmap-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn {\n  padding: 0;\n  width: 32px;\n  line-height: 30px;\n  margin-left: 3px;\n  margin-right: 3px;\n  border: none;\n  background: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn[disabled] {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn.active {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-dropdown .mindmap-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-dropdown .lake-diagram-contextual-mindmap-dropdown-row {\n  display: flex;\n}\n.lake-diagram-board-contextual-mindmap-width-control {\n  max-width: 70px;\n  margin-right: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner {\n  border: none;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number {\n  width: 100%;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 5px;\n}\n.lake-diagram-board-contextual-mindmap-width-control .lake-diagram-board-contextual-mindmap-width-inner .ant-input-number-focused {\n  box-shadow: none;\n}\n.lake-diagram-board-contextual-mindmap-color {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n  width: 32px;\n  max-height: 32px;\n  overflow: hidden;\n  background: var(--yq-bg-primary);\n  cursor: pointer;\n}\n");var mw=function(t){var e=t.layouts,n=t.selectedKey,r=t.setVisible,a=t.visible;return Oe.a.createElement("div",{className:"lake-diagram-layout-dropdown","data-lake_prevent_click_unselect":"true"},e.map((function(e){var i=e.key;return Oe.a.createElement("div",{key:i,"data-lake_prevent_click_unselect":"true",className:Me()("lake-diagram-layout-thumb",i,{selected:i===n}),onClick:function(){r(!a),t.onSelect(i)}},Oe.a.createElement("div",{className:i}))})))};mw.propTypes={title:Pe.a.string,diagram:Pe.a.object,layouts:Pe.a.array,selectedKey:Pe.a.string,setVisible:Pe.a.func,onSelect:Pe.a.func,visible:Pe.a.bool};var vw=function(t){var e=t.name,n=t.selections.filter((function(t){return t.isMindmap})),r=Ri(n,lb),a=n.map((function(t){return t.upDirection}));n.map((function(t){return t.upLayoutType}));var i=Object(Ae.useState)(!1),o=b()(i,2),c=o[0],l=o[1],s=ji.filter((function(t){if(n.every((function(t){return t.isStem})))return!0;var e=t.key.split("-")[0],r=n.some((function(t){var n=t.upLayoutType,r=t.isAbstract;return Di(n,e,r)})),i=!t.directions.every((function(t){return a.every((function(e){return Bi(e,t)}))}));return!r&&!i}));function u(t){0!==s.length&&l(t)}return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement(mw,Ce()({setVisible:u,selectedKey:r,layouts:s,onSelect:function(e){t.execCommand("layout",Li(e),n)},visible:c},t)),placement:"bottomCenter",onClick:function(){return u(!c)},visible:c,onVisibleChange:function(t){return u(t)},trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-layout-current"),"data-testid":e},Oe.a.createElement("div",{className:Me()("lake-diagram-layout-thumb",{"lake-diagam-multi-properties-selection":"multiValue"===r})},Oe.a.createElement("div",{className:r}))))))};vw.defaultProps={selections:[]},vw.propTypes={title:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,execCommand:Pe.a.func,name:Pe.a.string};var yw=function(t){var e=function(e){t.execCommand("border.shape",e,t.selections),t.setShape(e)},n=t.diagram.selector.selections.every((function(t){return!t.isAbstract}));return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-mindmap-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},n?Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-mindmap-line"}),className:Me()("mindmap-btn",{active:"line"===t.shape}),onClick:function(t){t.preventDefault(),e("line")}}):null,Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-mindmap-rect"}),className:Me()("mindmap-btn",{active:"rect"===t.shape}),onClick:function(t){t.preventDefault(),e("rect")}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-mindmap-capsule"}),className:Me()("mindmap-btn",{active:"capsule"===t.shape}),onClick:function(t){t.preventDefault(),e("capsule")}})))};yw.propTypes={title:Pe.a.string,className:Pe.a.string,borderProps:Pe.a.object,selections:Pe.a.array,execCommand:Pe.a.func,shape:Pe.a.string,setShape:Pe.a.func,isLine:Pe.a.bool};var gw=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)(t.get(n,"border.shape","line")||null),a=b()(r,2),i=a[0],o=a[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{overlay:Oe.a.createElement(yw,Ce()({shape:i,isLine:"line"===i,setShape:o},t)),placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-layout-current",{"lake-diagam-multi-properties-selection":"multiValue"===i})},Oe.a.createElement("span",{className:"lake-icon lake-icon-mindmap-".concat(i)}))))))};function bw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xw(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bw(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bw(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}gw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,defaultShape:Pe.a.string,get:Pe.a.func};var kw=function(t){var e=t.diagram,n=t.selections,r=t.strokeProps,a=t.setStrokeProps,i=function(e){var i=Math.min(Math.max(e,1),10);i!==r.strokeWidth&&(a(xw(xw({},r),{},{strokeWidth:i})),t.execCommand("border.stroke-width",i,n))},o=function(t){i(t.target.value)},c=function(e){t.onSelect&&t.onSelect(e)};return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-mindmap-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Oe.a.createElement(Dx,{min:1,max:10,value:r.strokeWidth,onBlur:o,onPressEnter:o,onStep:i}))),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Oe.a.createElement(Zb,{color:r.strokeColor,defaultColor:t.defaultColor,onSelect:c,onClear:function(){return c("rgba(0, 0, 0, 0)")},diagram:e,transSVG:Oe.a.createElement(Vb,{type:"context-cb-trans"})},Oe.a.createElement(je.a,{placement:"top",title:Mr("边框颜色")},Oe.a.createElement("div",{className:Me()("lake-diagram-stroke"),style:{backgroundColor:r.strokeColor}}))))))};kw.propTypes={title:Pe.a.string,colorBadge:Pe.a.object,name:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,onSelect:Pe.a.func,defaultColor:Pe.a.string,strokeProps:Pe.a.object,selections:Pe.a.array,setStrokeProps:Pe.a.func,execCommand:Pe.a.func};var ww=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)(!1),l=b()(c,2),s=l[0],u=l[1],d=Object(Ae.useState)(!0),h=b()(d,2),f=h[0],p=h[1];return Object(Ae.useEffect)((function(){if(n&&n.length>0){var e=n.filter((function(t){return t.canStroke()&&t.isMindmap})),r=t.get(e,"border.stroke-width"),a=t.get(n,"border.shape","line")||null,i=t.get(n,"border.stroke","transparent")||null;o({strokeWidth:r,shape:a,strokeColor:i}),p("line"===a)}return function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{visible:s,onVisibleChange:function(t){u(t)},overlay:Oe.a.createElement(kw,Ce()({setStrokeProps:o,strokeProps:i,onSelect:function(e){o(xw(xw({},i),{},{strokeColor:e})),t.execCommand("border.stroke",e,n)},isLine:f},t)),placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement(Vb,{type:"stroke-color",stroke:i.strokeColor})))))};ww.defaultProps={defaultColor:"transparent"},ww.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,currColor:Pe.a.string,defaultColor:Pe.a.string,get:Pe.a.func,execCommand:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-mindmap-text-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-mindmap-text-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-mindmap-text-dropdown .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Cw=function(t){var e=t.diagram,n=Object(Ae.useState)({}),r=b()(n,2),a=r[0],i=r[1],o=e.contentEditorPlus;Object(Ae.useEffect)((function(){function t(t){var e=t.query;i(e)}return e&&(o.on("querychange",t),o.emitQueryChange()),function(){o.off("querychange",t)}}),[e]);var c=a.bold,l=a.italic,s=a.strikethrough,u=a.underline;return Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-mindmap-text-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Re.a,{className:Me()({active:c}),icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-bold"}),onClick:function(){return o.execCommand("bold")}}),Oe.a.createElement(Re.a,{className:Me()({active:l}),onClick:function(){return o.execCommand("italic")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-italic"})}),Oe.a.createElement(Re.a,{className:Me()({active:s}),onClick:function(){return o.execCommand("strikethrough")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-strikethrough"})}),Oe.a.createElement(Re.a,{className:Me()({active:u}),onClick:function(){return o.execCommand("underline")},icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-underline"})})),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-text-dropdown-row"},Oe.a.createElement(Vk,Ce()({},t,{textStyle:a,title:Mr("字号")})),Oe.a.createElement(Yk,Ce()({},t,{textStyle:a,title:Mr("字色")})),Oe.a.createElement(Wk,Ce()({},t,{textStyle:a,title:Mr("水平对齐")}))))};Cw.defaultProps={defaultColor:"transparent"},Cw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,className:Pe.a.string};var Aw=function(t){var e=t.name,n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:"click",visible:a,onVisibleChange:function(t){i(t)},overlay:Oe.a.createElement(Cw,t)},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-text"})))))};function Ow(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ew(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ow(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ow(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}Aw.defaultProps={defaultColor:"transparent"},Aw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array};var Pw=function(t){var e=t.diagram,n=t.selections,r=t.treeEdgeProps,a=t.setTreeEdgeProps,i=t.containRoot,o=on(n.map((function(t){return t.stem}))),c=Object(Ae.useState)(""),l=b()(c,2),s=l[0],u=l[1],d=function(e){var i=Math.min(Math.max(e,1),5);i!==r.width&&(a(Ew(Ew({},r),{},{"stroke-width":i})),t.execCommand("treeEdge.stroke-width",i,n))},h=function(t){d(t.target.value)},f=function(e){t.onSelect&&t.onSelect(e)},p=function(e){t.execCommand("treeEdge.shape",e,o),t.setTreeRootProps({shape:e?"polyline":"none"})};return Object(Ae.useEffect)((function(){return o.length>0&&u(o[0].treeEdge.shape||"none"),function(){}}),[]),Oe.a.createElement("div",{className:Me()("lake-diagram-contextual-mindmap-dropdown",t.className),"data-lake_prevent_click_unselect":"true"},Oe.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-none"}),className:Me()("mindmap-btn",{active:"none"===s}),onClick:function(t){t.preventDefault(),u("none"),p(null)}}),Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-polyline"}),target:"dash",className:Me()("mindmap-btn",{active:"polyline"===s}),onClick:function(t){t.preventDefault(),u("polyline"),p("polyline")}})),!i&&Oe.a.createElement(Oe.a.Fragment,null,Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar-separator"}),Oe.a.createElement("div",{className:"lake-diagram-contextual-mindmap-dropdown-row"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-control"},Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-width-inner"},Oe.a.createElement(Dx,{min:1,max:5,value:r["stroke-width"]||t.defaultStrokeWidth,onBlur:h,onPressEnter:h,onStep:d}))),Oe.a.createElement("div",{className:"lake-diagram-board-contextual-mindmap-color"},Oe.a.createElement(Zb,{color:r.stroke,defaultColor:t.defaultColor,onSelect:f,onClear:function(){return f("rgba(0, 0, 0, 0)")},diagram:e,transSVG:Oe.a.createElement(Vb,{type:"context-cb-trans"})},Oe.a.createElement("div",{className:Me()("lake-diagram-stroke"),style:{backgroundColor:r.stroke}}))))))};Pw.defaultProps={defaultStrokeWidth:3},Pw.propTypes={title:Pe.a.string,colorBadge:Pe.a.object,containRoot:Pe.a.bool,name:Pe.a.string,className:Pe.a.string,diagram:Pe.a.object,onSelect:Pe.a.func,defaultColor:Pe.a.string,treeEdgeProps:Pe.a.object,selections:Pe.a.array,setTreeEdgeProps:Pe.a.func,defaultStrokeWidth:Pe.a.number,execCommand:Pe.a.func,setTreeRootProps:Pe.a.func};var Sw=function(t){var e=t.name,n=t.selections,r=Object(Ae.useState)({}),a=b()(r,2),i=a[0],o=a[1],c=Object(Ae.useState)({}),l=b()(c,2),s=l[0],u=l[1],d=Object(Ae.useState)(!1),h=b()(d,2),f=h[0],p=h[1],m=n.some((function(t){return t.isStem}));return Object(Ae.useEffect)((function(){if(n&&n.length>0){var t=n[0];o(t.treeEdge),u(t.stem.treeEdge)}return function(){}}),[]),Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{visible:f,onVisibleChange:function(t){p(t)},overlay:Oe.a.createElement(Pw,Ce()({setTreeEdgeProps:o,setTreeRootProps:u,treeEdgeProps:i,onSelect:function(e){o(Ew(Ew({},i),{},{stroke:e})),t.execCommand("treeEdge.stroke",e,n)},containRoot:m},t)),placement:"bottomCenter",trigger:"click"},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-mind-tree-edge-".concat(s.shape?s.shape:"none")})))))};Sw.defaultProps={defaultColor:"transparent"},Sw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object,selections:Pe.a.array,currColor:Pe.a.string,defaultColor:Pe.a.string,execCommand:Pe.a.func},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-contextual-align-dropdown {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 3px 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 5px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  margin: 0 2px;\n  border-radius: 3px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:hover {\n  background: var(--yq-border-primary);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-contextual-align-dropdown .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-align-dropdown .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-align-dropdown p {\n  margin-bottom: 0;\n}\n");var Mw=function(t){var e=t.diagram;function n(t,n,r){return e.command.enable(t)&&Oe.a.createElement(je.a,{title:r},Oe.a.createElement(Re.a,{icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-".concat(n)}),onClick:function(){return e.command.execute(t)}}))}return Oe.a.createElement("div",{className:"lake-diagram-contextual-align-dropdown","data-lake_prevent_click_unselect":"true"},Oe.a.createElement("p",null,n("AlignLeft","align-left",Mr("左对齐")),n("AlignHCenter","align-h-center",Mr("左右居中")),n("AlignRight","align-right",Mr("右对齐")),n("DistributeHorizontally","distribute-horizontally",Mr("水平均分"))),Oe.a.createElement("p",null,n("AlignTop","align-top",Mr("顶对齐")),n("AlignVCenter","align-v-center",Mr("上下居中")),n("AlignBottom","align-bottom",Mr("底对齐")),n("DistributeVertically","distribute-vertically",Mr("垂直均分"))))};Mw.defaultProps={diagram:null},Mw.propTypes={diagram:Pe.a.object};var jw=function(t){var e=t.name,n=Object(Ae.useState)(!1),r=b()(n,2),a=r[0],i=r[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:"click",visible:a,onVisibleChange:function(t){i(t)},overlay:Oe.a.createElement(Mw,t)},Oe.a.createElement(je.a,{placement:"top",title:t.title},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-align"})))))};jw.defaultProps={title:"",name:"",diagram:null},jw.propTypes={title:Pe.a.string,name:Pe.a.string,diagram:Pe.a.object};var Rw=function(t){var e=t.name,n=t.diagram,r=t.title,a=t.disabled;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:a,placement:"top",title:r},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-group"}),onClick:function(t){t.preventDefault(),t.stopPropagation(),n.command.execute("MakeGroup")}})))};Rw.propTypes={title:Pe.a.string,name:Pe.a.string,execCommand:Pe.a.func,diagram:Pe.a.object,disabled:Pe.a.oneOfType([Pe.a.bool,Pe.a.func])};var Lw=function(t){var e=t.name,n=t.diagram,r=t.title,a=t.disabled;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{disabled:a,placement:"top",title:r},Oe.a.createElement(Re.a,{"data-testid":e,icon:Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-ungroup"}),onClick:function(t){t.preventDefault(),t.stopPropagation(),n.command.execute("Ungroup")}})))};Lw.propTypes={title:Pe.a.string,name:Pe.a.string,execCommand:Pe.a.func,diagram:Pe.a.object,disabled:Pe.a.oneOfType([Pe.a.bool,Pe.a.func])};var Bw=function(t){var e=t.diagram,n=t.title,r=t.name;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command"},Oe.a.createElement(je.a,{placement:"top",title:Mr(n)},Oe.a.createElement(Re.a,{"data-testid":r,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.command.execute("Delete",{cells:e.deduplicate(e.selector.selections).map((function(t){return t.model.id}))})}},Oe.a.createElement("span",{className:"lake-icon lake-icon-delete-lane"}))))},Dw=function(t){var e=t.diagram,n=t.title;return Oe.a.createElement("div",{className:"lake-diagram-contextual-command",style:{width:"72px"}},Oe.a.createElement(je.a,{placement:"top",title:Mr(n)},Oe.a.createElement(Pk,{diagram:e})))};function Nw(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nw(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nw(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-table {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 3px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 16px 10px 0 10px;\n  width: auto;\n  height: auto;\n}\n.lake-diagram-mindmap-icons-table .icon-title {\n  margin-bottom: 6px;\n  margin-left: 4px;\n}\n.lake-diagram-mindmap-icons-table .icons-container {\n  margin-bottom: 22px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px;\n  height: 26px;\n  width: 26px;\n  margin: 0 4px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: inline-block;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-table .icons-container .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n}\n.lake-diagram-mindmap-icons-table .icons-container .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-table .lake-button-active {\n  background-color: var(--yq-yuque-grey-4);\n}\n.lake-diagram-mindmap-icons-table .lake-diagram-contextual-text-dropdown-row {\n  display: flex;\n}\n");var Iw=function(t){var e=t.diagram,n=t.className,r=Object(Ae.useMemo)((function(){return Lr.map((function(t,r){var a=Dr[r];return Oe.a.createElement("div",{key:t},Oe.a.createElement("div",{className:Me()("icon-title",n)},Br[r]),Oe.a.createElement("div",{className:Me()("icons-container",n)},Pt()(a).map((function(n){return Oe.a.createElement("img",{className:"icon-btn",key:t+n,src:_r(t,n),id:"insert-icon-".concat(t,"-").concat(n),onClick:function(){var r=e.selector.selections.filter((function(t){return t.isMindmap}));e.command.execute("Update",{id:r.map((function(t){return t.model.id})),model:r.map((function(e){return{icons:_w(_w({},e.model.icons||{}),{},c()({},t,n))}})),notSelect:!0})}})}))))}))}),[]);return Oe.a.createElement("div",{className:Me()("lake-diagram-mindmap-icons-table",n),"data-lake_prevent_click_unselect":"true"},r)},Tw=function(t){var e=t.name,n=t.title,r=Object(Ae.useState)(!1),a=b()(r,2),i=a[0],o=a[1];return Oe.a.createElement("div",{className:"lake-diagram-contextual-command lake-diagram-contextual-toolbar-dropdown"},Oe.a.createElement(De.a,{trigger:"click",visible:i,onVisibleChange:function(t){o(t)},overlay:Oe.a.createElement(Iw,t)},Oe.a.createElement(je.a,{placement:"top",title:n},Oe.a.createElement(Re.a,{"data-testid":e},Oe.a.createElement("span",{className:"lake-icon lake-icon-contextual-mindmap-icon"})))))},Fw={name:"properties",type:"custom",custom:qk,title:Mr("打开设置"),noMini:!0},zw=function(t){return{type:"separator",noMini:t}},qw=function(t){var e=t&&1!==t.length?[]:[zw(),{name:"add-link",type:"custom",custom:Fk,title:Mr("插入链接"),hotkey:pt.ua.macos?"⌘+K":"Ctrl+K"}];return[{name:"contextual-text-size",type:"custom",custom:Vk,title:Mr("字号"),disabled:!1},zw(),{name:"contextual-text-color",type:"custom",title:Mr("字色"),disabled:!1,custom:Yk},{name:"contextual-text-h-alignment",title:Mr("水平对齐"),type:"custom",custom:Wk,disabled:!1},{name:"contextual-text-v-alignment",title:Mr("竖直对齐"),type:"custom",custom:Uk,disabled:function(t){return!t.selector.selections.some((function(t){return t.canTextVerticalAlign()}))}},{name:"contextual-text-bold",type:"custom",custom:Tk,title:Mr("加粗"),disabled:!1}].concat(e,[zw(!0),Fw])},Yw=function(){return[{name:"arrangement",type:"custom",custom:jw,title:Mr("排列"),disabled:function(t){return t.selector.selections.filter((function(t){return!t.isLine||t.isLine&&!t.source.id&&!t.target.id})).length<2}},{name:"group",type:"custom",custom:Rw,title:Mr("成组")},zw(!0)]};function Hw(t){var e=t.coord,n=t.overlayClassName,r=Object(Ae.useRef)();if(e){var a="lake-prevent-card-activated lake-diagram-prevent-mouse-select lake-diagram-prevent-mouseleave-reset-focus-point";return Oe.a.createElement(Fe.a,Ce()({},t,{getPopupContainer:function(){return t.getPopupContainer?t.getPopupContainer():document.querySelector(".yuque-sdk-extra-container")||t.diagram.container},visible:!0,overlayClassName:n?"".concat(n," ").concat(a):a,"data-lake_prevent_click_unselect":!0}),Oe.a.createElement("div",{ref:r,"data-lake_prevent_click_unselect":"true",style:{position:"absolute",left:"".concat(e[0],"px"),top:"".concat(e[1]-16,"px"),pointerEvents:"none",width:"".concat(t.width,"px"),height:"".concat(t.height+32,"px")}}))}return Oe.a.createElement("span",{ref:r})}Hw.defaultProps={coord:null,diagram:null,onClose:function(){}},Hw.propTypes={coord:Pe.a.array,diagram:Pe.a.object,onClose:Pe.a.func,overlayClassName:Pe.a.string,getPopupContainer:Pe.a.object,height:Pe.a.number,width:Pe.a.number},We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-uniform-toolbar-body {\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-body {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.lake-diagram-uniform-toolbar-separator {\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-uniform-toolbar-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n.lake-diagram-board-contextual-toolbar {\n  display: flex;\n  height: 40px;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  padding: 0 6px;\n}\n.lake-diagram-board-contextual-toolbar-body {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-left: 4px;\n  margin-right: 4px;\n  height: 100%;\n  border-radius: 5px;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background-clip: none;\n  border-radius: 8px;\n  background: var(--yq-white);\n  border: 1px solid rgba(239, 240, 240, 0.9);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.04), 0 4px 8px 1px rgba(0, 0, 0, 0.02);\n}\n[data-kumuhana=\"pouli\"] .ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner {\n  background: rgba(41, 41, 41);\n  box-shadow: 0 1px 2px -2px rgba(0, 0, 0, 0.08), 0 2px 6px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 6px rgba(0, 0, 0, 0.08);\n  border: none;\n}\n.ant-popover.lake-diagram-board-contextual-toolbar-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button {\n  display: flex;\n  height: 32px;\n  line-height: 32px;\n  border-radius: 2px;\n  border: 1px solid transparent;\n  align-items: center;\n  transition: border 0.3s;\n  margin-right: 4px;\n  overflow: hidden;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button:hover .ant-btn:first-child {\n  border-color: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn {\n  border-radius: 0;\n  transition: none;\n  margin-right: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child {\n  border-right: 1px solid transparent;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn:first-child:not(:last-child) {\n  min-width: auto;\n  width: auto;\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) {\n  min-width: auto;\n  width: 16px;\n  border: none;\n  background: none;\n  padding: 0;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  position: relative;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon {\n  color: var(--yq-text-primary);\n  position: absolute;\n  right: 4px;\n  top: 14px;\n  width: 8px;\n  height: 8px;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI1IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjQ1Ij48cGF0aCBkPSJNMC0yaDh2OEgweiIvPjxwYXRoIGQ9Ik0uNTk2LjU1N2wzLjE1IDMuODIxYS4zMzIuMzMyIDAgMDAuNDk1IDBMNy40MDUuNTU3YS4zMzIuMzMyIDAgMDAtLjI0Ny0uNTUzSC44NDVjLS4yODggMC0uNDQuMzM5LS4yNDkuNTUzeiIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9nPjwvc3ZnPg==);\n  background-repeat: no-repeat;\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child) .lake-icon::before {\n  content: '';\n}\n.lake-diagram-contextual-toolbar-dropdown .ant-dropdown-button .ant-btn.ant-dropdown-trigger:last-child:not(:first-child):hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-contextual-command .ant-btn {\n  border: none;\n  background: none;\n  padding: 0 6px;\n  height: 32px;\n  min-width: 32px;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  color: var(--yq-text-primary);\n}\n.lake-diagram-contextual-command .ant-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-contextual-command .ant-btn:hover,\n.lake-diagram-contextual-command .ant-btn.lake-button-active {\n  opacity: 0.9;\n  color: var(--yq-text-body);\n  background: var(--yq-bg-primary-hover-light);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn:hover,\n[data-kumuhana=\"pouli\"] .lake-diagram-contextual-command .ant-btn.lake-button-active {\n  background: rgba(255, 255, 255, 0.12);\n  border-radius: 6px;\n}\n.lake-diagram-contextual-command .ant-btn:focus {\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .ant-btn::after {\n  display: none;\n}\n.lake-diagram-contextual-command .ant-btn .lake-icon {\n  margin-right: 0;\n  font-size: 18px;\n}\n.lake-diagram-contextual-command .ant-btn.active {\n  background: var(--yq-bg-primary-hover-light);\n  color: var(--yq-text-body);\n}\n.lake-diagram-contextual-command .lake-button-active {\n  background-color: var(--yq-bg-primary-hover-light);\n}\n.lake-diagram-contextual-button-popover {\n  padding-top: 0;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content {\n  min-width: auto;\n  width: auto;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-arrow {\n  display: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner {\n  background-color: inherit;\n  box-shadow: none;\n  border-radius: 0;\n  background-clip: none;\n}\n.lake-diagram-contextual-button-popover .ant-popover-content .ant-popover-inner .ant-popover-inner-content {\n  padding: 0;\n  stroke: '@yuque-grey-4';\n  box-shadow: rgba(0, 0, 0, 0.08) 0 0 4px;\n}\n.lake-diagram-board-contextual-vertical-separator {\n  width: 1px;\n  height: 60%;\n  margin: 0 6px;\n  background: rgba(0, 0, 0, 0.05);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-board-contextual-vertical-separator {\n  background: rgba(255, 255, 255, 0.08);\n}\n");var Gw=["diagram","custom","boardWebProxy"];function Xw(t,e,n){var r=n;if(t.length>0)if((r=t.map((function(t){return e.split(".").reduce((function(t,e){return t?t.isCell&&t.get(e)||t[e]:t}),t)}))).every((function(t){return t===r[0]})))r=r[0];else{if(!r.every((function(t){return"number"==typeof t})))return"multiValue";r.sort(),r=r[r.length-1]}return r}var Ww=function(t){var e=t.diagram,n=t.custom;t.boardWebProxy;var r=Be()(t,Gw),a=Object(Ae.useCallback)((function(t,n,r){e.command.execute("Update",{id:r,model:bn(t,n),autoSelect:!1})}),[e]);switch(t.type){case"separator":default:return Oe.a.createElement("div",{className:"lake-diagram-board-contextual-vertical-separator"});case"custom":return Oe.a.createElement(n,Ce()({diagram:e,get:Xw,execCommand:a},r))}};function Vw(t){var e=t.diagram,n=t.onProperties,r=t.mini,a=t.boardWebProxy,i=Object(Ae.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=Object(Ae.useState)(null),u=b()(s,2),d=u[0],h=u[1],f=Object(Ae.useState)(null),p=b()(f,2),m=p[0],v=p[1],y=Object(Ae.useState)(0),g=b()(y,2),x=g[0],k=g[1],w=Object(Ae.useState)(0),C=b()(w,2),A=C[0],O=C[1],E=Object(Ae.useState)(!0),P=b()(E,2),S=P[0];P[1];var M=e.contentEditor;function j(){return function(t,e,n){var r=t.length,a=[];if(0===r)return[];if(function(t){return t.every((function(e){return e.type===t[0].type}))}(t))switch(t[0].type){case"line":a=[{name:"contextual-line-style",type:"custom",title:Mr("线条样式"),custom:uw},zw(),{name:"contextual-line-source",type:"custom",title:Mr("起点"),custom:function(t){return Oe.a.createElement(ow,Ce()({},t,{type:"source"}))}},{name:"contextual-line-swap-endpoint",type:"custom",title:Mr("转换"),custom:dw},{name:"contextual-line-target",type:"custom",title:Mr("终点"),custom:function(t){return Oe.a.createElement(ow,Ce()({},t,{type:"target"}))}},zw(),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:fw},zw(!0),Fw];break;case"mindmap":a=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[{name:"contextual-mindmap-layout",type:"custom",title:Mr("结构"),custom:vw,disabled:function(t){return t.selector.selections.some((function(t){return t.isAbstract}))}},{name:"contextual-mindmap-tree-edge",type:"custom",title:Mr("分支"),custom:Sw,disabled:!1},zw(),{name:"contextual-mindmap-shape",type:"custom",title:Mr("节点形状"),custom:gw,disabled:!1},{name:"contextual-mindmap-fill",type:"custom",title:Mr("节点填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},{name:"contextual-mindmap-stroke",type:"custom",title:Mr("节点描边"),custom:ww,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canStroke()})).length}},zw(),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:Aw,disabled:!1},{name:"add-icon",type:"custom",title:Mr("添加标记"),custom:Tw,disabled:!1},{name:"add-link",type:"custom",custom:Fk,title:Mr("插入链接"),disabled:!1}];return t&&e.push(zw(),{name:"add-abstract",type:"custom",title:Mr("添加概要"),custom:pw,disabled:!1}),e.concat([zw(!0),Fw])}(uv(t,!0));break;case"text":a=qw(t);break;case"geometry":a=[{name:"contextual-geometry-shape",type:"custom",custom:$k,title:Mr("图形"),disabled:!1},zw(),{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:Mr("描边"),disabled:!1,custom:nw},zw(),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:aw,disabled:!1},{name:"add-link",type:"custom",custom:Fk,title:Mr("插入链接"),hotkey:pt.ua.macos?"⌘+K":"Ctrl+K"},zw(!0),Fw];break;case"group":a=1===t.length?[{name:"ungroup",type:"custom",custom:Lw,title:Mr("取消成组")},zw(!0),Fw]:[];break;case"stack":case"pen":a=[{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:Mr("描边"),disabled:!1,custom:nw},zw(!0),Fw];break;case"swimlane":a=yr(t[0])?[{name:"contextual-swimlane-lane-number",type:"custom",title:Mr("泳道数"),custom:Dw,disabled:function(t){var e=t.selector.selections;return!(1===e.length&&yr(e[0]))}},zw(!0),{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:Mr("描边"),disabled:!1,custom:nw},zw(!0),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:aw,disabled:!1},zw(!0),Fw]:[{name:"contextual-swimlane-lane-number",type:"custom",title:Mr("泳道数"),custom:Dw,disabled:function(t){var e=t.selector.selections;return e.some((function(t){return t.swimlane!==e[0].swimlane}))}},zw(!0),{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},zw(!0),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:aw,disabled:!1},{name:"add-link",type:"custom",custom:Fk,title:Mr("插入链接"),disabled:!1},zw(!0),{name:"delete-lane",type:"custom",custom:Bw,title:Mr("删除泳道"),disabled:!1},zw(!0),Fw];break;case"freehand":a=[{name:"contextual-geometry-stroke-color",type:"custom",title:Mr("描边"),disabled:!1,custom:nw},zw(!0),Fw];break;case"dsl":a=dr(t[0])?[{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},{name:"contextual-geometry-stroke-color",type:"custom",title:Mr("描边"),disabled:!1,custom:nw},zw(!0),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:aw,disabled:!1},zw(!0),{name:"enter-dsl-edit",type:"custom",title:Mr("编辑"),disabled:!1,custom:zk},zw(!0),Fw]:[{name:"contextual-geometry-fill-color",type:"custom",title:Mr("填充"),custom:Kk,disabled:function(t){return 0===t.selector.selections.filter((function(t){return t.canFill()})).length}},zw(!0),{name:"font-style",type:"custom",title:Mr("文字样式"),custom:aw,disabled:!1},zw(!0),{name:"enter-dsl-edit",type:"custom",title:Mr("编辑"),disabled:!1,custom:zk},zw(!0),Fw];break;default:a=[]}if(t.filter((function(t){return t.isStem})).length>1){var i,o=0===a.length?[].concat(D()(Yw()),[Fw]):Yw();(i=a).splice.apply(i,[a.length-1,0].concat(D()(o)))}return t.some((function(t){return"UML"===t.category}))&&0===a.findIndex((function(t){return"contextual-geometry-shape"===t.name}))&&a.splice(0,2),1===t.length&&xr(t[0])&&(a=qw()),r>1&&(a=a.filter((function(t){return"add-link"!==t.name}))),(a=a.filter((function(e){return!(n&&e.noMini||("function"==typeof e.disabled?e.disabled(t[0].diagram):e.disabled))}))).forEach((function(t){"properties"===t.name&&(t.onProperties=e)})),a}(e.selector.selections,n,r)}Object(Ae.useEffect)((function(){var t=function(){if(e.signal.addVertexPanelVisibility)return l(null),void h(null);var t=e.selector.selections,n=j();t&&l(n),1===n.length||n.length>1&&!e.signal.mouseMultiSelecting?function(t){h(null);var n=function(t,e){var n=Er(t,(function(t){if(mr(t)){var e=t.getKeyShapeBox();if(t.isAbstract){var n=Er(t.abstractCoveredCellsWithAllChildren,(function(t){return t.getKeyShapeBox()}));e.minY=Math.min(n.minY,e.minY),e.maxY=Math.max(n.maxY,e.maxY)}return function(t){var e=t.minX,n=t.minY;return{x:e,y:n,width:t.maxX-e,height:t.maxY-n}}(e)}return sr(t)?t.getPointBox():t.getBBox()})),r=n.minX,a=n.minY,i=n.maxX,o=n.maxY,c=e.viewport.convertViewport([r,a]),l=e.viewport.convertViewport([i,o]),s=l[0]-c[0],u=l[1]-c[1];return{x:c[0],y:c[1],width:s,height:u}}(t,e),r=n.x,a=n.y,i=n.width,o=n.height;k(o),O(i),h([r,a])}(t):h(null)},n=function(){l(null),h(null)},r=Nt()(n,24),a=Nt()((function(){t()}),20),i=Nt()((function(){if(!(e.signal.buttonDragCanvas||e.signal.dragging||e.signal.vertexResizing)){var n=e.selector.selections;1!==n.length||n[0].isPen||n[0].isFreehand||n[0].isGroup||c||t()}}),28),o=Nt()((function(){var t=j();l(t)}),16),s=function(){var t=e.viewport.invertViewport([0,0]);m&&ro(m[0],t[0],1)&&ro(m[1],t[1],1)||(l(null),h(null),v(t),a())},u=function(t){t.isModelChange&&o()},d=function(){v(e.viewport.invertViewport([0,0]))};return e.on("afterselect",a),e.on("keydown",r),e.on("mousemove",i),e.on("cell:dragstart",n),e.on("vertexresizestart",n),e.on("groupresizestart",n),e.on("abstadjuststart",n),e.on("endpointcontrolpointmousedown",n),e.on("addlinebuttonmousedown",n),e.on("aftercommandexecute",u),e.on("afterviewportchange",s),e.on("afterimport",d),M.on("textareaKeydown",r),function(){e.off("afterselect",a),e.off("keydown",r),e.off("mousemove",i),e.off("cell:dragstart",n),e.off("vertexresizestart",n),e.off("groupresizestart",n),e.off("abstadjuststart",n),e.off("endpointcontrolpointmousedown",n),e.off("addlinebuttonmousedown",n),e.off("aftercommandexecute",u),e.off("afterviewportchange",s),e.off("afterimport",d),M.off("textareaKeydown",r)}}),[e,c,m,S]);var R=Oe.a.createElement("div",{className:"lake-diagram-board-contextual-toolbar"},c&&c.map((function(t,n){return Oe.a.createElement(Ww,Ce()({key:n,diagram:e,boardWebProxy:a,selections:e.selector.selections},t))})));return Oe.a.createElement("div",{"data-testid":"board-contextual-toolbar"},Oe.a.createElement(Hw,{height:x,width:A,content:R,visible:!0,overlayClassName:"lake-diagram-board-contextual-toolbar-popover",diagram:e,coord:d}))}function Zw(t,e){var n={},r=[],a=[];return t.forEach((function(t){var e=t.category;t.cover||(t.cover="https://gw.alipayobjects.com/zos/bmw-prod/8681f102-cc41-4685-b75a-faadb0af0a61.svg"),"personal"===e?r.push(t):"official"===e&&a.push(t),e&&!n[e]&&(n[e]=!0)})),{personalData:r.splice(0,e),officialData:a.splice(0,e)}}Ww.propTypes={type:Pe.a.string,curr:Pe.a.string,custom:Pe.a.func,diagram:Pe.a.object},Vw.propTypes={className:Pe.a.string,position:Pe.a.string,items:Pe.a.array,domContainer:Pe.a.object,title:Pe.a.node,extra:Pe.a.node,execCommand:Pe.a.func,diagram:Pe.a.object,onProperties:Pe.a.func,mini:Pe.a.bool,boardWebProxy:Pe.a.object},We(".lake-diagram-scroll-tabs-container {\n  background-color: var(--yq-bg-primary);\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container {\n  overflow: scroll;\n  position: relative;\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar {\n  height: 0;\n  width: 5px;\n  background-color: var(--yq-bg-primary);\n  /* or add it to the track */\n}\n.lake-diagram-scroll-tabs-container .lake-diagram-scroll-tabs-inner-container::-webkit-scrollbar-thumb {\n  background: var(--yq-bg-primary-hover-light);\n  border-radius: 3px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 0 !important;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav::before {\n  display: none;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab:first-child {\n  margin-left: 0;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab {\n  padding: 0;\n  margin-left: 8px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a {\n  display: block;\n  color: var(--yq-yuque-grey-8);\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 1.57;\n  height: 32px;\n  border-radius: 6px;\n  padding: 5px 16px 27px 16px;\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab a:hover {\n  background-color: var(--yq-bg-primary-hover);\n  color: var(--yq-text-primary);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-tab-active a {\n  color: var(--yq-text-primary);\n  font-weight: 500;\n  background-color: var(--yq-bg-primary-hover);\n}\n.lake-diagram-scroll-tabs-container .ant-tabs > .ant-tabs-nav .ant-tabs-ink-bar {\n  display: none;\n}\n");var Uw=Ie.a.TabPane;function Kw(t){var e=t.tabs,n=void 0===e?[]:e,r=t.InnerRCNode,a=t.className,i=t.scrollToName;if(0===n.length||!r)return Oe.a.createElement("div",null);var o=Object(Ae.useRef)(null),c=Object(Ae.useRef)(null),l=Object(Ae.useState)(n[0].name),s=b()(l,2),u=s[0],d=s[1];return Object(Ae.useEffect)((function(){var t,e=o.current;if(e){var r,a=n.map((function(t){var n=e.querySelector("[data-lake-tab-scroll=".concat(t.name,"]"));return n?n.offsetTop:0}));t=Bt()((function(t){for(var e=t.target.scrollTop,r=a.length-1;r>0&&!(e>a[r]-48);r--);d((function(t){var e=n[r].name;return t!==e?e:t}))}),16),null===(r=o.current)||void 0===r||r.addEventListener("scroll",t)}return function(){var e;return t&&(null===(e=o.current)||void 0===e?void 0:e.removeEventListener("scroll",t))}}),[n]),Object(Ae.useEffect)((function(){if(i&&o&&o.current){var t,e=o.current.querySelector('[data-lake-tab-scroll="'.concat(i,'"]'));e&&1===e.nodeType&&(null===(t=o.current)||void 0===t||t.scrollTo(0,e.offsetTop))}}),[i]),Object(Ae.useEffect)((function(){c.current&&Array.from(c.current.querySelectorAll(".ant-tabs-tab")).forEach((function(t,e){0!==e&&1===t.nodeType&&(t.style.marginLeft="16px")}))}),[]),Oe.a.createElement("div",{className:"lake-diagram-scroll-tabs-container ".concat(a)},Oe.a.createElement(Ie.a,{animated:!1,onChange:function(t){var e=o.current;if(e){var n,r=e.querySelector('[data-lake-tab-scroll="'.concat(t,'"]'));r&&1===r.nodeType&&(null===(n=o.current)||void 0===n||n.scrollTo(0,r.offsetTop))}},activeKey:u,onTabClick:function(t){d(t)}},n.map((function(t){return Oe.a.createElement(Uw,{tab:Oe.a.createElement("a",null,t.title),key:t.name})}))),Oe.a.createElement("div",{ref:o,className:"lake-diagram-scroll-tabs-inner-container"},r))}We(".lake-board-material-lib-container {\n  text-align: left;\n  position: relative;\n  display: inline-block;\n  height: 560px;\n  width: 762px;\n  box-shadow: 0 1px 4px -2px rgba(0, 0, 0, 0.13), 0 2px 8px 0 rgba(0, 0, 0, 0.08), 0 8px 16px 4px rgba(0, 0, 0, 0.04);\n  border-radius: 4px;\n  background-color: var(--yq-bg-primary);\n}\n.lake-board-material-lib-container .lake-board-material-lib-close {\n  border-radius: 2px;\n  width: 24px;\n  height: 24px;\n  position: absolute;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/3ee0285f-a1ad-4051-82a6-89e802514ef4.svg);\n  background-position: center;\n  background-repeat: no-repeat;\n  top: 8px;\n  right: 14px;\n}\n.lake-board-material-lib-container .ant-tabs > .ant-tabs-nav .ant-tabs-nav-wrap {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container {\n  padding-left: 24px;\n  height: 498px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-diagram-scroll-tabs-inner-container {\n  height: 450px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-scroll-container .lake-board-material-lib-scroll-inner-container {\n  width: 762px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container {\n  padding-left: 24px;\n}\n.lake-board-material-lib-container .lake-board-personal-material-tab-pane-container .lake-board-material-lib-item-pane-container {\n  height: 498px;\n  overflow-y: scroll;\n}\n.lake-board-material-lib-container .lake-board-material-lib-close:hover {\n  background-color: var(--yq-bg-tertiary);\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty {\n  width: 400px;\n  color: var(--yq-text-body);\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: auto;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty .lake-board-material-lib-personal-empty-tips-h1 {\n  font-size: 18px;\n  margin: 24px 0;\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty p {\n  font-size: 14px;\n  margin-bottom: 8px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-personal-empty img {\n  margin-top: 16px;\n  opacity: 0.5;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container {\n  display: flex;\n  flex-wrap: wrap;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item {\n  position: relative;\n  margin-right: 24px;\n  margin-bottom: 24px;\n  font-size: 14px;\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-title {\n  height: 54px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-left: 16px;\n  border-top: 1px solid var(--yq-border-primary);\n  font-weight: bold;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-cover {\n  width: 220px;\n  height: 142px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-size: contain;\n  border-radius: 4px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  padding: 16px;\n  display: none;\n  background-color: rgba(250, 250, 250, 0.9);\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  border-radius: 4px;\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control {\n  background-color: rgba(20, 20, 20, 0.9);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-button {\n  position: absolute;\n  width: calc(100% - 32px);\n  bottom: 16px;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-title {\n  height: 14px;\n  font-weight: bold;\n  margin-bottom: 12px;\n  display: flex;\n  align-items: center;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-description {\n  height: 90px;\n  margin-bottom: 24px;\n  overflow: hidden;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  position: absolute;\n  width: 16px;\n  height: 16px;\n  top: 16px;\n  right: 16px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/0b88a90e-d1fd-4e14-b74d-dc5355e9de8d.svg);\n}\n[data-kumuhana='pouli'] .lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete {\n  filter: invert(100%);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-delete:hover {\n  cursor: pointer;\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item .lake-board-material-lib-item-control .lake-board-material-lib-item-use-control-href {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  margin-left: 4px;\n  background-position: center;\n  background-repeat: no-repeat;\n  background-image: url(https://gw.alipayobjects.com/zos/bmw-prod/712ccc64-9efb-4889-89d0-3531ff478a22.svg);\n}\n.lake-board-material-lib-container .lake-board-material-lib-item-pane-container .lake-board-material-lib-item-container .lake-board-material-lib-item:hover .lake-board-material-lib-item-control {\n  display: block;\n}\n");var Qw=Ie.a.TabPane,$w=[{name:"official",title:Mr("推荐素材")},{name:"personal",title:Mr("自定义素材")}],Jw=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Oe.a.createElement("div",null),a=arguments.length>4?arguments[4]:void 0;return Oe.a.createElement("div",{className:"lake-board-material-lib-item-pane-container","data-lake-tab-scroll":t},(null==n?void 0:n.length)>0?Oe.a.createElement("div",{className:"lake-board-material-lib-item-container"},n.map((function(t,e){return function(t,e,n){var r=t.id,a=t.cover,i=t.doclet_id,o=t.title;return Oe.a.createElement("div",{className:"lake-board-material-lib-item",key:r,"data-testid":"material-lib-item-doclet-id-".concat(i),"data-lake-tab-scroll":r},Oe.a.createElement("div",{className:"lake-board-material-lib-item-cover",style:{backgroundImage:"url(".concat(a,")")}}),o&&Oe.a.createElement("div",{className:"lake-board-material-lib-item-title"},Oe.a.createElement("span",null,o)),Oe.a.createElement("div",{className:"lake-board-material-lib-item-control"},function(t,e){var n=t.title,r=t.href,a=t.description,i=t.category,o=t.id;return Oe.a.createElement("div",null,Oe.a.createElement("div",{className:"lake-board-material-lib-item-use-control-title"},n,r&&Oe.a.createElement("a",{target:"_blank",className:"lake-board-material-lib-item-use-control-href",href:r})),a&&Oe.a.createElement("div",{className:"lake-board-material-lib-item-use-control-description"},a),"personal"===i&&Oe.a.createElement("div",{onClick:function(t){t.target.closest(".lake-board-material-lib-item").style.display="none",null==e||e.onDelete(o)},className:"lake-board-material-lib-item-use-control-delete"}),Oe.a.createElement(Re.a,{onClick:function(){e.onUse(t)},className:"lake-board-material-lib-item-use-control-button",block:!0},Mr("使用")))}(t,n)))}(t,0,a)}))):r)},tC=function(t,e){var n=t.map((function(t){return Jw(t.group_id,t.group,t.data,Oe.a.createElement("div",null),e)}));return Oe.a.createElement("div",{className:"lake-board-material-lib-scroll-inner-container"},n)},eC=Object.freeze({__proto__:null,ZoomTool:hb,Toolbar:tx,ContextMenu:Sx,Properties:Ik,ContextualMenu:Vw,MaterialLibMaxi:function(t){var e=t.scrollToName,n=function(t,e){var n=t.boardWebProxy,r=t.diagram,a=t.forceUpdate,i=Object(Ae.useState)(null),o=b()(i,2),c=o[0],l=o[1],s=function(){var t=dt()(ft.a.mark((function t(){var a;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.destroyed&&n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,n.material["find".concat(e)]();case 4:a=t.sent,l(Zw(a,100));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=function(){var e=dt()(ft.a.mark((function e(a){var i,o,c,l,s,u,d,h,f,p,m,v,y;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.destroyed&&n){e.next=2;break}return e.abrupt("return");case 2:return i=n.spm,o=a.id,c=a.category,e.next=6,n.material.use(o);case 6:if(l=e.sent){e.next=9;break}return e.abrupt("return");case 9:s=l.diagramData,u=l.graphicsBBox,s&&(d=s.body,h=s.head,gi(d),f=u||(null==h?void 0:h.bbox)||r.modelManager.bbox(d),p=r.viewport.getCenter(),"number"==typeof(g=f).x&&"number"!=typeof g.minX&&(g.minX=g.x,g.maxX=g.x+g.width),"number"==typeof g.y&&"number"!=typeof g.minY&&(g.minY=g.y,g.maxY=g.y+g.height),m=p[0]-f.minX-f.width/2,v=p[1]-f.minY-f.height/2,r.modelManager.translate(d,m,v),r.hooks.forceDecorateImportModels.call(d),r.command.execute("Add",{model:d}),i&&(y={material_id:a.id},"personal"===c?i.click("b4693.c107432.d223038",y):i.click("b4693.c107432.d223037",y)),t.onUse&&t.onUse());case 11:case"end":return e.stop()}var g}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(Ae.useEffect)((function(){s()}),[r,a]),{state:{data:c,maxCount:100},onUse:u,onMore:function(e){t.onMore&&t.onMore(e)},onDelete:function(e){n.material.destroy(e),t.onDelete&&t.onDelete(e)},onClose:function(){t.onClose&&t.onClose()}}}(t,"Maxi"),r=n.state.data,a=$w[0].name,i=Object(Ae.useState)(a),o=b()(i,2),c=o[0],l=o[1];if(Object(Ae.useEffect)((function(){e&&l(e)}),[e]),!r)return Oe.a.createElement("div",null);var s=r.personalData,u=r.officialData.reduce((function(t,e){var n=e.group,r=e.group_id;return t[r]||(t[r]={group_id:r,group:n,data:[]}),t[r].data.push(e),t}),{}),d=["Hot","team","Design","Technology","Mind"];Object.keys(u).length>d.length&&Object.keys(u).filter((function(t){return!d.includes(t)})).forEach((function(t){d.push(t)}));var h=Object.keys(u).length?d.map((function(t){return u[t]})):[],f=h.map((function(t){return{name:t.group_id,title:Mr(t.group)}}));return Oe.a.createElement("div",{className:"lake-board-material-lib-container"},Oe.a.createElement(Ie.a,{animated:!1,defaultActiveKey:c,onTabClick:function(t){l(t)}},Oe.a.createElement(Qw,{tab:$w[0].title,key:$w[0].name},Oe.a.createElement(Kw,{tabs:f,className:"lake-board-material-lib-scroll-container",InnerRCNode:tC(h,n)})),Oe.a.createElement(Qw,{tab:$w[1].title,key:$w[1].name},Oe.a.createElement("div",{className:"lake-board-personal-material-tab-pane-container"},Jw($w[1].name,$w[1].title,s,Oe.a.createElement("div",{className:"lake-board-material-lib-personal-empty","data-testid":"material-lib-personal-empty"},Oe.a.createElement("h1",{className:"lake-board-material-lib-personal-empty-tips-h1"},Mr("添加自定义素材")),Oe.a.createElement("p",null," ",Mr("步骤一：框选需要添加的内容")),Oe.a.createElement("p",null," ",Mr("步骤二：右键打开面板，选择“添加到素材库”")),Oe.a.createElement("img",{src:"https://gw.alipayobjects.com/zos/bmw-prod/5f652093-571b-4c7c-bd3f-fd81ff7fe2e1.svg"})),n)))),Oe.a.createElement("div",{className:"lake-board-material-lib-close","data-testid":"material-lib-close",onClick:function(){n.onClose()}}))}}),nC=Object.freeze({__proto__:null});function rC(t){var e,n=t.diagram,r=t.readonly,a=Object(Ae.useState)(null),i=b()(a,2),o=i[0],c=i[1],l=Object(Ae.useState)(""),s=b()(l,2),u=s[0],d=s[1],h=Object(Ae.useState)(null),f=b()(h,2),p=f[0],m=f[1],v=Object(Ae.useRef)();return Object(Ae.useEffect)((function(){function t(t){var e=t.cell,n=e.getKeyShape().getBoundingClientRect();c(null),c([n.x+n.width,n.y+n.height/2]),m(e),d(e.note.content)}return n.on("opennote",t),function(){n.off("opennote",t)}}),[n,o,c,m,u]),Object(Ae.useEffect)((function(){setTimeout((function(){var t=document.querySelector("textarea.lake-diagram-note-area");if(t){var e=t.value.length;t.focus(),t.setSelectionRange(e,e)}}),16)}),[o,v.current,p]),e=r?Oe.a.createElement("div",{className:"lake-diagram-note-area"},u):Oe.a.createElement("textarea",{className:"lake-diagram-note-area",value:u,onChange:function(t){var e=t.target.value;d(e)},ref:v}),Oe.a.createElement(ax,{placement:"right",content:e,visible:!0,overlayClassName:"lake-diagram-note-popover",diagram:n,coord:o,onClose:function(){o&&p&&(m(null),c(null),p.note.content!==u&&n.command.execute("Update",{id:p,model:{note:u?{content:u}:null}}))}})}function aC(t){return Oe.a.createElement(rC,t)}function iC(t){return Oe.a.createElement(rC,Ce()({},t,{readonly:!0}))}We("/* stylelint-disable */\n.lake-diagram-note-popover {\n  z-index: 1033;\n}\n.lake-diagram-note-popover .lake-diagram-note-area {\n  font-size: 12px;\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  width: 294px;\n  height: 128px;\n  padding: 16px 18px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n}\n"),rC.defaultProps={diagram:null,readonly:!1},rC.propTypes={diagram:Pe.a.object,readonly:Pe.a.bool},aC.defaultProps={diagram:null},aC.propTypes={diagram:Pe.a.object},iC.defaultProps={diagram:null},iC.propTypes={diagram:Pe.a.object};var oC=Object.freeze({__proto__:null,Editor:aC,Reader:iC});function cC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lC(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cC(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cC(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}We("/* stylelint-disable */\n/* stylelint-disable */\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*xza5Sbcltd8AAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*uGQVSrhnctYAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Normal.ttf') format('truetype');\n  font-weight: normal;\n  font-style: normal;\n}\n@font-face {\n  font-family: 'shouxie';\n  src: url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*x-EOT7NO1LoAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.woff2') format('woff2'), url('https://mdn.alipayobjects.com/huamei_0prmtq/afts/file/A*8C6gRKCCkoIAAAAAAAAAAAAADvuFAQ/Hand-drawn-font-Bold.ttf') format('truetype');\n  font-weight: bold;\n  font-style: normal;\n}\n/* stylelint-disable */\n/*\n* ============================================\n* SITE COLOR PALETTE\n* Please be careful to modify this file.\n* ============================================\n*/\n.lake-diagram-mindmap-icons-change-overlay .ant-popover-inner {\n  border: 0;\n  background: none;\n  box-shadow: none;\n}\n.lake-diagram-mindmap-icons-change {\n  background: var(--yq-bg-primary);\n  border: 1px solid var(--yq-yuque-grey-4);\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.12);\n  padding: 5px 13px;\n  display: flex;\n  align-items: center;\n}\n.lake-diagram-mindmap-icons-change .icon-btn {\n  border: none;\n  background: none;\n  padding: 2px 2px;\n  height: 26px;\n  width: 26px;\n  margin: 3px 8px 3px 0;\n  border-radius: 6px;\n  text-align: center;\n  cursor: pointer;\n  outline: none;\n  display: block;\n}\n.lake-diagram-mindmap-icons-change .icon-btn[disabled] {\n  color: var(--yq-text-caption);\n  background: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(38, 38, 38, 0.15);\n}\n[data-kumuhana=\"pouli\"] .lake-diagram-mindmap-icons-change .icon-btn:hover {\n  background: rgba(226, 226, 226, 0.15);\n}\n.lake-diagram-mindmap-icons-change .icon-btn:focus {\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .icon-btn::after {\n  display: none;\n}\n.lake-diagram-mindmap-icons-change .icon-btn.active {\n  background: var(--yq-yuque-grey-4);\n  color: var(--yq-yuque-grey-900);\n}\n.lake-diagram-mindmap-icons-change .lake-icon {\n  color: var(--yq-text-primary);\n  font-size: 18px;\n  padding: 2px 2px;\n  margin: 3px 0;\n  display: inline-block;\n  cursor: pointer;\n  border-radius: 6px;\n}\n.lake-diagram-mindmap-icons-change .lake-icon:hover {\n  background: var(--yq-border-primary);\n}\n.lake-diagram-mindmap-icons-change .lake-diagram-icon-change-vertical-separator {\n  width: 1px;\n  height: 28px;\n  margin: 0 14px 0 6px;\n  background: var(--yq-border-primary);\n  display: inline-block;\n}\n"),We(".lake-diagram-dsl-editor-container {\n  border: 1px solid var(--yq-border-primary);\n  border-radius: 8px;\n  background-color: white;\n  min-width: 300px;\n  min-height: 120px;\n  display: flex;\n  flex-direction: column;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container {\n  padding-top: 12px;\n  padding-left: 10px;\n  padding-right: 10px;\n  flex: 1 0 40px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea {\n  border: none;\n  resize: none;\n  outline: none;\n  box-shadow: none;\n  overflow-x: hidden;\n  overflow-y: auto;\n  word-break: break-word;\n  white-space: pre-wrap;\n  width: 100%;\n  height: 100%;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-textarea-container .lake-diagram-dsl-editor-textarea > div {\n  display: flex;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper {\n  display: flex;\n  font-size: 12px;\n  justify-content: space-between;\n  height: 40px;\n  min-height: 40px;\n  background: transparent;\n  border-top: 1px solid var(--yq-border-primary);\n  line-height: 24px;\n  padding: 8px 8px;\n  text-align: left;\n  text-indent: 0;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a {\n  font-size: 12px;\n  color: var(--yq-text-caption);\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper .larkui-icon {\n  margin-right: 6px;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper button {\n  width: 40px;\n  height: 24px;\n  text-align: center;\n  line-height: 24px;\n  background-color: var(--yq-theme);\n  color: white;\n  font-size: 12px;\n  border: none;\n  padding: 0;\n  border-radius: 4px;\n  cursor: pointer;\n}\n.lake-diagram-dsl-editor-container .lake-diagram-dsl-editor-helper a:hover {\n  color: var(--yq-text-body);\n}\n");var sC=!1,uC=Object.freeze({__proto__:null,Properties:cb,Note:oC,Toolbar:Yg,LinkEditor:Wg,ShapeOverlay:Zg,Dropdown:Tg,ZoomTool:tb,ContextMenu:nC,Board:eC,ToolbarShapeOverlay:$g,IconChange:function(t){var e=t.diagram;t.readonly;var n=t.className,r=Object(Ae.useState)(),a=b()(r,2),i=a[0],o=a[1],l=Object(Ae.useState)(),s=b()(l,2),u=s[0],d=s[1],h=Object(Ae.useState)(),f=b()(h,2),p=f[0],m=f[1];Object(Ae.useEffect)((function(){function t(t){var e=t.cell,n=t.key,r=t.nativeEvent;if(e&&n){var a=r.target,i=a.getBoundingClientRect();o(void 0),o([i.x+i.width,i.y+i.height]),d(e),m(a)}}return e.on("changemindmapicon",t),function(){e.off("changemindmapicon",t)}}),[e,i,o,d]);var v=Object(Ae.useMemo)((function(){var t=null==p?void 0:p.getAttribute("lake-mindmap-icon-key"),r=Lr.findIndex((function(e){return e===t}));if(t&&r>-1){var a=Dr[r];return Oe.a.createElement("div",{className:Me()("lake-diagram-mindmap-icons-change",n),"data-lake_prevent_click_unselect":"true"},Pt()(a).map((function(n){return Oe.a.createElement("img",{className:"icon-btn",key:t+n,src:_r(t,n),id:"change-icon-".concat(t,"-").concat(n),onClick:function(){var r=e.selector.selections.filter((function(t){return t.isMindmap}));e.command.execute("Update",{id:r.map((function(t){return t.model.id})),model:r.map((function(e){return{icons:lC(lC({},e.model.icons||{}),{},c()({},t,n))}}))})}})})),Oe.a.createElement("div",{className:"lake-diagram-icon-change-vertical-separator"}),Oe.a.createElement("span",{className:"lake-icon lake-icon-table-new-delete",onClick:function(){var n=e.selector.selections.filter((function(t){return t.isMindmap}));e.command.execute("Update",{id:n.map((function(t){return t.model.id})),model:n.map((function(e){return{icons:lC(lC({},e.model.icons||{}),{},c()({},t,null))}}))})}}))}return[]}),[null==p?void 0:p.getAttribute("lake-mindmap-icon-key")]);return Oe.a.createElement(ax,{placement:"bottom",content:v,style:{borderRadius:"8px"},visible:!0,overlayClassName:"lake-diagram-mindmap-icons-change-overlay",diagram:e,coord:i,onClose:function(){i&&u&&(d(void 0),o(void 0),p&&(p.dataset.lakeMindmapIconSelected="false"))}})},DslEditor:function(t){var e=t.diagram,n=Object(Ae.useState)(""),a=b()(n,2),i=a[0],o=a[1],c=Object(Ae.useState)(null),l=b()(c,2),s=l[0],u=l[1],d=Object(Ae.useState)([0,0]),h=b()(d,2),f=h[0],p=h[1],m=Object(Ae.useState)([0,0]),v=b()(m,2),y=v[0],g=v[1],x=Object(Ae.useRef)(null);Object(Ae.useEffect)((function(){var t=function(t){var n=t.cell;sC=!0,u(n),o(n.stencil.toText(n.htmls));var r=e.viewport.convertViewport([n.x,n.y]),a=b()(r,2),i=a[0],c=a[1];p([i,c]),g([n.width*e.viewport.zoom,n.height*e.viewport.zoom]),e.destroyed};return e.on("opendsleditor",t),function(){e.off("opendsleditor",t)}}),[e]);var k=function(){if(s){var t=s;sC=!1,u(null),[t].concat(D()(t.getChildren())).forEach((function(t){return t.show()})),i!==t.stencil.toText(t.htmls)&&e.command.execute("UpdateDslHtml",{dsl:t,htmls:t.stencil.toHtmls(i,t.htmls)}),e.selector.select(t)}};return Object(Ae.useEffect)((function(){if(x.current&&s){var t=function(t){"Enter"===t.key&&("stage"===s.shape||(r.ua.macos?t.metaKey:t.ctrlKey))&&(t.preventDefault(),sC&&k())};return x.current.addEventListener("keydown",t),window.addEventListener("mousedown",n),e.on("afterviewportchange",a),function(){var r;null===(r=x.current)||void 0===r||r.removeEventListener("keydown",t),window.removeEventListener("mousedown",n),e.off("afterviewportchange",a)}}function n(t){var e;null!==(e=t.target)&&void 0!==e&&e.closest(".lake-diagram-dsl-editor-container")||!sC||k()}function a(t){if(s){var n=e.viewport.convertViewport([s.x,s.y]),r=b()(n,2),a=r[0],i=r[1];p([a,i]),g([s.width*e.viewport.zoom,s.height*e.viewport.zoom])}}}),[s,i]),Oe.a.createElement("div",{className:"lake-diagram-dsl-editor-container",style:{position:"absolute",left:"".concat(f[0],"px"),top:"".concat(f[1],"px"),width:y[0]+5,height:y[1]+5,visibility:s?"initial":"hidden"},ref:x},Oe.a.createElement("div",{className:"lake-diagram-dsl-editor-textarea-container"},Oe.a.createElement("textarea",{className:"lake-diagram-dsl-editor-textarea",value:i,onChange:function(t){o(t.target.value)}})),Oe.a.createElement("div",{className:"lake-diagram-dsl-editor-helper"},Oe.a.createElement("a",{href:"https://www.yuque.com/yuque/wknab3/af4k4xq4ma35qvv2",target:"_blank"},Oe.a.createElement("span",{className:"lake-icon lake-icon-board-question"})),Oe.a.createElement("button",{onClick:k},Oe.a.createElement(je.a,{title:Oe.a.createElement("p",{style:{textAlign:"center"}},r.ua.macos?"Cmd":"Ctrl","+Enter"),placement:"bottom"},Mr("确定")))))}}),dC=new r.MessageManager;function hC(t){return fC.apply(this,arguments)}function fC(){return(fC=dt()(ft.a.mark((function t(e){var n,a,i,o,c,l,s,u,d,h,f,p,m,v;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.file,i=e.uploader,o=e.enable,c=e.onTemporaryOnLoad,l=e.onCompleted,a){t.next=3;break}return t.abrupt("return");case 3:if(r.FileUtils.isImage(a)){t.next=5;break}return t.abrupt("return");case 5:if(!o||o()){t.next=7;break}return t.abrupt("return");case 7:if(!a.size){t.next=12;break}if(null===(s=r.FileSizeChecker.check("image",a.size))){t.next=12;break}return s.callback(dC.show(s.level,s.msg,!s.alwaysOpen)),t.abrupt("return");case 12:return t.next=14,ux(a);case 14:if(u=t.sent,d=(null===(n=sx(u))||void 0===n?void 0:n.cdn)||URL.createObjectURL(a),h=new Image,f={src:d,naturalWidth:void 0,naturalHeight:void 0,uploadInfo:{hash:u,fileName:a.name,fileType:a.type,fileSize:a.size,localTempSrc:d,state:0}},h.onload=function(){Object.assign(f,{naturalWidth:h.naturalWidth,naturalHeight:h.naturalHeight}),c&&c(f)},h.src=d,"string"!=typeof d||!d.startsWith("blob:")){t.next=32;break}return p=i.image(a),lx(u,m={imageCdnPromise:p}),t.next=26,p;case 26:if(v=t.sent){t.next=30;break}return f.uploadInfo.state=-1,t.abrupt("return",f);case 30:m.cdn=v,l&&l({hash:u,cdn:v});case 32:return t.abrupt("return",f);case 33:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pC(t){if(t.image&&t.image.uploadInfo&&t.image.uploadInfo.hash){var e,n=null===(e=sx(t.image.uploadInfo.hash))||void 0===e?void 0:e.cdn;n?(t.image.src=n,t.image.uploadInfo.state=2):t.image.uploadInfo.state=-2}}function mC(t){t.body.forEach((function(t){Ve(t,(function(t){pC(t)}))}))}function vC(t){return yC.apply(this,arguments)}function yC(){return(yC=dt()(ft.a.mark((function t(e){var n,r,a,i,o,c,l,s,u,d,h;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.model,r=e.diagram,a=e.uploader,n){t.next=3;break}return t.abrupt("return");case 3:if((i=n.image||n.sourceImage)&&i.src){t.next=6;break}return t.abrupt("return");case 6:if(o=n.id,c=i.src,l=i.uploadInfo,!c.startsWith("blob:")){t.next=24;break}return t.prev=10,t.next=13,fetch(c).then((function(t){return t.blob()}));case 13:return s=t.sent,u=new File([s],l&&"".concat(i.uploadInfo.fileName)),t.next=17,hC({file:u,uploader:a});case 17:d=t.sent,r&&!r.destroyed&&(h=r.find(o))&&h.updateModel({image:d}),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(10),console.warn("Failed to save image when importing, src: ".concat(c));case 24:case"end":return t.stop()}}),t,null,[[10,21]])})))).apply(this,arguments)}function gC(t){return t.command.enable("Collapse")?t.command.execute("Collapse"):t.command.enable("Expand")?t.command.execute("Expand"):void 0}function bC(t){return t.command.enable("Collapse")||t.command.enable("Expand")}function xC(t){return t.command.enable("Expand")}function kC(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"curve-arrow").split("-"),n=b()(e,2),r=n[0],a=n[1],i=t.selector.selections;if(2===i.length&&i.every((function(t){return t.isMindmap}))){var o=t.add([{type:"line",source:{id:i[0].model.id},target:{id:i[1].model.id}}]),c=o[0].getPointAtPercent(.5);return t.remove(o),t.command.execute("Add",{model:{type:"line",shape:r,source:{id:i[0].model.id},target:{id:i[1].model.id,marker:a},controlPoints:[[c.x,c.y]]}})}t.command.execute("BeginInsertLine",{shape:r,marker:a})}var wC=[{name:"save",title:Mr("保存"),hotkey:pt.ua.macos?"⌘+S":"Ctrl+S",icon:"save",disabled:!1,execCommand:function(){}},{name:"undo",title:Mr("撤销"),hotkey:pt.ua.macos?"⌘+Z":"Ctrl+Z",icon:"undo",disabled:function(t){return!t.command.enable("Undo")},execCommand:function(t){return t.command.execute("Undo")}},{name:"redo",title:Mr("重做"),hotkey:pt.ua.macos?"⌘+Shift+Z":"Ctrl+Shift+Z",icon:"redo",disabled:function(t){return!t.command.enable("Redo")},execCommand:function(t){return t.command.execute("Redo")}},{type:"separator"},{name:"beginInsertRoot",title:Mr("插入主节点"),hotkey:(pt.ua.macos,"Shift+Enter"),icon:"insert-root",disabled:function(t){return!t.command.enable("MindmapBeginInsertStem")},execCommand:function(t){return t.command.execute("MindmapBeginInsertStem")}},{name:"append",title:Mr("插入同级"),hotkey:"Enter",icon:"insert-sibling",disabled:function(t){return!t.command.enable("MindmapAppendSibling")},execCommand:function(t){return t.command.execute("MindmapAppendSibling")}},{name:"appendChild",title:Mr("插入子级"),hotkey:"Tab",icon:"insert-child",disabled:function(t){return!t.command.enable("MindmapAppendChild")},execCommand:function(t){return t.command.execute("MindmapAppendChild")}},{name:"insertLine",title:Mr("线条"),hotkey:pt.ua.macos?"⌘+L":"Ctrl+L",type:"dropdown",mode:"button",defaultKey:"curve-arrow",data:[{key:"curve",icon:"line-curve"},{key:"curve-arrow",icon:"line-curve-arrow"}],execCommand:function(t,e){return kC(t,e)}},{name:"insertNote",title:Mr("备注"),icon:"diagram-toolbar-note",disabled:function(t){return!t.command.enable("MindmapOpenNote")},execCommand:function(t){return t.command.execute("MindmapOpenNote")}},{name:"createLink",title:Mr("插入链接"),hotkey:pt.ua.macos?"⌘+K":"Ctrl+K",icon:"link",disabled:function(t){return!t.command.enable("CreateLink")},execCommand:function(t){return t.command.execute("CreateLink")}},{name:"insertImage",title:Mr("插入图片"),type:"upload",icon:"image",accept:pt.EXTS.IMAGE_EXT.map((function(t){return"."+t})).join(","),disabled:function(t){return!t.command.enable("MindmapAttachImage")&&!t.command.enable("MindmapInsertImage")},onChange:function(){}},{type:"separator"},{name:"collapseExpand",title:Mr("折叠"),hotkey:pt.ua.macos?"⌘+/":"Ctrl+/",icon:"collapse-node",disabled:function(t){return!bC(t)},active:function(t){return xC(t)},execCommand:function(t){return gC(t)}}],CC=function(){function t(){m()(this,t),Object.assign(this,{format:"lakeboard",type:"Board",version:"1.0",diagramData:{head:{},body:[]},mode:"edit",viewportSetting:null,viewportOption:"adapt",text:"",graphicsBBox:null})}return y()(t,[{key:"get",value:function(t){return this[t]}},{key:"set",value:function(t,e){this[t]=e}},{key:"export",value:function(){var t=this;return Object.keys(this).reduce((function(e,n){return e[n]=t[n],e}),{})}}]),t}();function AC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function OC(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?AC(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AC(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var EC=Sr.locale,PC=new CC,SC=Object.freeze({__proto__:null,uploadImage:hC,onBeforeSave:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){if(t.destroyed)r();else if(e.isCompleted())r();else{var a,i=Date.now();!n&&kt.a.warning(Mr("图片上传中，请稍候")),Promise.resolve().then((function t(){e.isCompleted()||Date.now()-i>=72e4?(a&&clearTimeout(a),r()):a=setTimeout(t,6e3)}))}}))},processImageModel:pC,processExportData:mC,exportData:function(t){var e=t.export();return mC(e),e},tryTransferBlobUrl:vC,importData:function(t){var e=t.diagram,n=t.data,r=t.uploader;if(n&&(n.body||n.head)&&e){if(e.import(n),r&&"edit"===e.interaction.currentMode){var a=[];return n.body.forEach((function(t){Ve(t,(function(t){a.push(vC({model:t,diagram:e,uploader:r}))}))})),a}return[]}},get map(){return cx},cleanHashCache:function(){cx={}},addHashCache:lx,getHashCache:sx,generateHash:ux,executeCollapseExpand:gC,enableCollapseExpand:bC,collapseActive:xC,mindmapInsertLine:kC,mindToolbarConfigs:wC,uploadMindmapImage:function(t){var e=t.file,n=t.uploader,r=t.diagram,a=t.from;return new Promise((function(t){hC({file:e,uploader:n,enable:function(){return r.command.enable("MindmapAttachImage")||r.command.enable("MindmapInsertImage")},onTemporaryOnLoad:function(e){"clipboard"===a&&(e.firstInsertRatio=1/window.devicePixelRatio),0===r.selector.selections.length||"drop"===a?r.command.execute("MindmapInsertImage",{image:e}):1===r.selector.selections.length&&r.command.execute("MindmapAttachImage",{image:e}),t(e)}})}))},generateBoardWebProxy:function(t,e,n,a){var i,o;if(null==t||null===(i=t.templates)||void 0===i||!i.v2||!e)return null;var c,l,s,u,d,h=new r.Uploader({docId:e,docDomain:"User"});function f(){return p.apply(this,arguments)}function p(){return(p=dt()(ft.a.mark((function e(){var n,r,a,i=arguments;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,t.templates.v2.find(OC({include_types:"official",official_channel:"material_lib_board_config",format:"lakeboard"},n));case 3:return r=e.sent,e.next=6,t.templates.v2.find(OC({include_types:"personal",scene:"material",format:"lakeboard"},n));case 6:return a=e.sent,e.abrupt("return",[].concat(D()(null==r?void 0:r.data.map((function(t){var e,n,a,i,o=null==r?void 0:r.meta,c=null==o?void 0:o.official,l={id:t.id,title:t.name,doclet_id:t.doclet_id,cover:t.cover,category:"official"};return null!=t&&null!==(e=t.meta)&&void 0!==e&&e.description&&(l.description=null==t||null===(a=t.meta)||void 0===a?void 0:a.description),null!=t&&null!==(n=t.meta)&&void 0!==n&&n.descriptionUrl&&(l.href=null==t||null===(i=t.meta)||void 0===i?void 0:i.descriptionUrl),c&&c.forEach((function(e){var n=e.id,r=e.name_en,a=e.name_zh;e.template_ids.includes(t.id)&&(l.group="zh-cn"!==EC?r:a,l.group_id=n)})),l}))),D()(null==a?void 0:a.data.map((function(t){return{id:t.id,doclet_id:t.doclet_id,cover:t.cover,category:"personal"}})))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{iconfont:{disable:!(null==a||null===(o=a.settings)||void 0===o||!o.disable_iconfont),search:(d=dt()(ft.a.mark((function e(n){var r,a,i,o;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.keyword,a=n.page_size,i=n.page,e.prev=1,e.next=4,t.editor.iconfont({query:r,page_size:a,page:i});case 4:if(!(o=e.sent)){e.next=7;break}return e.abrupt("return",{data:o.icons.map((function(t){return{name:t.name,svg:t.show_svg.replace("currentColor","#666")}})),count:o.count});case 7:return e.abrupt("return",null);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),function(t){return d.apply(this,arguments)})},uploader:{image:(u=dt()(ft.a.mark((function t(){var e=arguments;return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",h.image.apply(h,e));case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},material:{use:(s=dt()(ft.a.mark((function e(n){var r,a,i,o;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.templates.v2.useMaterial({template_id:n});case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(a=r.data){e.next=8;break}return e.abrupt("return",null);case 8:if(!(i=a.doclet.body)){e.next=12;break}return o=JSON.parse(i),e.abrupt("return",o);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)}))),function(t){return s.apply(this,arguments)}),destroy:(l=dt()(ft.a.mark((function e(n){return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.templates.v2.destroy({id:n});case 1:case"end":return e.stop()}}),e)}))),function(t){return l.apply(this,arguments)}),create:(c=dt()(ft.a.mark((function e(n){var r,a,i,o,c,l;return ft.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.cover,a=n.diagramData,i=n.graphicsBBox,e.prev=1,!r||!a){e.next=13;break}return PC.set("graphicsBBox",i),PC.set("diagramData",a),o=Date.now(),c=new Date(o),e.next=9,t.templates.v2.create({scene:"material",in_edit:!1,name:"用户自定义素材".concat(c.toLocaleDateString()),target_type:"User",format:"lakeboard",cover:r,template_type:3,type:"Board",body:JSON.stringify(PC.export())});case 9:if(l=e.sent){e.next=12;break}return e.abrupt("return");case 12:return e.abrupt("return",l);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])}))),function(t){return c.apply(this,arguments)}),findMaxi:function(){return dt()(ft.a.mark((function t(){return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f({limit:100}));case 1:case"end":return t.stop()}}),t)})))()},findMini:function(){return dt()(ft.a.mark((function t(){return ft.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f({limit:16}));case 1:case"end":return t.stop()}}),t)})))()}},spm:n}},Model:CC,MAXI_MAX_MATERIAL_COUNT:100,MINI_MAX_MATERIAL_COUNT:16,getMaterialCells:px,createMaterial:mx})},3682:function(t,e,n){"use strict";function r(){if(!(this instanceof r))return new r;this.queue=[],this.cache=null}r.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]||(this.cache=null,this.queue.push(t)),this},r.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},r.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},r.prototype.rotate=function(t,e,n){var r,a,i;return 0!==t&&(this.translate(e,n),r=t*Math.PI/180,a=Math.cos(r),i=Math.sin(r),this.queue.push([a,i,-i,a,0,0]),this.cache=null,this.translate(-e,-n)),this},r.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},r.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},r.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var t=1;t<this.queue.length;t++)this.cache=(e=this.cache,n=this.queue[t],[e[0]*n[0]+e[2]*n[1],e[1]*n[0]+e[3]*n[1],e[0]*n[2]+e[2]*n[3],e[1]*n[2]+e[3]*n[3],e[0]*n[4]+e[2]*n[5]+e[4],e[1]*n[4]+e[3]*n[5]+e[5]]);var e,n;return this.cache},r.prototype.calc=function(t,e,n){var r;return this.queue.length?(this.cache||(this.cache=this.toArray()),[t*(r=this.cache)[0]+e*r[2]+(n?0:r[4]),t*r[1]+e*r[3]+(n?0:r[5])]):[t,e]},t.exports=r},3708:function(t,e,n){var r=n(2056),a=n(628)((function(t,e,n,a){r(t,e,n,a)}));t.exports=a},3739:function(t,e,n){"use strict";var r=/,?([a-z]),?/gi,a=parseFloat,i=Math,o=i.PI,c=i.min,l=i.max,s=i.pow,u=i.abs,d=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,h=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi,f=Array.isArray||function(t){return t instanceof Array};function p(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function m(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)p(t,n)&&(e[n]=m(t[n]));return e}function v(t){var e=v.ps=v.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout((function(){for(var n in e)p(e,n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])})),e[t]}function y(t,e,n,r){return 1===arguments.length&&(e=t.y,n=t.width,r=t.height,t=t.x),{x:t,y:e,width:n,height:r,x2:t+n,y2:e+r}}function g(){return this.join(",").replace(r,"$1")}function b(t){var e=m(t);return e.toString=g,e}function x(t,e,n,r,a,i,o,c,l){var u=1-l,d=s(u,3),h=s(u,2),f=l*l*l,p=d*e+3*h*l*r+3*u*l*l*i+f*c;return{x:E(d*t+3*h*l*n+3*u*l*l*a+f*o),y:E(p)}}function k(t){var e=B.apply(null,t);return y(e.x0,e.y0,e.x1-e.x0,e.y1-e.y0)}function w(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function C(t,e,n,r,a){return t*(t*(-3*e+9*n-9*r+3*a)+6*e-12*n+6*r)-3*e+3*n}function A(t,e,n,r,a,o,c,l,s){null==s&&(s=1);for(var u=(s=s>1?1:s<0?0:s)/2,d=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0,p=0;p<12;p++){var m=u*d[p]+u,v=C(m,t,n,a,c),y=C(m,e,r,o,l),g=v*v+y*y;f+=h[p]*i.sqrt(g)}return u*f}function O(t,e,n,r,a,i,o,s){if(!(l(t,n)<c(a,o)||c(t,n)>l(a,o)||l(e,r)<c(i,s)||c(e,r)>l(i,s))){var u=(t*r-e*n)*(i-s)-(e-r)*(a*s-i*o),d=(t-n)*(i-s)-(e-r)*(a-o);if(d){var h=E(((t*r-e*n)*(a-o)-(t-n)*(a*s-i*o))/d),f=E(u/d),p=+h.toFixed(2),m=+f.toFixed(2);if(!(p<+c(t,n).toFixed(2)||p>+l(t,n).toFixed(2)||p<+c(a,o).toFixed(2)||p>+l(a,o).toFixed(2)||m<+c(e,r).toFixed(2)||m>+l(e,r).toFixed(2)||m<+c(i,s).toFixed(2)||m>+l(i,s).toFixed(2)))return{x:h,y:f}}}}function E(t){return Math.round(1e11*t)/1e11}function P(t,e,n){if(!function(t,e){return t=y(t),w(e=y(e),t.x,t.y)||w(e,t.x2,t.y)||w(e,t.x,t.y2)||w(e,t.x2,t.y2)||w(t,e.x,e.y)||w(t,e.x2,e.y)||w(t,e.x,e.y2)||w(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}(k(t),k(e)))return n?0:[];for(var r=A.apply(0,t),a=A.apply(0,e),i=M(t)?1:~~(r/5)||1,o=M(e)?1:~~(a/5)||1,c=[],l=[],s={},d=n?0:[],h=0;h<i+1;h++){var f=x.apply(0,t.concat(h/i));c.push({x:f.x,y:f.y,t:h/i})}for(h=0;h<o+1;h++)f=x.apply(0,e.concat(h/o)),l.push({x:f.x,y:f.y,t:h/o});for(h=0;h<i;h++)for(var p=0;p<o;p++){var m,v=c[h],g=c[h+1],b=l[p],C=l[p+1],E=u(g.x-v.x)<.01?"y":"x",P=u(C.x-b.x)<.01?"y":"x",S=O(v.x,v.y,g.x,g.y,b.x,b.y,C.x,C.y);if(S){if(s[m=S.x.toFixed(9)+"#"+S.y.toFixed(9)])continue;s[m]=!0;var j=v.t+u((S[E]-v[E])/(g[E]-v[E]))*(g.t-v.t),R=b.t+u((S[P]-b[P])/(C[P]-b[P]))*(C.t-b.t);j>=0&&j<=1&&R>=0&&R<=1&&(n?d++:d.push({x:S.x,y:S.y,t1:j,t2:R}))}}return d}function S(t){var e=v(t);if(e.abs)return b(e.abs);if(f(t)&&f(t&&t[0])||(t=function(t){if(!t)return null;var e=v(t);if(e.arr)return m(e.arr);var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return f(t)&&f(t[0])&&(r=m(t)),r.length||String(t).replace(d,(function(t,e,a){var i=[],o=e.toLowerCase();for(a.replace(h,(function(t,e){e&&i.push(+e)})),"m"==o&&i.length>2&&(r.push([e].concat(i.splice(0,2))),o="l",e="m"==e?"l":"L");i.length>=n[o]&&(r.push([e].concat(i.splice(0,n[o]))),n[o]););})),r.toString=v.toString,e.arr=m(r),r}(t)),!t||!t.length)return[["M",0,0]];var n,r=[],a=0,i=0,o=0,c=0,l=0;"M"==t[0][0]&&(o=a=+t[0][1],c=i=+t[0][2],l++,r[0]=["M",a,i]);for(var s,u,p=l,y=t.length;p<y;p++){if(r.push(s=[]),(n=(u=t[p])[0])!=n.toUpperCase())switch(s[0]=n.toUpperCase(),s[0]){case"A":s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=+u[6]+a,s[7]=+u[7]+i;break;case"V":s[1]=+u[1]+i;break;case"H":s[1]=+u[1]+a;break;case"M":o=+u[1]+a,c=+u[2]+i;default:for(var x=1,k=u.length;x<k;x++)s[x]=+u[x]+(x%2?a:i)}else for(var w=0,C=u.length;w<C;w++)s[w]=u[w];switch(n=n.toUpperCase(),s[0]){case"Z":a=+o,i=+c;break;case"H":a=s[1];break;case"V":i=s[1];break;case"M":o=s[s.length-2],c=s[s.length-1];default:a=s[s.length-2],i=s[s.length-1]}}return r.toString=g,e.abs=b(r),r}function M(t){return t[0]===t[2]&&t[1]===t[3]&&t[4]===t[6]&&t[5]===t[7]}function j(t,e,n,r){return[t,e,n,r,n,r]}function R(t,e,n,r,a,i){var o=1/3,c=2/3;return[o*t+c*n,o*e+c*r,o*a+c*n,o*i+c*r,a,i]}function L(t,e,n,r,a,c,l,s,d,h){var f,m,v=120*o/180,y=o/180*(+a||0),g=[],b=(m=function(t,e,n){return{x:t*i.cos(n)-e*i.sin(n),y:t*i.sin(n)+e*i.cos(n)}},function t(){var e=Array.prototype.slice.call(arguments,0),n=e.join("␀"),r=t.cache=t.cache||{},a=t.count=t.count||[];return p(r,n)?(function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}(a,n),r[n]):(a.length>=1e3&&delete r[a.shift()],a.push(n),r[n]=m.apply(0,e),r[n])});if(h)S=h[0],M=h[1],E=h[2],P=h[3];else{t=(f=b(t,e,-y)).x,e=f.y;var x=(t-(s=(f=b(s,d,-y)).x))/2,k=(e-(d=f.y))/2,w=x*x/(n*n)+k*k/(r*r);w>1&&(n*=w=i.sqrt(w),r*=w);var C=n*n,A=r*r,O=(c==l?-1:1)*i.sqrt(u((C*A-C*k*k-A*x*x)/(C*k*k+A*x*x))),E=O*n*k/r+(t+s)/2,P=O*-r*x/n+(e+d)/2,S=i.asin(((e-P)/r).toFixed(9)),M=i.asin(((d-P)/r).toFixed(9));(S=t<E?o-S:S)<0&&(S=2*o+S),(M=s<E?o-M:M)<0&&(M=2*o+M),l&&S>M&&(S-=2*o),!l&&M>S&&(M-=2*o)}var j=M-S;if(u(j)>v){var R=M,B=s,D=d;M=S+v*(l&&M>S?1:-1),g=L(s=E+n*i.cos(M),d=P+r*i.sin(M),n,r,a,0,l,B,D,[M,R,E,P])}j=M-S;var N=i.cos(S),_=i.sin(S),I=i.cos(M),T=i.sin(M),F=i.tan(j/4),z=4/3*n*F,q=4/3*r*F,Y=[t,e],H=[t+z*_,e-q*N],G=[s+z*T,d-q*I],X=[s,d];if(H[0]=2*Y[0]-H[0],H[1]=2*Y[1]-H[1],h)return[H,G,X].concat(g);for(var W=[],V=0,Z=(g=[H,G,X].concat(g).join().split(",")).length;V<Z;V++)W[V]=V%2?b(g[V-1],g[V],y).y:b(g[V],g[V+1],y).x;return W}function B(t,e,n,r,a,o,s,d){for(var h,f,p,m,v,y,g,b,x=[],k=[[],[]],w=0;w<2;++w)if(0==w?(f=6*t-12*n+6*a,h=-3*t+9*n-9*a+3*s,p=3*n-3*t):(f=6*e-12*r+6*o,h=-3*e+9*r-9*o+3*d,p=3*r-3*e),u(h)<1e-12){if(u(f)<1e-12)continue;0<(m=-p/f)&&m<1&&x.push(m)}else g=f*f-4*p*h,b=i.sqrt(g),g<0||(0<(v=(-f+b)/(2*h))&&v<1&&x.push(v),0<(y=(-f-b)/(2*h))&&y<1&&x.push(y));for(var C,A=x.length,O=A;A--;)C=1-(m=x[A]),k[0][A]=C*C*C*t+3*C*C*m*n+3*C*m*m*a+m*m*m*s,k[1][A]=C*C*C*e+3*C*C*m*r+3*C*m*m*o+m*m*m*d;return k[0][O]=t,k[1][O]=e,k[0][O+1]=s,k[1][O+1]=d,k[0].length=k[1].length=O+2,{x0:c.apply(0,k[0]),y0:c.apply(0,k[1]),x1:l.apply(0,k[0]),y1:l.apply(0,k[1])}}function D(t){var e=v(t);if(e.curve)return b(e.curve);for(var n=S(t),r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i=function(t,e,n){var r,a;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(L.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*e.x-e.bx,a=2*e.y-e.by):(r=e.x,a=e.y),t=["C",r,a].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(R(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(R(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(j(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(j(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(j(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(j(e.x,e.y,e.X,e.Y))}return t},o=function(t,e){if(t[e].length>7){t[e].shift();for(var r=t[e];r.length;)c[e]="A",t.splice(e++,0,["C"].concat(r.splice(0,6)));t.splice(e,1),d=n.length}},c=[],l="",s="",u=0,d=n.length;u<d;u++){n[u]&&(l=n[u][0]),"C"!=l&&(c[u]=l,u&&(s=c[u-1])),n[u]=i(n[u],r,s),"A"!=c[u]&&"C"==l&&(c[u]="C"),o(n,u);var h=n[u],f=h.length;r.x=h[f-2],r.y=h[f-1],r.bx=a(h[f-4])||r.x,r.by=a(h[f-3])||r.y}return e.curve=b(n),n}t.exports=function(t,e,n){t=D(t),e=D(e);for(var r,a,i,o,c,l,s,u,d,h,f=n?0:[],p=0,m=t.length;p<m;p++){var v=t[p];if("M"==v[0])r=c=v[1],a=l=v[2];else{"C"==v[0]?(d=[r,a].concat(v.slice(1)),r=d[6],a=d[7]):(d=[r,a,r,a,c,l,c,l],r=c,a=l);for(var y=0,g=e.length;y<g;y++){var b=e[y];if("M"==b[0])i=s=b[1],o=u=b[2];else{"C"==b[0]?(h=[i,o].concat(b.slice(1)),i=h[6],o=h[7]):(h=[i,o,i,o,s,u,s,u],i=s,o=u);var x=P(d,h,n);if(n)f+=x;else{for(var k=0,w=x.length;k<w;k++)x[k].segment1=p,x[k].segment2=y,x[k].bez1=d,x[k].bez2=h;f=f.concat(x)}}}}}return f}},3760:function(t,e,n){var r=n(435),a=1,i=4;t.exports=function(t,e){return r(t,a|i,e="function"==typeof e?e:void 0)}},3761:function(t,e,n){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function o(t,e,n){if(n||2===arguments.length)for(var r,a=0,i=e.length;a<i;a++)!r&&a in e||(r||(r=Array.prototype.slice.call(e,0,a)),r[a]=e[a]);return t.concat(r||Array.prototype.slice.call(e))}function c(t,e,n){if(t&&t.length){var r=e[0],a=e[1],i=Math.PI/180*n,o=Math.cos(i),c=Math.sin(i);t.forEach((function(t){var e=t[0],n=t[1];t[0]=(e-r)*o-(n-a)*c+r,t[1]=(e-r)*c+(n-a)*o+a}))}}function l(t){var e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function s(t,e){var n=e.hachureAngle+90,r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);var a=[0,0];if(n)for(var i=0,l=t;i<l.length;i++)c(l[i],a,n);var s=function(t,e){for(var n=[],r=0,a=t;r<a.length;r++)(u=o([],a[r],!0))[0].join(",")!==u[u.length-1].join(",")&&u.push([u[0][0],u[0][1]]),u.length>2&&n.push(u);var i=[];e=Math.max(e,.1);for(var c=[],l=0,s=n;l<s.length;l++)for(var u=s[l],d=0;d<u.length-1;d++){var h=u[d],f=u[d+1];if(h[1]!==f[1]){var p=Math.min(h[1],f[1]);c.push({ymin:p,ymax:Math.max(h[1],f[1]),x:p===h[1]?h[0]:f[0],islope:(f[0]-h[0])/(f[1]-h[1])})}}if(c.sort((function(t,e){return t.ymin<e.ymin?-1:t.ymin>e.ymin?1:t.x<e.x?-1:t.x>e.x?1:t.ymax===e.ymax?0:(t.ymax-e.ymax)/Math.abs(t.ymax-e.ymax)})),!c.length)return i;for(var m=[],v=c[0].ymin;m.length||c.length;){if(c.length){var y=-1;for(d=0;d<c.length&&!(c[d].ymin>v);d++)y=d;c.splice(0,y+1).forEach((function(t){m.push({s:v,edge:t})}))}if((m=m.filter((function(t){return!(t.edge.ymax<=v)}))).sort((function(t,e){return t.edge.x===e.edge.x?0:(t.edge.x-e.edge.x)/Math.abs(t.edge.x-e.edge.x)})),m.length>1)for(d=0;d<m.length;d+=2){var g=d+1;if(g>=m.length)break;var b=m[d].edge,x=m[g].edge;i.push([[Math.round(b.x),v],[Math.round(x.x),v]])}v+=e,m.forEach((function(t){t.edge.x=t.edge.x+e*t.edge.islope}))}return i}(t,r);if(n){for(var u=0,d=t;u<d.length;u++)c(d[u],a,-n);!function(t,e,n){var r=[];t.forEach((function(t){return r.push.apply(r,t)})),c(r,e,n)}(s,a,-n)}return s}var u=function(){function t(t){this.helper=t}return t.prototype.fillPolygons=function(t,e){return this._fillPolygons(t,e)},t.prototype._fillPolygons=function(t,e){var n=s(t,e);return{type:"fillSketch",ops:this.renderLines(n,e)}},t.prototype.renderLines=function(t,e){for(var n=[],r=0,a=t;r<a.length;r++){var i=a[r];n.push.apply(n,this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],e))}return n},t}(),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.fillPolygons=function(t,e){var n=e.hachureGap;n<0&&(n=4*e.strokeWidth),n=Math.max(n,.1);for(var r=s(t,Object.assign({},e,{hachureGap:n})),a=Math.PI/180*e.hachureAngle,i=[],c=.5*n*Math.cos(a),u=.5*n*Math.sin(a),d=0,h=r;d<h.length;d++){var f=h[d],p=f[0],m=f[1];l([p,m])&&i.push([[p[0]-c,p[1]+u],o([],m,!0)],[[p[0]+c,p[1]-u],o([],m,!0)])}return{type:"fillSketch",ops:this.renderLines(i,e)}},e}(u),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.fillPolygons=function(t,e){var n=this._fillPolygons(t,e),r=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),a=this._fillPolygons(t,r);return n.ops=n.ops.concat(a.ops),n},e}(u),f=function(){function t(t){this.helper=t}return t.prototype.fillPolygons=function(t,e){var n=s(t,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(n,e)},t.prototype.dotsOnLines=function(t,e){var n=[],r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);var a=e.fillWeight;a<0&&(a=e.strokeWidth/2);for(var i=r/4,o=0,c=t;o<c.length;o++)for(var s=c[o],u=l(s),d=u/r,h=Math.ceil(d)-1,f=u-h*r,p=(s[0][0]+s[1][0])/2-r/4,m=Math.min(s[0][1],s[1][1]),v=0;v<h;v++){var y=m+f+v*r,g=p-i+2*Math.random()*i,b=y-i+2*Math.random()*i,x=this.helper.ellipse(g,b,a,a,e);n.push.apply(n,x.ops)}return{type:"fillSketch",ops:n}},t}(),p=function(){function t(t){this.helper=t}return t.prototype.fillPolygons=function(t,e){var n=s(t,e);return{type:"fillSketch",ops:this.dashedLine(n,e)}},t.prototype.dashedLine=function(t,e){var n=this,r=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,a=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,i=[];return t.forEach((function(t){var o=l(t),c=Math.floor(o/(r+a)),s=(o+a-c*(r+a))/2,u=t[0],d=t[1];u[0]>d[0]&&(u=t[1],d=t[0]);for(var h=Math.atan((d[1]-u[1])/(d[0]-u[0])),f=0;f<c;f++){var p=f*(r+a),m=p+r,v=[u[0]+p*Math.cos(h)+s*Math.cos(h),u[1]+p*Math.sin(h)+s*Math.sin(h)],y=[u[0]+m*Math.cos(h)+s*Math.cos(h),u[1]+m*Math.sin(h)+s*Math.sin(h)];i.push.apply(i,n.helper.doubleLineOps(v[0],v[1],y[0],y[1],e))}})),i},t}(),m=function(){function t(t){this.helper=t}return t.prototype.fillPolygons=function(t,e){var n=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,r=e.zigzagOffset<0?n:e.zigzagOffset,a=s(t,e=Object.assign({},e,{hachureGap:n+r}));return{type:"fillSketch",ops:this.zigzagLines(a,r,e)}},t.prototype.zigzagLines=function(t,e,n){var r=this,a=[];return t.forEach((function(t){var i=l(t),c=Math.round(i/(2*e)),s=t[0],u=t[1];s[0]>u[0]&&(s=t[1],u=t[0]);for(var d=Math.atan((u[1]-s[1])/(u[0]-s[0])),h=0;h<c;h++){var f=2*h*e,p=2*(h+1)*e,m=Math.sqrt(2*Math.pow(e,2)),v=[s[0]+f*Math.cos(d),s[1]+f*Math.sin(d)],y=[s[0]+p*Math.cos(d),s[1]+p*Math.sin(d)],g=[v[0]+m*Math.cos(d+Math.PI/4),v[1]+m*Math.sin(d+Math.PI/4)];a.push.apply(a,o(o([],r.helper.doubleLineOps(v[0],v[1],g[0],g[1],n),!1),r.helper.doubleLineOps(g[0],g[1],y[0],y[1],n),!1))}})),a},t}(),v={},y=function(){function t(t){this.seed=t}return t.prototype.next=function(){return this.seed?(Math.pow(2,31)-1&(this.seed=Math.imul(48271,this.seed)))/Math.pow(2,31):Math.random()},t}();const g={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function b(t,e){return t.type===e}function x(t){const e=[],n=function(t){const e=new Array;for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:0,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];e[e.length]={type:1,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length)}return e[e.length]={type:2,text:""},e}(t);let r="BOD",a=0,i=n[a];for(;!b(i,2);){let o=0;const c=[];if("BOD"===r){if("M"!==i.text&&"m"!==i.text)return x("M0,0"+t);a++,o=g[i.text],r=i.text}else b(i,1)?o=g[r]:(a++,o=g[i.text],r=i.text);if(!(a+o<n.length))throw new Error("Path data ended short");for(let t=a;t<a+o;t++){const e=n[t];if(!b(e,1))throw new Error("Param not a number: "+r+","+e.text);c[c.length]=+e.text}if("number"!=typeof g[r])throw new Error("Bad segment: "+r);{const t={key:r,data:c};e.push(t),a+=o,i=n[a],"M"===r&&(r="L"),"m"===r&&(r="l")}}return e}function k(t){let e=0,n=0,r=0,a=0;const i=[];for(const{key:o,data:c}of t)switch(o){case"M":i.push({key:"M",data:[...c]}),[e,n]=c,[r,a]=c;break;case"m":e+=c[0],n+=c[1],i.push({key:"M",data:[e,n]}),r=e,a=n;break;case"L":i.push({key:"L",data:[...c]}),[e,n]=c;break;case"l":e+=c[0],n+=c[1],i.push({key:"L",data:[e,n]});break;case"C":i.push({key:"C",data:[...c]}),e=c[4],n=c[5];break;case"c":{const t=c.map(((t,r)=>r%2?t+n:t+e));i.push({key:"C",data:t}),e=t[4],n=t[5];break}case"Q":i.push({key:"Q",data:[...c]}),e=c[2],n=c[3];break;case"q":{const t=c.map(((t,r)=>r%2?t+n:t+e));i.push({key:"Q",data:t}),e=t[2],n=t[3];break}case"A":i.push({key:"A",data:[...c]}),e=c[5],n=c[6];break;case"a":e+=c[5],n+=c[6],i.push({key:"A",data:[c[0],c[1],c[2],c[3],c[4],e,n]});break;case"H":i.push({key:"H",data:[...c]}),e=c[0];break;case"h":e+=c[0],i.push({key:"H",data:[e]});break;case"V":i.push({key:"V",data:[...c]}),n=c[0];break;case"v":n+=c[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...c]}),e=c[2],n=c[3];break;case"s":{const t=c.map(((t,r)=>r%2?t+n:t+e));i.push({key:"S",data:t}),e=t[2],n=t[3];break}case"T":i.push({key:"T",data:[...c]}),e=c[0],n=c[1];break;case"t":e+=c[0],n+=c[1],i.push({key:"T",data:[e,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),e=r,n=a}return i}function w(t){const e=[];let n="",r=0,a=0,i=0,o=0,c=0,l=0;for(const{key:s,data:u}of t){switch(s){case"M":e.push({key:"M",data:[...u]}),[r,a]=u,[i,o]=u;break;case"C":e.push({key:"C",data:[...u]}),r=u[4],a=u[5],c=u[2],l=u[3];break;case"L":e.push({key:"L",data:[...u]}),[r,a]=u;break;case"H":r=u[0],e.push({key:"L",data:[r,a]});break;case"V":a=u[0],e.push({key:"L",data:[r,a]});break;case"S":{let t=0,i=0;"C"===n||"S"===n?(t=r+(r-c),i=a+(a-l)):(t=r,i=a),e.push({key:"C",data:[t,i,...u]}),c=u[0],l=u[1],r=u[2],a=u[3];break}case"T":{const[t,i]=u;let o=0,s=0;"Q"===n||"T"===n?(o=r+(r-c),s=a+(a-l)):(o=r,s=a);const d=r+2*(o-r)/3,h=a+2*(s-a)/3,f=t+2*(o-t)/3,p=i+2*(s-i)/3;e.push({key:"C",data:[d,h,f,p,t,i]}),c=o,l=s,r=t,a=i;break}case"Q":{const[t,n,i,o]=u,s=r+2*(t-r)/3,d=a+2*(n-a)/3,h=i+2*(t-i)/3,f=o+2*(n-o)/3;e.push({key:"C",data:[s,d,h,f,i,o]}),c=t,l=n,r=i,a=o;break}case"A":{const t=Math.abs(u[0]),n=Math.abs(u[1]),i=u[2],o=u[3],c=u[4],l=u[5],s=u[6];0===t||0===n?(e.push({key:"C",data:[r,a,l,s,l,s]}),r=l,a=s):r===l&&a===s||(A(r,a,l,s,t,n,i,o,c).forEach((function(t){e.push({key:"C",data:t})})),r=l,a=s);break}case"Z":e.push({key:"Z",data:[]}),r=i,a=o}n=s}return e}function C(t,e,n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function A(t,e,n,r,a,i,o,c,l,s){const u=(d=o,Math.PI*d/180);var d;let h=[],f=0,p=0,m=0,v=0;if(s)[f,p,m,v]=s;else{[t,e]=C(t,e,-u),[n,r]=C(n,r,-u);const o=(t-n)/2,s=(e-r)/2;let d=o*o/(a*a)+s*s/(i*i);d>1&&(d=Math.sqrt(d),a*=d,i*=d);const h=a*a,y=i*i,g=h*y-h*s*s-y*o*o,b=h*s*s+y*o*o,x=(c===l?-1:1)*Math.sqrt(Math.abs(g/b));m=x*a*s/i+(t+n)/2,v=x*-i*o/a+(e+r)/2,f=Math.asin(parseFloat(((e-v)/i).toFixed(9))),p=Math.asin(parseFloat(((r-v)/i).toFixed(9))),t<m&&(f=Math.PI-f),n<m&&(p=Math.PI-p),f<0&&(f=2*Math.PI+f),p<0&&(p=2*Math.PI+p),l&&f>p&&(f-=2*Math.PI),!l&&p>f&&(p-=2*Math.PI)}let y=p-f;if(Math.abs(y)>120*Math.PI/180){const t=p,e=n,c=r;p=l&&p>f?f+120*Math.PI/180*1:f+120*Math.PI/180*-1,h=A(n=m+a*Math.cos(p),r=v+i*Math.sin(p),e,c,a,i,o,0,l,[p,t,m,v])}y=p-f;const g=Math.cos(f),b=Math.sin(f),x=Math.cos(p),k=Math.sin(p),w=Math.tan(y/4),O=4/3*a*w,E=4/3*i*w,P=[t,e],S=[t+O*b,e-E*g],M=[n+O*k,r-E*x],j=[n,r];if(S[0]=2*P[0]-S[0],S[1]=2*P[1]-S[1],s)return[S,M,j].concat(h);{h=[S,M,j].concat(h);const t=[];for(let e=0;e<h.length;e+=3){const n=C(h[e][0],h[e][1],u),r=C(h[e+1][0],h[e+1][1],u),a=C(h[e+2][0],h[e+2][1],u);t.push([n[0],n[1],r[0],r[1],a[0],a[1]])}return t}}var O={randOffset:function(t,e){return _(t,e)},randOffsetWithRange:function(t,e,n){return N(t,e,n)},ellipse:function(t,e,n,r,a){return j(t,e,a,M(n,r,a)).opset},doubleLineOps:function(t,e,n,r,a){return I(t,e,n,r,a,!0)}};function E(t,e,n,r,a){return{type:"path",ops:I(t,e,n,r,a)}}function P(t,e,n){var r=(t||[]).length;if(r>2){for(var a=[],i=0;i<r-1;i++)a.push.apply(a,I(t[i][0],t[i][1],t[i+1][0],t[i+1][1],n));return e&&a.push.apply(a,I(t[r-1][0],t[r-1][1],t[0][0],t[0][1],n)),{type:"path",ops:a}}return 2===r?E(t[0][0],t[0][1],t[1][0],t[1][1],n):{type:"path",ops:[]}}function S(t,e){var n=F(t,1*(1+.2*e.roughness),e);if(!e.disableMultiStroke){var r=F(t,1.5*(1+.22*e.roughness),function(t){var e=i({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}(e));n=n.concat(r)}return{type:"path",ops:n}}function M(t,e,n){var r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),a=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/a,o=Math.abs(t/2),c=Math.abs(e/2),l=1-n.curveFitting;return{increment:i,rx:o+=_(o*l,n),ry:c+=_(c*l,n)}}function j(t,e,n,r){var a=q(r.increment,t,e,r.rx,r.ry,1,r.increment*N(.1,N(.4,1,n),n),n),i=a[0],o=a[1],c=z(i,null,n);if(!n.disableMultiStroke&&0!==n.roughness){var l=z(q(r.increment,t,e,r.rx,r.ry,1.5,0,n)[0],null,n);c=c.concat(l)}return{estimatedPoints:o,opset:{type:"path",ops:c}}}function R(t,e,n,r,a,i,c,l,s){var u=t,d=e,h=Math.abs(n/2),f=Math.abs(r/2);h+=_(.01*h,s),f+=_(.01*f,s);for(var p=a,m=i;p<0;)p+=2*Math.PI,m+=2*Math.PI;m-p>2*Math.PI&&(p=0,m=2*Math.PI);var v=2*Math.PI/s.curveStepCount,y=Math.min(v/2,(m-p)/2),g=Y(y,u,d,h,f,p,m,1,s);if(!s.disableMultiStroke){var b=Y(y,u,d,h,f,p,m,1.5,s);g.push.apply(g,b)}return c&&(l?g.push.apply(g,o(o([],I(u,d,u+h*Math.cos(p),d+f*Math.sin(p),s),!1),I(u,d,u+h*Math.cos(m),d+f*Math.sin(m),s),!1)):g.push({op:"lineTo",data:[u,d]},{op:"lineTo",data:[u+h*Math.cos(p),d+f*Math.sin(p)]})),{type:"path",ops:g}}function L(t,e){for(var n=[],r=0,a=t;r<a.length;r++){var i=a[r];if(i.length){var o=e.maxRandomnessOffset||0,c=i.length;if(c>2){n.push({op:"move",data:[i[0][0]+_(o,e),i[0][1]+_(o,e)]});for(var l=1;l<c;l++)n.push({op:"lineTo",data:[i[l][0]+_(o,e),i[l][1]+_(o,e)]})}}}return{type:"fillPath",ops:n}}function B(t,e){return function(t,e){var n=t.fillStyle||"hachure";if(!v[n])switch(n){case"zigzag":v[n]||(v[n]=new d(e));break;case"cross-hatch":v[n]||(v[n]=new h(e));break;case"dots":v[n]||(v[n]=new f(e));break;case"dashed":v[n]||(v[n]=new p(e));break;case"zigzag-line":v[n]||(v[n]=new m(e));break;default:v[n="hachure"]||(v[n]=new u(e))}return v[n]}(e,O).fillPolygons(t,e)}function D(t){return t.randomizer||(t.randomizer=new y(t.seed||0)),t.randomizer.next()}function N(t,e,n,r){return void 0===r&&(r=1),n.roughness*r*(D(n)*(e-t)+t)}function _(t,e,n){return void 0===n&&(n=1),N(-t,t,e,n)}function I(t,e,n,r,a,i){void 0===i&&(i=!1);var o=i?a.disableMultiStrokeFill:a.disableMultiStroke,c=T(t,e,n,r,a,!0,!1);if(o)return c;var l=T(t,e,n,r,a,!0,!0);return c.concat(l)}function T(t,e,n,r,a,i,o){var c,l=Math.pow(t-n,2)+Math.pow(e-r,2),s=Math.sqrt(l);c=s<200?1:s>500?.4:-.0016668*s+1.233334;var u=a.maxRandomnessOffset||0;u*u*100>l&&(u=s/10);var d=u/2,h=.2+.2*D(a),f=a.bowing*a.maxRandomnessOffset*(r-e)/200,p=a.bowing*a.maxRandomnessOffset*(t-n)/200;f=_(f,a,c),p=_(p,a,c);var m=[],v=function(){return _(d,a,c)},y=function(){return _(u,a,c)},g=a.preserveVertices;return i&&(o?m.push({op:"move",data:[t+(g?0:v()),e+(g?0:v())]}):m.push({op:"move",data:[t+(g?0:_(u,a,c)),e+(g?0:_(u,a,c))]})),o?m.push({op:"bcurveTo",data:[f+t+(n-t)*h+v(),p+e+(r-e)*h+v(),f+t+2*(n-t)*h+v(),p+e+2*(r-e)*h+v(),n+(g?0:v()),r+(g?0:v())]}):m.push({op:"bcurveTo",data:[f+t+(n-t)*h+y(),p+e+(r-e)*h+y(),f+t+2*(n-t)*h+y(),p+e+2*(r-e)*h+y(),n+(g?0:y()),r+(g?0:y())]}),m}function F(t,e,n){var r=[];r.push([t[0][0]+_(e,n),t[0][1]+_(e,n)]),r.push([t[0][0]+_(e,n),t[0][1]+_(e,n)]);for(var a=1;a<t.length;a++)r.push([t[a][0]+_(e,n),t[a][1]+_(e,n)]),a===t.length-1&&r.push([t[a][0]+_(e,n),t[a][1]+_(e,n)]);return z(r,null,n)}function z(t,e,n){var r=t.length,a=[];if(r>3){var i=[],o=1-n.curveTightness;a.push({op:"move",data:[t[1][0],t[1][1]]});for(var c=1;c+2<r;c++){var l=t[c];i[0]=[l[0],l[1]],i[1]=[l[0]+(o*t[c+1][0]-o*t[c-1][0])/6,l[1]+(o*t[c+1][1]-o*t[c-1][1])/6],i[2]=[t[c+1][0]+(o*t[c][0]-o*t[c+2][0])/6,t[c+1][1]+(o*t[c][1]-o*t[c+2][1])/6],i[3]=[t[c+1][0],t[c+1][1]],a.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(e&&2===e.length){var s=n.maxRandomnessOffset;a.push({op:"lineTo",data:[e[0]+_(s,n),e[1]+_(s,n)]})}}else 3===r?(a.push({op:"move",data:[t[1][0],t[1][1]]}),a.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===r&&a.push.apply(a,I(t[0][0],t[0][1],t[1][0],t[1][1],n));return a}function q(t,e,n,r,a,i,o,c){var l=[],s=[];if(0===c.roughness){t/=4,s.push([e+r*Math.cos(-t),n+a*Math.sin(-t)]);for(var u=0;u<=2*Math.PI;u+=t){var d=[e+r*Math.cos(u),n+a*Math.sin(u)];l.push(d),s.push(d)}s.push([e+r*Math.cos(0),n+a*Math.sin(0)]),s.push([e+r*Math.cos(t),n+a*Math.sin(t)])}else{var h=_(.5,c)-Math.PI/2;s.push([_(i,c)+e+.9*r*Math.cos(h-t),_(i,c)+n+.9*a*Math.sin(h-t)]);var f=2*Math.PI+h-.01;for(u=h;u<f;u+=t)d=[_(i,c)+e+r*Math.cos(u),_(i,c)+n+a*Math.sin(u)],l.push(d),s.push(d);s.push([_(i,c)+e+r*Math.cos(h+2*Math.PI+.5*o),_(i,c)+n+a*Math.sin(h+2*Math.PI+.5*o)]),s.push([_(i,c)+e+.98*r*Math.cos(h+o),_(i,c)+n+.98*a*Math.sin(h+o)]),s.push([_(i,c)+e+.9*r*Math.cos(h+.5*o),_(i,c)+n+.9*a*Math.sin(h+.5*o)])}return[s,l]}function Y(t,e,n,r,a,i,o,c,l){var s=i+_(.1,l),u=[];u.push([_(c,l)+e+.9*r*Math.cos(s-t),_(c,l)+n+.9*a*Math.sin(s-t)]);for(var d=s;d<=o;d+=t)u.push([_(c,l)+e+r*Math.cos(d),_(c,l)+n+a*Math.sin(d)]);return u.push([e+r*Math.cos(o),n+a*Math.sin(o)]),u.push([e+r*Math.cos(o),n+a*Math.sin(o)]),z(u,null,l)}function H(t){return[...t]}function G(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function X(t,e,n){const r=G(e,n);if(0===r)return G(t,e);let a=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/r;return a=Math.max(0,Math.min(1,a)),G(t,W(e,n,a))}function W(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function V(t,e,n,r){const a=r||[];if(function(t,e){const n=t[e+0],r=t[e+1],a=t[e+2],i=t[e+3];let o=3*r[0]-2*n[0]-i[0];o*=o;let c=3*r[1]-2*n[1]-i[1];c*=c;let l=3*a[0]-2*i[0]-n[0];l*=l;let s=3*a[1]-2*i[1]-n[1];return s*=s,o<l&&(o=l),c<s&&(c=s),o+c}(t,e)<n){const n=t[e+0];a.length?(i=a[a.length-1],o=n,Math.sqrt(G(i,o))>1&&a.push(n)):a.push(n),a.push(t[e+3])}else{const r=.5,i=t[e+0],o=t[e+1],c=t[e+2],l=t[e+3],s=W(i,o,r),u=W(o,c,r),d=W(c,l,r),h=W(s,u,r),f=W(u,d,r),p=W(h,f,r);V([i,s,h,p],0,n,a),V([p,f,d,l],0,n,a)}var i,o;return a}function Z(t,e){return U(t,0,t.length,e)}function U(t,e,n,r,a){const i=a||[],o=t[e],c=t[n-1];let l=0,s=1;for(let r=e+1;r<n-1;++r){const e=X(t[r],o,c);e>l&&(l=e,s=r)}return Math.sqrt(l)>r?(U(t,e,s+1,r,i),U(t,s,n,r,i)):(i.length||i.push(o),i.push(c)),i}function K(t,e=.15,n){const r=[],a=(t.length-1)/3;for(let n=0;n<a;n++)V(t,3*n,e,r);return n&&n>0?U(r,0,r.length,n):r}var Q="none",$=function(){function t(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}return t.newSeed=function(){return Math.floor(Math.random()*Math.pow(2,31))},t.prototype._o=function(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions},t.prototype._d=function(t,e,n){return{shape:t,sets:e||[],options:n||this.defaultOptions}},t.prototype.line=function(t,e,n,r,a){var i=this._o(a);return this._d("line",[E(t,e,n,r,i)],i)},t.prototype.rectangle=function(t,e,n,r,a){var i=this._o(a),o=[],c=function(t,e,n,r,a){return function(t,e){return P(t,!0,e)}([[t,e],[t+n,e],[t+n,e+r],[t,e+r]],a)}(t,e,n,r,i);if(i.fill){var l=[[t,e],[t+n,e],[t+n,e+r],[t,e+r]];"solid"===i.fillStyle?o.push(L([l],i)):o.push(B([l],i))}return i.stroke!==Q&&o.push(c),this._d("rectangle",o,i)},t.prototype.ellipse=function(t,e,n,r,a){var i=this._o(a),o=[],c=M(n,r,i),l=j(t,e,i,c);if(i.fill)if("solid"===i.fillStyle){var s=j(t,e,i,c).opset;s.type="fillPath",o.push(s)}else o.push(B([l.estimatedPoints],i));return i.stroke!==Q&&o.push(l.opset),this._d("ellipse",o,i)},t.prototype.circle=function(t,e,n,r){var a=this.ellipse(t,e,n,n,r);return a.shape="circle",a},t.prototype.linearPath=function(t,e){var n=this._o(e);return this._d("linearPath",[P(t,!1,n)],n)},t.prototype.arc=function(t,e,n,r,a,o,c,l){void 0===c&&(c=!1);var s=this._o(l),u=[],d=R(t,e,n,r,a,o,c,!0,s);if(c&&s.fill)if("solid"===s.fillStyle){var h=i({},s);h.disableMultiStroke=!0;var f=R(t,e,n,r,a,o,!0,!1,h);f.type="fillPath",u.push(f)}else u.push(function(t,e,n,r,a,i,o){var c=t,l=e,s=Math.abs(n/2),u=Math.abs(r/2);s+=_(.01*s,o),u+=_(.01*u,o);for(var d=a,h=i;d<0;)d+=2*Math.PI,h+=2*Math.PI;h-d>2*Math.PI&&(d=0,h=2*Math.PI);for(var f=(h-d)/o.curveStepCount,p=[],m=d;m<=h;m+=f)p.push([c+s*Math.cos(m),l+u*Math.sin(m)]);return p.push([c+s*Math.cos(h),l+u*Math.sin(h)]),p.push([c,l]),B([p],o)}(t,e,n,r,a,o,s));return s.stroke!==Q&&u.push(d),this._d("arc",u,s)},t.prototype.curve=function(t,e){var n=this._o(e),r=[],a=S(t,n);if(n.fill&&n.fill!==Q&&t.length>=3){var i=K(function(t,e=0){const n=t.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(3===n)r.push(H(t[0]),H(t[1]),H(t[2]),H(t[2]));else{const n=[];n.push(t[0],t[0]);for(let e=1;e<t.length;e++)n.push(t[e]),e===t.length-1&&n.push(t[e]);const a=[],i=1-e;r.push(H(n[0]));for(let t=1;t+2<n.length;t++){const e=n[t];a[0]=[e[0],e[1]],a[1]=[e[0]+(i*n[t+1][0]-i*n[t-1][0])/6,e[1]+(i*n[t+1][1]-i*n[t-1][1])/6],a[2]=[n[t+1][0]+(i*n[t][0]-i*n[t+2][0])/6,n[t+1][1]+(i*n[t][1]-i*n[t+2][1])/6],a[3]=[n[t+1][0],n[t+1][1]],r.push(a[1],a[2],a[3])}}return r}(t),10,(1+n.roughness)/2);"solid"===n.fillStyle?r.push(L([i],n)):r.push(B([i],n))}return n.stroke!==Q&&r.push(a),this._d("curve",r,n)},t.prototype.polygon=function(t,e){var n=this._o(e),r=[],a=P(t,!0,n);return n.fill&&("solid"===n.fillStyle?r.push(L([t],n)):r.push(B([t],n))),n.stroke!==Q&&r.push(a),this._d("polygon",r,n)},t.prototype.path=function(t,e){var n=this._o(e),r=[];if(!t)return this._d("path",r,n);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");var a=n.fill&&"transparent"!==n.fill&&n.fill!==Q,i=n.stroke!==Q,o=!!(n.simplification&&n.simplification<1),c=function(t,e,n){const r=w(k(x(t))),a=[];let i=[],o=[0,0],c=[];const l=()=>{c.length>=4&&i.push(...K(c,1)),c=[]},s=()=>{l(),i.length&&(a.push(i),i=[])};for(const{key:t,data:e}of r)switch(t){case"M":s(),o=[e[0],e[1]],i.push(o);break;case"L":l(),i.push([e[0],e[1]]);break;case"C":if(!c.length){const t=i.length?i[i.length-1]:o;c.push([t[0],t[1]])}c.push([e[0],e[1]]),c.push([e[2],e[3]]),c.push([e[4],e[5]]);break;case"Z":l(),i.push([o[0],o[1]])}if(s(),!n)return a;const u=[];for(const t of a){const e=Z(t,n);e.length&&u.push(e)}return u}(t,0,o?4-4*n.simplification:(1+n.roughness)/2);return a&&("solid"===n.fillStyle?r.push(L(c,n)):r.push(B(c,n))),i&&(o?c.forEach((function(t){r.push(P(t,!1,n))})):r.push(function(t,e){for(var n=w(k(x(t))),r=[],a=[0,0],i=[0,0],o=function(t,n){switch(t){case"M":var o=1*(e.maxRandomnessOffset||0),c=e.preserveVertices;r.push({op:"move",data:n.map((function(t){return t+(c?0:_(o,e))}))}),i=[n[0],n[1]],a=[n[0],n[1]];break;case"L":r.push.apply(r,I(i[0],i[1],n[0],n[1],e)),i=[n[0],n[1]];break;case"C":var l=n[0],s=n[1],u=n[2],d=n[3],h=n[4],f=n[5];r.push.apply(r,function(t,e,n,r,a,i,o,c){for(var l=[],s=[c.maxRandomnessOffset||1,(c.maxRandomnessOffset||1)+.3],u=[0,0],d=c.disableMultiStroke?1:2,h=c.preserveVertices,f=0;f<d;f++)0===f?l.push({op:"move",data:[o[0],o[1]]}):l.push({op:"move",data:[o[0]+(h?0:_(s[0],c)),o[1]+(h?0:_(s[0],c))]}),u=h?[a,i]:[a+_(s[f],c),i+_(s[f],c)],l.push({op:"bcurveTo",data:[t+_(s[f],c),e+_(s[f],c),n+_(s[f],c),r+_(s[f],c),u[0],u[1]]});return l}(l,s,u,d,h,f,i,e)),i=[h,f];break;case"Z":r.push.apply(r,I(i[0],i[1],a[0],a[1],e)),i=[a[0],a[1]]}},c=0,l=n;c<l.length;c++){var s=l[c];o(s.key,s.data)}return{type:"path",ops:r}}(t,n))),this._d("path",r,n)},t.prototype.opsToPath=function(t,e){for(var n="",r=0,a=t.ops;r<a.length;r++){var i=a[r],o="number"==typeof e&&e>=0?i.data.map((function(t){return+t.toFixed(e)})):i.data;switch(i.op){case"move":n+="M".concat(o[0]," ").concat(o[1]," ");break;case"bcurveTo":n+="C".concat(o[0]," ").concat(o[1],", ").concat(o[2]," ").concat(o[3],", ").concat(o[4]," ").concat(o[5]," ");break;case"lineTo":n+="L".concat(o[0]," ").concat(o[1]," ")}}return n.trim()},t.prototype.toPaths=function(t){for(var e=t.sets||[],n=t.options||this.defaultOptions,r=[],a=0,i=e;a<i.length;a++){var o=i[a],c=null;switch(o.type){case"path":c={d:this.opsToPath(o),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:Q};break;case"fillPath":c={d:this.opsToPath(o),stroke:Q,strokeWidth:0,fill:n.fill||Q};break;case"fillSketch":c=this.fillSketch(o,n)}c&&r.push(c)}return r},t.prototype.fillSketch=function(t,e){var n=e.fillWeight;return n<0&&(n=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||Q,strokeWidth:n,fill:Q}},t}(),J=function(){function t(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new $(e)}return t.prototype.draw=function(t){for(var e=t.sets||[],n=t.options||this.getDefaultOptions(),r=this.ctx,a=t.options.fixedDecimalPlaceDigits,i=0,o=e;i<o.length;i++){var c=o[i];switch(c.type){case"path":r.save(),r.strokeStyle="none"===n.stroke?"transparent":n.stroke,r.lineWidth=n.strokeWidth,n.strokeLineDash&&r.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(r.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(r,c,a),r.restore();break;case"fillPath":r.save(),r.fillStyle=n.fill||"";var l="curve"===t.shape||"polygon"===t.shape||"path"===t.shape?"evenodd":"nonzero";this._drawToContext(r,c,a,l),r.restore();break;case"fillSketch":this.fillSketch(r,c,n)}}},t.prototype.fillSketch=function(t,e,n){var r=n.fillWeight;r<0&&(r=n.strokeWidth/2),t.save(),n.fillLineDash&&t.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(t.lineDashOffset=n.fillLineDashOffset),t.strokeStyle=n.fill||"",t.lineWidth=r,this._drawToContext(t,e,n.fixedDecimalPlaceDigits),t.restore()},t.prototype._drawToContext=function(t,e,n,r){void 0===r&&(r="nonzero"),t.beginPath();for(var a=0,i=e.ops;a<i.length;a++){var o=i[a],c="number"==typeof n&&n>=0?o.data.map((function(t){return+t.toFixed(n)})):o.data;switch(o.op){case"move":t.moveTo(c[0],c[1]);break;case"bcurveTo":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"lineTo":t.lineTo(c[0],c[1])}}"fillPath"===e.type?t.fill(r):t.stroke()},Object.defineProperty(t.prototype,"generator",{get:function(){return this.gen},enumerable:!1,configurable:!0}),t.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},t.prototype.line=function(t,e,n,r,a){var i=this.gen.line(t,e,n,r,a);return this.draw(i),i},t.prototype.rectangle=function(t,e,n,r,a){var i=this.gen.rectangle(t,e,n,r,a);return this.draw(i),i},t.prototype.ellipse=function(t,e,n,r,a){var i=this.gen.ellipse(t,e,n,r,a);return this.draw(i),i},t.prototype.circle=function(t,e,n,r){var a=this.gen.circle(t,e,n,r);return this.draw(a),a},t.prototype.linearPath=function(t,e){var n=this.gen.linearPath(t,e);return this.draw(n),n},t.prototype.polygon=function(t,e){var n=this.gen.polygon(t,e);return this.draw(n),n},t.prototype.arc=function(t,e,n,r,a,i,o,c){void 0===o&&(o=!1);var l=this.gen.arc(t,e,n,r,a,i,o,c);return this.draw(l),l},t.prototype.curve=function(t,e){var n=this.gen.curve(t,e);return this.draw(n),n},t.prototype.path=function(t,e){var n=this.gen.path(t,e);return this.draw(n),n},t}(),tt="http://www.w3.org/2000/svg",et=function(){function t(t,e){this.svg=t,this.gen=new $(e)}return t.prototype.draw=function(t){for(var e=t.sets||[],n=t.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,a=r.createElementNS(tt,"g"),i=t.options.fixedDecimalPlaceDigits,o=0,c=e;o<c.length;o++){var l=c[o],s=null;switch(l.type){case"path":(s=r.createElementNS(tt,"path")).setAttribute("d",this.opsToPath(l,i)),s.setAttribute("stroke",n.stroke),s.setAttribute("stroke-width",n.strokeWidth+""),s.setAttribute("fill","none"),n.strokeLineDash&&s.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&s.setAttribute("stroke-dashoffset","".concat(n.strokeLineDashOffset));break;case"fillPath":(s=r.createElementNS(tt,"path")).setAttribute("d",this.opsToPath(l,i)),s.setAttribute("stroke","none"),s.setAttribute("stroke-width","0"),s.setAttribute("fill",n.fill||""),"curve"!==t.shape&&"polygon"!==t.shape||s.setAttribute("fill-rule","evenodd");break;case"fillSketch":s=this.fillSketch(r,l,n)}s&&a.appendChild(s)}return a},t.prototype.fillSketch=function(t,e,n){var r=n.fillWeight;r<0&&(r=n.strokeWidth/2);var a=t.createElementNS(tt,"path");return a.setAttribute("d",this.opsToPath(e,n.fixedDecimalPlaceDigits)),a.setAttribute("stroke",n.fill||""),a.setAttribute("stroke-width",r+""),a.setAttribute("fill","none"),n.fillLineDash&&a.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&a.setAttribute("stroke-dashoffset","".concat(n.fillLineDashOffset)),a},Object.defineProperty(t.prototype,"generator",{get:function(){return this.gen},enumerable:!1,configurable:!0}),t.prototype.getDefaultOptions=function(){return this.gen.defaultOptions},t.prototype.opsToPath=function(t,e){return this.gen.opsToPath(t,e)},t.prototype.line=function(t,e,n,r,a){var i=this.gen.line(t,e,n,r,a);return this.draw(i)},t.prototype.rectangle=function(t,e,n,r,a){var i=this.gen.rectangle(t,e,n,r,a);return this.draw(i)},t.prototype.ellipse=function(t,e,n,r,a){var i=this.gen.ellipse(t,e,n,r,a);return this.draw(i)},t.prototype.circle=function(t,e,n,r){var a=this.gen.circle(t,e,n,r);return this.draw(a)},t.prototype.linearPath=function(t,e){var n=this.gen.linearPath(t,e);return this.draw(n)},t.prototype.polygon=function(t,e){var n=this.gen.polygon(t,e);return this.draw(n)},t.prototype.arc=function(t,e,n,r,a,i,o,c){void 0===o&&(o=!1);var l=this.gen.arc(t,e,n,r,a,i,o,c);return this.draw(l)},t.prototype.curve=function(t,e){var n=this.gen.curve(t,e);return this.draw(n)},t.prototype.path=function(t,e){var n=this.gen.path(t,e);return this.draw(n)},t}(),nt={canvas:function(t,e){return new J(t,e)},svg:function(t,e){return new et(t,e)},generator:function(t){return new $(t)},newSeed:function(){return $.newSeed()}};t.exports=nt},3762:function(t,e,n){var r=n(3763)();t.exports=r},3763:function(t,e,n){var r=n(3764),a=n(397),i=n(2027);t.exports=function(t){return function(e,n,o){return o&&"number"!=typeof o&&a(e,n,o)&&(n=o=void 0),e=i(e),void 0===n?(n=e,e=0):n=i(n),o=void 0===o?e<n?1:-1:i(o),r(e,n,o,t)}}},3764:function(t,e){var n=Math.ceil,r=Math.max;t.exports=function(t,e,a,i){for(var o=-1,c=r(n((e-t)/(a||1)),0),l=Array(c);c--;)l[i?c:++o]=t,t+=a;return l}},3765:function(t,e,n){"use strict";t.exports=n(3766)},3766:function(t,e,n){"use strict";var r=n(3767),a=n(3768),i=n(3682),o=n(3769),c=n(3770);function l(t){if(!(this instanceof l))return new l(t);var e=r(t);this.segments=e.segments,this.err=e.err,this.__stack=[]}l.from=function(t){if("string"==typeof t)return new l(t);if(t instanceof l){var e=new l("");return e.err=t.err,e.segments=t.segments.map((function(t){return t.slice()})),e.__stack=t.__stack.map((function(t){return i().matrix(t.toArray())})),e}throw new Error("SvgPath.from: invalid param type "+t)},l.prototype.__matrix=function(t){var e,n=this;t.queue.length&&this.iterate((function(r,a,i,o){var l,s,u,d;switch(r[0]){case"v":s=0===(l=t.calc(0,r[1],!0))[0]?["v",l[1]]:["l",l[0],l[1]];break;case"V":s=(l=t.calc(i,r[1],!1))[0]===t.calc(i,o,!1)[0]?["V",l[1]]:["L",l[0],l[1]];break;case"h":s=0===(l=t.calc(r[1],0,!0))[1]?["h",l[0]]:["l",l[0],l[1]];break;case"H":s=(l=t.calc(r[1],o,!1))[1]===t.calc(i,o,!1)[1]?["H",l[0]]:["L",l[0],l[1]];break;case"a":case"A":var h=t.toArray(),f=c(r[1],r[2],r[3]).transform(h);if(h[0]*h[3]-h[1]*h[2]<0&&(r[5]=r[5]?"0":"1"),l=t.calc(r[6],r[7],"a"===r[0]),"A"===r[0]&&r[6]===i&&r[7]===o||"a"===r[0]&&0===r[6]&&0===r[7]){s=["a"===r[0]?"l":"L",l[0],l[1]];break}s=f.isDegenerate()?["a"===r[0]?"l":"L",l[0],l[1]]:[r[0],f.rx,f.ry,f.ax,r[4],r[5],l[0],l[1]];break;case"m":d=a>0,s=["m",(l=t.calc(r[1],r[2],d))[0],l[1]];break;default:for(s=[u=r[0]],d=u.toLowerCase()===u,e=1;e<r.length;e+=2)l=t.calc(r[e],r[e+1],d),s.push(l[0],l[1])}n.segments[a]=s}),!0)},l.prototype.__evaluateStack=function(){var t,e;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=i(),e=this.__stack.length;--e>=0;)t.matrix(this.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},l.prototype.toString=function(){var t="",e="",n=!1;this.__evaluateStack();for(var r=0,a=this.segments.length;r<a;r++){var i=this.segments[r],o=i[0];o!==e||"m"===o||"M"===o?("m"===o&&"z"===e&&(t+=" "),t+=o,n=!1):n=!0;for(var c=1;c<i.length;c++){var l=i[c];1===c?n&&l>=0&&(t+=" "):l>=0&&(t+=" "),t+=l}e=o}return t},l.prototype.translate=function(t,e){return this.__stack.push(i().translate(t,e||0)),this},l.prototype.scale=function(t,e){return this.__stack.push(i().scale(t,e||0===e?e:t)),this},l.prototype.rotate=function(t,e,n){return this.__stack.push(i().rotate(t,e||0,n||0)),this},l.prototype.skewX=function(t){return this.__stack.push(i().skewX(t)),this},l.prototype.skewY=function(t){return this.__stack.push(i().skewY(t)),this},l.prototype.matrix=function(t){return this.__stack.push(i().matrix(t)),this},l.prototype.transform=function(t){return t.trim()?(this.__stack.push(a(t)),this):this},l.prototype.round=function(t){var e,n=0,r=0,a=0,i=0;return t=t||0,this.__evaluateStack(),this.segments.forEach((function(o){var c=o[0].toLowerCase()===o[0];switch(o[0]){case"H":case"h":return c&&(o[1]+=a),a=o[1]-o[1].toFixed(t),void(o[1]=+o[1].toFixed(t));case"V":case"v":return c&&(o[1]+=i),i=o[1]-o[1].toFixed(t),void(o[1]=+o[1].toFixed(t));case"Z":case"z":return a=n,void(i=r);case"M":case"m":return c&&(o[1]+=a,o[2]+=i),a=o[1]-o[1].toFixed(t),i=o[2]-o[2].toFixed(t),n=a,r=i,o[1]=+o[1].toFixed(t),void(o[2]=+o[2].toFixed(t));case"A":case"a":return c&&(o[6]+=a,o[7]+=i),a=o[6]-o[6].toFixed(t),i=o[7]-o[7].toFixed(t),o[1]=+o[1].toFixed(t),o[2]=+o[2].toFixed(t),o[3]=+o[3].toFixed(t+2),o[6]=+o[6].toFixed(t),void(o[7]=+o[7].toFixed(t));default:return e=o.length,c&&(o[e-2]+=a,o[e-1]+=i),a=o[e-2]-o[e-2].toFixed(t),i=o[e-1]-o[e-1].toFixed(t),void o.forEach((function(e,n){n&&(o[n]=+o[n].toFixed(t))}))}})),this},l.prototype.iterate=function(t,e){var n,r,a,i=this.segments,o={},c=!1,l=0,s=0,u=0,d=0;if(e||this.__evaluateStack(),i.forEach((function(e,n){var r=t(e,n,l,s);Array.isArray(r)&&(o[n]=r,c=!0);var a=e[0]===e[0].toLowerCase();switch(e[0]){case"m":case"M":return l=e[1]+(a?l:0),s=e[2]+(a?s:0),u=l,void(d=s);case"h":case"H":return void(l=e[1]+(a?l:0));case"v":case"V":return void(s=e[1]+(a?s:0));case"z":case"Z":return l=u,void(s=d);default:l=e[e.length-2]+(a?l:0),s=e[e.length-1]+(a?s:0)}})),!c)return this;for(a=[],n=0;n<i.length;n++)if(void 0!==o[n])for(r=0;r<o[n].length;r++)a.push(o[n][r]);else a.push(i[n]);return this.segments=a,this},l.prototype.abs=function(){return this.iterate((function(t,e,n,r){var a,i=t[0],o=i.toUpperCase();if(i!==o)switch(t[0]=o,i){case"v":return void(t[1]+=r);case"a":return t[6]+=n,void(t[7]+=r);default:for(a=1;a<t.length;a++)t[a]+=a%2?n:r}}),!0),this},l.prototype.rel=function(){return this.iterate((function(t,e,n,r){var a,i=t[0],o=i.toLowerCase();if(i!==o&&(0!==e||"M"!==i))switch(t[0]=o,i){case"V":return void(t[1]-=r);case"A":return t[6]-=n,void(t[7]-=r);default:for(a=1;a<t.length;a++)t[a]-=a%2?n:r}}),!0),this},l.prototype.unarc=function(){return this.iterate((function(t,e,n,r){var a,i,c,l=[],s=t[0];return"A"!==s&&"a"!==s?null:("a"===s?(i=n+t[6],c=r+t[7]):(i=t[6],c=t[7]),0===(a=o(n,r,i,c,t[4],t[5],t[1],t[2],t[3])).length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(a.forEach((function(t){l.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])})),l))})),this},l.prototype.unshort=function(){var t,e,n,r,a,i=this.segments;return this.iterate((function(o,c,l,s){var u,d=o[0],h=d.toUpperCase();c&&("T"===h?(u="t"===d,"Q"===(n=i[c-1])[0]?(t=n[1]-l,e=n[2]-s):"q"===n[0]?(t=n[1]-n[3],e=n[2]-n[4]):(t=0,e=0),r=-t,a=-e,u||(r+=l,a+=s),i[c]=[u?"q":"Q",r,a,o[1],o[2]]):"S"===h&&(u="s"===d,"C"===(n=i[c-1])[0]?(t=n[3]-l,e=n[4]-s):"c"===n[0]?(t=n[3]-n[5],e=n[4]-n[6]):(t=0,e=0),r=-t,a=-e,u||(r+=l,a+=s),i[c]=[u?"c":"C",r,a,o[1],o[2],o[3],o[4]]))})),this},t.exports=l},3767:function(t,e,n){"use strict";var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},a=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function i(t){return t>=48&&t<=57}function o(t){return t>=48&&t<=57||43===t||45===t||46===t}function c(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function l(t){for(;t.index<t.max&&(10===(e=t.path.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&a.indexOf(e)>=0);)t.index++;var e}function s(t){var e=t.path.charCodeAt(t.index);return 48===e?(t.param=0,void t.index++):49===e?(t.param=1,void t.index++):void(t.err="SvgPath: arc flag can be 0 or 1 only (at pos "+t.index+")")}function u(t){var e,n=t.index,r=n,a=t.max,o=!1,c=!1,l=!1,s=!1;if(r>=a)t.err="SvgPath: missed param (at pos "+r+")";else if(43!==(e=t.path.charCodeAt(r))&&45!==e||(e=++r<a?t.path.charCodeAt(r):0),i(e)||46===e){if(46!==e){if(o=48===e,e=++r<a?t.path.charCodeAt(r):0,o&&r<a&&e&&i(e))return void(t.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+n+")");for(;r<a&&i(t.path.charCodeAt(r));)r++,c=!0;e=r<a?t.path.charCodeAt(r):0}if(46===e){for(s=!0,r++;i(t.path.charCodeAt(r));)r++,l=!0;e=r<a?t.path.charCodeAt(r):0}if(101===e||69===e){if(s&&!c&&!l)return void(t.err="SvgPath: invalid float exponent (at pos "+r+")");if(43!==(e=++r<a?t.path.charCodeAt(r):0)&&45!==e||r++,!(r<a&&i(t.path.charCodeAt(r))))return void(t.err="SvgPath: invalid float exponent (at pos "+r+")");for(;r<a&&i(t.path.charCodeAt(r));)r++}t.index=r,t.param=parseFloat(t.path.slice(n,r))+0}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+r+")"}function d(t){var e,n;n=(e=t.path[t.segmentStart]).toLowerCase();var a=t.data;if("m"===n&&a.length>2&&(t.result.push([e,a[0],a[1]]),a=a.slice(2),n="l",e="m"===e?"l":"L"),"r"===n)t.result.push([e].concat(a));else for(;a.length>=r[n]&&(t.result.push([e].concat(a.splice(0,r[n]))),r[n]););}function h(t){var e,n,a,i,c,h=t.max;if(t.segmentStart=t.index,e=t.path.charCodeAt(t.index),n=97==(32|e),function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return!0}return!1}(e))if(i=r[t.path[t.index].toLowerCase()],t.index++,l(t),t.data=[],i){for(a=!1;;){for(c=i;c>0;c--){if(!n||3!==c&&4!==c?u(t):s(t),t.err.length)return void d(t);t.data.push(t.param),l(t),a=!1,t.index<h&&44===t.path.charCodeAt(t.index)&&(t.index++,l(t),a=!0)}if(!a){if(t.index>=t.max)break;if(!o(t.path.charCodeAt(t.index)))break}}d(t)}else d(t);else t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")"}t.exports=function(t){var e=new c(t),n=e.max;for(l(e);e.index<n&&!e.err.length;)h(e);return e.result.length&&("mM".indexOf(e.result[0][0])<0?(e.err="SvgPath: string should start with `M` or `m`",e.result=[]):e.result[0][0]="M"),{err:e.err,segments:e.result}}},3768:function(t,e,n){"use strict";var r=n(3682),a={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},i=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,o=/[\s,]+/;t.exports=function(t){var e,n,c=new r;return t.split(i).forEach((function(t){if(t.length)if(void 0===a[t])switch(n=t.split(o).map((function(t){return+t||0})),e){case"matrix":return void(6===n.length&&c.matrix(n));case"scale":return void(1===n.length?c.scale(n[0],n[0]):2===n.length&&c.scale(n[0],n[1]));case"rotate":return void(1===n.length?c.rotate(n[0],0,0):3===n.length&&c.rotate(n[0],n[1],n[2]));case"translate":return void(1===n.length?c.translate(n[0],0):2===n.length&&c.translate(n[0],n[1]));case"skewX":return void(1===n.length&&c.skewX(n[0]));case"skewY":return void(1===n.length&&c.skewY(n[0]))}else e=t})),c}},3769:function(t,e,n){"use strict";var r=2*Math.PI;function a(t,e,n,r){var a=t*n+e*r;return a>1&&(a=1),a<-1&&(a=-1),(t*r-e*n<0?-1:1)*Math.acos(a)}function i(t,e){var n=4/3*Math.tan(e/4),r=Math.cos(t),a=Math.sin(t),i=Math.cos(t+e),o=Math.sin(t+e);return[r,a,r-a*n,a+r*n,i+o*n,o-i*n,i,o]}t.exports=function(t,e,n,o,c,l,s,u,d){var h=Math.sin(d*r/360),f=Math.cos(d*r/360),p=f*(t-n)/2+h*(e-o)/2,m=-h*(t-n)/2+f*(e-o)/2;if(0===p&&0===m)return[];if(0===s||0===u)return[];s=Math.abs(s),u=Math.abs(u);var v=p*p/(s*s)+m*m/(u*u);v>1&&(s*=Math.sqrt(v),u*=Math.sqrt(v));var y=function(t,e,n,i,o,c,l,s,u,d){var h=d*(t-n)/2+u*(e-i)/2,f=-u*(t-n)/2+d*(e-i)/2,p=l*l,m=s*s,v=h*h,y=f*f,g=p*m-p*y-m*v;g<0&&(g=0),g/=p*y+m*v;var b=(g=Math.sqrt(g)*(o===c?-1:1))*l/s*f,x=g*-s/l*h,k=d*b-u*x+(t+n)/2,w=u*b+d*x+(e+i)/2,C=(h-b)/l,A=(f-x)/s,O=(-h-b)/l,E=(-f-x)/s,P=a(1,0,C,A),S=a(C,A,O,E);return 0===c&&S>0&&(S-=r),1===c&&S<0&&(S+=r),[k,w,P,S]}(t,e,n,o,c,l,s,u,h,f),g=[],b=y[2],x=y[3],k=Math.max(Math.ceil(Math.abs(x)/(r/4)),1);x/=k;for(var w=0;w<k;w++)g.push(i(b,x)),b+=x;return g.map((function(t){for(var e=0;e<t.length;e+=2){var n=t[e+0],r=t[e+1],a=f*(n*=s)-h*(r*=u),i=h*n+f*r;t[e+0]=a+y[0],t[e+1]=i+y[1]}return t}))}},3770:function(t,e,n){"use strict";var r=1e-10,a=Math.PI/180;function i(t,e,n){if(!(this instanceof i))return new i(t,e,n);this.rx=t,this.ry=e,this.ax=n}i.prototype.transform=function(t){var e=Math.cos(this.ax*a),n=Math.sin(this.ax*a),i=[this.rx*(t[0]*e+t[2]*n),this.rx*(t[1]*e+t[3]*n),this.ry*(-t[0]*n+t[2]*e),this.ry*(-t[1]*n+t[3]*e)],o=i[0]*i[0]+i[2]*i[2],c=i[1]*i[1]+i[3]*i[3],l=((i[0]-i[3])*(i[0]-i[3])+(i[2]+i[1])*(i[2]+i[1]))*((i[0]+i[3])*(i[0]+i[3])+(i[2]-i[1])*(i[2]-i[1])),s=(o+c)/2;if(l<r*s)return this.rx=this.ry=Math.sqrt(s),this.ax=0,this;var u=i[0]*i[1]+i[2]*i[3],d=s+(l=Math.sqrt(l))/2,h=s-l/2;return this.ax=Math.abs(u)<r&&Math.abs(d-c)<r?90:180*Math.atan(Math.abs(u)>Math.abs(d-c)?(d-o)/u:u/(d-c))/Math.PI,this.ax>=0?(this.rx=Math.sqrt(d),this.ry=Math.sqrt(h)):(this.ax+=90,this.rx=Math.sqrt(h),this.ry=Math.sqrt(d)),this},i.prototype.isDegenerate=function(){return this.rx<r*this.ry||this.ry<r*this.rx},t.exports=i},3771:function(t,e,n){var r=n(435),a=4;t.exports=function(t){return r(t,a)}},3805:function(t,e,n){"use strict";var r=n(3491),a=n.n(r),i=n(3454);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function c(){c=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function d(t,e,n,a){var i=e&&e.prototype instanceof p?e:p,o=Object.create(i.prototype),c=new P(a||[]);return r(o,"_invoke",{value:C(t,n,c)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=d;var f={};function p(){}function m(){}function v(){}var y={};u(y,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==e&&n.call(b,i)&&(y=b);var x=v.prototype=p.prototype=Object.create(y);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function a(r,i,c,l){var s=h(t[r],t,i);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==o(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){a("next",t,c,l)}),(function(t){a("throw",t,c,l)})):e.resolve(d).then((function(t){u.value=t,c(u)}),(function(t){return a("throw",t,c,l)}))}l(s.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){a(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function C(t,e,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return M()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var c=A(o,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=h(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function A(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=h(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,f;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:M}}function M(){return{value:void 0,done:!0}}return m.prototype=v,r(x,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:m,configurable:!0}),m.displayName=u(v,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},k(w.prototype),u(w.prototype,l,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new w(d(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},k(x),u(x,s,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function l(t,e,n,r,a,i,o){try{var c=t[i](o),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,a)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){l(i,r,a,o,c,"next",t)}function c(t){l(i,r,a,o,c,"throw",t)}o(void 0)}))}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(a=r.key,i=void 0,i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(a,"string"),"symbol"===o(i)?i:String(i)),r)}var a,i}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var a=f(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(f,t);var e,n,r,a,o,l=h(f);function f(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),l.apply(this,arguments)}return e=f,n=[{key:"init",value:function(t){var e=t.content;t.onFocus,this.setContent(e)}},{key:"getDefaultDiagram",value:function(){var t,e,n;return{diagramData:{head:{theme:{name:"dark"===(null===(t=window)||void 0===t||null===(e=t.appData)||void 0===e||null===(n=e.themeManager)||void 0===n?void 0:n._current)?"dark":"default"}},body:[]}}}},{key:"setContent",value:function(t){var e=f.contentToMind(t);e?this.isUseDefaultContent=!1:(e=this.getDefaultDiagram(),this.isUseDefaultContent=!0),this.engine.setValue(e)}},{key:"getValue",value:function(){return JSON.stringify(this.engine.getValue())}},{key:"getPureContent",value:function(){return JSON.stringify(this.engine.getValue())}},{key:"getEditorContent",value:function(t){return{content:this.getValue(),html:null,premium:null,premiumHtml:null}}},{key:"export",value:function(t,e){"png"!==t&&"jpg"!==t||this.engine.download(t,e)}},{key:"getThumbnail",value:(o=s(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.engine.canvas({backgroundColor:"#fff"});case 2:return e=t.sent,t.abrupt("return",e.toDataURL("image/jpeg",.5));case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"isEmpty",value:function(){return 0===this.engine.getValue().diagramData.body.length}},{key:"getDocMeta",value:function(){return this.engine.getMeta()}},{key:"isContentReady",value:function(){var t;return null===(t=this.engine.uploader)||void 0===t?void 0:t.isCompleted()}},{key:"onBeforeSave",value:(a=s(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.engine.onBeforeSave();case 2:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"onCommandEnd",value:function(t){this.engine.on("commandEnd",(function(e,n){t(i.EDITOR_NAME.BOARD,e,n)}))}}],n&&u(e.prototype,n),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),f}(n(3485).a);p.contentToMind=function(t){return t&&(a.a.isLakeMind(t)||a.a.isLakeBoard(t))?JSON.parse(t):null},e.a=p},3838:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(8),o=n.n(i),c=n(2800),l=n(34),s=n(3805);function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,c=[],l=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);l=!0);}catch(t){s=!0,a=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var h=(null==c?void 0:c.Reader)||window["lake-board"].Reader;function f(t){var e=t.content,n=t.width,i=t.height,o=Object(r.useMemo)((function(){return s.a.contentToMind(e)}),[e]),c=u(Object(r.useState)(null),2),d=c[0],f=c[1],p=Object(r.useMemo)((function(){return a.a.createElement(h,{onLoad:function(n){var r=new s.a(e,n);t.onLoad(r),f(n)}})}),[]),m={};return i&&(m.height=i),n&&(m.width=n),Object(r.useEffect)((function(){if(d&&o){var e=d.diagram,n=o.viewportOption,r=o.viewportSetting;if(d.setValue(o),l.ua.mobile||t.autoFit)e.viewport.autoFit();else if(n&&"WYSIWYG"===n&&r)e.viewport.set(r);else{var a=e.getCells().filter((function(t){return t.isRoot&&t.isMindmap&&!t.isLine}));e.viewport.autoFit({zoom:1}),a.length>0&&e.viewport.scrollIntoView(a[0])}}}),[d,o]),a.a.createElement("div",{className:t.className,style:m},p)}f.defaultProps={className:"",onLoad:function(){}},f.propTypes={className:o.a.string,content:o.a.string,onLoad:o.a.func,height:o.a.oneOfType([o.a.string,o.a.number]),width:o.a.oneOfType([o.a.string,o.a.number]),autoFit:o.a.bool},e.default=f},3847:function(t,e,n){"use strict";n.r(e);var r=n(3838);e.default=r.default},3930:function(t,e,n){"use strict";e.a={wrapper:"Reader-module_wrapper_8LhoV",adapt:"Reader-module_adapt_jPfiq",content:"Reader-module_content_iqKeO",draft:"Reader-module_draft_zoYcP"}},4098:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(8),o=n.n(i),c=n(107),l=n.n(c),s=n(3473),u=n(3847),d=n(3839),h=n(298),f=n(447),p=n(3930);function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i,o,c=[],l=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);l=!0);}catch(t){s=!0,a=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var y=new l.a("doc:mind.reader"),g=Object(f.c)((function(){return n.e(138).then(n.bind(null,3833))}),{suspense:!0}),b=Object(f.c)((function(){return n.e(23).then(n.bind(null,3905))}),{suspense:!0});function x(t){var e=t.book,n=t.doc;return Object(d.a)(e,n),a.a.createElement("div",{"data-testid":""})}function k(t){var e=t.book,n=t.doc,i=t.isDocEmbed,o=t.shouldRenderComments,c=k.useViewModel({doc:n,isDocEmbed:i,dispatch:t.dispatch}),l=c.getStage();return Object(r.useEffect)((function(){y("mind reader react node created")}),[]),a.a.createElement("div",{className:p.a.wrapper},a.a.createElement(x,{book:e,doc:n}),a.a.createElement("div",{className:p.a.adapt},a.a.createElement(u.default,{className:p.a.content,content:n.content,width:"100%",height:l.height,onLoad:c.onLoad})),!i&&a.a.createElement(a.a.Fragment,null,a.a.createElement(g,{type:"Doc",targetId:n.id,likeStatus:n.like.actioned,likeCount:n.like.count,size:"bubble",bubblePopover:!0}),a.a.createElement(b,{style:o?{bottom:"32px"}:{bottom:"86px"}})))}k.useViewModel=function(t){var e=t.doc,n=t.isDocEmbed,a=t.dispatch,i=m(Object(r.useState)(document.body.clientHeight),2),o=i[0],c=i[1],l=Object(f.e)(),u=function(){c(document.body.clientHeight)},d=function(t){s.a.getSheetStoredPosition(e.id)&&console.log("TODO")};return Object(r.useEffect)((function(){return window.addEventListener("resize",u,!1),function(){window.removeEventListener("resize",u,!1)}}),[]),{state:{viewHeight:o},getStage:function(){return{height:o-(n?32:60)}},restorePosition:d,addCommentCount:function(){a({type:"doc/addCommentCount"})},onLoad:function(t){d(),Object(h.b)(e.id,e.type),g.start(),b.start(),l.priorityTaskManager.execMedium()},reduceCommentCount:function(){a({type:"doc/reduceCommentCount"})}}},k.propTypes={group:o.a.object.isRequired,book:o.a.object.isRequired,doc:o.a.object.isRequired,isShare:o.a.bool,isDocEmbed:o.a.bool,dispatch:o.a.func,shouldRenderComments:o.a.bool},e.default=k}}]);