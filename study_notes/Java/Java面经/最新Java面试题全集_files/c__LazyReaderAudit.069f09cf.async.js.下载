(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{3630:function(e,t,n){"use strict";n.r(t);n(207);var a=n(91),r=(n(95),n(49)),l=(n(113),n(35)),o=n(0),i=n.n(o),c=n(8),u=n.n(c),s=n(674),d=n.n(s),m=n(13),f=n.n(m),p=n(100),_=n(109),S=n(71),A=n(42),g={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l,o,i=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=l.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw r}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var y=function(e){var t=e.icon,n=e.content,a=e.style,r=e.showClose,l=b(Object(o.useState)(!0),2),c=l[0],u=l[1];return c?i.a.createElement("div",{className:g.wrap,style:a},t&&i.a.createElement("div",{className:g.icon},t),i.a.createElement("div",{className:g.content},n),r&&i.a.createElement("div",{className:g.close,onClick:function(){u(!1)}},i.a.createElement("span",{className:f()("lake-icon","lake-icon-close",g.closeIcon)}))):null};y.propTypes={icon:u.a.node,content:u.a.node.isRequired,style:u.a.object,showClose:u.a.bool};var E=y,v=n(213),D={closeBtn:"ReaderAudit-module_closeBtn_hHU+3",detail:"ReaderAudit-module_detail_mWCgN",toggleDetail:"ReaderAudit-module_toggleDetail_pq7CA",moreLink:"ReaderAudit-module_moreLink_oxcCo",tagModeWrapper:"ReaderAudit-module_tagModeWrapper_xupeI",tagText:"ReaderAudit-module_tagText_Womh9",pending:"ReaderAudit-module_pending_m3C28",illegal:"ReaderAudit-module_illegal_B8aJ7",banned:"ReaderAudit-module_banned_sHuxy",isIntranet:"ReaderAudit-module_isIntranet_WPBjb",tagClose:"ReaderAudit-module_tagClose_YIxR7"};function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==R(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===R(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l,o,i=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=l.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw r}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function j(e){var t,n=O(Object(o.useState)(!1),2),c=n[0],u=n[1],s=O(Object(o.useState)(!0),2),m=s[0],g=s[1],b=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,T=e.doc,y=e.type,v=e.tagMode,R=T.audits,h=T.read_status,k=T.id,j=T.content_updated_at,N=T.abilities,x=void 0===N?{}:N,C=window.appData,I=C.book,P=C.group,q=C.me,M=e.isYuque||window.appData.isYuque;var B="audit_ignored_".concat(y,"_").concat(k);function W(e){null==e||e.preventDefault(),localStorage.setItem(B,Date.now()),g(!1)}function Y(e){var t=e.filter((function(e){return null!==e}));return d()(t)}if(Object(o.useEffect)((function(){if(h===p.READ_STATUS.insecure)if(q.isAdmin||x.update){if(!b){var e=localStorage.getItem(B);if(e&&j){var t=new Date(j).getTime();g(t>e)}}}else g(!1)}),[]),h<=p.READ_STATUS.ok&&(null==I?void 0:I.status)!==_.STATUS.banned&&(null==P?void 0:P.status)!==S.STATUS.blocked)return null;if(h<=p.READ_STATUS.ok&&((null==I?void 0:I.status)===_.STATUS.banned||(null==P?void 0:P.status)===S.STATUS.blocked))return null!=q&&q.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==P?void 0:P.status)===S.STATUS.blocked,", bookBlocked: ").concat((null==I?void 0:I.status)===_.STATUS.banned)),null;if(null!=P&&P.isPermanentPunished)return null!=q&&q.isAdmin&&h>p.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===y&&h<=p.READ_STATUS.ok)return null;if(!m)return null;var F=[];R&&(R.forbidden||R.reason)&&(F=R.forbidden||[R.reason]);var L,H={};if(H[p.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),H[p.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),H[p.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),H[p.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),H[p.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),H[p.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),H[p.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),M)L=H[h]||H[p.READ_STATUS.suspect];else{var J=!v&&F.length>0?i.a.createElement("a",{onClick:function(e){e.preventDefault(),u(!c)},className:D.toggleDetail},c?"收起详情":"展开详情"):null,K=i.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:D.moreLink},__("了解更多"));L=b||h!==p.READ_STATUS.insecure?i.a.createElement(i.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),K,J," "):i.a.createElement(i.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),K,J)}var $=M?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(v){if(M){var z,G,Q,V,X=(U(z={},p.READ_STATUS.pending,__("审核中")),U(z,p.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),U(z,p.READ_STATUS.banned,__("该内容已屏蔽#tag")),z);switch(h){case p.READ_STATUS.pending:case p.READ_STATUS.suspect:V=p.READ_STATUS.pending;break;case p.READ_STATUS.illegal:case p.READ_STATUS.illegal_polity:case p.READ_STATUS.illegal_ak:case p.READ_STATUS.illegal_privacy:V=p.READ_STATUS.illegal;break;case p.READ_STATUS.banned:V=p.READ_STATUS.banned;break;default:V=null}return(Q=X[V])?i.a.createElement(l.a,{title:i.a.createElement("span",{className:D.tagText},L),placement:"bottom"},i.a.createElement("div",{className:f()(D.tagModeWrapper,(G={},U(G,D.pending,V===p.READ_STATUS.pending),U(G,D.illegal,V===p.READ_STATUS.illegal),U(G,D.banned,V===p.READ_STATUS.banned),G))},i.a.createElement("span",{className:D.tagText},Q))):null}return i.a.createElement("div",{className:f()(D.tagModeWrapper,D.isIntranet),onClick:function(){r.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:i.a.createElement(i.a.Fragment,null,L,F.length>0&&i.a.createElement("ul",{className:D.detail},Y(F).map((function(e){return i.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){W()}})}},i.a.createElement("span",{className:D.tagText},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),i.a.createElement("div",{className:D.tagClose,onClick:function(e){e.stopPropagation(),W()}},i.a.createElement(A.b,{name:"close",width:10,height:10})))}return i.a.createElement(E,{style:w({marginBottom:"Doc"===y?24:0,marginTop:4},$),icon:i.a.createElement(A.b,{name:"doc-has-content-risk",height:17,width:15}),content:i.a.createElement(i.a.Fragment,null,!M&&i.a.createElement(a.a,{title:__("确认忽略该提醒？"),onConfirm:W,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},i.a.createElement("span",{className:D.closeBtn},i.a.createElement(A.b,{name:"close",width:14}))),i.a.createElement("span",{"data-testid":"audit-tip"},L),c&&i.a.createElement("ul",{className:D.detail},Y(F).map((function(e){return i.a.createElement("li",{key:e},e)}))))})}j.defaultProps={isYuque:window.appData.isYuque},j.propTypes={doc:u.a.object.isRequired,type:u.a.string,isYuque:u.a.bool,tagMode:u.a.bool};t.default=Object(v.b)(j)}}]);