/*! For license information please see c__LazySheetReader.2953c451.async.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[98,89],{3630:function(e,t,r){"use strict";r.r(t);r(207);var n=r(91),a=(r(95),r(49)),o=(r(113),r(35)),i=r(0),l=r.n(i),c=r(8),u=r.n(c),s=r(674),d=r.n(s),f=r(13),p=r.n(f),h=r(100),g=r(109),m=r(71),b=r(42),v={wrap:"index-module_wrap_4GDfH",close:"index-module_close_27uFj",icon:"index-module_icon_RfM4L",closeIcon:"index-module_closeIcon_6sSTs"};function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=function(e){var t=e.icon,r=e.content,n=e.style,a=e.showClose,o=y(Object(i.useState)(!0),2),c=o[0],u=o[1];return c?l.a.createElement("div",{className:v.wrap,style:n},t&&l.a.createElement("div",{className:v.icon},t),l.a.createElement("div",{className:v.content},r),a&&l.a.createElement("div",{className:v.close,onClick:function(){u(!1)}},l.a.createElement("span",{className:p()("lake-icon","lake-icon-close",v.closeIcon)}))):null};w.propTypes={icon:u.a.node,content:u.a.node.isRequired,style:u.a.object,showClose:u.a.bool};var A=w,E=r(213),_={closeBtn:"ReaderAudit-module_closeBtn_hHU+3",detail:"ReaderAudit-module_detail_mWCgN",toggleDetail:"ReaderAudit-module_toggleDetail_pq7CA",moreLink:"ReaderAudit-module_moreLink_oxcCo",tagModeWrapper:"ReaderAudit-module_tagModeWrapper_xupeI",tagText:"ReaderAudit-module_tagText_Womh9",pending:"ReaderAudit-module_pending_m3C28",illegal:"ReaderAudit-module_illegal_B8aJ7",banned:"ReaderAudit-module_banned_sHuxy",isIntranet:"ReaderAudit-module_isIntranet_WPBjb",tagClose:"ReaderAudit-module_tagClose_YIxR7"};function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==T(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===T(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function R(e){var t,r=j(Object(i.useState)(!1),2),c=r[0],u=r[1],s=j(Object(i.useState)(!0),2),f=s[0],v=s[1],y=null===(t=window.appData.settings)||void 0===t?void 0:t.forbid_insecure_content,S=e.doc,w=e.type,E=e.tagMode,T=S.audits,O=S.read_status,N=S.id,R=S.content_updated_at,C=S.abilities,L=void 0===C?{}:C,D=window.appData,I=D.book,P=D.group,U=D.me,M=e.isYuque||window.appData.isYuque;var H="audit_ignored_".concat(w,"_").concat(N);function z(e){null==e||e.preventDefault(),localStorage.setItem(H,Date.now()),v(!1)}function B(e){var t=e.filter((function(e){return null!==e}));return d()(t)}if(Object(i.useEffect)((function(){if(O===h.READ_STATUS.insecure)if(U.isAdmin||L.update){if(!y){var e=localStorage.getItem(H);if(e&&R){var t=new Date(R).getTime();v(t>e)}}}else v(!1)}),[]),O<=h.READ_STATUS.ok&&(null==I?void 0:I.status)!==g.STATUS.banned&&(null==P?void 0:P.status)!==m.STATUS.blocked)return null;if(O<=h.READ_STATUS.ok&&((null==I?void 0:I.status)===g.STATUS.banned||(null==P?void 0:P.status)===m.STATUS.blocked))return null!=U&&U.isAdmin&&console.error("ATTENTION: 该文档所在的知识库或者作者被屏蔽, groupBlocked: ".concat((null==P?void 0:P.status)===m.STATUS.blocked,", bookBlocked: ").concat((null==I?void 0:I.status)===g.STATUS.banned)),null;if(null!=P&&P.isPermanentPunished)return null!=U&&U.isAdmin&&O>h.READ_STATUS.ok&&console.error("ATTENTION: 该用户已经被永久屏蔽，此文档也是屏蔽状态"),null;if("Comment"===w&&O<=h.READ_STATUS.ok)return null;if(!f)return null;var F=[];T&&(T.forbidden||T.reason)&&(F=T.forbidden||[T.reason]);var Z,$={};if($[h.READ_STATUS.pending]=__("当前内容正在审核中，其他人暂时无法查看，请稍候。"),$[h.READ_STATUS.suspect]=__("因内容疑似有违规内容，其他人无法查看，正在审核中，请稍后。"),$[h.READ_STATUS.illegal]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),$[h.READ_STATUS.illegal_polity]=__("当前内容有违规内容，其他人无法查看，请修正后再发布。"),$[h.READ_STATUS.illegal_ak]=__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),$[h.READ_STATUS.illegal_privacy]=__("当前文档中包含疑似明文敏感信息（包括不限于身份证号、住址、手机号等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),$[h.READ_STATUS.banned]=__("内容因含敏感信息已被系统屏蔽处理，其他人无法查看。"),M)Z=$[O]||$[h.READ_STATUS.suspect];else{var q=!E&&F.length>0?l.a.createElement("a",{onClick:function(e){e.preventDefault(),u(!c)},className:_.toggleDetail},c?"收起详情":"展开详情"):null,W=l.a.createElement("a",{href:"https://yuque.antfin.com/lark/bqllwz/cg2xev",target:"_blank",className:_.moreLink},__("了解更多"));Z=y||O!==h.READ_STATUS.insecure?l.a.createElement(l.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），已被系统自动设置为私密，请脱敏或删除明文敏感信息后重新发布。"),W,q," "):l.a.createElement(l.a.Fragment,null,__("当前文档中包含疑似明文敏感信息（包括不限于OSS秘钥、AK信息、数据库账密等），可能会造成数据泄露，请脱敏或删除明文敏感信息后重新发布。"),W,q)}var Y=M?{}:{padding:24,paddingRight:32,marginTop:8,position:"relative"};if(E){if(M){var G,J,V,K,Q=(k(G={},h.READ_STATUS.pending,__("审核中")),k(G,h.READ_STATUS.illegal,__("该内容涉嫌违规#tag")),k(G,h.READ_STATUS.banned,__("该内容已屏蔽#tag")),G);switch(O){case h.READ_STATUS.pending:case h.READ_STATUS.suspect:K=h.READ_STATUS.pending;break;case h.READ_STATUS.illegal:case h.READ_STATUS.illegal_polity:case h.READ_STATUS.illegal_ak:case h.READ_STATUS.illegal_privacy:K=h.READ_STATUS.illegal;break;case h.READ_STATUS.banned:K=h.READ_STATUS.banned;break;default:K=null}return(V=Q[K])?l.a.createElement(o.a,{title:l.a.createElement("span",{className:_.tagText},Z),placement:"bottom"},l.a.createElement("div",{className:p()(_.tagModeWrapper,(J={},k(J,_.pending,K===h.READ_STATUS.pending),k(J,_.illegal,K===h.READ_STATUS.illegal),k(J,_.banned,K===h.READ_STATUS.banned),J))},l.a.createElement("span",{className:_.tagText},V))):null}return l.a.createElement("div",{className:p()(_.tagModeWrapper,_.isIntranet),onClick:function(){a.a.confirm({title:__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag"),content:l.a.createElement(l.a.Fragment,null,Z,F.length>0&&l.a.createElement("ul",{className:_.detail},B(F).map((function(e){return l.a.createElement("li",{key:e},e)})))),okText:__("知道了"),cancelText:__("忽略"),onCancel:function(){z()}})}},l.a.createElement("span",{className:_.tagText},__("疑似含敏感信息，请脱敏或删除敏感信息后重新发布#tag")),l.a.createElement("div",{className:_.tagClose,onClick:function(e){e.stopPropagation(),z()}},l.a.createElement(b.b,{name:"close",width:10,height:10})))}return l.a.createElement(A,{style:x({marginBottom:"Doc"===w?24:0,marginTop:4},Y),icon:l.a.createElement(b.b,{name:"doc-has-content-risk",height:17,width:15}),content:l.a.createElement(l.a.Fragment,null,!M&&l.a.createElement(n.a,{title:__("确认忽略该提醒？"),onConfirm:z,okText:__("忽略"),cancelText:__("取消"),placement:"bottom"},l.a.createElement("span",{className:_.closeBtn},l.a.createElement(b.b,{name:"close",width:14}))),l.a.createElement("span",{"data-testid":"audit-tip"},Z),c&&l.a.createElement("ul",{className:_.detail},B(F).map((function(e){return l.a.createElement("li",{key:e},e)}))))})}R.defaultProps={isYuque:window.appData.isYuque},R.propTypes={doc:u.a.object.isRequired,type:u.a.string,isYuque:u.a.bool,tagMode:u.a.bool};t.default=Object(E.b)(R)},3688:function(e,t,r){var n=r(187);e.exports=function(e,t,r){for(var a=-1,o=e.length;++a<o;){var i=e[a],l=t(i);if(null!=l&&(void 0===c?l==l&&!n(l):r(l,c)))var c=l,u=i}return u}},3723:function(e,t,r){"use strict";var n=r(0),a=r.n(n),o=r(8),i=r.n(o),l=r(108),c=r(1777),u="EmbedHeader-module_docEmbedHeader_lYs+e",s="EmbedHeader-module_embedHeaderReference_SWdkM",d="EmbedHeader-module_embedHeaderTitle_SPNfw",f="EmbedHeader-module_embedHeaderLink_Q9Vhk";function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=function(e){var t=e.title,r=e.link,n=e.height,o=e.style,i=void 0===o?{}:o,p=e.doc,h=e.book,m=e.group,b=window.appData,v=b.isYuqueMobileApp,y=b.isDesktopApp;return a.a.createElement("div",{className:u,style:g({height:"".concat(n,"px")},i)},a.a.createElement("span",{className:s},__("引用自"),"："),a.a.createElement("span",{className:d},t,a.a.createElement(c.b,{group:m,book:h,doc:p})),a.a.createElement("a",{className:f,href:r,target:"_blank",onClick:function(){!function(e){if(v){var t,r,n=(null===(t=window.nebulaMobileApp)||void 0===t||null===(r=t.envInfo)||void 0===r?void 0:r.origin)||window.location.origin;return l.a.pushWebWindow({url:"".concat(n).concat(e)}),!1}if(y)window.parent.postMessage({name:"openExternalLink",args:["".concat(window.location.origin).concat(e)]},"*")}(r)}},__("查看原文")))};b.propTypes={title:i.a.string,link:i.a.string,height:i.a.number,style:i.a.object,doc:i.a.object,book:i.a.object,group:i.a.object};t.a=b},3730:function(e,t,r){"use strict";r.d(t,"a",(function(){return ue})),r.d(t,"b",(function(){return N}));var n=r(60),a=r.n(n),o=r(3731),i=r.n(o),l=r(371),c=r.n(l),u=r(395),s=r.n(u),d=r(651),f=r.n(d),p=r(24),h=r.n(p),g=r(3733),m=r.n(g),b=r(26),v=r.n(b),y=r(2756),S=r.n(y);function w(e,t){return function(e){for(var t,r=e.rows,n=r.length,a=[],o=[],i=0,l=0,c=0,u=0;u<n;u++){for(var s=r[u].cells,d=0,f=0;f<s.length;f++){var p=s[f],h=p.rowSpan,g=p.colSpan;i+=h*g,d+=g,h>1&&(l+=(h-1)*g)}o[u]=d,0===u&&(t=d),c=Math.max(d,c)}if(m()(i/t)&&t===c){var b=0;if(o.forEach((function(e){b+=c-e})),b!==l){var v=l-b;if(v&&m()(v/c)){for(var y=[],S=0;S<n;S++){for(var w=r[S].cells;a[S+y.length]===c;)y.push(S+y.length);for(var A=S+y.length,E=0;E<w.length;E++){var _=w[E],T=_.rowSpan,O=_.colSpan;if(T>1)for(var x=1;x<T;x++)a[A+x]=(a[A+x]||0)+O}}y.forEach((function(t){e.insertRow(t)}))}}}}(e),function(e){var t=e.rows[0];0===t.cells.length&&t.remove(),e.rows.length>1&&1===t.cells.length&&""===t.cells[0].innerText.trim()&&0===t.cells[0].getElementsByTagName("img").length&&1===t.cells[0].colSpan&&1===t.cells[0].rowSpan&&t.remove()}(e),function(e){Array.from(e.rows).forEach((function(e){var t=e.getAttribute("style"),r=t&&t.match(/mso-xlrowspan:(\d+)/),n=e.getAttribute("height");if(r&&n){var a=parseInt(r[1]);n=parseInt(n)/a||24,e.setAttribute("height",n),e.style.height=n+"px"}if(Array.from(e.cells).forEach((function(t){var r=t.getAttribute("style");if(t.setAttribute("height",n),t.style.height=n+"px",t.colSpan>1&&r&&-1!==r.indexOf("mso-ignore:colspan")){var a=t.colSpan;t.setAttribute("colSpan",1);for(var o=1;o<a;o++){var i=t.cloneNode();e.insertBefore(i,t.nextSibling)}}})),r){var o=parseInt(r[1]);if(o<1e6)for(var i=1;i<o;i++){var l=e.cloneNode();e.parentNode.insertBefore(l,e)}}}))}(e),function(e,t){for(var r=[],n=e.rows,a=n.length,o=100,i=0;i<a;i++){var l=n[i].cells,c=l.length;r[i]=r[i]||[];for(var u=c>16300,s=0;s<c;s++){var d=l[s];if(u&&s>o&&""===d.innerHTML&&A(d))break;o=Math.max(o,s);for(var f=d.rowSpan,p=void 0===f?1:f,g=d.colSpan,m=void 0===g?1:g,b=p>1||m>1,v=s;r[i][v];)v++;if(r[i][v]={rowSpan:p,colSpan:m,isMulti:b,element:d},b)for(var y=p;y>0;){for(var S=m;S>0;){if(1!==S||1!==y){var w=i+y-1,E=v+S-1;r[w]=r[w]||[],r[w][E]={isEmpty:!0,parent:{row:i,col:v}}}S--}y--}}}var _=r.map((function(e){return e.length})),T=Math.max.apply(Math,h()(_));return r.forEach((function(e,r){if(e.length<T)for(var n=T-e.length;n--;)0!==r||t?e.push({rowSpan:1,colSpan:1,isShadow:!0,element:null}):e.unshift({rowSpan:1,colSpan:1,isShadow:!0,element:null});for(var a=0;a<T;a++)e[a]||(e[a]={rowSpan:1,colSpan:1,isShadow:!0,element:null})})),{rows:r.length,cols:T,table:r}}(e,t)}function A(e){for(var t=10;t>0&&e;){if(e.tagName&&"td"===e.tagName.toLowerCase()){if(""!==e.innerHTML)return!1;t-=1}e=e.nextSibling}return!0}var E=/^\s*\(?¥\s*\(?[\d,.]+\)?$/,_=/^#+$/,T=/^\d\.\d+[Ee]\+\d+$/,O=String.fromCharCode(165),x=String.fromCharCode(36),k=String.fromCharCode(8364),j=String.fromCharCode(163);function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;e=function(e){return e.replace(/\\0022/g,"")}(e=function(e,t,r){var n=e.match(/<col[^>]*>/g),a=0;if(n){var o=n[n.length-1].match(/<col[^>]*span=(\d+)[^>]*>/);o&&(a=parseInt(o[1],10))}if(a>r){var i=e.split("</tr>");e=(i=i.map((function(e){var t=e.match(/(\s*<td[^>]*>\s*<\/td>)(\s*)$/);if(t){var r=t[1].repeat(a-30);e.endsWith(r+t[2])&&(e=e.substr(0,e.length-r.length-t[2].length))}return e}))).join("</tr>")}var l=e.match(/\s*<tr[^>]*>\s*(<td[^>]*>\s*<\/td>\s*)+<\/tr>/g);if(l&&l.length>t){var c=e.match(/<td[^>]*>[^<]*[^\s<]+[^<]*<\/td>/g);if(!c)return"<table><tr><td></td></tr></table>";var u=c[c.length-1],s=e.lastIndexOf(u),d=e.slice(0,s+u.length);e=e.slice(s+u.length);var p={};l.forEach((function(e){p[e]=p[e]||{content:e,count:0},p[e].count+=1}));for(var h=Object.values(p),g=(h=f()(h,"count")).length-1;h[g];){var m=h[g];if(m.count>t){var b=m.content.replace(/([*.?+$^[\](){}|/\\])/g,(function(e){return"\\".concat(e)}));e=e.replace(new RegExp(b,"g"),"")}g--}e=d+e}return e}(e,200,200));var o=(new DOMParser).parseFromString(e,"text/html"),l=o.body,u=function(e,t){for(var r=e.length,n=[],a=0;a<r;a++)t(e[a])&&n.push(e[a]);return n}(o.all,(function(e){return"STYLE"===e.tagName}));if(!l)return null;for(var s,d=l.firstChild,p=[],h=[],g={},m={},b=[],v={},y=!1;d;)if(D(d)){var S=W(d,p.length,u,a);S.mergeCells&&(h=h.concat(S.mergeCells)),S.startCell&&(s=S.startCell),S.selectOptions&&Object.assign(v,S.selectOptions),Object.assign(m,S.rows),S.columns&&Object.assign(g,S.columns),p=p.concat(S.table),S.cellsNeedFix&&(b=b.concat(S.cellsNeedFix)),d=q(d),y=!1}else if(z(d))M(d)&&(d.innerHTML=""),I(d)&&(d.innerHTML=d.innerHTML.replace(/\n/g,"<br/>")),d=d.firstChild||q(d),y=!1;else if(U(d)){var w=d.innerText.trim(),A=d.getAttribute("href");C(p,p.length,w,A),y=!1,d=q(d)}else if(P(d)){var E=d.getAttribute("src");L(p,p.length,E,a),y=!1,d=q(d)}else if(F(d))d=d.firstChild||q(d);else if(Z(d))y=!1,d=q(d);else if($(d)){var _=d.data;if(""!==_.trim()||!z(d.parentNode))R(p,y?p.length-1:p.length,_),y=!0;d=q(d)}else d=q(d);var T=function(e){var t={};return e.forEach((function(e,r){e.forEach((function(e,n){e&&0!==Object.keys(e).length&&(t[r]=t[r]||{},0!==Object.keys(e).length&&(t[r][n]=e))}))})),t}(p);h=c()(h,(function(e){return"".concat(e.row,":").concat(e.col)}));var O=i()(p.map((function(e){return e.length})))||20,x={name:r||"Sheet".concat(t+1),rowCount:n?Math.max(p.length,n.rowCount):p.length,colCount:n?Math.max(O,n.colCount):O,data:T,mergeCells:h,rows:m,columns:g,filter:{},index:t,defaults:{}};return s&&(x.startCell=s),Object.keys(v).length>0&&(x.selectOptions=v),b.length>0&&(x.cellsNeedFix=b),x}function R(e,t,r){e[t]=e[t]||[],e[t][0]?e[t][0].value+=""+r:e[t][0]={value:r}}function C(e,t,r,n){e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value={class:"link",text:r,url:n}}function L(e,t,r,n){r=function(e){return e.replace(/\?x-oss-process=image\/resize.+/,"")}(r),e[t]=e[t]||[],e[t][0]=e[t][0]||{},e[t][0].value=n?{class:"image",name:"",src:r}:{class:"image",name:"",status:"needUpload",originSrc:r}}function D(e){return"TABLE"===e.tagName}function I(e){return"PRE"===e.tagName}function P(e){return"IMG"===e.tagName}function U(e){return"A"===e.tagName}function M(e){var t=e.getAttribute("style");return t&&t.startsWith("mso-element")}var H=["BODY","ARTICLE","ASIDE","ADDRESS","DD","DL","FIELDSET","FIGCAPTION","FIGURE","FOOTER","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","P","DIV","PRE","BLOCKQUOTE","UL","OL","LI","TABLE","THEAD","TBODY","TFOOT","SECTION"];function z(e){return 1===e.nodeType&&H.includes(e.tagName)}var B=["B","I","ABBR","CITE","CODE","DFN","DEL","EM","KBD","STRONG","SAMP","A","BDO","Q","SPAN","SUB","SUP","BUTTON","LABEL"];function F(e){return 1===e.nodeType&&B.includes(e.tagName)}function Z(e){return"BR"===e.tagName}function $(e){return 3===e.nodeType}function q(e){if(e.nextSibling)return e.nextSibling;for(var t=e.parentNode;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}return null}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=e.cloneNode(!0);document.body.appendChild(o);var i=w(o,n),l={};r&&r.forEach((function(e){document.body.appendChild(e),Object.assign(l,G(e.innerHTML))}));var c={table:[]},u=o.querySelectorAll("col");if(u.length>0){var s={},d=0;u.forEach((function(e){for(var t=parseInt(e.getAttribute("width")),r=e.span,n=0;n<r&&d<i.cols;)s[d]=0!==t?{size:t}:{size:0,hidden:!0,oldSize:120},d+=1,n+=1})),c.columns=s}var f=Array.from(o.rows);c.rows={},f.forEach((function(e,r){if(0===e.offsetHeight&&r!==f.length-1)c.rows[r+t]={size:0,hidden:!0,oldSize:24};else{var n=Math.max(e.offsetHeight,24)||24,a={size:n};24!==n&&(a.customSize=n),c.rows[r+t]=a}}));var p=o.getAttribute("data-startCell");if(p){var h=p.split(":");c.startCell={row:parseInt(h[0])||0,col:parseInt(h[1])||0}}var g=o.getAttribute("data-selectOptions");if(g)try{c.selectOptions=JSON.parse(decodeURIComponent(g))}catch(e){console.log(e)}return i.table.forEach((function(e,r){c.table[r]=[],e.forEach((function(e,o){if(e.element){var i=function(e,t){var r=e.getAttribute("data-value");if(r)try{var n=JSON.parse(decodeURIComponent(r));if(function(e){return!!e.class&&("link"===e.class?e.text&&e.url:"file"===e.class||"image"===e.class?e.name&&e.src:"checkbox"===e.class?void 0!==e.value:"select"===e.class?e.value&&(e.options||e.optionId):"mention"===e.class?e.value&&e.value[0].id&&e.value[0].login:"formula"===e.class&&void 0!==e.formula)}(n))return n}catch(e){console.log(e)}for(var a=e.querySelectorAll("img"),o=a.length,i=0;i<o;i++){var l=a[i].getAttribute("src");if(l)return t?{class:"image",src:l,name:"image"}:{class:"image",status:"needUpload",originSrc:l,name:"image"}}e.innerHTML=e.innerHTML.replace(/<!--\[if[\s\S]+<!--\[endif\]-->/g,"").replace(/<rt[^>]*>[^<]*<\/rt>/g,"").replace(/\n/g,"").replace(/<br>\s*/g,"\n");var c,u=e.innerHTML.replace(/<[^>]+>/g,"").trim();u="string"!=typeof(c=u)?c:c.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&nbsp;/g," ");var s=e.querySelector("a");return s&&s.getAttribute("href")?{class:"link",text:u.replace(/\n/g,""),url:s.getAttribute("href")}:(u.endsWith(" %")&&(u=u.replace(/ %$/,"%")),u)}(e.element,n),u=function(e){try{var t=window.getComputedStyle(e),r={};1===e.childNodes.length&&"S"===e.childNodes[0].tagName&&(r.strikeThrough=!0);var n=function(e){var t;-1!==e.indexOf("pt")&&(t=parseInt(e,10));var r=12;if(-1!==e.indexOf("em")?r=parseFloat(e,14):-1!==e.indexOf("px")&&(r=parseFloat(e,10)),t=t||Math.round(r/1.3333333),J[t])return t;var n=Object.keys(J).map((function(e){return parseInt(e,10)}));n.sort();for(var a=0;n[a];){if(n[a]>t)return n[a];a++}return n[a-1]}(t.fontSize);return-1!==t.textDecoration.indexOf("underline")&&(r.underline=!0),-1!==t.textDecoration.indexOf("line-through")&&(r.strikeThrough=!0),(n>12||e.style.fontSize&&e.style.fontSize.indexOf("px")>0)&&(r.fontSize=n),["rgba(0, 0, 0)","rgb(0, 0, 0)","rgba(0, 0, 0, 0.65)","rgb(88, 90, 90)"].includes(t.color)||(r.color=t.color),"italic"===t.fontStyle&&(r.fontStyle=t.fontStyle),"normal"===t.whiteSpace&&e.classList.length>0&&(r.overflow="wrap"),["400",400,"normal"].includes(t.fontWeight)||(r.fontWeight=t.fontWeight),"middle"!==t.verticalAlign&&(r.vAlign=Y[t.verticalAlign]||"middle"),"start"!==t.textAlign&&"left"!==t.textAlign&&(r.hAlign=Y[t.textAlign]||"left"),"rgba(0, 0, 0, 0)"!==t.backgroundColor&&"rgb(255, 255, 255)"!==t.backgroundColor&&(r.backColor=t.backgroundColor),"0px"!==t.borderLeftWidth&&"rgb(204, 204, 204)"!==t.borderLeftColor&&(r.border=r.border||{},r.border.left={color:t.borderLeftColor,lineStyle:"dashed"===t.borderLeftStyle?"dash":"normal"}),"0px"!==t.borderRightWidth&&"rgb(204, 204, 204)"!==t.borderRightColor&&(r.border=r.border||{},r.border.right={color:t.borderRightColor,lineStyle:"dashed"===t.borderRightStyle?"dash":"normal"}),"0px"!==t.borderTopWidth&&"rgb(204, 204, 204)"!==t.borderTopColor&&(r.border=r.border||{},r.border.top={color:t.borderTopColor,lineStyle:"dashed"===t.borderTopStyle?"dash":"normal"}),"0px"!==t.borderBottomWidth&&"rgb(204, 204, 204)"!==t.borderBottomColor&&(r.border=r.border||{},r.border.bottom={color:t.borderBottomColor,lineStyle:"dashed"===t.borderBottomStyle?"dash":"normal"}),0===Object.keys(r).length?null:r}catch(e){return null}}(e.element),s=function(e){var t=e.getAttribute("data-note");if(t)try{var r=JSON.parse(decodeURIComponent(t));if(r.text)return r}catch(e){console.log(e)}}(e.element),d={name:"auto"},f=!1;if(l){var p=e.element.classList&&e.element.classList[0];l[p]&&("object"===a()(l[p])?Object.assign(d,l[p]):d.name=l[p],["currency","number","percentage"].includes(d.name)&&(d.decimal=2),c.table[r][o]=c.table[r][o]||{},c.table[r][o].type=d,["text","auto"].includes(d.name)||(f=!0))}u&&(c.table[r][o]=c.table[r][o]||{},c.table[r][o].style=u),s&&(c.table[r][o]=c.table[r][o]||{},c.table[r][o].note=s),void 0!==i&&""!==i?(c.table[r][o]=c.table[r][o]||{},c.table[r][o].type=d,c.table[r][o].value=i,"string"==typeof i&&((_.test(i)||T.test(i))&&(f=!0),E.test(i)&&"auto"===d.name&&(f=!0,c.table[r][o].type.name="currency",c.table[r][o].type.symbol=O,c.table[r][o].type.decimal=2))):""===i&&c.columns&&c.columns[o]&&c.columns[o].size<=15&&c.columns[o].size>=0&&(f=!0),f&&n&&(c.cellsNeedFix=c.cellsNeedFix||[],c.cellsNeedFix.push({row:r+t,col:o})),e.isMulti&&(c.mergeCells=c.mergeCells||[],c.mergeCells.push({row:r+t,col:o,rowCount:e.rowSpan,colCount:e.colSpan}),u&&(c.table[r+e.rowSpan-1]=c.table[r+e.rowSpan-1]||[],c.table[r+e.rowSpan-1][o+e.colSpan-1]=c.table[r+e.rowSpan-1][o+e.colSpan-1]||{},c.table[r+e.rowSpan-1][o+e.colSpan-1].style=u))}}))})),o.remove(),r&&r.forEach((function(e){e.remove()})),c}var Y={"-webkit-left":"left","-webkit-right":"right","-webkit-center":"center",left:"left",right:"right",center:"center","-webkit-baseline-middle":"middle",top:"top",bottom:"bottom",middle:"middle"};function G(e){var t=/([^{}]+){([^{}]+)}/,r=e.match(/[^{}]+{([^{}]+)}/g),n={};return r&&r.forEach((function(e){var r=e.match(t);if(r){var a=r[1].trim(),o=r[2];if(a.startsWith(".")){var i=o.match(/mso-number-format:(.+);(\n|$)/);i&&(n[a.substr(1)]=function(e){return-1!==(e=e.replace(/\/|"|\\/g,"")).indexOf("Date")?"date":-1!==e.indexOf("Time")?"time":e.endsWith("%")?"percentage":-1!==e.indexOf(j)?{name:"currency",symbol:j}:-1!==e.indexOf(k)?{name:"currency",symbol:k}:-1!==e.indexOf(O)?{name:"currency",symbol:O}:e.match(/^@$/)?"text":-1!==e.indexOf("General")||-1!==e.indexOf("Standard")||-1!==e.indexOf("Fixed")?"auto":e.match(/(年|月|日|时|分|秒|dd|y|m|h|s|md|dm)/)?e.match(/(时|分|秒|s|h)/)?"datetime":e.match(/[^d]ddd[^d]/)?{name:"datetime",formatter:"dddd"}:"date":-1!==e.indexOf(x)?{name:"currency",symbol:x}:"number"}(i[1]))}}})),0===Object.keys(n).length?null:n}var J={9:12,10:13,11:14,12:16,14:19,16:22,18:24,22:29,24:32,30:40,36:48};function V(e){return e.trim().replace(/'/g,"").replace(/"/g,"")}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Q=K.length,X=[{type:"whitespace",reg:/^(?:\s+)/},{type:"string",reg:/^(?:"(\\["]|[^"])*")/},{type:"string",reg:/^(?:'(\\[']|[^'])*')/},{type:"function",reg:/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/},{type:"error",reg:/^(?:#[A-Z0-9\/]+(!|\?)?)/},{type:"sheetCell",reg:/^(?:'{1}[^']+'{1}!{1}\${0,1}[A-Za-z]+\${0,1}[0-9]+)/},{type:"sheetCell",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}\${0,1}[A-Za-z]+\${0,1}[0-9]+)/},{type:"absoluteCell",reg:/^(?:\$[A-Za-z]+\$[0-9]+)/},{type:"absoluteColCell",reg:/^(?:\$[A-Za-z]+[0-9]+)/},{type:"absoluteRowCell",reg:/^(?:[A-Za-z]+\$[0-9]+)/},{type:"relativeCell",reg:/^(?:[A-Za-z]+[0-9]+)/},{type:"colRange",reg:/^(?:[A-Za-z]+:[A-Za-z]+)/},{type:"colRange",reg:/^(?:'{1}[\u4e00-\u9fa5A-Za-z0-9]+'{1}!{1}[A-Za-z]+:[A-Za-z]+)/},{type:"colRange",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}[A-Za-z]+:[A-Za-z]+)/},{type:"rowRange",reg:/^(?:[0-9]+:[0-9]+)/},{type:"rowRange",reg:/^(?:'{1}[\u4e00-\u9fa5A-Za-z0-9]+'{1}!{1}[0-9]+:[0-9]+)/},{type:"rowRange",reg:/^(?:[\u4e00-\u9fa5A-Za-z0-9]+!{1}[0-9]+:[0-9]+)/},{type:"mixRange",reg:/^(?:[0-9]+:[0-9]+)/},{type:"function",reg:/^(?:[A-Za-z\.0-9]+(?=[(]))/},{type:"variable",reg:/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/},{type:"number",reg:/^(?:[0-9]+)/},{type:"array",reg:/^(?:\[(.*)?\])/},{type:"&",reg:/^(?:&)/},{type:"whitespace",reg:/^(?: )/},{type:"decimal",reg:/^(?:[.])/},{type:":",reg:/^(?::)/},{type:";",reg:/^(?:;)/},{type:",",reg:/^(?:,)/},{type:"*",reg:/^(?:\*)/},{type:"/",reg:/^(?:\/)/},{type:"-",reg:/^(?:-)/},{type:"+",reg:/^(?:\+)/},{type:"^",reg:"/^(?:^)/,"},{type:"(",reg:/^(?:\()/},{type:")",reg:/^(?:\))/},{type:">",reg:/^(?:>)/},{type:"<",reg:/^(?:<)/},{type:"NOT",reg:/^(?:NOT\b)/},{type:'"',reg:/^(?:")/},{type:"'",reg:/^(?:')/},{type:"!",reg:/^(?:!)/},{type:"=",reg:/^(?:=)/},{type:"%",reg:/^(?:%)/},{type:"#",reg:/^(?:[#])/},{type:"EOF",reg:/^(?:$)/}],ee=/^([\u4e00-\u9fa5A-Za-z0-9]+!{1})/,te=/^'{1}(.+'{1}!{1})/,re=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/;function ne(e){var t=parseInt(e,10);return isNaN(t)?-1:Math.max(t-1,-1)}function ae(e){var t=0;if("string"==typeof e)for(var r=0,n=e.length-1;r<e.length;r+=1,n-=1)t+=Math.pow(Q,n)*(K.indexOf(e[r])+1);return t-1}function oe(e){var t=function(e){var t=null,r=e,n=e.match(ee);return n?(r=e.substring(n[0].length),t=n[0].slice(0,-1)):(n=e.match(te))&&(r=e.substring(n[0].length),t=n[0].slice(1,-2)),{sheet:t,label:r.toUpperCase()}}(e),r=t.label.match(re),n=v()(r,5),a=n[1],o=n[2],i=n[3],l=n[4];return{row:{index:ne(l),label:l,absolute:"$"===i},col:{index:ae(o),label:o,absolute:"$"===a},sheet:t.sheet}}function ie(e){var t=(e.row.absolute?"$":"")+(e.row.index+1);return function(e,t){return t?/^[A-Za-z0-9]+$/.test(t)&&!t.match(/^[A-Za-z]{1,3}[0-9]+/)?"".concat(t,"!").concat(e):"'".concat(t,"'!").concat(e):e}((e.col.absolute?"$":"")+function e(t){var r=K.substr(t%26,1),n=Math.floor(t/26);return n>0?"".concat(e(n-1)).concat(r):r}(e.col.index)+t,e.sheet)}function le(e,t){var r=e.baseCell,n=e.formula,a=oe(r),o=oe(t);return function(e,t,r,n){var a=function(e,t){var r=[];e=(e+"").replace(/\s/g,"");for(var n=function(){var t=void 0,n=void 0,a=void 0;X.forEach((function(r){(a=e.match(r.reg))&&(!t||a[0].length>t[0].length)&&(t=a,n=r.type)})),t?(r.push({text:t[0],type:n}),e=e.slice(t[0].length)):(r.push({text:e[0],type:"other"}),e=e.slice(1)),t=null};e.length>0;)n();for(var a=r.length,o=0;o<a-2;o++)r[o].type.indexOf("Cell")>0&&":"===r[o+1].type&&r[o+2].type.indexOf("Cell")<0&&(r[o+1].type="colon");return r}(e),o="";return a.forEach((function(e){if(e.type.indexOf("Cell")>0){var n=oe(e.text);n.row.index+=n.row.absolute?0:t,n.col.index+=n.col.absolute?0:r,o+=ie(n)}else o+=e.text})),o}(n,o.row.index-a.row.index,o.col.index-a.col.index)}function ce(e){return(new DOMParser).parseFromString(e,"text/xml")}function ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"==typeof e&&(e=[e]);var r={format:"lakesheet",type:"Sheet",version:"1.0",larkJson:!0,sheet:[]},n=t.names,o=void 0===n?[]:n,i=t.deflate,l=void 0!==i&&i,c=t.worksheetsDeflate,u=void 0!==c&&c,d=t.xml;if(e.forEach((function(e,t){l&&(e=s.a.inflate(e,{to:"string"}));var n=N(e,t,o[t],{rowCount:50,colCount:20},!0);n.selectOptions&&(r.selectOptions=r.selectOptions||{},Object.assign(r.selectOptions,n.selectOptions),delete n.selectOptions),r.sheet.push(n)})),d){if(u&&d.worksheets){var f={};for(var p in d.worksheets){var h=d.worksheets[p];f[p]=s.a.inflate(h,{to:"string"})}d.worksheets=f}!function(e,t){if(t.workbook&&t.worksheets){for(var r=function(e){if(!e)return null;var t=ce(e).getElementsByTagName("c");if(0!==t.length){for(var r=[],n=0;n<t.length;n++)r.push({cell:t[n].getAttribute("r"),sheetIndex:t[n].getAttribute("i")||1});return 0===r.length?null:S()(r,"sheetIndex")}}(t.calcChain),n=ce(t.workbook).getElementsByTagName("sheet"),o={},i={},l={},c=1,u=0;u<n.length;u++){var s=parseInt(n[u].getAttribute("r:id").replace("rId","")),d=n[u].getAttribute("sheetId"),f=n[u].getAttribute("state");o[d]=s,"hidden"!==f&&(i[c]=s,l[d]=c,c+=1)}if(e.calcChain=[],r)for(var p in r){var h=o[p],g="sheet".concat(h);if(t.worksheets[g])for(var m=ce(t.worksheets[g]).getElementsByTagName("f"),b={},v=0;v<m.length;v++){var y=m[v],w=y.parentNode.getAttribute("r"),A=y.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&nbsp;/g," "),E=y.getAttribute("t"),_=y.getAttribute("ref"),T=y.getAttribute("si");"shared"===E&&(_?b[T]={baseCell:w,formula:A}:A=le(b[T],w));var O=w.match(/\d+/),x=w.match(/[A-Z]+/);O&&(O=parseInt(O[0])-1),x&&(x=ae(x[0]));var k=l[p]-1;if(e.sheet[k])if(e.sheet[k].data[O]=e.sheet[k].data[O]||{},e.sheet[k].data[O][x]=e.sheet[k].data[O][x]||{},"string"==typeof A&&0===A.toLowerCase().indexOf("hyperlink(")){var j=A.substring(10,A.length-1).split(","),N=V(j[0]),R=j.length>1?V(j[1]):N;console.log(N,R),e.sheet[k].data[O][x].value={class:"link",url:N,text:R}}else e.sheet[k].data[O][x].value={class:"formula",formula:A,value:e.sheet[k].data[O][x].value||""},e.calcChain.push({row:O,col:x,sheet:k})}}e.sheet.forEach((function(e,r){if(e.cellsNeedFix){var n=i[r+1],o="sheet".concat(n),l=ce(t.worksheets[o]);e.cellsNeedFix.forEach((function(t){var r=t.row,n=t.col,o=ie({row:{index:r},col:{index:n}}),i=l.querySelector("c[r=".concat(o,"]"));if(i){var c="s"===i.getAttribute("t"),u=i.querySelector("v");if(u&&u.innerHTML&&!c){var s=e.data[r]&&e.data[r][n]&&e.data[r][n].value,d=e.data[r]&&e.data[r][n]&&e.data[r][n].type,f=u.innerHTML;if(d&&!isNaN(1*f)){var p=1*f,h=p>=367?343:p<61?86400:0;"date"===d.name||"datetime"===d.name||"time"===d.name?f=86400*f+h:["percentage","number","currency"].includes(d.name)&&(f*=1)}s&&"formula"===s.class?s.value=f:"object"!==a()(s)&&(e.data[r]=e.data[r]||{},e.data[r][n]=e.data[r][n]||{},e.data[r][n].value=f)}}})),delete e.cellsNeedFix}}))}}(r,d)}return r.sheet=s.a.deflate(JSON.stringify(r.sheet),{to:"string"}),r}},3731:function(e,t,r){var n=r(3688),a=r(3732),o=r(236);e.exports=function(e){return e&&e.length?n(e,o,a):void 0}},3732:function(e,t){e.exports=function(e,t){return e>t}},3733:function(e,t,r){var n=r(641);e.exports=function(e){return"number"==typeof e&&e==n(e)}},3801:function(e,t,r){"use strict";var n=r(0),a=r.n(n),o=r(8),i=r.n(o),l=r(553),c=r(213),u=r(3635),s=r(243);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(){f=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,a){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),l=new x(a||[]);return n(i,"_invoke",{value:E(e,r,l)}),i}function s(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function h(){}function g(){}function m(){}var b={};c(b,o,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(k([])));y&&y!==t&&r.call(y,o)&&(b=y);var S=m.prototype=h.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function a(n,o,i,l){var c=s(e[n],e,o);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==d(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){a("next",e,i,l)}),(function(e){a("throw",e,i,l)})):t.resolve(f).then((function(e){u.value=e,i(u)}),(function(e){return a("throw",e,i,l)}))}l(c.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){a(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function E(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return j()}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var l=_(i,r);if(l){if(l===p)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function _(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var a=s(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:j}}function j(){return{value:void 0,done:!0}}return g.prototype=m,n(S,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:g,configurable:!0}),g.displayName=c(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(A.prototype),c(A.prototype,i,(function(){return this})),e.AsyncIterator=A,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new A(u(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(S),c(S,l,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=k,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;O(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},e}function p(e,t,r,n,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,a)}var h,g,m=Object(l.a)({loader:function(){return Promise.all([r.e(0),r.e(1),r.e(4),r.e(10),r.e(53)]).then(r.bind(null,3952))},loading:u.a}),b=Object(l.a)({loader:(h=f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.loadModule)("larksheet");case 2:return e.abrupt("return",Promise.all([r.e(0),r.e(4),r.e(21),r.e(51)]).then(r.bind(null,3972)));case 3:case"end":return e.stop()}}),e)})),g=function(){var e=this,t=arguments;return new Promise((function(r,n){var a=h.apply(e,t);function o(e){p(a,r,n,o,i,"next",e)}function i(e){p(a,r,n,o,i,"throw",e)}o(void 0)}))},function(){return g.apply(this,arguments)}),loading:u.a});function v(e){var t=e.format,r=e.content;return"spreadjs"===t?"export"===new URLSearchParams(window.location.search).get("mode")?a.a.createElement(m,{content:r,onLoad:e.onLoad}):a.a.createElement(b,{body:r,className:e.className||"",showToolbar:e.showToolbar,sheetStyle:e.geSheetStyle}):"lakesheet"===t?a.a.createElement(m,{versionMode:!!e.versionMode,abilities:e.abilities,docId:e.docId,docType:e.docType,type:e.type,content:r,onLoad:e.onLoad}):null}v.propTypes={className:i.a.string,format:i.a.string.isRequired,abilities:i.a.object,docId:i.a.number.isRequired,content:i.a.string.isRequired,versionMode:i.a.bool,showToolbar:i.a.bool,geSheetStyle:i.a.object,onLoad:i.a.func},t.a=Object(c.b)(v,!0,__("数据出错，请通过历史恢复到最近的正确版本，重新编辑"))},4075:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(3730);function a(e){var t=[],r={};if(e.startsWith("<!doctype html>"))t.push(e.substring(15));else{var a=JSON.parse(e.substring(15));t=a.htmls,r=a.options}var o=Object(n.a)(t,r);return{value:JSON.stringify(o)}}},4087:function(e,t,r){"use strict";var n=r(0),a=r.n(n),o=r(8),i=r.n(o),l=r(3801),c=r(1777),u=r(3723),s=r(3630),d={draft:"SheetEmbed-module_draft_hySRt",sheetViewer:"SheetEmbed-module_sheetViewer_LnVL7",content:"SheetEmbed-module_content_XRryY"};function f(e){var t=e.doc,r=e.book,n=e.group,o=e.match,i=e.sheetHeight,f=e.hasReadAuditTip,p=e.showHeader?i-32:i;return t.loaded?a.a.createElement("div",{className:d.wrapper},e.showHeader&&a.a.createElement(u.a,{title:t.title,doc:t,book:r,group:n,height:32,link:o&&o.url}),a.a.createElement("div",{className:d.content},e.showHeader&&a.a.createElement(c.g,{doc:t,className:d.draft}),f&&a.a.createElement(s.default,{key:"audits",doc:t,type:"Doc"}),a.a.createElement("div",{className:d.sheetViewer,style:{width:"100%",height:p,overflow:"hidden"}},a.a.createElement(l.a,{content:t.content,format:t.format,geSheetStyle:{width:"100%",height:i-40}})))):null}f.defaultProps={showHeader:!0},f.propTypes={doc:i.a.object.isRequired,book:i.a.object.isRequired,group:i.a.object.isRequired,sheetHeight:i.a.number.isRequired,match:i.a.object.isRequired,showHeader:i.a.bool,hasReadAuditTip:i.a.bool.isRequired};t.a=f},5116:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(555),i=r(3473),l=r(3801),c=r(3839),u=r(298),s=r(4075),d=r(3551),f=r(447),p=r(4087),h={wrapper:"SheetReader-module_wrapper_P6Ioz",content:"SheetReader-module_content_BhpjY",draft:"SheetReader-module_draft_78IYK",sheetViewer:"SheetReader-module_sheetViewer_zdxVX",infobar:"SheetReader-module_infobar_AXygs"};function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,l=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var b=Object(f.c)((function(){return r.e(138).then(r.bind(null,3833))}),{suspense:!0}),v=Object(f.c)((function(){return r.e(23).then(r.bind(null,3905))}),{suspense:!0});function y(e){var t=e.book,r=e.doc;return Object(c.a)(t,r),a.a.createElement("div",{"data-testid":""})}t.default=Object(o.d)((function(e){return{doc:e.doc}}))((function(e){var t=g(Object(n.useState)(document.body.clientHeight),2),r=t[0],o=t[1],c=Object(f.e)(),m=e.group,S=e.book,w=e.doc,A=e.history,E=e.match,_=e.shouldRenderComments,T=function(){o(document.body.clientHeight)};Object(n.useEffect)((function(){return window.addEventListener("resize",T,!1),function(){window.removeEventListener("resize",T,!1)}}),[]);var O=Object(n.useMemo)((function(){return new d.a}),[]);if(!w.loaded)return null;if(w.loaded&&"lakesheet_html"===w.format){var x=Object(s.a)(w.content);w.content=x.value,w.format="lakesheet"}var k="doc_embed"===A.location.query.view,j=k?32:60,N=98===w.read_status||99===w.read_status||100===w.read_status;N&&(j+=42);var R=r-j;return k?a.a.createElement(p.a,{doc:w,book:S,group:m,sheetHeight:R,match:E,hasReadAuditTip:N,showHeader:O.showHeader}):a.a.createElement("div",{className:h.wrapper},a.a.createElement(y,{book:S,doc:w}),a.a.createElement("div",{className:h.content},a.a.createElement("div",{className:h.sheetViewer,style:{width:"100%",height:R,overflow:"hidden"}},a.a.createElement(l.a,{docId:w.id,type:w.type,abilities:w.abilities,content:w.content,format:w.format,geSheetStyle:{width:"100%",height:R-40},onLoad:function(e){var t=i.a.getSheetStoredPosition(w.id);t&&e.setPosition(t),Object(u.b)(w.id,w.type),b.start(),v.start(),c.priorityTaskManager.execMedium()}}))),a.a.createElement(b,{type:"Doc",targetId:w.id,likeStatus:w.like.actioned,likeCount:w.like.count,size:"bubble",bubblePopover:!0}),a.a.createElement(v,{style:_?{bottom:"32px"}:{bottom:"86px"}}))}))}}]);